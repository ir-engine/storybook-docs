import{r as y}from"./index-DPzuYzxM.js";import{C as u,a as i,L as S,b as h,Q as a,B as x,c as M}from"./three.module-BizNiMhn.js";import{u as O,g as T}from"./WebRTCTransportFunctions-mB_FREj1.js";import{d as j,S as c,u as V,a as B,c as F,s as p,E as G,g as I,b as L}from"./UUIDComponent-GqVY2Xw8.js";import{R as P,T as R,a as _,O as C,b as g,c as l}from"./resourceLoaderHooks-CRL4d032.js";const H=j({name:"SplineComponent",jsonID:"EE_spline",schema:c.Object({elements:c.Array(c.Object({position:g.Vec3(),rotation:g.Quaternion()}),{default:()=>[{position:new i(-1,0,-1),rotation:new a},{position:new i(1,0,-1),rotation:new a().setFromAxisAngle(l,Math.PI/2)},{position:new i(1,0,1),rotation:new a().setFromAxisAngle(l,Math.PI)},{position:new i(-1,0,1),rotation:new a().setFromAxisAngle(l,3*Math.PI/2)}]}),curve:c.Class(()=>new u([],!0),{serialized:!1})}),reactor:()=>{const m=V(),s=B(m,H),f=O(T(P).nodeHelperVisibility),r=s.elements;return y.useEffect(()=>{if(r.length<3){s.curve.set(new u([],!0));return}const e=new u(r.value.map(n=>n.position),!0);e.curveType="catmullrom",s.curve.set(e)},[r.length,r.value.map(e=>`${JSON.stringify(e.position)}${JSON.stringify(e.rotation)})`).join("")]),y.useEffect(()=>{if(!f.value||r.length<3)return;const e=200,n=new i,E=()=>new h({color:"white",opacity:.35}),b=()=>{const t=new x;return t.setAttribute("position",new M(new Float32Array(e*3),3)),t},o=F();p(o,R),p(o,G,{parentEntity:m}),p(o,_),p(o,C,new S(b(),E()));const v=I(o,C),A=s.curve.value,w=v.geometry.attributes.position;for(let t=0;t<e;t++){const d=t/(e-1);A.getPoint(d,n),w.setXYZ(t,n.x,n.y,n.z)}return w.needsUpdate=!0,()=>{L(o)}},[f,s.curve]),null}});export{H as S};
