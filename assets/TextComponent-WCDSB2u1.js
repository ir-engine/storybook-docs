import{r as xe}from"./index-CBqU2yxZ.js";import{U as wn,ad as Cn,ae as Fn,af as Mn,ag as An,g as mr,a0 as Dn,F as Nt,a as It,ah as En,p as jr,y as On,ai as Rn,o as Gn,j as Ln,v as sn,I as Bn,s as Vr,l as Pn,i as ln,k as In,V as yr,t as br,B as Nn,aj as Wn,M as zn,ak as jn}from"./three.module-D2RMN07C.js";import{S as ge,c as Vn,e as Hn,f as Xn}from"./index-_wFD3GG2.js";import{i as Yn}from"./ActionFunctions-CxzuxLxN.js";import{n as Jn}from"./EditorServices-BJKHmurs.js";function Kn(){var c=Object.create(null);function r(t,e){var a=t.id,i=t.name,n=t.dependencies;n===void 0&&(n=[]);var o=t.init;o===void 0&&(o=function(){});var s=t.getTransferables;if(s===void 0&&(s=null),!c[a])try{n=n.map(function(u){return u&&u.isWorkerModule&&(r(u,function(h){if(h instanceof Error)throw h}),u=c[u.id].value),u}),o=d("<"+i+">.init",o),s&&(s=d("<"+i+">.getTransferables",s));var f=null;typeof o=="function"?f=o.apply(void 0,n):console.error("worker module init function failed to rehydrate"),c[a]={id:a,value:f,getTransferables:s},e(f)}catch(u){u&&u.noLog||console.error(u),e(u)}}function l(t,e){var a,i=t.id,n=t.args;(!c[i]||typeof c[i].value!="function")&&e(new Error("Worker module "+i+": not found or its 'init' did not return a function"));try{var o=(a=c[i]).value.apply(a,n);o&&typeof o.then=="function"?o.then(s,function(f){return e(f instanceof Error?f:new Error(""+f))}):s(o)}catch(f){e(f)}function s(f){try{var u=c[i].getTransferables&&c[i].getTransferables(f);(!u||!Array.isArray(u)||!u.length)&&(u=void 0),e(f,u)}catch(h){console.error(h),e(h)}}}function d(t,e){var a=void 0;self.troikaDefine=function(n){return a=n};var i=URL.createObjectURL(new Blob(["/** "+t.replace(/\*/g,"")+` **/

troikaDefine(
`+e+`
)`],{type:"application/javascript"}));try{importScripts(i)}catch(n){console.error(n)}return URL.revokeObjectURL(i),delete self.troikaDefine,a}self.addEventListener("message",function(t){var e=t.data,a=e.messageId,i=e.action,n=e.data;try{i==="registerModule"&&r(n,function(o){o instanceof Error?postMessage({messageId:a,success:!1,error:o.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof o=="function"}})}),i==="callModule"&&l(n,function(o,s){o instanceof Error?postMessage({messageId:a,success:!1,error:o.message}):postMessage({messageId:a,success:!0,result:o},s||void 0)})}catch(o){postMessage({messageId:a,success:!1,error:o.stack})}})}function Qn(c){var r=function(){for(var l=[],d=arguments.length;d--;)l[d]=arguments[d];return r._getInitResult().then(function(t){if(typeof t=="function")return t.apply(void 0,l);throw new Error("Worker module function was called but `init` did not return a callable function")})};return r._getInitResult=function(){var l=c.dependencies,d=c.init;l=Array.isArray(l)?l.map(function(e){return e&&e._getInitResult?e._getInitResult():e}):[];var t=Promise.all(l).then(function(e){return d.apply(null,e)});return r._getInitResult=function(){return t},t},r}var fn=function(){var c=!1;if(typeof window<"u"&&typeof window.document<"u")try{var r=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));r.terminate(),c=!0}catch(l){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+l.message+"]")}return fn=function(){return c},c},Zn=0,qn=0,lr=!1,xt=Object.create(null),kt=Object.create(null),dr=Object.create(null);function lt(c){if((!c||typeof c.init!="function")&&!lr)throw new Error("requires `options.init` function");var r=c.dependencies,l=c.init,d=c.getTransferables,t=c.workerId;if(!fn())return Qn(c);t==null&&(t="#default");var e="workerModule"+ ++Zn,a=c.name||e,i=null;r=r&&r.map(function(o){return typeof o=="function"&&!o.workerModuleData&&(lr=!0,o=lt({workerId:t,name:"<"+a+"> function dependency: "+o.name,init:`function(){return (
`+Bt(o)+`
)}`}),lr=!1),o&&o.workerModuleData&&(o=o.workerModuleData),o});function n(){for(var o=[],s=arguments.length;s--;)o[s]=arguments[s];if(!i){i=Hr(t,"registerModule",n.workerModuleData);var f=function(){i=null,kt[t].delete(f)};(kt[t]||(kt[t]=new Set)).add(f)}return i.then(function(u){var h=u.isCallable;if(h)return Hr(t,"callModule",{id:e,args:o});throw new Error("Worker module function was called but `init` did not return a callable function")})}return n.workerModuleData={isWorkerModule:!0,id:e,name:a,dependencies:r,init:Bt(l),getTransferables:d&&Bt(d)},n}function $n(c){kt[c]&&kt[c].forEach(function(r){r()}),xt[c]&&(xt[c].terminate(),delete xt[c])}function Bt(c){var r=c.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function ea(c){var r=xt[c];if(!r){var l=Bt(Kn);r=xt[c]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+c.replace(/\*/g,"")+` **/

;(`+l+")()"],{type:"application/javascript"}))),r.onmessage=function(d){var t=d.data,e=t.messageId,a=dr[e];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete dr[e],a(t)}}return r}function Hr(c,r,l){return new Promise(function(d,t){var e=++qn;dr[e]=function(a){a.success?d(a.result):t(new Error("Error in worker "+r+" call: "+a.error))},ea(c).postMessage({messageId:e,action:r,data:l})})}function un(){var c=function(r){function l(B,E,v,b,_,M,k,N){var D=1-k;N.x=D*D*B+2*D*k*v+k*k*_,N.y=D*D*E+2*D*k*b+k*k*M}function d(B,E,v,b,_,M,k,N,D,P){var X=1-D;P.x=X*X*X*B+3*X*X*D*v+3*X*D*D*_+D*D*D*k,P.y=X*X*X*E+3*X*X*D*b+3*X*D*D*M+D*D*D*N}function t(B,E){for(var v=/([MLQCZ])([^MLQCZ]*)/g,b,_,M,k,N;b=v.exec(B);){var D=b[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(P){return parseFloat(P)});switch(b[1]){case"M":k=_=D[0],N=M=D[1];break;case"L":(D[0]!==k||D[1]!==N)&&E("L",k,N,k=D[0],N=D[1]);break;case"Q":{E("Q",k,N,k=D[2],N=D[3],D[0],D[1]);break}case"C":{E("C",k,N,k=D[4],N=D[5],D[0],D[1],D[2],D[3]);break}case"Z":(k!==_||N!==M)&&E("L",k,N,_,M);break}}}function e(B,E,v){v===void 0&&(v=16);var b={x:0,y:0};t(B,function(_,M,k,N,D,P,X,$,V){switch(_){case"L":E(M,k,N,D);break;case"Q":{for(var W=M,pe=k,ue=1;ue<v;ue++)l(M,k,P,X,N,D,ue/(v-1),b),E(W,pe,b.x,b.y),W=b.x,pe=b.y;break}case"C":{for(var Q=M,ee=k,se=1;se<v;se++)d(M,k,P,X,$,V,N,D,se/(v-1),b),E(Q,ee,b.x,b.y),Q=b.x,ee=b.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",i="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",n=new WeakMap,o={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function s(B,E){var v=B.getContext?B.getContext("webgl",o):B,b=n.get(v);if(!b){let X=function(Q){var ee=M[Q];if(!ee&&(ee=M[Q]=v.getExtension(Q),!ee))throw new Error(Q+" not supported");return ee},$=function(Q,ee){var se=v.createShader(ee);return v.shaderSource(se,Q),v.compileShader(se),se},V=function(Q,ee,se,j){if(!k[Q]){var te={},q={},L=v.createProgram();v.attachShader(L,$(ee,v.VERTEX_SHADER)),v.attachShader(L,$(se,v.FRAGMENT_SHADER)),v.linkProgram(L),k[Q]={program:L,transaction:function(K){v.useProgram(L),K({setUniform:function(Y,ke){for(var ne=[],oe=arguments.length-2;oe-- >0;)ne[oe]=arguments[oe+2];var fe=q[ke]||(q[ke]=v.getUniformLocation(L,ke));v["uniform"+Y].apply(v,[fe].concat(ne))},setAttribute:function(Y,ke,ne,oe,fe){var de=te[Y];de||(de=te[Y]={buf:v.createBuffer(),loc:v.getAttribLocation(L,Y),data:null}),v.bindBuffer(v.ARRAY_BUFFER,de.buf),v.vertexAttribPointer(de.loc,ke,v.FLOAT,!1,0,0),v.enableVertexAttribArray(de.loc),_?v.vertexAttribDivisor(de.loc,oe):X("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(de.loc,oe),fe!==de.data&&(v.bufferData(v.ARRAY_BUFFER,fe,ne),de.data=fe)}})}}}k[Q].transaction(j)},W=function(Q,ee){D++;try{v.activeTexture(v.TEXTURE0+D);var se=N[Q];se||(se=N[Q]=v.createTexture(),v.bindTexture(v.TEXTURE_2D,se),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.NEAREST),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.NEAREST)),v.bindTexture(v.TEXTURE_2D,se),ee(se,D)}finally{D--}},pe=function(Q,ee,se){var j=v.createFramebuffer();P.push(j),v.bindFramebuffer(v.FRAMEBUFFER,j),v.activeTexture(v.TEXTURE0+ee),v.bindTexture(v.TEXTURE_2D,Q),v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_2D,Q,0);try{se(j)}finally{v.deleteFramebuffer(j),v.bindFramebuffer(v.FRAMEBUFFER,P[--P.length-1]||null)}},ue=function(){M={},k={},N={},D=-1,P.length=0};var _=typeof WebGL2RenderingContext<"u"&&v instanceof WebGL2RenderingContext,M={},k={},N={},D=-1,P=[];v.canvas.addEventListener("webglcontextlost",function(Q){ue(),Q.preventDefault()},!1),n.set(v,b={gl:v,isWebGL2:_,getExtension:X,withProgram:V,withTexture:W,withTextureFramebuffer:pe,handleContextLoss:ue})}E(b)}function f(B,E,v,b,_,M,k,N){k===void 0&&(k=15),N===void 0&&(N=null),s(B,function(D){var P=D.gl,X=D.withProgram,$=D.withTexture;$("copy",function(V,W){P.texImage2D(P.TEXTURE_2D,0,P.RGBA,_,M,0,P.RGBA,P.UNSIGNED_BYTE,E),X("copy",a,i,function(pe){var ue=pe.setUniform,Q=pe.setAttribute;Q("aUV",2,P.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",W),P.bindFramebuffer(P.FRAMEBUFFER,N||null),P.disable(P.BLEND),P.colorMask(k&8,k&4,k&2,k&1),P.viewport(v,b,_,M),P.scissor(v,b,_,M),P.drawArrays(P.TRIANGLES,0,3)})})})}function u(B,E,v){var b=B.width,_=B.height;s(B,function(M){var k=M.gl,N=new Uint8Array(b*_*4);k.readPixels(0,0,b,_,k.RGBA,k.UNSIGNED_BYTE,N),B.width=E,B.height=v,f(k,N,0,0,b,_)})}var h=Object.freeze({__proto__:null,withWebGLContext:s,renderImageData:f,resizeWebGLCanvasWithoutClearing:u});function p(B,E,v,b,_,M){M===void 0&&(M=1);var k=new Uint8Array(B*E),N=b[2]-b[0],D=b[3]-b[1],P=[];e(v,function(Q,ee,se,j){P.push({x1:Q,y1:ee,x2:se,y2:j,minX:Math.min(Q,se),minY:Math.min(ee,j),maxX:Math.max(Q,se),maxY:Math.max(ee,j)})}),P.sort(function(Q,ee){return Q.maxX-ee.maxX});for(var X=0;X<B;X++)for(var $=0;$<E;$++){var V=pe(b[0]+N*(X+.5)/B,b[1]+D*($+.5)/E),W=Math.pow(1-Math.abs(V)/_,M)/2;V<0&&(W=1-W),W=Math.max(0,Math.min(255,Math.round(W*255))),k[$*B+X]=W}return k;function pe(Q,ee){for(var se=1/0,j=1/0,te=P.length;te--;){var q=P[te];if(q.maxX+j<=Q)break;if(Q+j>q.minX&&ee-j<q.maxY&&ee+j>q.minY){var L=G(Q,ee,q.x1,q.y1,q.x2,q.y2);L<se&&(se=L,j=Math.sqrt(se))}}return ue(Q,ee)&&(j=-j),j}function ue(Q,ee){for(var se=0,j=P.length;j--;){var te=P[j];if(te.maxX<=Q)break;var q=te.y1>ee!=te.y2>ee&&Q<(te.x2-te.x1)*(ee-te.y1)/(te.y2-te.y1)+te.x1;q&&(se+=te.y1<te.y2?1:-1)}return se!==0}}function g(B,E,v,b,_,M,k,N,D,P){M===void 0&&(M=1),N===void 0&&(N=0),D===void 0&&(D=0),P===void 0&&(P=0),y(B,E,v,b,_,M,k,null,N,D,P)}function y(B,E,v,b,_,M,k,N,D,P,X){M===void 0&&(M=1),D===void 0&&(D=0),P===void 0&&(P=0),X===void 0&&(X=0);for(var $=p(B,E,v,b,_,M),V=new Uint8Array($.length*4),W=0;W<$.length;W++)V[W*4+X]=$[W];f(k,V,D,P,B,E,1<<3-X,N)}function G(B,E,v,b,_,M){var k=_-v,N=M-b,D=k*k+N*N,P=D?Math.max(0,Math.min(1,((B-v)*k+(E-b)*N)/D)):0,X=B-(v+P*k),$=E-(b+P*N);return X*X+$*$}var S=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:g,generateIntoFramebuffer:y}),C="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",x="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",T="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",R=new Float32Array([0,0,2,0,0,2]),U=null,F=!1,I={},O=new WeakMap;function J(B){if(!F&&!H(B))throw new Error("WebGL generation not supported")}function m(B,E,v,b,_,M,k){if(M===void 0&&(M=1),k===void 0&&(k=null),!k&&(k=U,!k)){var N=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!N)throw new Error("OffscreenCanvas or DOM canvas not supported");k=U=N.getContext("webgl",{depth:!1})}J(k);var D=new Uint8Array(B*E*4);s(k,function(V){var W=V.gl,pe=V.withTexture,ue=V.withTextureFramebuffer;pe("readable",function(Q,ee){W.texImage2D(W.TEXTURE_2D,0,W.RGBA,B,E,0,W.RGBA,W.UNSIGNED_BYTE,null),ue(Q,ee,function(se){w(B,E,v,b,_,M,W,se,0,0,0),W.readPixels(0,0,B,E,W.RGBA,W.UNSIGNED_BYTE,D)})})});for(var P=new Uint8Array(B*E),X=0,$=0;X<D.length;X+=4)P[$++]=D[X];return P}function A(B,E,v,b,_,M,k,N,D,P){M===void 0&&(M=1),N===void 0&&(N=0),D===void 0&&(D=0),P===void 0&&(P=0),w(B,E,v,b,_,M,k,null,N,D,P)}function w(B,E,v,b,_,M,k,N,D,P,X){M===void 0&&(M=1),D===void 0&&(D=0),P===void 0&&(P=0),X===void 0&&(X=0),J(k);var $=[];e(v,function(V,W,pe,ue){$.push(V,W,pe,ue)}),$=new Float32Array($),s(k,function(V){var W=V.gl,pe=V.isWebGL2,ue=V.getExtension,Q=V.withProgram,ee=V.withTexture,se=V.withTextureFramebuffer,j=V.handleContextLoss;if(ee("rawDistances",function(te,q){(B!==te._lastWidth||E!==te._lastHeight)&&W.texImage2D(W.TEXTURE_2D,0,W.RGBA,te._lastWidth=B,te._lastHeight=E,0,W.RGBA,W.UNSIGNED_BYTE,null),Q("main",C,x,function(L){var he=L.setAttribute,K=L.setUniform,ae=!pe&&ue("ANGLE_instanced_arrays"),Y=!pe&&ue("EXT_blend_minmax");he("aUV",2,W.STATIC_DRAW,0,R),he("aLineSegment",4,W.DYNAMIC_DRAW,1,$),K.apply(void 0,["4f","uGlyphBounds"].concat(b)),K("1f","uMaxDistance",_),K("1f","uExponent",M),se(te,q,function(ke){W.enable(W.BLEND),W.colorMask(!0,!0,!0,!0),W.viewport(0,0,B,E),W.scissor(0,0,B,E),W.blendFunc(W.ONE,W.ONE),W.blendEquationSeparate(W.FUNC_ADD,pe?W.MAX:Y.MAX_EXT),W.clear(W.COLOR_BUFFER_BIT),pe?W.drawArraysInstanced(W.TRIANGLES,0,3,$.length/4):ae.drawArraysInstancedANGLE(W.TRIANGLES,0,3,$.length/4)})}),Q("post",a,T,function(L){L.setAttribute("aUV",2,W.STATIC_DRAW,0,R),L.setUniform("1i","tex",q),W.bindFramebuffer(W.FRAMEBUFFER,N),W.disable(W.BLEND),W.colorMask(X===0,X===1,X===2,X===3),W.viewport(D,P,B,E),W.scissor(D,P,B,E),W.drawArrays(W.TRIANGLES,0,3)})}),W.isContextLost())throw j(),new Error("webgl context lost")})}function H(B){var E=!B||B===U?I:B.canvas||B,v=O.get(E);if(v===void 0){F=!0;var b=null;try{var _=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],M=m(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,B);v=M&&_.length===M.length&&M.every(function(k,N){return k===_[N]}),v||(b="bad trial run results",console.info(_,M))}catch(k){v=!1,b=k.message}b&&console.warn("WebGL SDF generation not supported:",b),F=!1,O.set(E,v)}return v}var z=Object.freeze({__proto__:null,generate:m,generateIntoCanvas:A,generateIntoFramebuffer:w,isSupported:H});function Z(B,E,v,b,_,M){_===void 0&&(_=Math.max(b[2]-b[0],b[3]-b[1])/2),M===void 0&&(M=1);try{return m.apply(z,arguments)}catch(k){return console.info("WebGL SDF generation failed, falling back to JS",k),p.apply(S,arguments)}}function re(B,E,v,b,_,M,k,N,D,P){_===void 0&&(_=Math.max(b[2]-b[0],b[3]-b[1])/2),M===void 0&&(M=1),N===void 0&&(N=0),D===void 0&&(D=0),P===void 0&&(P=0);try{return A.apply(z,arguments)}catch(X){return console.info("WebGL SDF generation failed, falling back to JS",X),g.apply(S,arguments)}}return r.forEachPathCommand=t,r.generate=Z,r.generateIntoCanvas=re,r.javascript=S,r.pathToLineSegments=e,r.webgl=z,r.webglUtils=h,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return c}function ta(){var c=function(r){var l={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},d={},t={};d.L=1,t[1]="L",Object.keys(l).forEach(function(j,te){d[j]=1<<te+1,t[d[j]]=j}),Object.freeze(d);var e=d.LRI|d.RLI|d.FSI,a=d.L|d.R|d.AL,i=d.B|d.S|d.WS|d.ON|d.FSI|d.LRI|d.RLI|d.PDI,n=d.BN|d.RLE|d.LRE|d.RLO|d.LRO|d.PDF,o=d.S|d.WS|d.B|e|d.PDI|n,s=null;function f(){if(!s){s=new Map;var j=function(q){if(l.hasOwnProperty(q)){var L=0;l[q].split(",").forEach(function(he){var K=he.split("+"),ae=K[0],Y=K[1];ae=parseInt(ae,36),Y=Y?parseInt(Y,36):0,s.set(L+=ae,d[q]);for(var ke=0;ke<Y;ke++)s.set(++L,d[q])})}};for(var te in l)j(te)}}function u(j){return f(),s.get(j.codePointAt(0))||d.L}function h(j){return t[u(j)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(j,te){var q=36,L=0,he=new Map,K=te&&new Map,ae;return j.split(",").forEach(function Y(ke){if(ke.indexOf("+")!==-1)for(var ne=+ke;ne--;)Y(ae);else{ae=ke;var oe=ke.split(">"),fe=oe[0],de=oe[1];fe=String.fromCodePoint(L+=parseInt(fe,q)),de=String.fromCodePoint(L+=parseInt(de,q)),he.set(fe,de),te&&K.set(de,fe)}}),{map:he,reverseMap:K}}var y,G,S;function C(){if(!y){var j=g(p.pairs,!0),te=j.map,q=j.reverseMap;y=te,G=q,S=g(p.canonical,!1).map}}function x(j){return C(),y.get(j)||null}function T(j){return C(),G.get(j)||null}function R(j){return C(),S.get(j)||null}var U=d.L,F=d.R,I=d.EN,O=d.ES,J=d.ET,m=d.AN,A=d.CS,w=d.B,H=d.S,z=d.ON,Z=d.BN,re=d.NSM,B=d.AL,E=d.LRO,v=d.RLO,b=d.LRE,_=d.RLE,M=d.PDF,k=d.LRI,N=d.RLI,D=d.FSI,P=d.PDI;function X(j,te){for(var q=125,L=new Uint32Array(j.length),he=0;he<j.length;he++)L[he]=u(j[he]);var K=new Map;function ae(Pe,je){var Ie=L[Pe];L[Pe]=je,K.set(Ie,K.get(Ie)-1),Ie&i&&K.set(i,K.get(i)-1),K.set(je,(K.get(je)||0)+1),je&i&&K.set(i,(K.get(i)||0)+1)}for(var Y=new Uint8Array(j.length),ke=new Map,ne=[],oe=null,fe=0;fe<j.length;fe++)oe||ne.push(oe={start:fe,end:j.length-1,level:te==="rtl"?1:te==="ltr"?0:Wr(fe,!1)}),L[fe]&w&&(oe.end=fe,oe=null);for(var de=_|b|v|E|e|P|M|w,_e=function(Pe){return Pe+(Pe&1?1:2)},Me=function(Pe){return Pe+(Pe&1?2:1)},me=0;me<ne.length;me++){oe=ne[me];var ye=[{_level:oe.level,_override:0,_isolate:0}],le=void 0,Ae=0,we=0,Be=0;K.clear();for(var Te=oe.start;Te<=oe.end;Te++){var ce=L[Te];if(le=ye[ye.length-1],K.set(ce,(K.get(ce)||0)+1),ce&i&&K.set(i,(K.get(i)||0)+1),ce&de)if(ce&(_|b)){Y[Te]=le._level;var Ue=(ce===_?Me:_e)(le._level);Ue<=q&&!Ae&&!we?ye.push({_level:Ue,_override:0,_isolate:0}):Ae||we++}else if(ce&(v|E)){Y[Te]=le._level;var Ye=(ce===v?Me:_e)(le._level);Ye<=q&&!Ae&&!we?ye.push({_level:Ye,_override:ce&v?F:U,_isolate:0}):Ae||we++}else if(ce&e){ce&D&&(ce=Wr(Te+1,!0)===1?N:k),Y[Te]=le._level,le._override&&ae(Te,le._override);var Se=(ce===N?Me:_e)(le._level);Se<=q&&Ae===0&&we===0?(Be++,ye.push({_level:Se,_override:0,_isolate:1,_isolInitIndex:Te})):Ae++}else if(ce&P){if(Ae>0)Ae--;else if(Be>0){for(we=0;!ye[ye.length-1]._isolate;)ye.pop();var be=ye[ye.length-1]._isolInitIndex;be!=null&&(ke.set(be,Te),ke.set(Te,be)),ye.pop(),Be--}le=ye[ye.length-1],Y[Te]=le._level,le._override&&ae(Te,le._override)}else ce&M?(Ae===0&&(we>0?we--:!le._isolate&&ye.length>1&&(ye.pop(),le=ye[ye.length-1])),Y[Te]=le._level):ce&w&&(Y[Te]=oe.level);else Y[Te]=le._level,le._override&&ce!==Z&&ae(Te,le._override)}for(var De=[],Ce=null,ve=oe.start;ve<=oe.end;ve++){var Fe=L[ve];if(!(Fe&n)){var Ge=Y[ve],Re=Fe&e,Ee=Fe===P;Ce&&Ge===Ce._level?(Ce._end=ve,Ce._endsWithIsolInit=Re):De.push(Ce={_start:ve,_end:ve,_level:Ge,_startsWithPDI:Ee,_endsWithIsolInit:Re})}}for(var We=[],Je=0;Je<De.length;Je++){var He=De[Je];if(!He._startsWithPDI||He._startsWithPDI&&!ke.has(He._start)){for(var Ke=[Ce=He],qe=void 0;Ce&&Ce._endsWithIsolInit&&(qe=ke.get(Ce._end))!=null;)for(var Xe=Je+1;Xe<De.length;Xe++)if(De[Xe]._start===qe){Ke.push(Ce=De[Xe]);break}for(var Le=[],$e=0;$e<Ke.length;$e++)for(var kr=Ke[$e],zt=kr._start;zt<=kr._end;zt++)Le.push(zt);for(var xn=Y[Le[0]],Ur=oe.level,Ut=Le[0]-1;Ut>=0;Ut--)if(!(L[Ut]&n)){Ur=Y[Ut];break}var jt=Le[Le.length-1],kn=Y[jt],Sr=oe.level;if(!(L[jt]&e)){for(var St=jt+1;St<=oe.end;St++)if(!(L[St]&n)){Sr=Y[St];break}}We.push({_seqIndices:Le,_sosType:Math.max(Ur,xn)%2?F:U,_eosType:Math.max(Sr,kn)%2?F:U})}}for(var Vt=0;Vt<We.length;Vt++){var Ht=We[Vt],ie=Ht._seqIndices,ft=Ht._sosType,Un=Ht._eosType,rt=Y[ie[0]]&1?F:U;if(K.get(re))for(var _t=0;_t<ie.length;_t++){var _r=ie[_t];if(L[_r]&re){for(var Xt=ft,Tt=_t-1;Tt>=0;Tt--)if(!(L[ie[Tt]]&n)){Xt=L[ie[Tt]];break}ae(_r,Xt&(e|P)?z:Xt)}}if(K.get(I))for(var wt=0;wt<ie.length;wt++){var Tr=ie[wt];if(L[Tr]&I)for(var Ct=wt-1;Ct>=-1;Ct--){var wr=Ct===-1?ft:L[ie[Ct]];if(wr&a){wr===B&&ae(Tr,m);break}}}if(K.get(B))for(var Yt=0;Yt<ie.length;Yt++){var Cr=ie[Yt];L[Cr]&B&&ae(Cr,F)}if(K.get(O)||K.get(A))for(var ut=1;ut<ie.length-1;ut++){var Jt=ie[ut];if(L[Jt]&(O|A)){for(var nt=0,Kt=0,Qt=ut-1;Qt>=0&&(nt=L[ie[Qt]],!!(nt&n));Qt--);for(var Zt=ut+1;Zt<ie.length&&(Kt=L[ie[Zt]],!!(Kt&n));Zt++);nt===Kt&&(L[Jt]===O?nt===I:nt&(I|m))&&ae(Jt,nt)}}if(K.get(I))for(var Ve=0;Ve<ie.length;Ve++){var Sn=ie[Ve];if(L[Sn]&I){for(var Ft=Ve-1;Ft>=0&&L[ie[Ft]]&(J|n);Ft--)ae(ie[Ft],I);for(Ve++;Ve<ie.length&&L[ie[Ve]]&(J|n|I);Ve++)L[ie[Ve]]!==I&&ae(ie[Ve],I)}}if(K.get(J)||K.get(O)||K.get(A))for(var ct=0;ct<ie.length;ct++){var Fr=ie[ct];if(L[Fr]&(J|O|A)){ae(Fr,z);for(var Mt=ct-1;Mt>=0&&L[ie[Mt]]&n;Mt--)ae(ie[Mt],z);for(var At=ct+1;At<ie.length&&L[ie[At]]&n;At++)ae(ie[At],z)}}if(K.get(I))for(var qt=0,Mr=ft;qt<ie.length;qt++){var Ar=ie[qt],$t=L[Ar];$t&I?Mr===U&&ae(Ar,U):$t&a&&(Mr=$t)}if(K.get(i)){var ht=F|I|m,Dr=ht|U,Dt=[];{for(var at=[],ot=0;ot<ie.length;ot++)if(L[ie[ot]]&i){var dt=j[ie[ot]],Er=void 0;if(x(dt)!==null)if(at.length<63)at.push({char:dt,seqIndex:ot});else break;else if((Er=T(dt))!==null)for(var vt=at.length-1;vt>=0;vt--){var er=at[vt].char;if(er===Er||er===T(R(dt))||x(R(er))===dt){Dt.push([at[vt].seqIndex,ot]),at.length=vt;break}}}Dt.sort(function(Pe,je){return Pe[0]-je[0]})}for(var tr=0;tr<Dt.length;tr++){for(var Or=Dt[tr],Et=Or[0],rr=Or[1],Rr=!1,ze=0,nr=Et+1;nr<rr;nr++){var Gr=ie[nr];if(L[Gr]&Dr){Rr=!0;var Lr=L[Gr]&ht?F:U;if(Lr===rt){ze=Lr;break}}}if(Rr&&!ze){ze=ft;for(var ar=Et-1;ar>=0;ar--){var Br=ie[ar];if(L[Br]&Dr){var Pr=L[Br]&ht?F:U;Pr!==rt?ze=Pr:ze=rt;break}}}if(ze){if(L[ie[Et]]=L[ie[rr]]=ze,ze!==rt){for(var pt=Et+1;pt<ie.length;pt++)if(!(L[ie[pt]]&n)){u(j[ie[pt]])&re&&(L[ie[pt]]=ze);break}}if(ze!==rt){for(var gt=rr+1;gt<ie.length;gt++)if(!(L[ie[gt]]&n)){u(j[ie[gt]])&re&&(L[ie[gt]]=ze);break}}}}for(var Qe=0;Qe<ie.length;Qe++)if(L[ie[Qe]]&i){for(var Ir=Qe,or=Qe,ir=ft,mt=Qe-1;mt>=0;mt--)if(L[ie[mt]]&n)Ir=mt;else{ir=L[ie[mt]]&ht?F:U;break}for(var Nr=Un,yt=Qe+1;yt<ie.length;yt++)if(L[ie[yt]]&(i|n))or=yt;else{Nr=L[ie[yt]]&ht?F:U;break}for(var sr=Ir;sr<=or;sr++)L[ie[sr]]=ir===Nr?ir:rt;Qe=or}}}for(var Ne=oe.start;Ne<=oe.end;Ne++){var _n=Y[Ne],Ot=L[Ne];if(_n&1?Ot&(U|I|m)&&Y[Ne]++:Ot&F?Y[Ne]++:Ot&(m|I)&&(Y[Ne]+=2),Ot&n&&(Y[Ne]=Ne===0?oe.level:Y[Ne-1]),Ne===oe.end||u(j[Ne])&(H|w))for(var Rt=Ne;Rt>=0&&u(j[Rt])&o;Rt--)Y[Rt]=oe.level}}return{levels:Y,paragraphs:ne};function Wr(Pe,je){for(var Ie=Pe;Ie<j.length;Ie++){var Ze=L[Ie];if(Ze&(F|B))return 1;if(Ze&(w|U)||je&&Ze===P)return 0;if(Ze&e){var zr=Tn(Ie);Ie=zr===-1?j.length:zr}}return 0}function Tn(Pe){for(var je=1,Ie=Pe+1;Ie<j.length;Ie++){var Ze=L[Ie];if(Ze&w)break;if(Ze&P){if(--je===0)return Ie}else Ze&e&&je++}return-1}}var $="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",V;function W(){if(!V){var j=g($,!0),te=j.map,q=j.reverseMap;q.forEach(function(L,he){te.set(he,L)}),V=te}}function pe(j){return W(),V.get(j)||null}function ue(j,te,q,L){var he=j.length;q=Math.max(0,q==null?0:+q),L=Math.min(he-1,L==null?he-1:+L);for(var K=new Map,ae=q;ae<=L;ae++)if(te[ae]&1){var Y=pe(j[ae]);Y!==null&&K.set(ae,Y)}return K}function Q(j,te,q,L){var he=j.length;q=Math.max(0,q==null?0:+q),L=Math.min(he-1,L==null?he-1:+L);var K=[];return te.paragraphs.forEach(function(ae){var Y=Math.max(q,ae.start),ke=Math.min(L,ae.end);if(Y<ke){for(var ne=te.levels.slice(Y,ke+1),oe=ke;oe>=Y&&u(j[oe])&o;oe--)ne[oe]=ae.level;for(var fe=ae.level,de=1/0,_e=0;_e<ne.length;_e++){var Me=ne[_e];Me>fe&&(fe=Me),Me<de&&(de=Me|1)}for(var me=fe;me>=de;me--)for(var ye=0;ye<ne.length;ye++)if(ne[ye]>=me){for(var le=ye;ye+1<ne.length&&ne[ye+1]>=me;)ye++;ye>le&&K.push([le+Y,ye+Y])}}}),K}function ee(j,te,q,L){var he=se(j,te,q,L),K=[].concat(j);return he.forEach(function(ae,Y){K[Y]=(te.levels[ae]&1?pe(j[ae]):null)||j[ae]}),K.join("")}function se(j,te,q,L){for(var he=Q(j,te,q,L),K=[],ae=0;ae<j.length;ae++)K[ae]=ae;return he.forEach(function(Y){for(var ke=Y[0],ne=Y[1],oe=K.slice(ke,ne+1),fe=oe.length;fe--;)K[ne-fe]=oe[fe]}),K}return r.closingToOpeningBracket=T,r.getBidiCharType=u,r.getBidiCharTypeName=h,r.getCanonicalBracket=R,r.getEmbeddingLevels=X,r.getMirroredCharacter=pe,r.getMirroredCharactersMap=ue,r.getReorderSegments=Q,r.getReorderedIndices=se,r.getReorderedString=ee,r.openingToClosingBracket=x,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return c}const cn=/\bvoid\s+main\s*\(\s*\)\s*{/g;function vr(c){const r=/^[ \t]*#include +<([\w\d./]+)>/gm;function l(d,t){let e=An[t];return e?vr(e):d}return c.replace(r,l)}const Oe=[];for(let c=0;c<256;c++)Oe[c]=(c<16?"0":"")+c.toString(16);function ra(){const c=Math.random()*4294967295|0,r=Math.random()*4294967295|0,l=Math.random()*4294967295|0,d=Math.random()*4294967295|0;return(Oe[c&255]+Oe[c>>8&255]+Oe[c>>16&255]+Oe[c>>24&255]+"-"+Oe[r&255]+Oe[r>>8&255]+"-"+Oe[r>>16&15|64]+Oe[r>>24&255]+"-"+Oe[l&63|128]+Oe[l>>8&255]+"-"+Oe[l>>16&255]+Oe[l>>24&255]+Oe[d&255]+Oe[d>>8&255]+Oe[d>>16&255]+Oe[d>>24&255]).toUpperCase()}const et=Object.assign||function(){let c=arguments[0];for(let r=1,l=arguments.length;r<l;r++){let d=arguments[r];if(d)for(let t in d)Object.prototype.hasOwnProperty.call(d,t)&&(c[t]=d[t])}return c},na=Date.now(),Xr=new WeakMap,Yr=new Map;let aa=1e10;function pr(c,r){const l=la(r);let d=Xr.get(c);if(d||Xr.set(c,d=Object.create(null)),d[l])return new d[l];const t=`_onBeforeCompile${l}`,e=function(o,s){c.onBeforeCompile.call(this,o,s);const f=this.customProgramCacheKey()+"|"+o.vertexShader+"|"+o.fragmentShader;let u=Yr[f];if(!u){const h=oa(this,o,r,l);u=Yr[f]=h}o.vertexShader=u.vertexShader,o.fragmentShader=u.fragmentShader,et(o.uniforms,this.uniforms),r.timeUniform&&(o.uniforms[r.timeUniform]={get value(){return Date.now()-na}}),this[t]&&this[t](o)},a=function(){return i(r.chained?c:c.clone())},i=function(o){const s=Object.create(o,n);return Object.defineProperty(s,"baseMaterial",{value:c}),Object.defineProperty(s,"id",{value:aa++}),s.uuid=ra(),s.uniforms=et({},o.uniforms,r.uniforms),s.defines=et({},o.defines,r.defines),s.defines[`TROIKA_DERIVED_MATERIAL_${l}`]="",s.extensions=et({},o.extensions,r.extensions),s._listeners=void 0,s},n={constructor:{value:a},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return c.customProgramCacheKey()+"|"+l}},onBeforeCompile:{get(){return e},set(o){this[t]=o}},copy:{writable:!0,configurable:!0,value:function(o){return c.copy.call(this,o),!c.isShaderMaterial&&!c.isDerivedMaterial&&(et(this.extensions,o.extensions),et(this.defines,o.defines),et(this.uniforms,wn.clone(o.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const o=new c.constructor;return i(o).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let o=this._depthMaterial;return o||(o=this._depthMaterial=pr(c.isDerivedMaterial?c.getDepthMaterial():new Cn({depthPacking:Fn}),r),o.defines.IS_DEPTH_MATERIAL="",o.uniforms=this.uniforms),o}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let o=this._distanceMaterial;return o||(o=this._distanceMaterial=pr(c.isDerivedMaterial?c.getDistanceMaterial():new Mn,r),o.defines.IS_DISTANCE_MATERIAL="",o.uniforms=this.uniforms),o}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:o,_distanceMaterial:s}=this;o&&o.dispose(),s&&s.dispose(),c.dispose.call(this)}}};return d[l]=a,new a}function oa(c,{vertexShader:r,fragmentShader:l},d,t){let{vertexDefs:e,vertexMainIntro:a,vertexMainOutro:i,vertexTransform:n,fragmentDefs:o,fragmentMainIntro:s,fragmentMainOutro:f,fragmentColorTransform:u,customRewriter:h,timeUniform:p}=d;if(e=e||"",a=a||"",i=i||"",o=o||"",s=s||"",f=f||"",(n||h)&&(r=vr(r)),(u||h)&&(l=l.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),l=vr(l)),h){let g=h({vertexShader:r,fragmentShader:l});r=g.vertexShader,l=g.fragmentShader}if(u){let g=[];l=l.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,y=>(g.push(y),"")),f=`${u}
${g.join(`
`)}
${f}`}if(p){const g=`
uniform float ${p};
`;e=g+e,o=g+o}return n&&(r=`vec3 troika_position_${t};
vec3 troika_normal_${t};
vec2 troika_uv_${t};
${r}
`,e=`${e}
void troikaVertexTransform${t}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${n}
}
`,a=`
troika_position_${t} = vec3(position);
troika_normal_${t} = vec3(normal);
troika_uv_${t} = vec2(uv);
troikaVertexTransform${t}(troika_position_${t}, troika_normal_${t}, troika_uv_${t});
${a}
`,r=r.replace(/\b(position|normal|uv)\b/g,(g,y,G,S)=>/\battribute\s+vec[23]\s+$/.test(S.substr(0,G))?y:`troika_${y}_${t}`),c.map&&c.map.channel>0||(r=r.replace(/\bMAP_UV\b/g,`troika_uv_${t}`))),r=Jr(r,t,e,a,i),l=Jr(l,t,o,s,f),{vertexShader:r,fragmentShader:l}}function Jr(c,r,l,d,t){return(d||t||l)&&(c=c.replace(cn,`
${l}
void troikaOrigMain${r}() {`),c+=`
void main() {
  ${d}
  troikaOrigMain${r}();
  ${t}
}`),c}function ia(c,r){return c==="uniforms"?void 0:typeof r=="function"?r.toString():r}let sa=0;const Kr=new Map;function la(c){const r=JSON.stringify(c,ia);let l=Kr.get(r);return l==null&&Kr.set(r,l=++sa),l}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function fa(){return typeof window>"u"&&(self.window=self),function(c){var r={parse:function(t){var e=r._bin,a=new Uint8Array(t);if(e.readASCII(a,0,4)=="ttcf"){var i=4;e.readUshort(a,i),i+=2,e.readUshort(a,i),i+=2;var n=e.readUint(a,i);i+=4;for(var o=[],s=0;s<n;s++){var f=e.readUint(a,i);i+=4,o.push(r._readFont(a,f))}return o}return[r._readFont(a,0)]},_readFont:function(t,e){var a=r._bin,i=e;a.readFixed(t,e),e+=4;var n=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],s={_data:t,_offset:i},f={},u=0;u<n;u++){var h=a.readASCII(t,e,4);e+=4,a.readUint(t,e),e+=4;var p=a.readUint(t,e);e+=4;var g=a.readUint(t,e);e+=4,f[h]={offset:p,length:g}}for(u=0;u<o.length;u++){var y=o[u];f[y]&&(s[y.trim()]=r[y.trim()].parse(t,f[y].offset,f[y].length,s))}return s},_tabOffset:function(t,e,a){for(var i=r._bin,n=i.readUshort(t,a+4),o=a+12,s=0;s<n;s++){var f=i.readASCII(t,o,4);o+=4,i.readUint(t,o),o+=4;var u=i.readUint(t,o);if(o+=4,i.readUint(t,o),o+=4,f==e)return u}return 0}};r._bin={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return r._bin.readShort(t,e)/16384},readInt:function(t,e){return r._bin._view(t).getInt32(e)},readInt8:function(t,e){return r._bin._view(t).getInt8(e)},readShort:function(t,e){return r._bin._view(t).getInt16(e)},readUshort:function(t,e){return r._bin._view(t).getUint16(e)},readUshorts:function(t,e,a){for(var i=[],n=0;n<a;n++)i.push(r._bin.readUshort(t,e+2*n));return i},readUint:function(t,e){return r._bin._view(t).getUint32(e)},readUint64:function(t,e){return 4294967296*r._bin.readUint(t,e)+r._bin.readUint(t,e+4)},readASCII:function(t,e,a){for(var i="",n=0;n<a;n++)i+=String.fromCharCode(t[e+n]);return i},readUnicode:function(t,e,a){for(var i="",n=0;n<a;n++){var o=t[e++]<<8|t[e++];i+=String.fromCharCode(o)}return i},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,a){var i=r._bin._tdec;return i&&e==0&&a==t.length?i.decode(t):r._bin.readASCII(t,e,a)},readBytes:function(t,e,a){for(var i=[],n=0;n<a;n++)i.push(t[e+n]);return i},readASCIIArray:function(t,e,a){for(var i=[],n=0;n<a;n++)i.push(String.fromCharCode(t[e+n]));return i},_view:function(t){return t._dataView||(t._dataView=t.buffer?new DataView(t.buffer,t.byteOffset,t.byteLength):new DataView(new Uint8Array(t).buffer))}},r._lctf={},r._lctf.parse=function(t,e,a,i,n){var o=r._bin,s={},f=e;o.readFixed(t,e),e+=4;var u=o.readUshort(t,e);e+=2;var h=o.readUshort(t,e);e+=2;var p=o.readUshort(t,e);return e+=2,s.scriptList=r._lctf.readScriptList(t,f+u),s.featureList=r._lctf.readFeatureList(t,f+h),s.lookupList=r._lctf.readLookupList(t,f+p,n),s},r._lctf.readLookupList=function(t,e,a){var i=r._bin,n=e,o=[],s=i.readUshort(t,e);e+=2;for(var f=0;f<s;f++){var u=i.readUshort(t,e);e+=2;var h=r._lctf.readLookupTable(t,n+u,a);o.push(h)}return o},r._lctf.readLookupTable=function(t,e,a){var i=r._bin,n=e,o={tabs:[]};o.ltype=i.readUshort(t,e),e+=2,o.flag=i.readUshort(t,e),e+=2;var s=i.readUshort(t,e);e+=2;for(var f=o.ltype,u=0;u<s;u++){var h=i.readUshort(t,e);e+=2;var p=a(t,f,n+h,o);o.tabs.push(p)}return o},r._lctf.numOfOnes=function(t){for(var e=0,a=0;a<32;a++)t>>>a&1&&e++;return e},r._lctf.readClassDef=function(t,e){var a=r._bin,i=[],n=a.readUshort(t,e);if(e+=2,n==1){var o=a.readUshort(t,e);e+=2;var s=a.readUshort(t,e);e+=2;for(var f=0;f<s;f++)i.push(o+f),i.push(o+f),i.push(a.readUshort(t,e)),e+=2}if(n==2){var u=a.readUshort(t,e);for(e+=2,f=0;f<u;f++)i.push(a.readUshort(t,e)),e+=2,i.push(a.readUshort(t,e)),e+=2,i.push(a.readUshort(t,e)),e+=2}return i},r._lctf.getInterval=function(t,e){for(var a=0;a<t.length;a+=3){var i=t[a],n=t[a+1];if(t[a+2],i<=e&&e<=n)return a}return-1},r._lctf.readCoverage=function(t,e){var a=r._bin,i={};i.fmt=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);return e+=2,i.fmt==1&&(i.tab=a.readUshorts(t,e,n)),i.fmt==2&&(i.tab=a.readUshorts(t,e,3*n)),i},r._lctf.coverageIndex=function(t,e){var a=t.tab;if(t.fmt==1)return a.indexOf(e);if(t.fmt==2){var i=r._lctf.getInterval(a,e);if(i!=-1)return a[i+2]+(e-a[i])}return-1},r._lctf.readFeatureList=function(t,e){var a=r._bin,i=e,n=[],o=a.readUshort(t,e);e+=2;for(var s=0;s<o;s++){var f=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2;var h=r._lctf.readFeatureTable(t,i+u);h.tag=f.trim(),n.push(h)}return n},r._lctf.readFeatureTable=function(t,e){var a=r._bin,i=e,n={},o=a.readUshort(t,e);e+=2,o>0&&(n.featureParams=i+o);var s=a.readUshort(t,e);e+=2,n.tab=[];for(var f=0;f<s;f++)n.tab.push(a.readUshort(t,e+2*f));return n},r._lctf.readScriptList=function(t,e){var a=r._bin,i=e,n={},o=a.readUshort(t,e);e+=2;for(var s=0;s<o;s++){var f=a.readASCII(t,e,4);e+=4;var u=a.readUshort(t,e);e+=2,n[f.trim()]=r._lctf.readScriptTable(t,i+u)}return n},r._lctf.readScriptTable=function(t,e){var a=r._bin,i=e,n={},o=a.readUshort(t,e);e+=2,o>0&&(n.default=r._lctf.readLangSysTable(t,i+o));var s=a.readUshort(t,e);e+=2;for(var f=0;f<s;f++){var u=a.readASCII(t,e,4);e+=4;var h=a.readUshort(t,e);e+=2,n[u.trim()]=r._lctf.readLangSysTable(t,i+h)}return n},r._lctf.readLangSysTable=function(t,e){var a=r._bin,i={};a.readUshort(t,e),e+=2,i.reqFeature=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);return e+=2,i.features=a.readUshorts(t,e,n),i},r.CFF={},r.CFF.parse=function(t,e,a){var i=r._bin;(t=new Uint8Array(t.buffer,e,a))[e=0],t[++e],t[++e],t[++e],e++;var n=[];e=r.CFF.readIndex(t,e,n);for(var o=[],s=0;s<n.length-1;s++)o.push(i.readASCII(t,e+n[s],n[s+1]-n[s]));e+=n[n.length-1];var f=[];e=r.CFF.readIndex(t,e,f);var u=[];for(s=0;s<f.length-1;s++)u.push(r.CFF.readDict(t,e+f[s],e+f[s+1]));e+=f[f.length-1];var h=u[0],p=[];e=r.CFF.readIndex(t,e,p);var g=[];for(s=0;s<p.length-1;s++)g.push(i.readASCII(t,e+p[s],p[s+1]-p[s]));if(e+=p[p.length-1],r.CFF.readSubrs(t,e,h),h.CharStrings){e=h.CharStrings,p=[],e=r.CFF.readIndex(t,e,p);var y=[];for(s=0;s<p.length-1;s++)y.push(i.readBytes(t,e+p[s],p[s+1]-p[s]));h.CharStrings=y}if(h.ROS){e=h.FDArray;var G=[];for(e=r.CFF.readIndex(t,e,G),h.FDArray=[],s=0;s<G.length-1;s++){var S=r.CFF.readDict(t,e+G[s],e+G[s+1]);r.CFF._readFDict(t,S,g),h.FDArray.push(S)}e+=G[G.length-1],e=h.FDSelect,h.FDSelect=[];var C=t[e];if(e++,C!=3)throw C;var x=i.readUshort(t,e);for(e+=2,s=0;s<x+1;s++)h.FDSelect.push(i.readUshort(t,e),t[e+2]),e+=3}return h.Encoding&&(h.Encoding=r.CFF.readEncoding(t,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=r.CFF.readCharset(t,h.charset,h.CharStrings.length)),r.CFF._readFDict(t,h,g),h},r.CFF._readFDict=function(t,e,a){var i;for(var n in e.Private&&(i=e.Private[1],e.Private=r.CFF.readDict(t,i,i+e.Private[0]),e.Private.Subrs&&r.CFF.readSubrs(t,i+e.Private.Subrs,e.Private)),e)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(n)!=-1&&(e[n]=a[e[n]-426+35])},r.CFF.readSubrs=function(t,e,a){var i=r._bin,n=[];e=r.CFF.readIndex(t,e,n);var o,s=n.length;o=s<1240?107:s<33900?1131:32768,a.Bias=o,a.Subrs=[];for(var f=0;f<n.length-1;f++)a.Subrs.push(i.readBytes(t,e+n[f],n[f+1]-n[f]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(t,e){for(var a=0;a<t.charset.length;a++)if(t.charset[a]==e)return a;return-1},r.CFF.glyphBySE=function(t,e){return e<0||e>255?-1:r.CFF.glyphByUnicode(t,r.CFF.tableSE[e])},r.CFF.readEncoding=function(t,e,a){r._bin;var i=[".notdef"],n=t[e];if(e++,n!=0)throw"error: unknown encoding format: "+n;var o=t[e];e++;for(var s=0;s<o;s++)i.push(t[e+s]);return i},r.CFF.readCharset=function(t,e,a){var i=r._bin,n=[".notdef"],o=t[e];if(e++,o==0)for(var s=0;s<a;s++){var f=i.readUshort(t,e);e+=2,n.push(f)}else{if(o!=1&&o!=2)throw"error: format: "+o;for(;n.length<a;){f=i.readUshort(t,e),e+=2;var u=0;for(o==1?(u=t[e],e++):(u=i.readUshort(t,e),e+=2),s=0;s<=u;s++)n.push(f),f++}}return n},r.CFF.readIndex=function(t,e,a){var i=r._bin,n=i.readUshort(t,e)+1,o=t[e+=2];if(e++,o==1)for(var s=0;s<n;s++)a.push(t[e+s]);else if(o==2)for(s=0;s<n;s++)a.push(i.readUshort(t,e+2*s));else if(o==3)for(s=0;s<n;s++)a.push(16777215&i.readUint(t,e+3*s-1));else if(n!=1)throw"unsupported offset size: "+o+", count: "+n;return(e+=n*o)-1},r.CFF.getCharString=function(t,e,a){var i=r._bin,n=t[e],o=t[e+1];t[e+2],t[e+3],t[e+4];var s=1,f=null,u=null;n<=20&&(f=n,s=1),n==12&&(f=100*n+o,s=2),21<=n&&n<=27&&(f=n,s=1),n==28&&(u=i.readShort(t,e+1),s=3),29<=n&&n<=31&&(f=n,s=1),32<=n&&n<=246&&(u=n-139,s=1),247<=n&&n<=250&&(u=256*(n-247)+o+108,s=2),251<=n&&n<=254&&(u=256*-(n-251)-o-108,s=2),n==255&&(u=i.readInt(t,e+1)/65535,s=5),a.val=u??"o"+f,a.size=s},r.CFF.readCharString=function(t,e,a){for(var i=e+a,n=r._bin,o=[];e<i;){var s=t[e],f=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,h=null,p=null;s<=20&&(h=s,u=1),s==12&&(h=100*s+f,u=2),s!=19&&s!=20||(h=s,u=2),21<=s&&s<=27&&(h=s,u=1),s==28&&(p=n.readShort(t,e+1),u=3),29<=s&&s<=31&&(h=s,u=1),32<=s&&s<=246&&(p=s-139,u=1),247<=s&&s<=250&&(p=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(p=256*-(s-251)-f-108,u=2),s==255&&(p=n.readInt(t,e+1)/65535,u=5),o.push(p??"o"+h),e+=u}return o},r.CFF.readDict=function(t,e,a){for(var i=r._bin,n={},o=[];e<a;){var s=t[e],f=t[e+1];t[e+2],t[e+3],t[e+4];var u=1,h=null,p=null;if(s==28&&(p=i.readShort(t,e+1),u=3),s==29&&(p=i.readInt(t,e+1),u=5),32<=s&&s<=246&&(p=s-139,u=1),247<=s&&s<=250&&(p=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(p=256*-(s-251)-f-108,u=2),s==255)throw p=i.readInt(t,e+1)/65535,u=5,"unknown number";if(s==30){var g=[];for(u=1;;){var y=t[e+u];u++;var G=y>>4,S=15&y;if(G!=15&&g.push(G),S!=15&&g.push(S),S==15)break}for(var C="",x=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],T=0;T<g.length;T++)C+=x[g[T]];p=parseFloat(C)}s<=21&&(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],u=1,s==12&&(h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],u=2)),h!=null?(n[h]=o.length==1?o[0]:o,o=[]):o.push(p),e+=u}return n},r.cmap={},r.cmap.parse=function(t,e,a){t=new Uint8Array(t.buffer,e,a),e=0;var i=r._bin,n={};i.readUshort(t,e),e+=2;var o=i.readUshort(t,e);e+=2;var s=[];n.tables=[];for(var f=0;f<o;f++){var u=i.readUshort(t,e);e+=2;var h=i.readUshort(t,e);e+=2;var p=i.readUint(t,e);e+=4;var g="p"+u+"e"+h,y=s.indexOf(p);if(y==-1){var G;y=n.tables.length,s.push(p);var S=i.readUshort(t,p);S==0?G=r.cmap.parse0(t,p):S==4?G=r.cmap.parse4(t,p):S==6?G=r.cmap.parse6(t,p):S==12?G=r.cmap.parse12(t,p):console.debug("unknown format: "+S,u,h,p),n.tables.push(G)}if(n[g]!=null)throw"multiple tables for one platform+encoding";n[g]=y}return n},r.cmap.parse0=function(t,e){var a=r._bin,i={};i.format=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2,i.map=[];for(var o=0;o<n-6;o++)i.map.push(t[e+o]);return i},r.cmap.parse4=function(t,e){var a=r._bin,i=e,n={};n.format=a.readUshort(t,e),e+=2;var o=a.readUshort(t,e);e+=2,a.readUshort(t,e),e+=2;var s=a.readUshort(t,e);e+=2;var f=s/2;n.searchRange=a.readUshort(t,e),e+=2,n.entrySelector=a.readUshort(t,e),e+=2,n.rangeShift=a.readUshort(t,e),e+=2,n.endCount=a.readUshorts(t,e,f),e+=2*f,e+=2,n.startCount=a.readUshorts(t,e,f),e+=2*f,n.idDelta=[];for(var u=0;u<f;u++)n.idDelta.push(a.readShort(t,e)),e+=2;for(n.idRangeOffset=a.readUshorts(t,e,f),e+=2*f,n.glyphIdArray=[];e<i+o;)n.glyphIdArray.push(a.readUshort(t,e)),e+=2;return n},r.cmap.parse6=function(t,e){var a=r._bin,i={};i.format=a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,a.readUshort(t,e),e+=2,i.firstCode=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2,i.glyphIdArray=[];for(var o=0;o<n;o++)i.glyphIdArray.push(a.readUshort(t,e)),e+=2;return i},r.cmap.parse12=function(t,e){var a=r._bin,i={};i.format=a.readUshort(t,e),e+=2,e+=2,a.readUint(t,e),e+=4,a.readUint(t,e),e+=4;var n=a.readUint(t,e);e+=4,i.groups=[];for(var o=0;o<n;o++){var s=e+12*o,f=a.readUint(t,s+0),u=a.readUint(t,s+4),h=a.readUint(t,s+8);i.groups.push([f,u,h])}return i},r.glyf={},r.glyf.parse=function(t,e,a,i){for(var n=[],o=0;o<i.maxp.numGlyphs;o++)n.push(null);return n},r.glyf._parseGlyf=function(t,e){var a=r._bin,i=t._data,n=r._tabOffset(i,"glyf",t._offset)+t.loca[e];if(t.loca[e]==t.loca[e+1])return null;var o={};if(o.noc=a.readShort(i,n),n+=2,o.xMin=a.readShort(i,n),n+=2,o.yMin=a.readShort(i,n),n+=2,o.xMax=a.readShort(i,n),n+=2,o.yMax=a.readShort(i,n),n+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(a.readUshort(i,n)),n+=2;var f=a.readUshort(i,n);if(n+=2,i.length-n<f)return null;o.instructions=a.readBytes(i,n,f),n+=f;var u=o.endPts[o.noc-1]+1;for(o.flags=[],s=0;s<u;s++){var h=i[n];if(n++,o.flags.push(h),(8&h)!=0){var p=i[n];n++;for(var g=0;g<p;g++)o.flags.push(h),s++}}for(o.xs=[],s=0;s<u;s++){var y=(2&o.flags[s])!=0,G=(16&o.flags[s])!=0;y?(o.xs.push(G?i[n]:-i[n]),n++):G?o.xs.push(0):(o.xs.push(a.readShort(i,n)),n+=2)}for(o.ys=[],s=0;s<u;s++)y=(4&o.flags[s])!=0,G=(32&o.flags[s])!=0,y?(o.ys.push(G?i[n]:-i[n]),n++):G?o.ys.push(0):(o.ys.push(a.readShort(i,n)),n+=2);var S=0,C=0;for(s=0;s<u;s++)S+=o.xs[s],C+=o.ys[s],o.xs[s]=S,o.ys[s]=C}else{var x;o.parts=[];do{x=a.readUshort(i,n),n+=2;var T={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(T),T.glyphIndex=a.readUshort(i,n),n+=2,1&x){var R=a.readShort(i,n);n+=2;var U=a.readShort(i,n);n+=2}else R=a.readInt8(i,n),n++,U=a.readInt8(i,n),n++;2&x?(T.m.tx=R,T.m.ty=U):(T.p1=R,T.p2=U),8&x?(T.m.a=T.m.d=a.readF2dot14(i,n),n+=2):64&x?(T.m.a=a.readF2dot14(i,n),n+=2,T.m.d=a.readF2dot14(i,n),n+=2):128&x&&(T.m.a=a.readF2dot14(i,n),n+=2,T.m.b=a.readF2dot14(i,n),n+=2,T.m.c=a.readF2dot14(i,n),n+=2,T.m.d=a.readF2dot14(i,n),n+=2)}while(32&x);if(256&x){var F=a.readUshort(i,n);for(n+=2,o.instr=[],s=0;s<F;s++)o.instr.push(i[n]),n++}}return o},r.GDEF={},r.GDEF.parse=function(t,e,a,i){var n=e;e+=4;var o=r._bin.readUshort(t,e);return{glyphClassDef:o===0?null:r._lctf.readClassDef(t,n+o)}},r.GPOS={},r.GPOS.parse=function(t,e,a,i){return r._lctf.parse(t,e,a,i,r.GPOS.subt)},r.GPOS.subt=function(t,e,a,i){var n=r._bin,o=a,s={};if(s.fmt=n.readUshort(t,a),a+=2,e==1||e==2||e==3||e==7||e==8&&s.fmt<=2){var f=n.readUshort(t,a);a+=2,s.coverage=r._lctf.readCoverage(t,f+o)}if(e==1&&s.fmt==1){var u=n.readUshort(t,a);a+=2,u!=0&&(s.pos=r.GPOS.readValueRecord(t,a,u))}else if(e==2&&s.fmt>=1&&s.fmt<=2){u=n.readUshort(t,a),a+=2;var h=n.readUshort(t,a);a+=2;var p=r._lctf.numOfOnes(u),g=r._lctf.numOfOnes(h);if(s.fmt==1){s.pairsets=[];var y=n.readUshort(t,a);a+=2;for(var G=0;G<y;G++){var S=o+n.readUshort(t,a);a+=2;var C=n.readUshort(t,S);S+=2;for(var x=[],T=0;T<C;T++){var R=n.readUshort(t,S);S+=2,u!=0&&(m=r.GPOS.readValueRecord(t,S,u),S+=2*p),h!=0&&(A=r.GPOS.readValueRecord(t,S,h),S+=2*g),x.push({gid2:R,val1:m,val2:A})}s.pairsets.push(x)}}if(s.fmt==2){var U=n.readUshort(t,a);a+=2;var F=n.readUshort(t,a);a+=2;var I=n.readUshort(t,a);a+=2;var O=n.readUshort(t,a);for(a+=2,s.classDef1=r._lctf.readClassDef(t,o+U),s.classDef2=r._lctf.readClassDef(t,o+F),s.matrix=[],G=0;G<I;G++){var J=[];for(T=0;T<O;T++){var m=null,A=null;u!=0&&(m=r.GPOS.readValueRecord(t,a,u),a+=2*p),h!=0&&(A=r.GPOS.readValueRecord(t,a,h),a+=2*g),J.push({val1:m,val2:A})}s.matrix.push(J)}}}else if(e==4&&s.fmt==1)s.markCoverage=r._lctf.readCoverage(t,n.readUshort(t,a)+o),s.baseCoverage=r._lctf.readCoverage(t,n.readUshort(t,a+2)+o),s.markClassCount=n.readUshort(t,a+4),s.markArray=r.GPOS.readMarkArray(t,n.readUshort(t,a+6)+o),s.baseArray=r.GPOS.readBaseArray(t,n.readUshort(t,a+8)+o,s.markClassCount);else if(e==6&&s.fmt==1)s.mark1Coverage=r._lctf.readCoverage(t,n.readUshort(t,a)+o),s.mark2Coverage=r._lctf.readCoverage(t,n.readUshort(t,a+2)+o),s.markClassCount=n.readUshort(t,a+4),s.mark1Array=r.GPOS.readMarkArray(t,n.readUshort(t,a+6)+o),s.mark2Array=r.GPOS.readBaseArray(t,n.readUshort(t,a+8)+o,s.markClassCount);else{if(e==9&&s.fmt==1){var w=n.readUshort(t,a);a+=2;var H=n.readUint(t,a);if(a+=4,i.ltype==9)i.ltype=w;else if(i.ltype!=w)throw"invalid extension substitution";return r.GPOS.subt(t,i.ltype,o+H)}console.debug("unsupported GPOS table LookupType",e,"format",s.fmt)}return s},r.GPOS.readValueRecord=function(t,e,a){var i=r._bin,n=[];return n.push(1&a?i.readShort(t,e):0),e+=1&a?2:0,n.push(2&a?i.readShort(t,e):0),e+=2&a?2:0,n.push(4&a?i.readShort(t,e):0),e+=4&a?2:0,n.push(8&a?i.readShort(t,e):0),e+=8&a?2:0,n},r.GPOS.readBaseArray=function(t,e,a){var i=r._bin,n=[],o=e,s=i.readUshort(t,e);e+=2;for(var f=0;f<s;f++){for(var u=[],h=0;h<a;h++)u.push(r.GPOS.readAnchorRecord(t,o+i.readUshort(t,e))),e+=2;n.push(u)}return n},r.GPOS.readMarkArray=function(t,e){var a=r._bin,i=[],n=e,o=a.readUshort(t,e);e+=2;for(var s=0;s<o;s++){var f=r.GPOS.readAnchorRecord(t,a.readUshort(t,e+2)+n);f.markClass=a.readUshort(t,e),i.push(f),e+=4}return i},r.GPOS.readAnchorRecord=function(t,e){var a=r._bin,i={};return i.fmt=a.readUshort(t,e),i.x=a.readShort(t,e+2),i.y=a.readShort(t,e+4),i},r.GSUB={},r.GSUB.parse=function(t,e,a,i){return r._lctf.parse(t,e,a,i,r.GSUB.subt)},r.GSUB.subt=function(t,e,a,i){var n=r._bin,o=a,s={};if(s.fmt=n.readUshort(t,a),a+=2,e!=1&&e!=2&&e!=4&&e!=5&&e!=6)return null;if(e==1||e==2||e==4||e==5&&s.fmt<=2||e==6&&s.fmt<=2){var f=n.readUshort(t,a);a+=2,s.coverage=r._lctf.readCoverage(t,o+f)}if(e==1&&s.fmt>=1&&s.fmt<=2){if(s.fmt==1)s.delta=n.readShort(t,a),a+=2;else if(s.fmt==2){var u=n.readUshort(t,a);a+=2,s.newg=n.readUshorts(t,a,u),a+=2*s.newg.length}}else if(e==2&&s.fmt==1){u=n.readUshort(t,a),a+=2,s.seqs=[];for(var h=0;h<u;h++){var p=n.readUshort(t,a)+o;a+=2;var g=n.readUshort(t,p);s.seqs.push(n.readUshorts(t,p+2,g))}}else if(e==4)for(s.vals=[],u=n.readUshort(t,a),a+=2,h=0;h<u;h++){var y=n.readUshort(t,a);a+=2,s.vals.push(r.GSUB.readLigatureSet(t,o+y))}else if(e==5&&s.fmt==2){if(s.fmt==2){var G=n.readUshort(t,a);a+=2,s.cDef=r._lctf.readClassDef(t,o+G),s.scset=[];var S=n.readUshort(t,a);for(a+=2,h=0;h<S;h++){var C=n.readUshort(t,a);a+=2,s.scset.push(C==0?null:r.GSUB.readSubClassSet(t,o+C))}}}else if(e==6&&s.fmt==3){if(s.fmt==3){for(h=0;h<3;h++){u=n.readUshort(t,a),a+=2;for(var x=[],T=0;T<u;T++)x.push(r._lctf.readCoverage(t,o+n.readUshort(t,a+2*T)));a+=2*u,h==0&&(s.backCvg=x),h==1&&(s.inptCvg=x),h==2&&(s.ahedCvg=x)}u=n.readUshort(t,a),a+=2,s.lookupRec=r.GSUB.readSubstLookupRecords(t,a,u)}}else{if(e==7&&s.fmt==1){var R=n.readUshort(t,a);a+=2;var U=n.readUint(t,a);if(a+=4,i.ltype==9)i.ltype=R;else if(i.ltype!=R)throw"invalid extension substitution";return r.GSUB.subt(t,i.ltype,o+U)}console.debug("unsupported GSUB table LookupType",e,"format",s.fmt)}return s},r.GSUB.readSubClassSet=function(t,e){var a=r._bin.readUshort,i=e,n=[],o=a(t,e);e+=2;for(var s=0;s<o;s++){var f=a(t,e);e+=2,n.push(r.GSUB.readSubClassRule(t,i+f))}return n},r.GSUB.readSubClassRule=function(t,e){var a=r._bin.readUshort,i={},n=a(t,e),o=a(t,e+=2);e+=2,i.input=[];for(var s=0;s<n-1;s++)i.input.push(a(t,e)),e+=2;return i.substLookupRecords=r.GSUB.readSubstLookupRecords(t,e,o),i},r.GSUB.readSubstLookupRecords=function(t,e,a){for(var i=r._bin.readUshort,n=[],o=0;o<a;o++)n.push(i(t,e),i(t,e+2)),e+=4;return n},r.GSUB.readChainSubClassSet=function(t,e){var a=r._bin,i=e,n=[],o=a.readUshort(t,e);e+=2;for(var s=0;s<o;s++){var f=a.readUshort(t,e);e+=2,n.push(r.GSUB.readChainSubClassRule(t,i+f))}return n},r.GSUB.readChainSubClassRule=function(t,e){for(var a=r._bin,i={},n=["backtrack","input","lookahead"],o=0;o<n.length;o++){var s=a.readUshort(t,e);e+=2,o==1&&s--,i[n[o]]=a.readUshorts(t,e,s),e+=2*i[n[o]].length}return s=a.readUshort(t,e),e+=2,i.subst=a.readUshorts(t,e,2*s),e+=2*i.subst.length,i},r.GSUB.readLigatureSet=function(t,e){var a=r._bin,i=e,n=[],o=a.readUshort(t,e);e+=2;for(var s=0;s<o;s++){var f=a.readUshort(t,e);e+=2,n.push(r.GSUB.readLigature(t,i+f))}return n},r.GSUB.readLigature=function(t,e){var a=r._bin,i={chain:[]};i.nglyph=a.readUshort(t,e),e+=2;var n=a.readUshort(t,e);e+=2;for(var o=0;o<n-1;o++)i.chain.push(a.readUshort(t,e)),e+=2;return i},r.head={},r.head.parse=function(t,e,a){var i=r._bin,n={};return i.readFixed(t,e),e+=4,n.fontRevision=i.readFixed(t,e),e+=4,i.readUint(t,e),e+=4,i.readUint(t,e),e+=4,n.flags=i.readUshort(t,e),e+=2,n.unitsPerEm=i.readUshort(t,e),e+=2,n.created=i.readUint64(t,e),e+=8,n.modified=i.readUint64(t,e),e+=8,n.xMin=i.readShort(t,e),e+=2,n.yMin=i.readShort(t,e),e+=2,n.xMax=i.readShort(t,e),e+=2,n.yMax=i.readShort(t,e),e+=2,n.macStyle=i.readUshort(t,e),e+=2,n.lowestRecPPEM=i.readUshort(t,e),e+=2,n.fontDirectionHint=i.readShort(t,e),e+=2,n.indexToLocFormat=i.readShort(t,e),e+=2,n.glyphDataFormat=i.readShort(t,e),e+=2,n},r.hhea={},r.hhea.parse=function(t,e,a){var i=r._bin,n={};return i.readFixed(t,e),e+=4,n.ascender=i.readShort(t,e),e+=2,n.descender=i.readShort(t,e),e+=2,n.lineGap=i.readShort(t,e),e+=2,n.advanceWidthMax=i.readUshort(t,e),e+=2,n.minLeftSideBearing=i.readShort(t,e),e+=2,n.minRightSideBearing=i.readShort(t,e),e+=2,n.xMaxExtent=i.readShort(t,e),e+=2,n.caretSlopeRise=i.readShort(t,e),e+=2,n.caretSlopeRun=i.readShort(t,e),e+=2,n.caretOffset=i.readShort(t,e),e+=2,e+=8,n.metricDataFormat=i.readShort(t,e),e+=2,n.numberOfHMetrics=i.readUshort(t,e),e+=2,n},r.hmtx={},r.hmtx.parse=function(t,e,a,i){for(var n=r._bin,o={aWidth:[],lsBearing:[]},s=0,f=0,u=0;u<i.maxp.numGlyphs;u++)u<i.hhea.numberOfHMetrics&&(s=n.readUshort(t,e),e+=2,f=n.readShort(t,e),e+=2),o.aWidth.push(s),o.lsBearing.push(f);return o},r.kern={},r.kern.parse=function(t,e,a,i){var n=r._bin,o=n.readUshort(t,e);if(e+=2,o==1)return r.kern.parseV1(t,e-2,a,i);var s=n.readUshort(t,e);e+=2;for(var f={glyph1:[],rval:[]},u=0;u<s;u++){e+=2,a=n.readUshort(t,e),e+=2;var h=n.readUshort(t,e);e+=2;var p=h>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;e=r.kern.readFormat0(t,e,f)}return f},r.kern.parseV1=function(t,e,a,i){var n=r._bin;n.readFixed(t,e),e+=4;var o=n.readUint(t,e);e+=4;for(var s={glyph1:[],rval:[]},f=0;f<o;f++){n.readUint(t,e),e+=4;var u=n.readUshort(t,e);e+=2,n.readUshort(t,e),e+=2;var h=u>>>8;if((h&=15)!=0)throw"unknown kern table format: "+h;e=r.kern.readFormat0(t,e,s)}return s},r.kern.readFormat0=function(t,e,a){var i=r._bin,n=-1,o=i.readUshort(t,e);e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2;for(var s=0;s<o;s++){var f=i.readUshort(t,e);e+=2;var u=i.readUshort(t,e);e+=2;var h=i.readShort(t,e);e+=2,f!=n&&(a.glyph1.push(f),a.rval.push({glyph2:[],vals:[]}));var p=a.rval[a.rval.length-1];p.glyph2.push(u),p.vals.push(h),n=f}return e},r.loca={},r.loca.parse=function(t,e,a,i){var n=r._bin,o=[],s=i.head.indexToLocFormat,f=i.maxp.numGlyphs+1;if(s==0)for(var u=0;u<f;u++)o.push(n.readUshort(t,e+(u<<1))<<1);if(s==1)for(u=0;u<f;u++)o.push(n.readUint(t,e+(u<<2)));return o},r.maxp={},r.maxp.parse=function(t,e,a){var i=r._bin,n={},o=i.readUint(t,e);return e+=4,n.numGlyphs=i.readUshort(t,e),e+=2,o==65536&&(n.maxPoints=i.readUshort(t,e),e+=2,n.maxContours=i.readUshort(t,e),e+=2,n.maxCompositePoints=i.readUshort(t,e),e+=2,n.maxCompositeContours=i.readUshort(t,e),e+=2,n.maxZones=i.readUshort(t,e),e+=2,n.maxTwilightPoints=i.readUshort(t,e),e+=2,n.maxStorage=i.readUshort(t,e),e+=2,n.maxFunctionDefs=i.readUshort(t,e),e+=2,n.maxInstructionDefs=i.readUshort(t,e),e+=2,n.maxStackElements=i.readUshort(t,e),e+=2,n.maxSizeOfInstructions=i.readUshort(t,e),e+=2,n.maxComponentElements=i.readUshort(t,e),e+=2,n.maxComponentDepth=i.readUshort(t,e),e+=2),n},r.name={},r.name.parse=function(t,e,a){var i=r._bin,n={};i.readUshort(t,e),e+=2;var o=i.readUshort(t,e);e+=2,i.readUshort(t,e);for(var s,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],u=e+=2,h=0;h<o;h++){var p=i.readUshort(t,e);e+=2;var g=i.readUshort(t,e);e+=2;var y=i.readUshort(t,e);e+=2;var G=i.readUshort(t,e);e+=2;var S=i.readUshort(t,e);e+=2;var C=i.readUshort(t,e);e+=2;var x,T=f[G],R=u+12*o+C;if(p==0)x=i.readUnicode(t,R,S/2);else if(p==3&&g==0)x=i.readUnicode(t,R,S/2);else if(g==0)x=i.readASCII(t,R,S);else if(g==1)x=i.readUnicode(t,R,S/2);else if(g==3)x=i.readUnicode(t,R,S/2);else{if(p!=1)throw"unknown encoding "+g+", platformID: "+p;x=i.readASCII(t,R,S),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var U="p"+p+","+y.toString(16);n[U]==null&&(n[U]={}),n[U][T!==void 0?T:G]=x,n[U]._lang=y}for(var F in n)if(n[F].postScriptName!=null&&n[F]._lang==1033)return n[F];for(var F in n)if(n[F].postScriptName!=null&&n[F]._lang==0)return n[F];for(var F in n)if(n[F].postScriptName!=null&&n[F]._lang==3084)return n[F];for(var F in n)if(n[F].postScriptName!=null)return n[F];for(var F in n){s=F;break}return console.debug("returning name table with languageID "+n[s]._lang),n[s]},r["OS/2"]={},r["OS/2"].parse=function(t,e,a){var i=r._bin.readUshort(t,e);e+=2;var n={};if(i==0)r["OS/2"].version0(t,e,n);else if(i==1)r["OS/2"].version1(t,e,n);else if(i==2||i==3||i==4)r["OS/2"].version2(t,e,n);else{if(i!=5)throw"unknown OS/2 table version: "+i;r["OS/2"].version5(t,e,n)}return n},r["OS/2"].version0=function(t,e,a){var i=r._bin;return a.xAvgCharWidth=i.readShort(t,e),e+=2,a.usWeightClass=i.readUshort(t,e),e+=2,a.usWidthClass=i.readUshort(t,e),e+=2,a.fsType=i.readUshort(t,e),e+=2,a.ySubscriptXSize=i.readShort(t,e),e+=2,a.ySubscriptYSize=i.readShort(t,e),e+=2,a.ySubscriptXOffset=i.readShort(t,e),e+=2,a.ySubscriptYOffset=i.readShort(t,e),e+=2,a.ySuperscriptXSize=i.readShort(t,e),e+=2,a.ySuperscriptYSize=i.readShort(t,e),e+=2,a.ySuperscriptXOffset=i.readShort(t,e),e+=2,a.ySuperscriptYOffset=i.readShort(t,e),e+=2,a.yStrikeoutSize=i.readShort(t,e),e+=2,a.yStrikeoutPosition=i.readShort(t,e),e+=2,a.sFamilyClass=i.readShort(t,e),e+=2,a.panose=i.readBytes(t,e,10),e+=10,a.ulUnicodeRange1=i.readUint(t,e),e+=4,a.ulUnicodeRange2=i.readUint(t,e),e+=4,a.ulUnicodeRange3=i.readUint(t,e),e+=4,a.ulUnicodeRange4=i.readUint(t,e),e+=4,a.achVendID=[i.readInt8(t,e),i.readInt8(t,e+1),i.readInt8(t,e+2),i.readInt8(t,e+3)],e+=4,a.fsSelection=i.readUshort(t,e),e+=2,a.usFirstCharIndex=i.readUshort(t,e),e+=2,a.usLastCharIndex=i.readUshort(t,e),e+=2,a.sTypoAscender=i.readShort(t,e),e+=2,a.sTypoDescender=i.readShort(t,e),e+=2,a.sTypoLineGap=i.readShort(t,e),e+=2,a.usWinAscent=i.readUshort(t,e),e+=2,a.usWinDescent=i.readUshort(t,e),e+=2},r["OS/2"].version1=function(t,e,a){var i=r._bin;return e=r["OS/2"].version0(t,e,a),a.ulCodePageRange1=i.readUint(t,e),e+=4,a.ulCodePageRange2=i.readUint(t,e),e+=4},r["OS/2"].version2=function(t,e,a){var i=r._bin;return e=r["OS/2"].version1(t,e,a),a.sxHeight=i.readShort(t,e),e+=2,a.sCapHeight=i.readShort(t,e),e+=2,a.usDefault=i.readUshort(t,e),e+=2,a.usBreak=i.readUshort(t,e),e+=2,a.usMaxContext=i.readUshort(t,e),e+=2},r["OS/2"].version5=function(t,e,a){var i=r._bin;return e=r["OS/2"].version2(t,e,a),a.usLowerOpticalPointSize=i.readUshort(t,e),e+=2,a.usUpperOpticalPointSize=i.readUshort(t,e),e+=2},r.post={},r.post.parse=function(t,e,a){var i=r._bin,n={};return n.version=i.readFixed(t,e),e+=4,n.italicAngle=i.readFixed(t,e),e+=4,n.underlinePosition=i.readShort(t,e),e+=2,n.underlineThickness=i.readShort(t,e),e+=2,n},r==null&&(r={}),r.U==null&&(r.U={}),r.U.codeToGlyph=function(t,e){var a=t.cmap,i=-1;if(a.p0e4!=null?i=a.p0e4:a.p3e1!=null?i=a.p3e1:a.p1e0!=null?i=a.p1e0:a.p0e3!=null&&(i=a.p0e3),i==-1)throw"no familiar platform and encoding!";var n=a.tables[i];if(n.format==0)return e>=n.map.length?0:n.map[e];if(n.format==4){for(var o=-1,s=0;s<n.endCount.length;s++)if(e<=n.endCount[s]){o=s;break}return o==-1||n.startCount[o]>e?0:65535&(n.idRangeOffset[o]!=0?n.glyphIdArray[e-n.startCount[o]+(n.idRangeOffset[o]>>1)-(n.idRangeOffset.length-o)]:e+n.idDelta[o])}if(n.format==12){if(e>n.groups[n.groups.length-1][1])return 0;for(s=0;s<n.groups.length;s++){var f=n.groups[s];if(f[0]<=e&&e<=f[1])return f[2]+(e-f[0])}return 0}throw"unknown cmap table format "+n.format},r.U.glyphToPath=function(t,e){var a={cmds:[],crds:[]};if(t.SVG&&t.SVG.entries[e]){var i=t.SVG.entries[e];return i==null?a:(typeof i=="string"&&(i=r.SVG.toPath(i),t.SVG.entries[e]=i),i)}if(t.CFF){var n={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:t.CFF.Private?t.CFF.Private.defaultWidthX:0,open:!1},o=t.CFF,s=t.CFF.Private;if(o.ROS){for(var f=0;o.FDSelect[f+2]<=e;)f+=2;s=o.FDArray[o.FDSelect[f+1]].Private}r.U._drawCFF(t.CFF.CharStrings[e],n,o,s,a)}else t.glyf&&r.U._drawGlyf(e,t,a);return a},r.U._drawGlyf=function(t,e,a){var i=e.glyf[t];i==null&&(i=e.glyf[t]=r.glyf._parseGlyf(e,t)),i!=null&&(i.noc>-1?r.U._simpleGlyph(i,a):r.U._compoGlyph(i,e,a))},r.U._simpleGlyph=function(t,e){for(var a=0;a<t.noc;a++){for(var i=a==0?0:t.endPts[a-1]+1,n=t.endPts[a],o=i;o<=n;o++){var s=o==i?n:o-1,f=o==n?i:o+1,u=1&t.flags[o],h=1&t.flags[s],p=1&t.flags[f],g=t.xs[o],y=t.ys[o];if(o==i)if(u){if(!h){r.U.P.moveTo(e,g,y);continue}r.U.P.moveTo(e,t.xs[s],t.ys[s])}else h?r.U.P.moveTo(e,t.xs[s],t.ys[s]):r.U.P.moveTo(e,(t.xs[s]+g)/2,(t.ys[s]+y)/2);u?h&&r.U.P.lineTo(e,g,y):p?r.U.P.qcurveTo(e,g,y,t.xs[f],t.ys[f]):r.U.P.qcurveTo(e,g,y,(g+t.xs[f])/2,(y+t.ys[f])/2)}r.U.P.closePath(e)}},r.U._compoGlyph=function(t,e,a){for(var i=0;i<t.parts.length;i++){var n={cmds:[],crds:[]},o=t.parts[i];r.U._drawGlyf(o.glyphIndex,e,n);for(var s=o.m,f=0;f<n.crds.length;f+=2){var u=n.crds[f],h=n.crds[f+1];a.crds.push(u*s.a+h*s.b+s.tx),a.crds.push(u*s.c+h*s.d+s.ty)}for(f=0;f<n.cmds.length;f++)a.cmds.push(n.cmds[f])}},r.U._getGlyphClass=function(t,e){var a=r._lctf.getInterval(e,t);return a==-1?0:e[a+2]},r.U._applySubs=function(t,e,a,i){for(var n=t.length-e-1,o=0;o<a.tabs.length;o++)if(a.tabs[o]!=null){var s,f=a.tabs[o];if(!f.coverage||(s=r._lctf.coverageIndex(f.coverage,t[e]))!=-1){if(a.ltype==1)t[e],f.fmt==1?t[e]=t[e]+f.delta:t[e]=f.newg[s];else if(a.ltype==4)for(var u=f.vals[s],h=0;h<u.length;h++){var p=u[h],g=p.chain.length;if(!(g>n)){for(var y=!0,G=0,S=0;S<g;S++){for(;t[e+G+(1+S)]==-1;)G++;p.chain[S]!=t[e+G+(1+S)]&&(y=!1)}if(y){for(t[e]=p.nglyph,S=0;S<g+G;S++)t[e+S+1]=-1;break}}}else if(a.ltype==5&&f.fmt==2)for(var C=r._lctf.getInterval(f.cDef,t[e]),x=f.cDef[C+2],T=f.scset[x],R=0;R<T.length;R++){var U=T[R],F=U.input;if(!(F.length>n)){for(y=!0,S=0;S<F.length;S++){var I=r._lctf.getInterval(f.cDef,t[e+1+S]);if(C==-1&&f.cDef[I+2]!=F[S]){y=!1;break}}if(y){var O=U.substLookupRecords;for(h=0;h<O.length;h+=2)O[h],O[h+1]}}}else if(a.ltype==6&&f.fmt==3){if(!r.U._glsCovered(t,f.backCvg,e-f.backCvg.length)||!r.U._glsCovered(t,f.inptCvg,e)||!r.U._glsCovered(t,f.ahedCvg,e+f.inptCvg.length))continue;var J=f.lookupRec;for(R=0;R<J.length;R+=2){C=J[R];var m=i[J[R+1]];r.U._applySubs(t,e+C,m,i)}}}}},r.U._glsCovered=function(t,e,a){for(var i=0;i<e.length;i++)if(r._lctf.coverageIndex(e[i],t[a+i])==-1)return!1;return!0},r.U.glyphsToPath=function(t,e,a){for(var i={cmds:[],crds:[]},n=0,o=0;o<e.length;o++){var s=e[o];if(s!=-1){for(var f=o<e.length-1&&e[o+1]!=-1?e[o+1]:0,u=r.U.glyphToPath(t,s),h=0;h<u.crds.length;h+=2)i.crds.push(u.crds[h]+n),i.crds.push(u.crds[h+1]);for(a&&i.cmds.push(a),h=0;h<u.cmds.length;h++)i.cmds.push(u.cmds[h]);a&&i.cmds.push("X"),n+=t.hmtx.aWidth[s],o<e.length-1&&(n+=r.U.getPairAdjustment(t,s,f))}}return i},r.U.P={},r.U.P.moveTo=function(t,e,a){t.cmds.push("M"),t.crds.push(e,a)},r.U.P.lineTo=function(t,e,a){t.cmds.push("L"),t.crds.push(e,a)},r.U.P.curveTo=function(t,e,a,i,n,o,s){t.cmds.push("C"),t.crds.push(e,a,i,n,o,s)},r.U.P.qcurveTo=function(t,e,a,i,n){t.cmds.push("Q"),t.crds.push(e,a,i,n)},r.U.P.closePath=function(t){t.cmds.push("Z")},r.U._drawCFF=function(t,e,a,i,n){for(var o=e.stack,s=e.nStems,f=e.haveWidth,u=e.width,h=e.open,p=0,g=e.x,y=e.y,G=0,S=0,C=0,x=0,T=0,R=0,U=0,F=0,I=0,O=0,J={val:0,size:0};p<t.length;){r.CFF.getCharString(t,p,J);var m=J.val;if(p+=J.size,m=="o1"||m=="o18")o.length%2!=0&&!f&&(u=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,f=!0;else if(m=="o3"||m=="o23")o.length%2!=0&&!f&&(u=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,f=!0;else if(m=="o4")o.length>1&&!f&&(u=o.shift()+i.nominalWidthX,f=!0),h&&r.U.P.closePath(n),y+=o.pop(),r.U.P.moveTo(n,g,y),h=!0;else if(m=="o5")for(;o.length>0;)g+=o.shift(),y+=o.shift(),r.U.P.lineTo(n,g,y);else if(m=="o6"||m=="o7")for(var A=o.length,w=m=="o6",H=0;H<A;H++){var z=o.shift();w?g+=z:y+=z,w=!w,r.U.P.lineTo(n,g,y)}else if(m=="o8"||m=="o24"){A=o.length;for(var Z=0;Z+6<=A;)G=g+o.shift(),S=y+o.shift(),C=G+o.shift(),x=S+o.shift(),g=C+o.shift(),y=x+o.shift(),r.U.P.curveTo(n,G,S,C,x,g,y),Z+=6;m=="o24"&&(g+=o.shift(),y+=o.shift(),r.U.P.lineTo(n,g,y))}else{if(m=="o11")break;if(m=="o1234"||m=="o1235"||m=="o1236"||m=="o1237")m=="o1234"&&(S=y,C=(G=g+o.shift())+o.shift(),O=x=S+o.shift(),R=x,F=y,g=(U=(T=(I=C+o.shift())+o.shift())+o.shift())+o.shift(),r.U.P.curveTo(n,G,S,C,x,I,O),r.U.P.curveTo(n,T,R,U,F,g,y)),m=="o1235"&&(G=g+o.shift(),S=y+o.shift(),C=G+o.shift(),x=S+o.shift(),I=C+o.shift(),O=x+o.shift(),T=I+o.shift(),R=O+o.shift(),U=T+o.shift(),F=R+o.shift(),g=U+o.shift(),y=F+o.shift(),o.shift(),r.U.P.curveTo(n,G,S,C,x,I,O),r.U.P.curveTo(n,T,R,U,F,g,y)),m=="o1236"&&(G=g+o.shift(),S=y+o.shift(),C=G+o.shift(),O=x=S+o.shift(),R=x,U=(T=(I=C+o.shift())+o.shift())+o.shift(),F=R+o.shift(),g=U+o.shift(),r.U.P.curveTo(n,G,S,C,x,I,O),r.U.P.curveTo(n,T,R,U,F,g,y)),m=="o1237"&&(G=g+o.shift(),S=y+o.shift(),C=G+o.shift(),x=S+o.shift(),I=C+o.shift(),O=x+o.shift(),T=I+o.shift(),R=O+o.shift(),U=T+o.shift(),F=R+o.shift(),Math.abs(U-g)>Math.abs(F-y)?g=U+o.shift():y=F+o.shift(),r.U.P.curveTo(n,G,S,C,x,I,O),r.U.P.curveTo(n,T,R,U,F,g,y));else if(m=="o14"){if(o.length>0&&!f&&(u=o.shift()+a.nominalWidthX,f=!0),o.length==4){var re=o.shift(),B=o.shift(),E=o.shift(),v=o.shift(),b=r.CFF.glyphBySE(a,E),_=r.CFF.glyphBySE(a,v);r.U._drawCFF(a.CharStrings[b],e,a,i,n),e.x=re,e.y=B,r.U._drawCFF(a.CharStrings[_],e,a,i,n)}h&&(r.U.P.closePath(n),h=!1)}else if(m=="o19"||m=="o20")o.length%2!=0&&!f&&(u=o.shift()+i.nominalWidthX),s+=o.length>>1,o.length=0,f=!0,p+=s+7>>3;else if(m=="o21")o.length>2&&!f&&(u=o.shift()+i.nominalWidthX,f=!0),y+=o.pop(),g+=o.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,g,y),h=!0;else if(m=="o22")o.length>1&&!f&&(u=o.shift()+i.nominalWidthX,f=!0),g+=o.pop(),h&&r.U.P.closePath(n),r.U.P.moveTo(n,g,y),h=!0;else if(m=="o25"){for(;o.length>6;)g+=o.shift(),y+=o.shift(),r.U.P.lineTo(n,g,y);G=g+o.shift(),S=y+o.shift(),C=G+o.shift(),x=S+o.shift(),g=C+o.shift(),y=x+o.shift(),r.U.P.curveTo(n,G,S,C,x,g,y)}else if(m=="o26")for(o.length%2&&(g+=o.shift());o.length>0;)G=g,S=y+o.shift(),g=C=G+o.shift(),y=(x=S+o.shift())+o.shift(),r.U.P.curveTo(n,G,S,C,x,g,y);else if(m=="o27")for(o.length%2&&(y+=o.shift());o.length>0;)S=y,C=(G=g+o.shift())+o.shift(),x=S+o.shift(),g=C+o.shift(),y=x,r.U.P.curveTo(n,G,S,C,x,g,y);else if(m=="o10"||m=="o29"){var M=m=="o10"?i:a;if(o.length==0)console.debug("error: empty stack");else{var k=o.pop(),N=M.Subrs[k+M.Bias];e.x=g,e.y=y,e.nStems=s,e.haveWidth=f,e.width=u,e.open=h,r.U._drawCFF(N,e,a,i,n),g=e.x,y=e.y,s=e.nStems,f=e.haveWidth,u=e.width,h=e.open}}else if(m=="o30"||m=="o31"){var D=o.length,P=(Z=0,m=="o31");for(Z+=D-(A=-3&D);Z<A;)P?(S=y,C=(G=g+o.shift())+o.shift(),y=(x=S+o.shift())+o.shift(),A-Z==5?(g=C+o.shift(),Z++):g=C,P=!1):(G=g,S=y+o.shift(),C=G+o.shift(),x=S+o.shift(),g=C+o.shift(),A-Z==5?(y=x+o.shift(),Z++):y=x,P=!0),r.U.P.curveTo(n,G,S,C,x,g,y),Z+=4}else{if((m+"").charAt(0)=="o")throw console.debug("Unknown operation: "+m,t),m;o.push(m)}}}e.x=g,e.y=y,e.nStems=s,e.haveWidth=f,e.width=u,e.open=h};var l=r,d={Typr:l};return c.Typr=l,c.default=d,Object.defineProperty(c,"__esModule",{value:!0}),c}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function ua(){return function(c){var r=Uint8Array,l=Uint16Array,d=Uint32Array,t=new r([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),e=new r([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new r([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),i=function(m,A){for(var w=new l(31),H=0;H<31;++H)w[H]=A+=1<<m[H-1];var z=new d(w[30]);for(H=1;H<30;++H)for(var Z=w[H];Z<w[H+1];++Z)z[Z]=Z-w[H]<<5|H;return[w,z]},n=i(t,2),o=n[0],s=n[1];o[28]=258,s[258]=28;for(var f=i(e,0)[0],u=new l(32768),h=0;h<32768;++h){var p=(43690&h)>>>1|(21845&h)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,u[h]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(m,A,w){for(var H=m.length,z=0,Z=new l(A);z<H;++z)++Z[m[z]-1];var re,B=new l(A);for(z=0;z<A;++z)B[z]=B[z-1]+Z[z-1]<<1;{re=new l(1<<A);var E=15-A;for(z=0;z<H;++z)if(m[z])for(var v=z<<4|m[z],b=A-m[z],_=B[m[z]-1]++<<b,M=_|(1<<b)-1;_<=M;++_)re[u[_]>>>E]=v}return re},y=new r(288);for(h=0;h<144;++h)y[h]=8;for(h=144;h<256;++h)y[h]=9;for(h=256;h<280;++h)y[h]=7;for(h=280;h<288;++h)y[h]=8;var G=new r(32);for(h=0;h<32;++h)G[h]=5;var S=g(y,9),C=g(G,5),x=function(m){for(var A=m[0],w=1;w<m.length;++w)m[w]>A&&(A=m[w]);return A},T=function(m,A,w){var H=A/8|0;return(m[H]|m[H+1]<<8)>>(7&A)&w},R=function(m,A){var w=A/8|0;return(m[w]|m[w+1]<<8|m[w+2]<<16)>>(7&A)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],F=function(m,A,w){var H=new Error(A||U[m]);if(H.code=m,Error.captureStackTrace&&Error.captureStackTrace(H,F),!w)throw H;return H},I=function(m,A,w){var H=m.length;if(!H||w&&!w.l&&H<5)return A||new r(0);var z=!A||w,Z=!w||w.i;w||(w={}),A||(A=new r(3*H));var re,B=function(le){var Ae=A.length;if(le>Ae){var we=new r(Math.max(2*Ae,le));we.set(A),A=we}},E=w.f||0,v=w.p||0,b=w.b||0,_=w.l,M=w.d,k=w.m,N=w.n,D=8*H;do{if(!_){w.f=E=T(m,v,1);var P=T(m,v+1,3);if(v+=3,!P){var X=m[(q=((re=v)/8|0)+(7&re&&1)+4)-4]|m[q-3]<<8,$=q+X;if($>H){Z&&F(0);break}z&&B(b+X),A.set(m.subarray(q,$),b),w.b=b+=X,w.p=v=8*$;continue}if(P==1)_=S,M=C,k=9,N=5;else if(P==2){var V=T(m,v,31)+257,W=T(m,v+10,15)+4,pe=V+T(m,v+5,31)+1;v+=14;for(var ue=new r(pe),Q=new r(19),ee=0;ee<W;++ee)Q[a[ee]]=T(m,v+3*ee,7);v+=3*W;var se=x(Q),j=(1<<se)-1,te=g(Q,se);for(ee=0;ee<pe;){var q,L=te[T(m,v,j)];if(v+=15&L,(q=L>>>4)<16)ue[ee++]=q;else{var he=0,K=0;for(q==16?(K=3+T(m,v,3),v+=2,he=ue[ee-1]):q==17?(K=3+T(m,v,7),v+=3):q==18&&(K=11+T(m,v,127),v+=7);K--;)ue[ee++]=he}}var ae=ue.subarray(0,V),Y=ue.subarray(V);k=x(ae),N=x(Y),_=g(ae,k),M=g(Y,N)}else F(1);if(v>D){Z&&F(0);break}}z&&B(b+131072);for(var ke=(1<<k)-1,ne=(1<<N)-1,oe=v;;oe=v){var fe=(he=_[R(m,v)&ke])>>>4;if((v+=15&he)>D){Z&&F(0);break}if(he||F(2),fe<256)A[b++]=fe;else{if(fe==256){oe=v,_=null;break}var de=fe-254;if(fe>264){var _e=t[ee=fe-257];de=T(m,v,(1<<_e)-1)+o[ee],v+=_e}var Me=M[R(m,v)&ne],me=Me>>>4;if(Me||F(3),v+=15&Me,Y=f[me],me>3&&(_e=e[me],Y+=R(m,v)&(1<<_e)-1,v+=_e),v>D){Z&&F(0);break}z&&B(b+131072);for(var ye=b+de;b<ye;b+=4)A[b]=A[b-Y],A[b+1]=A[b+1-Y],A[b+2]=A[b+2-Y],A[b+3]=A[b+3-Y];b=ye}}w.l=_,w.p=oe,w.b=b,_&&(E=1,w.m=k,w.d=M,w.n=N)}while(!E);return b==A.length?A:function(le,Ae,we){(we==null||we>le.length)&&(we=le.length);var Be=new(le instanceof l?l:le instanceof d?d:r)(we-Ae);return Be.set(le.subarray(Ae,we)),Be}(A,0,b)},O=new r(0),J=typeof TextDecoder<"u"&&new TextDecoder;try{J.decode(O,{stream:!0})}catch{}return c.convert_streams=function(m){var A=new DataView(m),w=0;function H(){var V=A.getUint16(w);return w+=2,V}function z(){var V=A.getUint32(w);return w+=4,V}function Z(V){X.setUint16($,V),$+=2}function re(V){X.setUint32($,V),$+=4}for(var B={signature:z(),flavor:z(),length:z(),numTables:H(),reserved:H(),totalSfntSize:z(),majorVersion:H(),minorVersion:H(),metaOffset:z(),metaLength:z(),metaOrigLength:z(),privOffset:z(),privLength:z()},E=0;Math.pow(2,E)<=B.numTables;)E++;E--;for(var v=16*Math.pow(2,E),b=16*B.numTables-v,_=12,M=[],k=0;k<B.numTables;k++)M.push({tag:z(),offset:z(),compLength:z(),origLength:z(),origChecksum:z()}),_+=16;var N,D=new Uint8Array(12+16*M.length+M.reduce(function(V,W){return V+W.origLength+4},0)),P=D.buffer,X=new DataView(P),$=0;return re(B.flavor),Z(B.numTables),Z(v),Z(E),Z(b),M.forEach(function(V){re(V.tag),re(V.origChecksum),re(_),re(V.origLength),V.outOffset=_,(_+=V.origLength)%4!=0&&(_+=4-_%4)}),M.forEach(function(V){var W,pe=m.slice(V.offset,V.offset+V.compLength);if(V.compLength!=V.origLength){var ue=new Uint8Array(V.origLength);W=new Uint8Array(pe,2),I(W,ue)}else ue=new Uint8Array(pe);D.set(ue,V.outOffset);var Q=0;(_=V.outOffset+V.origLength)%4!=0&&(Q=4-_%4),D.set(new Uint8Array(Q).buffer,V.outOffset+V.origLength),N=_+Q}),P.slice(0,N)},Object.defineProperty(c,"__esModule",{value:!0}),c}({}).convert_streams}function ca(c,r){const l={M:2,L:2,Q:4,C:6,Z:0},d={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},t=1,e=2,a=4,i=8,n=16,o=32;let s;function f(U){if(!s){const F={R:e,L:t,D:a,C:n,U:o,T:i};s=new Map;for(let I in d){let O=0;d[I].split(",").forEach(J=>{let[m,A]=J.split("+");m=parseInt(m,36),A=A?parseInt(A,36):0,s.set(O+=m,F[I]);for(let w=A;w--;)s.set(++O,F[I])})}}return s.get(U)||o}const u=1,h=2,p=3,g=4,y=[null,"isol","init","fina","medi"];function G(U){const F=new Uint8Array(U.length);let I=o,O=u,J=-1;for(let m=0;m<U.length;m++){const A=U.codePointAt(m);let w=f(A)|0,H=u;w&i||(I&(t|a|n)?w&(e|a|n)?(H=p,(O===u||O===p)&&F[J]++):w&(t|o)&&(O===h||O===g)&&F[J]--:I&(e|o)&&(O===h||O===g)&&F[J]--,O=F[m]=H,I=w,J=m,A>65535&&m++)}return F}function S(U,F){const I=[];for(let J=0;J<F.length;J++){const m=F.codePointAt(J);m>65535&&J++,I.push(c.U.codeToGlyph(U,m))}const O=U.GSUB;if(O){const{lookupList:J,featureList:m}=O;let A;const w=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,H=[];m.forEach(z=>{if(w.test(z.tag))for(let Z=0;Z<z.tab.length;Z++){if(H[z.tab[Z]])continue;H[z.tab[Z]]=!0;const re=J[z.tab[Z]],B=/^(isol|init|fina|medi)$/.test(z.tag);B&&!A&&(A=G(F));for(let E=0;E<I.length;E++)(!A||!B||y[A[E]]===z.tag)&&c.U._applySubs(I,E,re,J)}})}return I}function C(U,F){const I=new Int16Array(F.length*3);let O=0;for(;O<F.length;O++){const w=F[O];if(w===-1)continue;I[O*3+2]=U.hmtx.aWidth[w];const H=U.GPOS;if(H){const z=H.lookupList;for(let Z=0;Z<z.length;Z++){const re=z[Z];for(let B=0;B<re.tabs.length;B++){const E=re.tabs[B];if(re.ltype===1){if(c._lctf.coverageIndex(E.coverage,w)!==-1&&E.pos){A(E.pos,O);break}}else if(re.ltype===2){let v=null,b=J();if(b!==-1){const _=c._lctf.coverageIndex(E.coverage,F[b]);if(_!==-1){if(E.fmt===1){const M=E.pairsets[_];for(let k=0;k<M.length;k++)M[k].gid2===w&&(v=M[k])}else if(E.fmt===2){const M=c.U._getGlyphClass(F[b],E.classDef1),k=c.U._getGlyphClass(w,E.classDef2);v=E.matrix[M][k]}if(v){v.val1&&A(v.val1,b),v.val2&&A(v.val2,O);break}}}}else if(re.ltype===4){const v=c._lctf.coverageIndex(E.markCoverage,w);if(v!==-1){const b=J(m),_=b===-1?-1:c._lctf.coverageIndex(E.baseCoverage,F[b]);if(_!==-1){const M=E.markArray[v],k=E.baseArray[_][M.markClass];I[O*3]=k.x-M.x+I[b*3]-I[b*3+2],I[O*3+1]=k.y-M.y+I[b*3+1];break}}}else if(re.ltype===6){const v=c._lctf.coverageIndex(E.mark1Coverage,w);if(v!==-1){const b=J();if(b!==-1){const _=F[b];if(x(U,_)===3){const M=c._lctf.coverageIndex(E.mark2Coverage,_);if(M!==-1){const k=E.mark1Array[v],N=E.mark2Array[M][k.markClass];I[O*3]=N.x-k.x+I[b*3]-I[b*3+2],I[O*3+1]=N.y-k.y+I[b*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const z=J();if(z!==-1){const Z=U.kern.glyph1.indexOf(F[z]);if(Z!==-1){const re=U.kern.rval[Z].glyph2.indexOf(w);re!==-1&&(I[z*3+2]+=U.kern.rval[Z].vals[re])}}}}return I;function J(w){for(let H=O-1;H>=0;H--)if(F[H]!==-1&&(!w||w(F[H])))return H;return-1}function m(w){return x(U,w)===1}function A(w,H){for(let z=0;z<3;z++)I[H*3+z]+=w[z]||0}}function x(U,F){const I=U.GDEF&&U.GDEF.glyphClassDef;return I?c.U._getGlyphClass(F,I):0}function T(...U){for(let F=0;F<U.length;F++)if(typeof U[F]=="number")return U[F]}function R(U){const F=Object.create(null),I=U["OS/2"],O=U.hhea,J=U.head.unitsPerEm,m=T(I&&I.sTypoAscender,O&&O.ascender,J),A={unitsPerEm:J,ascender:m,descender:T(I&&I.sTypoDescender,O&&O.descender,0),capHeight:T(I&&I.sCapHeight,m),xHeight:T(I&&I.sxHeight,m),lineGap:T(I&&I.sTypoLineGap,O&&O.lineGap),supportsCodePoint(w){return c.U.codeToGlyph(U,w)>0},forEachGlyph(w,H,z,Z){let re=0;const B=1/A.unitsPerEm*H,E=S(U,w);let v=0;const b=C(U,E);return E.forEach((_,M)=>{if(_!==-1){let k=F[_];if(!k){const{cmds:N,crds:D}=c.U.glyphToPath(U,_);let P="",X=0;for(let ue=0,Q=N.length;ue<Q;ue++){const ee=l[N[ue]];P+=N[ue];for(let se=1;se<=ee;se++)P+=(se>1?",":"")+D[X++]}let $,V,W,pe;if(D.length){$=V=1/0,W=pe=-1/0;for(let ue=0,Q=D.length;ue<Q;ue+=2){let ee=D[ue],se=D[ue+1];ee<$&&($=ee),se<V&&(V=se),ee>W&&(W=ee),se>pe&&(pe=se)}}else $=W=V=pe=0;k=F[_]={index:_,advanceWidth:U.hmtx.aWidth[_],xMin:$,yMin:V,xMax:W,yMax:pe,path:P}}Z.call(null,k,re+b[M*3]*B,b[M*3+1]*B,v),re+=b[M*3+2]*B,z&&(re+=z*H)}v+=w.codePointAt(v)>65535?2:1}),re}};return A}return function(F){const I=new Uint8Array(F,0,4),O=c._bin.readASCII(I,0,4);if(O==="wOFF")F=r(F);else if(O==="wOF2")throw new Error("woff2 fonts not supported");return R(c.parse(F)[0])}}const ha=lt({name:"Typr Font Parser",dependencies:[fa,ua,ca],init(c,r,l){const d=c(),t=r();return l(d,t)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function da(){return function(c){var r=function(){this.buckets=new Map};r.prototype.add=function(C){var x=C>>5;this.buckets.set(x,(this.buckets.get(x)||0)|1<<(31&C))},r.prototype.has=function(C){var x=this.buckets.get(C>>5);return x!==void 0&&(x&1<<(31&C))!=0},r.prototype.serialize=function(){var C=[];return this.buckets.forEach(function(x,T){C.push((+T).toString(36)+":"+x.toString(36))}),C.join(",")},r.prototype.deserialize=function(C){var x=this;this.buckets.clear(),C.split(",").forEach(function(T){var R=T.split(":");x.buckets.set(parseInt(R[0],36),parseInt(R[1],36))})};var l=Math.pow(2,8),d=l-1,t=~d;function e(C){var x=function(R){return R&t}(C).toString(16),T=function(R){return(R&t)+l-1}(C).toString(16);return"codepoint-index/plane"+(C>>16)+"/"+x+"-"+T+".json"}function a(C,x){var T=C&d,R=x.codePointAt(T/6|0);return((R=(R||48)-48)&1<<T%6)!=0}function i(C,x){var T;(T=C,T.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(R){return R.split("-").map(function(U){return parseInt(U.trim(),16)})})).forEach(function(R){var U=R[0],F=R[1];F===void 0&&(F=U),x(U,F)})}function n(C,x){i(C,function(T,R){for(var U=T;U<=R;U++)x(U)})}var o={},s={},f=new WeakMap,u="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function h(C){var x=f.get(C);return x||(x=new r,n(C.ranges,function(T){return x.add(T)}),f.set(C,x)),x}var p,g=new Map;function y(C,x,T){return C[x]?x:C[T]?T:function(R){for(var U in R)return U}(C)}function G(C,x){var T=x;if(!C.includes(T)){T=1/0;for(var R=0;R<C.length;R++)Math.abs(C[R]-x)<Math.abs(T-x)&&(T=C[R])}return T}function S(C){return p||(p=new Set,n("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(x){p.add(x)})),p.has(C)}return c.CodePointSet=r,c.clearCache=function(){o={},s={}},c.getFontsForString=function(C,x){x===void 0&&(x={});var T,R=x.lang;R===void 0&&(R=new RegExp("\\p{Script=Hangul}","u").test(T=C)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(T)?"ja":"en");var U=x.category;U===void 0&&(U="sans-serif");var F=x.style;F===void 0&&(F="normal");var I=x.weight;I===void 0&&(I=400);var O=(x.dataUrl||u).replace(/\/$/g,""),J=new Map,m=new Uint8Array(C.length),A={},w={},H=new Array(C.length),z=new Map,Z=!1;function re(v){var b=g.get(v);return b||(b=fetch(O+"/"+v).then(function(_){if(!_.ok)throw new Error(_.statusText);return _.json().then(function(M){if(!Array.isArray(M)||M[0]!==1)throw new Error("Incorrect schema version; need 1, got "+M[0]);return M[1]})}).catch(function(_){if(O!==u)return Z||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+O+'", trying default CDN. '+_.message),Z=!0),O=u,g.delete(v),re(v);throw _}),g.set(v,b)),b}for(var B=function(v){var b=C.codePointAt(v),_=e(b);H[v]=_,o[_]||z.has(_)||z.set(_,re(_).then(function(M){o[_]=M})),b>65535&&(v++,E=v)},E=0;E<C.length;E++)B(E);return Promise.all(z.values()).then(function(){z.clear();for(var v=function(_){var M=C.codePointAt(_),k=null,N=o[H[_]],D=void 0;for(var P in N){var X=w[P];if(X===void 0&&(X=w[P]=new RegExp(P).test(R||"en")),X){for(var $ in D=P,N[P])if(a(M,N[P][$])){k=$;break}break}}if(!k){e:for(var V in N)if(V!==D){for(var W in N[V])if(a(M,N[V][W])){k=W;break e}}}k||(console.debug("No font coverage for U+"+M.toString(16)),k="latin"),H[_]=k,s[k]||z.has(k)||z.set(k,re("font-meta/"+k+".json").then(function(pe){s[k]=pe})),M>65535&&(_++,b=_)},b=0;b<C.length;b++)v(b);return Promise.all(z.values())}).then(function(){for(var v,b=null,_=0;_<C.length;_++){var M=C.codePointAt(_);if(b&&(S(M)||h(b).has(M)))m[_]=m[_-1];else{b=s[H[_]];var k=A[b.id];if(!k){var N=b.typeforms,D=y(N,U,"sans-serif"),P=y(N[D],F,"normal"),X=G((v=N[D])===null||v===void 0?void 0:v[P],I);k=A[b.id]=O+"/font-files/"+b.id+"/"+D+"."+P+"."+X+".woff"}var $=J.get(k);$==null&&($=J.size,J.set(k,$)),m[_]=$}M>65535&&(_++,m[_]=m[_-1])}return{fontUrls:Array.from(J.keys()),chars:m}})},Object.defineProperty(c,"__esModule",{value:!0}),c}({})}function va(c,r){const l=Object.create(null),d=Object.create(null);function t(a,i){const n=o=>{console.error(`Failure loading font ${a}`,o)};try{const o=new XMLHttpRequest;o.open("get",a,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)n(new Error(o.statusText));else if(o.status>0)try{const s=c(o.response);s.src=a,i(s)}catch(s){n(s)}},o.onerror=n,o.send()}catch(o){n(o)}}function e(a,i){let n=l[a];n?i(n):d[a]?d[a].push(i):(d[a]=[i],t(a,o=>{o.src=a,l[a]=o,d[a].forEach(s=>s(o)),delete d[a]}))}return function(a,i,{lang:n,fonts:o=[],style:s="normal",weight:f="normal",unicodeFontsURL:u}={}){const h=new Uint8Array(a.length),p=[];a.length||S();const g=new Map,y=[];if(s!=="italic"&&(s="normal"),typeof f!="number"&&(f=f==="bold"?700:400),o&&!Array.isArray(o)&&(o=[o]),o=o.slice().filter(x=>!x.lang||x.lang.test(n)).reverse(),o.length){let U=0;(function F(I=0){for(let O=I,J=a.length;O<J;O++){const m=a.codePointAt(O);if(U===1&&p[h[O-1]].supportsCodePoint(m)||/\s/.test(a[O]))h[O]=h[O-1],U===2&&(y[y.length-1][1]=O);else for(let A=h[O],w=o.length;A<=w;A++)if(A===w){const H=U===2?y[y.length-1]:y[y.length]=[O,O];H[1]=O,U=2}else{h[O]=A;const{src:H,unicodeRange:z}=o[A];if(!z||C(m,z)){const Z=l[H];if(!Z){e(H,()=>{F(O)});return}if(Z.supportsCodePoint(m)){let re=g.get(Z);typeof re!="number"&&(re=p.length,p.push(Z),g.set(Z,re)),h[O]=re,U=1;break}}}m>65535&&O+1<J&&(h[O+1]=h[O],O++,U===2&&(y[y.length-1][1]=O))}G()})()}else y.push([0,a.length-1]),G();function G(){if(y.length){const x=y.map(T=>a.substring(T[0],T[1]+1)).join(`
`);r.getFontsForString(x,{lang:n||void 0,style:s,weight:f,dataUrl:u}).then(({fontUrls:T,chars:R})=>{const U=p.length;let F=0;y.forEach(O=>{for(let J=0,m=O[1]-O[0];J<=m;J++)h[O[0]+J]=R[F++]+U;F++});let I=0;T.forEach((O,J)=>{e(O,m=>{p[J+U]=m,++I===T.length&&S()})})})}else S()}function S(){i({chars:h,fonts:p})}function C(x,T){for(let R=0;R<T.length;R++){const[U,F=U]=T[R];if(U<=x&&x<=F)return!0}return!1}}}const pa=lt({name:"FontResolver",dependencies:[va,ha,da],init(c,r,l){return c(r,l())}});function ga(c,r){const d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,t="[^\\S\\u00A0]",e=new RegExp(`${t}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:p,lang:g,fonts:y,style:G,weight:S,preResolvedFonts:C,unicodeFontsURL:x},T){const R=({chars:U,fonts:F})=>{let I,O;const J=[];for(let m=0;m<U.length;m++)U[m]!==O?(O=U[m],J.push(I={start:m,end:m,fontObj:F[U[m]]})):I.end=m;T(J)};C?R(C):c(p,R,{lang:g,fonts:y,style:G,weight:S,unicodeFontsURL:x})}function i({text:p="",font:g,lang:y,sdfGlyphSize:G=64,fontSize:S=400,fontWeight:C=1,fontStyle:x="normal",letterSpacing:T=0,lineHeight:R="normal",maxWidth:U=1/0,direction:F,textAlign:I="left",textIndent:O=0,whiteSpace:J="normal",overflowWrap:m="normal",anchorX:A=0,anchorY:w=0,metricsOnly:H=!1,unicodeFontsURL:z,preResolvedFonts:Z=null,includeCaretPositions:re=!1,chunkedBoundsSize:B=8192,colorRanges:E=null},v){const b=f(),_={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),S=+S,T=+T,U=+U,R=R||"normal",O=+O,a({text:p,lang:y,style:x,weight:C,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:z,preResolvedFonts:Z},M=>{_.fontLoad=f()-b;const k=isFinite(U);let N=null,D=null,P=null,X=null,$=null,V=null,W=null,pe=null,ue=0,Q=0,ee=J!=="nowrap";const se=new Map,j=f();let te=O,q=0,L=new u;const he=[L];M.forEach(ne=>{const{fontObj:oe}=ne,{ascender:fe,descender:de,unitsPerEm:_e,lineGap:Me,capHeight:me,xHeight:ye}=oe;let le=se.get(oe);if(!le){const ce=S/_e,Ue=R==="normal"?(fe-de+Me)*ce:R*S,Ye=(Ue-(fe-de)*ce)/2,Se=Math.min(Ue,(fe-de)*ce),be=(fe+de)/2*ce+Se/2;le={index:se.size,src:oe.src,fontObj:oe,fontSizeMult:ce,unitsPerEm:_e,ascender:fe*ce,descender:de*ce,capHeight:me*ce,xHeight:ye*ce,lineHeight:Ue,baseline:-Ye-fe*ce,caretTop:be,caretBottom:be-Se},se.set(oe,le)}const{fontSizeMult:Ae}=le,we=p.slice(ne.start,ne.end+1);let Be,Te;oe.forEachGlyph(we,S,T,(ce,Ue,Ye,Se)=>{Ue+=q,Se+=ne.start,Be=Ue,Te=ce;const be=p.charAt(Se),De=ce.advanceWidth*Ae,Ce=L.count;let ve;if("isEmpty"in ce||(ce.isWhitespace=!!be&&new RegExp(t).test(be),ce.canBreakAfter=!!be&&e.test(be),ce.isEmpty=ce.xMin===ce.xMax||ce.yMin===ce.yMax||d.test(be)),!ce.isWhitespace&&!ce.isEmpty&&Q++,ee&&k&&!ce.isWhitespace&&Ue+De+te>U&&Ce){if(L.glyphAt(Ce-1).glyphObj.canBreakAfter)ve=new u,te=-Ue;else for(let Ge=Ce;Ge--;)if(Ge===0&&m==="break-word"){ve=new u,te=-Ue;break}else if(L.glyphAt(Ge).glyphObj.canBreakAfter){ve=L.splitAt(Ge+1);const Re=ve.glyphAt(0).x;te-=Re;for(let Ee=ve.count;Ee--;)ve.glyphAt(Ee).x-=Re;break}ve&&(L.isSoftWrapped=!0,L=ve,he.push(L),ue=U)}let Fe=L.glyphAt(L.count);Fe.glyphObj=ce,Fe.x=Ue+te,Fe.y=Ye,Fe.width=De,Fe.charIndex=Se,Fe.fontData=le,be===`
`&&(L=new u,he.push(L),te=-(Ue+De+T*S)+O)}),q=Be+Te.advanceWidth*Ae+T*S});let K=0;he.forEach(ne=>{let oe=!0;for(let fe=ne.count;fe--;){const de=ne.glyphAt(fe);oe&&!de.glyphObj.isWhitespace&&(ne.width=de.x+de.width,ne.width>ue&&(ue=ne.width),oe=!1);let{lineHeight:_e,capHeight:Me,xHeight:me,baseline:ye}=de.fontData;_e>ne.lineHeight&&(ne.lineHeight=_e);const le=ye-ne.baseline;le<0&&(ne.baseline+=le,ne.cap+=le,ne.ex+=le),ne.cap=Math.max(ne.cap,ne.baseline+Me),ne.ex=Math.max(ne.ex,ne.baseline+me)}ne.baseline-=K,ne.cap-=K,ne.ex-=K,K+=ne.lineHeight});let ae=0,Y=0;if(A&&(typeof A=="number"?ae=-A:typeof A=="string"&&(ae=-ue*(A==="left"?0:A==="center"?.5:A==="right"?1:o(A)))),w&&(typeof w=="number"?Y=-w:typeof w=="string"&&(Y=w==="top"?0:w==="top-baseline"?-he[0].baseline:w==="top-cap"?-he[0].cap:w==="top-ex"?-he[0].ex:w==="middle"?K/2:w==="bottom"?K:w==="bottom-baseline"?-he[he.length-1].baseline:o(w)*K)),!H){const ne=r.getEmbeddingLevels(p,F);N=new Uint16Array(Q),D=new Uint8Array(Q),P=new Float32Array(Q*2),X={},W=[1/0,1/0,-1/0,-1/0],pe=[],re&&(V=new Float32Array(p.length*4)),E&&($=new Uint8Array(Q*3));let oe=0,fe=-1,de=-1,_e,Me;if(he.forEach((me,ye)=>{let{count:le,width:Ae}=me;if(le>0){let we=0;for(let Se=le;Se--&&me.glyphAt(Se).glyphObj.isWhitespace;)we++;let Be=0,Te=0;if(I==="center")Be=(ue-Ae)/2;else if(I==="right")Be=ue-Ae;else if(I==="justify"&&me.isSoftWrapped){let Se=0;for(let be=le-we;be--;)me.glyphAt(be).glyphObj.isWhitespace&&Se++;Te=(ue-Ae)/Se}if(Te||Be){let Se=0;for(let be=0;be<le;be++){let De=me.glyphAt(be);const Ce=De.glyphObj;De.x+=Be+Se,Te!==0&&Ce.isWhitespace&&be<le-we&&(Se+=Te,De.width+=Te)}}const ce=r.getReorderSegments(p,ne,me.glyphAt(0).charIndex,me.glyphAt(me.count-1).charIndex);for(let Se=0;Se<ce.length;Se++){const[be,De]=ce[Se];let Ce=1/0,ve=-1/0;for(let Fe=0;Fe<le;Fe++)if(me.glyphAt(Fe).charIndex>=be){let Ge=Fe,Re=Fe;for(;Re<le;Re++){let Ee=me.glyphAt(Re);if(Ee.charIndex>De)break;Re<le-we&&(Ce=Math.min(Ce,Ee.x),ve=Math.max(ve,Ee.x+Ee.width))}for(let Ee=Ge;Ee<Re;Ee++){const We=me.glyphAt(Ee);We.x=ve-(We.x+We.width-Ce)}break}}let Ue;const Ye=Se=>Ue=Se;for(let Se=0;Se<le;Se++){const be=me.glyphAt(Se);Ue=be.glyphObj;const De=Ue.index,Ce=ne.levels[be.charIndex]&1;if(Ce){const ve=r.getMirroredCharacter(p[be.charIndex]);ve&&be.fontData.fontObj.forEachGlyph(ve,0,0,Ye)}if(re){const{charIndex:ve,fontData:Fe}=be,Ge=be.x+ae,Re=be.x+be.width+ae;V[ve*4]=Ce?Re:Ge,V[ve*4+1]=Ce?Ge:Re,V[ve*4+2]=me.baseline+Fe.caretBottom+Y,V[ve*4+3]=me.baseline+Fe.caretTop+Y;const Ee=ve-fe;Ee>1&&s(V,fe,Ee),fe=ve}if(E){const{charIndex:ve}=be;for(;ve>de;)de++,E.hasOwnProperty(de)&&(Me=E[de])}if(!Ue.isWhitespace&&!Ue.isEmpty){const ve=oe++,{fontSizeMult:Fe,src:Ge,index:Re}=be.fontData,Ee=X[Ge]||(X[Ge]={});Ee[De]||(Ee[De]={path:Ue.path,pathBounds:[Ue.xMin,Ue.yMin,Ue.xMax,Ue.yMax]});const We=be.x+ae,Je=be.y+me.baseline+Y;P[ve*2]=We,P[ve*2+1]=Je;const He=We+Ue.xMin*Fe,Ke=Je+Ue.yMin*Fe,qe=We+Ue.xMax*Fe,Xe=Je+Ue.yMax*Fe;He<W[0]&&(W[0]=He),Ke<W[1]&&(W[1]=Ke),qe>W[2]&&(W[2]=qe),Xe>W[3]&&(W[3]=Xe),ve%B===0&&(_e={start:ve,end:ve,rect:[1/0,1/0,-1/0,-1/0]},pe.push(_e)),_e.end++;const Le=_e.rect;if(He<Le[0]&&(Le[0]=He),Ke<Le[1]&&(Le[1]=Ke),qe>Le[2]&&(Le[2]=qe),Xe>Le[3]&&(Le[3]=Xe),N[ve]=De,D[ve]=Re,E){const $e=ve*3;$[$e]=Me>>16&255,$[$e+1]=Me>>8&255,$[$e+2]=Me&255}}}}}),V){const me=p.length-fe;me>1&&s(V,fe,me)}}const ke=[];se.forEach(({index:ne,src:oe,unitsPerEm:fe,ascender:de,descender:_e,lineHeight:Me,capHeight:me,xHeight:ye})=>{ke[ne]={src:oe,unitsPerEm:fe,ascender:de,descender:_e,lineHeight:Me,capHeight:me,xHeight:ye}}),_.typesetting=f()-j,v({glyphIds:N,glyphFontIndices:D,glyphPositions:P,glyphData:X,fontData:ke,caretPositions:V,glyphColors:$,chunkedBounds:pe,fontSize:S,topBaseline:Y+he[0].baseline,blockBounds:[ae,Y-K,ae+ue,Y],visibleBounds:W,timings:_})})}function n(p,g){i({...p,metricsOnly:!0},y=>{const[G,S,C,x]=y.blockBounds;g({width:C-G,height:x-S})})}function o(p){let g=p.match(/^([\d.]+)%$/),y=g?parseFloat(g[1]):NaN;return isNaN(y)?0:y/100}function s(p,g,y){const G=p[g*4],S=p[g*4+1],C=p[g*4+2],x=p[g*4+3],T=(S-G)/y;for(let R=0;R<y;R++){const U=(g+R)*4;p[U]=G+T*R,p[U+1]=G+T*(R+1),p[U+2]=C,p[U+3]=x}}function f(){return(self.performance||Date).now()}function u(){this.data=[]}const h=["glyphObj","x","y","width","charIndex","fontData"];return u.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/h.length)},glyphAt(p){let g=u.flyweight;return g.data=this.data,g.index=p,g},splitAt(p){let g=new u;return g.data=this.data.splice(p*h.length),g}},u.flyweight=h.reduce((p,g,y,G)=>(Object.defineProperty(p,g,{get(){return this.data[this.index*h.length+y]},set(S){this.data[this.index*h.length+y]=S}}),p),{data:null,index:0}),{typeset:i,measure:n}}const tt=()=>(self.performance||Date).now(),Wt=un();let Qr;function ma(c,r,l,d,t,e,a,i,n,o,s=!0){return s?ba(c,r,l,d,t,e,a,i,n,o).then(null,f=>(Qr||(console.warn("WebGL SDF generation failed, falling back to JS",f),Qr=!0),qr(c,r,l,d,t,e,a,i,n,o))):qr(c,r,l,d,t,e,a,i,n,o)}const Pt=[],ya=5;let gr=0;function hn(){const c=tt();for(;Pt.length&&tt()-c<ya;)Pt.shift()();gr=Pt.length?setTimeout(hn,0):0}const ba=(...c)=>new Promise((r,l)=>{Pt.push(()=>{const d=tt();try{Wt.webgl.generateIntoCanvas(...c),r({timing:tt()-d})}catch(t){l(t)}}),gr||(gr=setTimeout(hn,0))}),xa=4,ka=2e3,Zr={};let Ua=0;function qr(c,r,l,d,t,e,a,i,n,o){const s="TroikaTextSDFGenerator_JS_"+Ua++%xa;let f=Zr[s];return f||(f=Zr[s]={workerModule:lt({name:s,workerId:s,dependencies:[un,tt],init(u,h){const p=u().javascript.generate;return function(...g){const y=h();return{textureData:p(...g),timing:h()-y}}},getTransferables(u){return[u.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(c,r,l,d,t,e).then(({textureData:u,timing:h})=>{const p=tt(),g=new Uint8Array(u.length*4);for(let y=0;y<u.length;y++)g[y*4+o]=u[y];return Wt.webglUtils.renderImageData(a,g,i,n,c,r,1<<3-o),h+=tt()-p,--f.requests===0&&(f.idleTimer=setTimeout(()=>{$n(s)},ka)),{timing:h}})}function Sa(c){c._warm||(Wt.webgl.isSupported(c),c._warm=!0)}const _a=Wt.webglUtils.resizeWebGLCanvasWithoutClearing,st={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},Ta=new Nt;function it(){return(self.performance||Date).now()}const $r=Object.create(null);function wa(c,r){c=Fa({},c);const l=it(),{defaultFontURL:d}=st,t=[];if(d&&t.push({label:"default",src:en(d)}),c.font&&t.push({label:"user",src:en(c.font)}),c.font=t,c.text=""+c.text,c.sdfGlyphSize=c.sdfGlyphSize||st.sdfGlyphSize,c.unicodeFontsURL=c.unicodeFontsURL||st.unicodeFontsURL,c.colorRanges!=null){let u={};for(let h in c.colorRanges)if(c.colorRanges.hasOwnProperty(h)){let p=c.colorRanges[h];typeof p!="number"&&(p=Ta.set(p).getHex()),u[h]=p}c.colorRanges=u}Object.freeze(c);const{textureWidth:e,sdfExponent:a}=st,{sdfGlyphSize:i}=c,n=e/i*4;let o=$r[i];if(!o){const u=document.createElement("canvas");u.width=e,u.height=i*256/n,o=$r[i]={glyphCount:0,sdfGlyphSize:i,sdfCanvas:u,sdfTexture:new En(u,void 0,void 0,void 0,jr,jr),contextLost:!1,glyphsByFont:new Map},o.sdfTexture.generateMipmaps=!1,Ca(o)}const{sdfTexture:s,sdfCanvas:f}=o;Aa(c).then(u=>{const{glyphIds:h,glyphFontIndices:p,fontData:g,glyphPositions:y,fontSize:G,timings:S}=u,C=[],x=new Float32Array(h.length*4);let T=0,R=0;const U=it(),F=g.map(A=>{let w=o.glyphsByFont.get(A.src);return w||o.glyphsByFont.set(A.src,w=new Map),w});h.forEach((A,w)=>{const H=p[w],{src:z,unitsPerEm:Z}=g[H];let re=F[H].get(A);if(!re){const{path:_,pathBounds:M}=u.glyphData[z][A],k=Math.max(M[2]-M[0],M[3]-M[1])/i*(st.sdfMargin*i+.5),N=o.glyphCount++,D=[M[0]-k,M[1]-k,M[2]+k,M[3]+k];F[H].set(A,re={path:_,atlasIndex:N,sdfViewBox:D}),C.push(re)}const{sdfViewBox:B}=re,E=y[R++],v=y[R++],b=G/Z;x[T++]=E+B[0]*b,x[T++]=v+B[1]*b,x[T++]=E+B[2]*b,x[T++]=v+B[3]*b,h[w]=re.atlasIndex}),S.quads=(S.quads||0)+(it()-U);const I=it();S.sdf={};const O=f.height,J=Math.ceil(o.glyphCount/n),m=Math.pow(2,Math.ceil(Math.log2(J*i)));m>O&&(console.info(`Increasing SDF texture size ${O}->${m}`),_a(f,e,m),s.dispose()),Promise.all(C.map(A=>dn(A,o,c.gpuAccelerateSDF).then(({timing:w})=>{S.sdf[A.atlasIndex]=w}))).then(()=>{C.length&&!o.contextLost&&(vn(o),s.needsUpdate=!0),S.sdfTotal=it()-I,S.total=it()-l,r(Object.freeze({parameters:c,sdfTexture:s,sdfGlyphSize:i,sdfExponent:a,glyphBounds:x,glyphAtlasIndices:h,glyphColors:u.glyphColors,caretPositions:u.caretPositions,chunkedBounds:u.chunkedBounds,ascender:u.ascender,descender:u.descender,lineHeight:u.lineHeight,capHeight:u.capHeight,xHeight:u.xHeight,topBaseline:u.topBaseline,blockBounds:u.blockBounds,visibleBounds:u.visibleBounds,timings:u.timings}))})}),Promise.resolve().then(()=>{o.contextLost||Sa(f)})}function dn({path:c,atlasIndex:r,sdfViewBox:l},{sdfGlyphSize:d,sdfCanvas:t,contextLost:e},a){if(e)return Promise.resolve({timing:-1});const{textureWidth:i,sdfExponent:n}=st,o=Math.max(l[2]-l[0],l[3]-l[1]),s=Math.floor(r/4),f=s%(i/d)*d,u=Math.floor(s/(i/d))*d,h=r%4;return ma(d,d,c,l,o,n,t,f,u,h,a)}function Ca(c){const r=c.sdfCanvas;r.addEventListener("webglcontextlost",l=>{console.log("Context Lost",l),l.preventDefault(),c.contextLost=!0}),r.addEventListener("webglcontextrestored",l=>{console.log("Context Restored",l),c.contextLost=!1;const d=[];c.glyphsByFont.forEach(t=>{t.forEach(e=>{d.push(dn(e,c,!0))})}),Promise.all(d).then(()=>{vn(c),c.sdfTexture.needsUpdate=!0})})}function Fa(c,r){for(let l in r)r.hasOwnProperty(l)&&(c[l]=r[l]);return c}let Gt;function en(c){return Gt||(Gt=typeof document>"u"?{}:document.createElement("a")),Gt.href=c,Gt.href}function vn(c){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:r,sdfTexture:l}=c,{width:d,height:t}=r,e=c.sdfCanvas.getContext("webgl");let a=l.image.data;(!a||a.length!==d*t*4)&&(a=new Uint8Array(d*t*4),l.image={width:d,height:t,data:a},l.flipY=!1,l.isDataTexture=!0),e.readPixels(0,0,d,t,e.RGBA,e.UNSIGNED_BYTE,a)}}const Ma=lt({name:"Typesetter",dependencies:[ga,pa,ta],init(c,r,l){return c(r,l())}}),Aa=lt({name:"Typesetter",dependencies:[Ma],init(c){return function(r){return new Promise(l=>{c.typeset(r,l)})}},getTransferables(c){const r=[];for(let l in c)c[l]&&c[l].buffer&&r.push(c[l].buffer);return r}}),tn={};function Da(c){let r=tn[c];if(!r){const l=new br(1,1,c,c),d=l.clone(),t=l.attributes,e=d.attributes,a=new Nn,i=t.uv.count;for(let n=0;n<i;n++)e.position.array[n*3]*=-1,e.normal.array[n*3+2]*=-1;["position","normal","uv"].forEach(n=>{a.setAttribute(n,new Wn([...t[n].array,...e[n].array],t[n].itemSize))}),a.setIndex([...l.index.array,...d.index.array.map(n=>n+i)]),a.translate(.5,.5,0),r=tn[c]=a}return r}const Ea="aTroikaGlyphBounds",rn="aTroikaGlyphIndex",Oa="aTroikaGlyphColor";class Ra extends On{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Rn,this.boundingBox=new Gn}computeBoundingSphere(){}computeBoundingBox(){}setSide(r){const l=this.getIndex().count;this.setDrawRange(r===Ln?l/2:0,r===sn?l:l/2)}set detail(r){if(r!==this._detail){this._detail=r,(typeof r!="number"||r<1)&&(r=1);let l=Da(r);["position","normal","uv"].forEach(d=>{this.attributes[d]=l.attributes[d].clone()}),this.setIndex(l.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,l,d,t,e){fr(this,Ea,r,4),fr(this,rn,l,1),fr(this,Oa,e,3),this._blockBounds=d,this._chunkedBounds=t,this.instanceCount=l.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:l,boundingBox:d}=this;if(l){const{PI:t,floor:e,min:a,max:i,sin:n,cos:o}=Math,s=t/2,f=t*2,u=Math.abs(l),h=r[0]/u,p=r[2]/u,g=e((h+s)/f)!==e((p+s)/f)?-u:a(n(h)*u,n(p)*u),y=e((h-s)/f)!==e((p-s)/f)?u:i(n(h)*u,n(p)*u),G=e((h+t)/f)!==e((p+t)/f)?u*2:i(u-o(h)*u,u-o(p)*u);d.min.set(g,r[1],l<0?-G:0),d.max.set(y,r[3],l<0?0:G)}else d.min.set(r[0],r[1],0),d.max.set(r[2],r[3],0);d.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let l=this.getAttribute(rn).count,d=this._chunkedBounds;if(d)for(let t=d.length;t--;){l=d[t].end;let e=d[t].rect;if(e[1]<r.w&&e[3]>r.y&&e[0]<r.z&&e[2]>r.x)break}this.instanceCount=l}}function fr(c,r,l,d){const t=c.getAttribute(r);l?t&&t.array.length===l.length?(t.array.set(l),t.needsUpdate=!0):(c.setAttribute(r,new Bn(l,d)),delete c._maxInstanceCount,c.dispose()):t&&c.deleteAttribute(r)}const Ga=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,La=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ba=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Pa=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function Ia(c){const r=pr(c,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new It},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Vr(0,0,0,0)},uTroikaClipRect:{value:new Vr(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new It},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Nt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Pn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Ga,vertexTransform:La,fragmentDefs:Ba,fragmentColorTransform:Pa,customRewriter({vertexShader:l,fragmentShader:d}){let t=/\buniform\s+vec3\s+diffuse\b/;return t.test(d)&&(d=d.replace(t,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),t.test(l)||(l=l.replace(cn,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:l,fragmentShader:d}}});return r.transparent=!0,Object.defineProperties(r,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),r}const xr=new ln({color:16777215,side:sn,transparent:!0}),nn=8421504,an=new In,Lt=new yr,ur=new yr,bt=[],Na=new yr,cr="+x+y";function on(c){return Array.isArray(c)?c[0]:c}let pn=()=>{const c=new mr(new br(1,1),xr);return pn=()=>c,c},gn=()=>{const c=new mr(new br(1,1,32,1),xr);return gn=()=>c,c};const Wa={type:"syncstart"},za={type:"synccomplete"},mn=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],ja=mn.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class yn extends mr{constructor(){const r=new Ra;super(r,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=nn,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=cr,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(Wa),wa({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},l=>{this._isSyncing=!1,this._textRenderInfo=l,this.geometry.updateGlyphs(l.glyphBounds,l.glyphAtlasIndices,l.blockBounds,l.chunkedBounds,l.glyphColors);const d=this._queuedSyncs;d&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{d.forEach(t=>t&&t())})),this.dispatchEvent(za),r&&r()})))}onBeforeRender(r,l,d,t,e,a){this.sync(),e.isTroikaTextMaterial&&this._prepareForRender(e),e._hadOwnSide=e.hasOwnProperty("side"),this.geometry.setSide(e._actualSide=e.side),e.side=Dn}onAfterRender(r,l,d,t,e,a){e._hadOwnSide?e.side=e._actualSide:delete e.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let r=this._derivedMaterial;const l=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=xr.clone());if((!r||r.baseMaterial!==l)&&(r=this._derivedMaterial=Ia(l),l.addEventListener("dispose",function d(){l.removeEventListener("dispose",d),r.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let d=r._outlineMtl;return d||(d=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),d.isTextOutlineMaterial=!0,d.depthWrite=!1,d.map=null,r.addEventListener("dispose",function t(){r.removeEventListener("dispose",t),d.dispose()})),[d,r]}else return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return on(this.material).getDepthMaterial()}get customDistanceMaterial(){return on(this.material).getDistanceMaterial()}_prepareForRender(r){const l=r.isTextOutlineMaterial,d=r.uniforms,t=this.textRenderInfo;if(t){const{sdfTexture:i,blockBounds:n}=t;d.uTroikaSDFTexture.value=i,d.uTroikaSDFTextureSize.value.set(i.image.width,i.image.height),d.uTroikaSDFGlyphSize.value=t.sdfGlyphSize,d.uTroikaSDFExponent.value=t.sdfExponent,d.uTroikaTotalBounds.value.fromArray(n),d.uTroikaUseGlyphColors.value=!l&&!!t.glyphColors;let o=0,s=0,f=0,u,h,p,g=0,y=0;if(l){let{outlineWidth:S,outlineOffsetX:C,outlineOffsetY:x,outlineBlur:T,outlineOpacity:R}=this;o=this._parsePercent(S)||0,s=Math.max(0,this._parsePercent(T)||0),u=R,g=this._parsePercent(C)||0,y=this._parsePercent(x)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(p=this.strokeColor,d.uTroikaStrokeColor.value.set(p??nn),h=this.strokeOpacity,h==null&&(h=1)),u=this.fillOpacity;d.uTroikaDistanceOffset.value=o,d.uTroikaPositionOffset.value.set(g,y),d.uTroikaBlurRadius.value=s,d.uTroikaStrokeWidth.value=f,d.uTroikaStrokeOpacity.value=h,d.uTroikaFillOpacity.value=u??1,d.uTroikaCurveRadius.value=this.curveRadius||0;let G=this.clipRect;if(G&&Array.isArray(G)&&G.length===4)d.uTroikaClipRect.value.fromArray(G);else{const S=(this.fontSize||.1)*100;d.uTroikaClipRect.value.set(n[0]-S,n[1]-S,n[2]+S,n[3]+S)}this.geometry.applyClipRect(d.uTroikaClipRect.value)}d.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const e=l?this.outlineColor||0:this.color;if(e==null)delete r.color;else{const i=r.hasOwnProperty("color")?r.color:r.color=new Nt;(e!==i._input||typeof e=="object")&&i.set(i._input=e)}let a=this.orientation||cr;if(a!==r._orientation){let i=d.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let n=a!==cr&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(n){let[,o,s,f,u]=n;Lt.set(0,0,0)[s]=o==="-"?1:-1,ur.set(0,0,0)[u]=f==="-"?-1:1,an.lookAt(Na,Lt.cross(ur),ur),i.setFromMatrix4(an)}else i.identity();r._orientation=a}}_parsePercent(r){if(typeof r=="string"){let l=r.match(/^(-?[\d.]+)%$/),d=l?parseFloat(l[1]):NaN;r=(isNaN(d)?0:d/100)*this.fontSize}return r}localPositionToTextCoords(r,l=new It){l.copy(r);const d=this.curveRadius;return d&&(l.x=Math.atan2(r.x,Math.abs(d)-Math.abs(r.z))*Math.abs(d)),l}worldPositionToTextCoords(r,l=new It){return Lt.copy(r),this.localPositionToTextCoords(this.worldToLocal(Lt),l)}raycast(r,l){const{textRenderInfo:d,curveRadius:t}=this;if(d){const e=d.blockBounds,a=t?gn():pn(),i=a.geometry,{position:n,uv:o}=i.attributes;for(let s=0;s<o.count;s++){let f=e[0]+o.getX(s)*(e[2]-e[0]);const u=e[1]+o.getY(s)*(e[3]-e[1]);let h=0;t&&(h=t-Math.cos(f/t)*t,f=Math.sin(f/t)*t),n.setXYZ(s,f,u,h)}i.boundingSphere=this.geometry.boundingSphere,i.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,bt.length=0,a.raycast(r,bt);for(let s=0;s<bt.length;s++)bt[s].object=this,l.push(bt[s])}}copy(r){const l=this.geometry;return super.copy(r),this.geometry=l,ja.forEach(d=>{this[d]=r[d]}),this}clone(){return new this.constructor().copy(this)}}mn.forEach(c=>{const r="_private_"+c;Object.defineProperty(yn.prototype,c,{get(){return this[r]},set(l){l!==this[r]&&(this[r]=l,this._needsSync=!0)}})});const Va=ge.LiteralUnion(["auto","ltr","rtl"],"auto"),Ha=ge.LiteralUnion(["left","center","right","justify"],"left");ge.LiteralUnion(["normal","nowrap"],"normal");const Xa=ge.LiteralUnion(["normal","break-word"],"normal"),Ya=ge.Union([ge.Number(),ge.Literal("normal")],"normal");var bn=(c=>(c[c.Basic=0]="Basic",c[c.Standard=1]="Standard",c))(bn||{});const Ja="type your text here",hr=c=>typeof c=="number"?c:new Nt(c).getHex(),Ka=Vn({name:"TextComponent",jsonID:"EE_text_spatial",schema:ge.Object({text:ge.String(Ja),textOpacity:ge.Number(100,{minimum:0,maximum:100}),textWidth:ge.Number(1/0),textIndent:ge.Number(0),textAlign:Ha,textWrap:ge.Bool(!0),textWrapKind:Xa,textAnchor:ge.Vec2({x:0,y:100}),textDepthOffset:ge.Number(0),textCurveRadius:ge.Number(0),letterSpacing:ge.Number(0),lineHeight:Ya,textDirection:Va,font:ge.Nullable(ge.String()),fontSize:ge.Number(.2),fontColor:ge.Color(16777215),fontMaterial:ge.Enum(bn,0),outlineOpacity:ge.Number(100,{minimum:0,maximum:100}),outlineWidth:ge.Number(100,{minimum:0,maximum:100}),outlineBlur:ge.Number(100,{minimum:0,maximum:100}),outlineOffset:ge.Vec2({x:0,y:100}),outlineColor:ge.Color(0),strokeOpacity:ge.Number(100,{minimum:0,maximum:100}),strokeWidth:ge.Number(100,{minimum:0,maximum:100}),strokeColor:ge.Color(4473924),textOrientation:ge.String("+x+y"),clipActive:ge.Bool(!1),clipRectMin:ge.Vec2({x:-1024,y:-1024}),clipRectMax:ge.Vec2({x:1024,y:1024}),gpuAccelerated:ge.Bool(!0),glyphResolution:ge.Number(6),glyphDetail:ge.Number(1),troikaMesh:ge.Nullable(ge.Type())}),reactor:function(){if(!Yn)return null;const c=Hn(),r=Xn(c,Ka);return xe.useEffect(()=>(r.troikaMesh.set(new yn),Jn(c,r.troikaMesh.value),()=>{r.troikaMesh.value.dispose()}),[]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.text=r.text.value,l.sync()},[r.text]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.fillOpacity=r.textOpacity.value/100,l.sync()},[r.textOpacity]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.textIndent=r.textIndent.value,l.sync()},[r.textIndent]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.textAlign=r.textAlign.value,l.sync()},[r.textAlign]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.whiteSpace=r.textWrap.value?"normal":"nowrap",l.sync()},[r.textWrap]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.overflowWrap=r.textWrapKind.value,l.sync()},[r.textWrapKind]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.anchorX=`${r.textAnchor.x.value}%`,l.anchorY=`${r.textAnchor.y.value}%`,l.sync()},[r.textAnchor]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.curveRadius=zn.degToRad(r.textCurveRadius.value),l.sync()},[r.textCurveRadius]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.depthOffset=r.textDepthOffset.value,l.sync()},[r.textDepthOffset]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.maxWidth=r.textWidth.value,l.sync()},[r.textWidth]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.lineHeight=r.lineHeight.value,l.sync()},[r.lineHeight]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.letterSpacing=r.letterSpacing.value,l.sync()},[r.letterSpacing]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.direction=r.textDirection.value,l.sync()},[r.textDirection]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.font=r.font.value,l.sync()},[r.font]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.fontSize=r.fontSize.value,l.sync()},[r.fontSize]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.color=hr(r.fontColor.value),l.sync()},[r.fontColor]),xe.useEffect(()=>{const l=r.troikaMesh.value;switch(r.fontMaterial.value){case 0:l.material=new ln;break;case 1:l.material=new jn;break}l.sync()},[r.fontMaterial]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.outlineOpacity=r.outlineOpacity.value/100,l.sync()},[r.outlineOpacity]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.outlineWidth=`${r.outlineWidth.value}%`,l.sync()},[r.outlineWidth]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.outlineBlur=`${r.outlineBlur.value}%`,l.sync()},[r.outlineBlur]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.outlineOffsetX=`${r.outlineOffset.x.value}%`,l.outlineOffsetY=`${r.outlineOffset.y.value}%`,l.sync()},[r.outlineOffset]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.outlineColor=hr(r.outlineColor.value),l.sync()},[r.outlineColor]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.strokeOpacity=r.strokeOpacity.value/100,l.sync()},[r.strokeOpacity]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.strokeWidth=`${r.strokeWidth.value}%`,l.sync()},[r.strokeWidth]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.strokeColor=hr(r.strokeColor.value),l.sync()},[r.strokeColor]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.orientation=r.textOrientation.value,l.sync()},[r.textOrientation]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.clipRect=r.clipActive.value?[r.clipRectMin.x.value,r.clipRectMin.y.value,r.clipRectMax.x.value,r.clipRectMax.x.value]:[],l.sync()},[r.clipActive,r.clipRectMin,r.clipRectMax]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.gpuAccelerateSDF=r.gpuAccelerated.value,l.sync()},[r.gpuAccelerated]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.sdfGlyphSize=Math.pow(2,r.glyphResolution.value),l.sync()},[r.glyphResolution]),xe.useEffect(()=>{const l=r.troikaMesh.value;l.glyphGeometryDetail=r.glyphDetail.value,l.sync()},[r.glyphDetail]),null}});export{bn as F,Ka as T};
