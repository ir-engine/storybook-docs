import{r as y}from"./index-CBqU2yxZ.js";import{V as a,n as h,m as q,B as x,e as N,Q as m,$ as l}from"./three.module-D2RMN07C.js";import{c as g,S as o,e as A,f as w,l as O,s as C,m as G,r as H}from"./index-_wFD3GG2.js";import{c as V,b as j}from"./ActionFunctions-CxzuxLxN.js";import{c as f}from"./MathLerpFunctions-CYXVD2J2.js";import{ae as B,B as R,n as k,N as F,p as I,w as L,R as P}from"./EditorServices-BJKHmurs.js";const v=200,u=new a,T=new h({color:"white",opacity:.35}),_=()=>{const e=new x;return e.setAttribute("position",new N(new Float32Array(v*3),3)),e},b=g({name:"SplineHelperComponent",schema:o.Object({layerMask:o.Number(B.NodeHelper)}),reactor:function(){const e=A(),s=w(e,b),t=w(e,d),[n]=R(_,e);return y.useEffect(()=>{const r=t.curve.value;if(t.elements.length<3)return;const i=O(),c=new q(n.value,T);c.name=`SplineHelperComponent-${e}`,k(i,c),C(i,F,c.name),C(i,I,{parentEntity:e}),L(i,!0);const S=c.geometry.attributes.position;for(let p=0;p<v;p++){const M=p/(v-1);r.getPoint(M,u),S.setXYZ(p,u.x,u.y,u.z)}return S.needsUpdate=!0,()=>{i&&G(i)}},[t.curve,s.layerMask]),null}}),d=g({name:"SplineComponent",jsonID:"EE_spline",schema:o.Object({elements:o.Array(o.Object({position:o.Vec3(),quaternion:o.Quaternion()}),[{position:new a(-1,0,-1),quaternion:new m},{position:new a(1,0,-1),quaternion:new m().setFromAxisAngle(f,Math.PI/2)},{position:new a(1,0,1),quaternion:new m().setFromAxisAngle(f,Math.PI)},{position:new a(-1,0,1),quaternion:new m().setFromAxisAngle(f,3*Math.PI/2)}]),curve:o.Class(()=>new l([],!0))}),onSet:(e,s,t)=>{t&&t.elements&&s.elements.set(t.elements.map(n=>({position:new a().copy(n.position),quaternion:new m().copy(n.quaternion)})))},reactor:()=>{const e=A(),s=w(e,d),t=V(j(P).nodeHelperVisibility),n=s.elements;return y.useEffect(()=>{if(n.length<3){s.curve.set(new l([],!0));return}const r=new l(n.value.map(E=>E.position),!0);r.curveType="catmullrom",s.curve.set(r)},[n.length,n.value.map(r=>`${JSON.stringify(r.position)}${JSON.stringify(r.quaternion)})`).join("")]),y.useEffect(()=>(t.value&&C(e,b),()=>{H(e,b)}),[t]),null}});export{d as S};
