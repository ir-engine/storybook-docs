var qn=Object.defineProperty;var On=(e,t,n)=>t in e?qn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var p=(e,t,n)=>On(e,typeof t!="symbol"?t+"":t,n);import{r as B,R as ee}from"./index-DPzuYzxM.js";import{w as kn,P as Ln,d as jn,S as re,u as Fn,a as Bt,t as An,s as pt,h as Pn}from"./UUIDComponent-GqVY2Xw8.js";import{n as Dn}from"./index-CO8llcWC.js";import{c as bt}from"./Util-D6kE0IP9.js";import{N as Vn}from"./NodeEditor-SBboXx3y.js";import{H as Bn,d as _n,g as Rn,e as Qn}from"./WebRTCTransportFunctions-mB_FREj1.js";import{G as _t,aW as wt}from"./resourceLoaderHooks-CRL4d032.js";import{l as Gn}from"./lodash-AQPfkADg.js";import"./index-Dls6AtJn.js";import{C as xt}from"./index-PchlGXp2.js";import"./index-B8Egbi3s.js";import"./index-C53TPVpl.js";import"./index-CvvRAf94.js";import"./ZoomOutSm-BKYTao-C.js";import"./index-BmZLy_Eh.js";import"./index-DNUDjAZy.js";import{I as yt}from"./index-dk6FhMkf.js";import{u as Un}from"./useTranslation-CW9c4UDM.js";import"./_commonjsHelpers-C4iS2aBk.js";import"./v4-BOvFkHkt.js";import"./three.module-BizNiMhn.js";import"./iconBase-qHBVS_PM.js";import"./ShadowComponent-DnhO6zHH.js";import"./useFeatureFlags-Dn9l-n2t.js";import"./FeathersHooks-Bcw5IzUg.js";import"./EditorServices-5l66pnva.js";import"./AuthService-CgpOViw1.js";import"./___vite-browser-external_commonjs-proxy-BqV5D26a.js";import"./index-Dp9Z83cc.js";import"./index-C0GIA9vz.js";import"./tw-merge-Ds6tgvmq.js";import"./utils-C_TihLnJ.js";import"./index-D9X8Um7J.js";import"./index-DYLXRpC5.js";import"./AssetType-CNZ47EUo.js";import"./index-YWE9xQ_z.js";import"./index-Bs5DOUC-.js";const Hn=Object.freeze(Object.defineProperty({__proto__:null,get Concat(){return He},get Constant(){return yl},get Equal(){return vl},get ListLoop(){return El},get getIndex(){return Sl},get getLength(){return Tl}},Symbol.toStringTag,{value:"Module"})),Xn=Object.freeze(Object.defineProperty({__proto__:null,get AssocPath(){return $l},get Constant(){return Nl},get Equal(){return Ml},get MergeDeep(){return zl},get Path(){return Cl},get PathAsInteger(){return ql},get PathAsString(){return Il}},Symbol.toStringTag,{value:"Module"}));class z{static mustEqual(t,n,o=""){if(t!==n)throw new Error(`failed assertion: ${t} must equal ${n}.  ${o}`)}static mustBeTrue(t,n=""){if(!t)throw new Error(`failed assertion: ${n}`)}static mustBeDefined(t,n=""){if(t===void 0)throw new Error(`failed assertion: variable must be defined ${n}`)}}class K{constructor(){p(this,"listeners",[])}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}clear(){this.listeners.splice(0,this.listeners.length)}emit(t){this.listeners.length!==0&&this.listeners.slice(0).forEach(n=>{n(t)})}get listenerCount(){return this.listeners.length}}function vt(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3}}const W=class W{static log(t,n){this.onLog.emit({severity:t,text:n})}static verbose(t){this.onLog.emit({severity:"verbose",text:t})}static info(t){this.onLog.emit({severity:"info",text:t})}static warning(t){this.onLog.emit({severity:"warning",text:t})}static error(t){this.onLog.emit({severity:"error",text:t})}};p(W,"logLevel",1),p(W,"prefixStyle",1),p(W,"onLog",new K),(()=>{const t=()=>{switch(W.prefixStyle){case 0:return"";case 1:return"[ee Visual Script]:";case 2:return new Date().toLocaleTimeString().padStart(11,"0")+" "}};W.onLog.addListener(n=>{if(!(W.logLevel>vt(n.severity)))switch(vt(n.severity)){case 1:console.info(t()+n.text);break;case 2:console.warn(t()+n.text);break;case 3:console.error(t()+n.text);break}})})();let le=W;const Et={linear:e=>e,quadratic:e=>e*e,cubic:e=>e*e*e,quartric:e=>e*e*e*e,quintic:e=>e*e*e*e*e,sine:e=>1-Math.cos(e*Math.PI/2),exponential:e=>Math.pow(2,10*(e-1)),circle:e=>1-Math.sqrt(1-e*e),back:e=>e*e*((1.70158+1)*e-1.70158),elastic:e=>1-Math.pow(Math.cos(e*Math.PI/2),3)*Math.cos(e*Math.PI),bounce:e=>{if(e<1/2.75)return 7.5625*e*e;if(e<2/2.75){const n=e-.5454545454545454;return 7.5625*n*n+.75}if(e<2.5/2.75){const n=e-.8181818181818182;return 7.5625*n*n+.9375}const t=e-2.625/2.75;return 7.5625*t*t+.984375}},St={in:e=>e,out:e=>t=>1-e(1-t),inOut:e=>t=>t<.5?e(t*2)/2:1-e((1-t)*2)/2};class Xe{constructor(t,n,o=[]){p(this,"label","");p(this,"metadata",{});p(this,"eventEmitter",new K);this.id=t,this.name=n,this.parameters=o}}const Rt=(e,t,n)=>{const o=e.find(a=>a.name===t);if(o===void 0)throw new Error(`can not find input socket with name ${t} on node of type ${n}`);return o.value},Qt=(e,t,n,o)=>{const a=e.find(s=>s.name===t);if(a===void 0)throw new Error(`can not find output socket with name ${t} on node of type ${o}`);a.value=n};var _=(e=>(e.Event="Event",e.Flow="Flow",e.Async="Async",e.Function="Function",e))(_||{});const Tt=e=>e.nodeType==="Flow",Nt=e=>e.nodeType==="Event",Gt=e=>e.nodeType==="Async",Mt=e=>e.nodeType==="Function";function Ke(e,t){if(t.links.length===0)return 0;const n=e.nodes,o=t.links[0];if((o._targetNode===void 0||o._targetSocket===void 0)&&(z.mustBeTrue(t.links.length===1),o._targetNode=n[o.nodeId],o._targetSocket=o._targetNode.outputs.find(c=>c.name===o.socketName),o._targetSocket===void 0))throw new Error(`can not find socket with the name ${o.socketName}`);const a=o._targetNode,s=o._targetSocket;if(!Mt(a))return t.value=s.value,0;let i=0;if(Mt(a)){for(const c of a.inputs)i+=Ke(e,c);return e.onNodeExecutionStart.emit(a),a.exec(a),i++,e.onNodeExecutionEnd.emit(a),t.value=s.value,i}return 0}class Kn{constructor(t,n,o=void 0){p(this,"fiberCompletedListenerStack",[]);p(this,"nodes");p(this,"executionSteps",0);this.engine=t,this.nextEval=n,this.nodes=t.nodes,o!==void 0&&this.fiberCompletedListenerStack.push(o)}commit(t,n,o=void 0){z.mustBeTrue(Tt(t)),z.mustBeTrue(this.nextEval===null);const a=t.outputs.find(s=>s.name===n);if(a===void 0)throw new Error(`can not find socket with the name ${n}`);if(a.links.length>1)throw new Error(`invalid for an output flow socket to have multiple downstream links:${t.description.typeName}.${a.name} has ${a.links.length} downlinks`);if(a.links.length===1){const s=a.links[0];if(s===void 0)throw new Error("link must be defined");this.nextEval=s}o!==void 0&&this.fiberCompletedListenerStack.push(o)}executeStep(){const t=this.nextEval;if(this.nextEval=null,t===null){if(this.fiberCompletedListenerStack.length===0)return;const o=this.fiberCompletedListenerStack.pop();if(o===void 0)throw new Error("awaitingCallback is empty");o();return}const n=this.nodes[t.nodeId];if(n.inputs.forEach(o=>{o.valueTypeName!=="flow"&&(this.executionSteps+=Ke(this.engine,o))}),this.engine.onNodeExecutionStart.emit(n),Gt(n)){this.engine.asyncNodes.push(n),n.triggered(this.engine,t.socketName,()=>{const o=this.engine.asyncNodes.indexOf(n);this.engine.asyncNodes.splice(o,1),this.engine.onNodeExecutionEnd.emit(n),this.executionSteps++});return}if(Tt(n)){n.triggered(this,t.socketName),this.engine.onNodeExecutionEnd.emit(n),this.executionSteps++;return}throw new TypeError(`should not get here, unhandled node ${n.description.typeName}`)}isCompleted(){return this.fiberCompletedListenerStack.length===0&&this.nextEval===null}}function Wn(e){return new Promise(t=>setTimeout(t,Math.round(e*1e3)))}class Yn{constructor(t){p(this,"fiberQueue",[]);p(this,"asyncNodes",[]);p(this,"eventNodes",[]);p(this,"onNodeExecutionStart",new K);p(this,"onNodeExecutionEnd",new K);p(this,"executionSteps",0);this.nodes=t,Object.values(t).forEach(n=>{Nt(n)&&this.eventNodes.push(n)}),this.eventNodes.forEach(n=>{n.inputs.forEach(o=>{z.mustBeTrue(o.valueTypeName!=="flow"),this.executionSteps+=Ke(this,o)}),this.onNodeExecutionStart.emit(n),n.init(this),this.executionSteps++,this.onNodeExecutionEnd.emit(n)})}dispose(){this.asyncNodes.forEach(t=>t.dispose()),this.eventNodes.forEach(t=>t.dispose(this))}commitToNewFiber(t,n,o=void 0){z.mustBeTrue(Nt(t)||Gt(t));const a=t.outputs.find(s=>s.name===n);if(a===void 0)throw new Error(`no socket with the name ${n}`);if(a.links.length>1)throw new Error(`invalid for an output flow socket to have multiple downstream links:${t.description.typeName}.${a.name} has ${a.links.length} downlinks`);if(a.links.length===1){const s=new Kn(this,a.links[0],o);this.fiberQueue.push(s)}}executeAllSync(t=100,n=1e8){const o=Date.now();let a=0,s=0;for(;s<n&&a<t&&this.fiberQueue.length>0;){const i=this.fiberQueue[0],c=i.executionSteps;i.executeStep(),s+=i.executionSteps-c,i.isCompleted()&&this.fiberQueue.shift(),a=(Date.now()-o)*.001}return this.executionSteps+=s,s}async executeAllAsync(t=100,n=1e8){const o=Date.now();let a=0,s=0,i=0;do i>0&&await Wn(0),a+=this.executeAllSync(t-s,n-a),s=(Date.now()-o)*.001,i+=1;while((this.asyncNodes.length>0||this.fiberQueue.length>0)&&s<t&&a<n);return a}}const Zn=({graph:e,registry:t,nodeTypeName:n,nodeConfiguration:o={}})=>{const a=t.nodes[n]?t.nodes[n]:void 0;if(a===void 0)throw le.verbose("known nodes: "+Object.keys(t.nodes).join(", ")),new Error(`no registered node descriptions with the typeName ${n}`);const s=a.nodeFactory(e,o);return s.inputs.forEach(i=>{var c;i.valueTypeName!=="flow"&&i.value===void 0&&(i.value=(c=t.values[i.valueTypeName])==null?void 0:c.creator())}),s},Jn=({variables:e={},customEvents:t={},values:n,dependencies:o={}})=>({variables:e,customEvents:t,values:n,getDependency:a=>{const s=o[a];return s||console.error(`Dependency not found ${a}.  Did you register it? Existing dependencies: ${Object.keys(o)}`),s}});class Ne{constructor(t="",n=""){p(this,"_targetNode");p(this,"_targetSocket");this.nodeId=t,this.socketName=n}}class ${constructor(t,n,o=void 0,a=void 0,s){p(this,"links",[]);this.valueTypeName=t,this.name=n,this.value=o,this.label=a,this.valueChoices=s}}class eo{constructor(t,n,o,a){p(this,"value");p(this,"label","");p(this,"metadata",{});p(this,"version",0);p(this,"onChanged",new K);this.id=t,this.name=n,this.valueTypeName=o,this.initialValue=a,this.value=this.initialValue}get(){return this.value}set(t){t!==this.value&&(this.value=t,this.version++,this.onChanged.emit(this))}}function to({graphJson:e,registry:t}){const n=(e==null?void 0:e.name)||"",o=(e==null?void 0:e.metadata)||{};let a={},s={};"variables"in e&&(a=so(t.values,e.variables??[])),"customEvents"in e&&(s=io(t.values,e.customEvents??[]));const i=(e==null?void 0:e.nodes)??[];i.length===0&&le.warning("readGraphFromJSON: no nodes specified");const c=Jn({...t,variables:a,customEvents:s}),l={};for(let u=0;u<i.length;u+=1){const m=i[u],f=no({graph:c,registry:t,nodeJson:m}),h=m.id;if(h in l)throw new Error(`can not create new node with id ${h} as one with that id already exists.`);l[h]=f}return Object.entries(l).forEach(([u,m])=>{m.inputs.forEach(f=>{f.links.forEach(h=>{if(!(h.nodeId in l))throw new Error(`node '${m.description.typeName}' specifies an input '${f.name}' whose link goes to a nonexistent upstream node id: ${h.nodeId}`);const g=l[h.nodeId],d=g.outputs.find(b=>b.name===h.socketName);if(d===void 0)throw new Error(`node '${m.description.typeName}' specifies an input '${f.name}' whose link goes to a nonexistent output '${h.socketName}' on upstream node '${g.description.typeName}'`);const w=new Ne(u,f.name);d.links.findIndex(b=>b.nodeId==w.nodeId&&b.socketName==w.socketName)<0&&d.links.push(w)})}),m.outputs.forEach(f=>{f.links.forEach(h=>{if(!(h.nodeId in l))throw new Error(`node '${m.description.typeName}' specifies an output '${f.name}' whose link goes to a nonexistent downstream node id ${h.nodeId}`);const g=l[h.nodeId],d=g.inputs.find(b=>b.name===h.socketName);if(d===void 0)throw new Error(`node '${m.description.typeName}' specifies an output '${f.name}' whose link goes to a nonexistent input '${h.socketName}' on downstream node '${g.description.typeName}'`);const w=new Ne(u,f.name);d.links.findIndex(b=>b.nodeId==w.nodeId&&b.socketName==w.socketName)<0&&d.links.push(w)})})}),{name:n,metadata:o,nodes:l,customEvents:s,variables:a}}function no({graph:e,registry:t,nodeJson:n}){if(n.type===void 0)throw new Error("readGraphFromJSON: no type for node");const o=n.type,a=n.configuration,s={};a!==void 0&&Object.keys(a).forEach(c=>{s[c]=a[c]});const i=Zn({graph:e,registry:t,nodeTypeName:o,nodeConfiguration:s});return i.label=(n==null?void 0:n.label)??i.label,i.metadata=(n==null?void 0:n.metadata)??i.metadata,n.parameters!==void 0&&oo(t.values,i,n.parameters),n.flows!==void 0&&ao(i,n.flows),i}function oo(e,t,n){t.inputs.forEach(o=>{var s;if(!(o.name in n))return;const a=n[o.name];if("value"in a&&(o.value=(s=e[o.valueTypeName])==null?void 0:s.deserialize(a.value)),"link"in a){const i=a.link;o.links.push(new Ne(i.nodeId,i.socket))}});for(const o in n)if(t.inputs.find(s=>s.name===o)===void 0)throw new Error(`node '${t.description.typeName}' specifies an input '${o}' that doesn't exist on its node type, available inputs are: ${t.inputs.map(s=>s.name).join(", ")}`)}function ao(e,t){e.outputs.forEach(n=>{if(n.name in t){const o=t[n.name];n.links.push(new Ne(o.nodeId,o.socket))}});for(const n in t)if(e.outputs.find(a=>a.name===n)===void 0)throw new Error(`node '${e.description.typeName}' specifies an output '${n}' that doesn't exist on its node type, available outputs are: ${e.outputs.map(a=>a.name).join(", ")}`)}function so(e,t){var o;const n={};for(let a=0;a<t.length;a+=1){const s=t[a],i=new eo(s.id,s.name,s.valueTypeName,(o=e[s.valueTypeName])==null?void 0:o.deserialize(s.initialValue));if(i.label=(s==null?void 0:s.label)??i.label,i.metadata=(s==null?void 0:s.metadata)??i.metadata,s.id in n)throw new Error(`duplicate variable id ${i.id}`);n[s.id]=i}return n}function io(e,t){const n={};for(let o=0;o<t.length;o+=1){const a=t[o],s=[];(a.parameters??[]).forEach(c=>{var l;s.push(new $(c.valueTypeName,c.name,(l=e[c.valueTypeName])==null?void 0:l.deserialize(c.defaultValue)))});const i=new Xe(a.id,a.name,s);if(i.label=(a==null?void 0:a.label)??i.label,i.metadata=(a==null?void 0:a.metadata)??i.metadata,i.id in n)throw new Error(`duplicate variable id ${i.id}`);n[i.id]=i}return n}class ne{constructor(t){p(this,"inputs");p(this,"outputs");p(this,"description");p(this,"nodeType");p(this,"otherTypeNames");p(this,"graph");p(this,"label");p(this,"metadata");p(this,"configuration");p(this,"readInput",t=>Rt(this.inputs,t,this.description.typeName));p(this,"writeOutput",(t,n)=>{Qt(this.outputs,t,n,this.description.typeName)});this.inputs=t.inputs,this.outputs=t.outputs,this.description=t.description,this.nodeType=t.nodeType,this.graph=t.graph,this.configuration=t.configuration,this.metadata=t.metadata||{}}}class We extends ne{constructor(t,n,o=[],a=[],s={}){super({description:{...t,category:t.category},inputs:o,outputs:a,graph:n,nodeType:_.Async,configuration:s}),z.mustBeTrue(this.inputs.some(i=>i.valueTypeName==="flow")),z.mustBeTrue(this.outputs.some(i=>i.valueTypeName==="flow"))}triggered(t,n,o){throw new Error("not implemented")}dispose(){throw new Error("not implemented")}}class ro extends ne{constructor(t,n,o=[],a=[],s={}){super({...t,description:{...t,category:t.category},inputs:o,outputs:a,graph:n,configuration:s,nodeType:_.Event}),z.mustBeTrue(!this.inputs.some(i=>i.valueTypeName==="flow")),z.mustBeTrue(this.outputs.some(i=>i.valueTypeName==="flow"))}init(t){throw new Error("not implemented")}dispose(t){throw new Error("not implemented")}}class co extends ro{constructor(t){super(t.description,t.graph,t.inputs,t.outputs,t.configuration)}}class lo extends ne{constructor(n){super({...n,nodeType:_.Event});p(this,"initInner");p(this,"disposeInner");p(this,"state");p(this,"outputSocketKeys");p(this,"init",n=>{this.state=this.initInner({read:this.readInput,write:this.writeOutput,state:this.state,outputSocketKeys:this.outputSocketKeys,commit:(o,a)=>{n.commitToNewFiber(this,o,a),n.executeAllSync(1)},configuration:this.configuration,graph:this.graph})});this.initInner=n.init,this.disposeInner=n.dispose,this.state=n.initialState,this.outputSocketKeys=n.outputs.map(o=>o.name)}dispose(){this.disposeInner({state:this.state,graph:this.graph})}}class Ut extends ne{constructor(t,n,o=[],a=[],s={}){super({description:{...t,category:t.category},inputs:o,outputs:a,graph:n,configuration:s,nodeType:_.Flow}),z.mustBeTrue(this.inputs.some(i=>i.valueTypeName==="flow"))}triggered(t,n){throw new Error("not implemented")}}class uo extends Ut{constructor(t){super(t.description,t.graph,t.inputs,t.outputs,t.configuration)}}class mo extends ne{constructor(n){super({...n,nodeType:_.Flow});p(this,"triggeredInner");p(this,"state");p(this,"outputSocketKeys");p(this,"triggered",(n,o)=>{this.state=this.triggeredInner({commit:(a,s)=>n.commit(this,a,s),read:this.readInput,write:this.writeOutput,graph:this.graph,state:this.state,configuration:this.configuration,outputSocketKeys:this.outputSocketKeys,triggeringSocketName:o})});this.triggeredInner=n.triggered,this.state=n.initialState,this.outputSocketKeys=n.outputs.map(o=>o.name)}}const $t=(e,{valueType:t,defaultValue:n,choices:o})=>new $(t,e,n,void 0,o),fo=(e,t,n,o)=>t.map(a=>{const s=e[a];if(typeof s=="string")return new $(s,a);if(typeof s=="function"){const i=s(n,o);return $t(a,i)}return $t(a,s)}),ho=e=>e.map(t=>new $(t.valueType,t.key,t.defaultValue,void 0,t.choices));function zt(e,t,n){if(typeof e=="function"){const o=e(t,n);return ho(o)}return fo(e,Object.keys(e),t,n)}const Ye=(e,{typeName:t,in:n,out:o,otherTypeNames:a=[],category:s=v.None,configuration:i,helpDescription:c="",label:l=""},u,m)=>({description:{typeName:t,configuration:i||{},category:s,otherTypeNames:a,helpDescription:c,label:l},nodeType:e,inputs:zt(n,u,m),outputs:zt(o,u,m),configuration:u,graph:m});var v=(e=>(e.Action="Action",e.Logic="Logic",e.Engine="Engine",e.Variable="Variable",e.Flow="Flow",e.None="None",e.Math="Math",e.Debug="Debug",e))(v||{});function A(e){return{...e,nodeFactory:(t,n)=>new mo({...Ye(_.Flow,e,n,t),initialState:e.initialState,triggered:e.triggered})}}function me(e){return{...e,nodeFactory:(t,n)=>new go({...Ye(_.Function,e,n,t),exec:e.exec})}}function ke(e){return{...e,nodeFactory:(t,n)=>new lo({...Ye(_.Event,e,n,t),initialState:e.initialState,init:e.init,dispose:e.dispose})}}class go extends ne{constructor(n){super({...n,nodeType:_.Function});p(this,"execInner");p(this,"exec",n=>{this.execInner({read:o=>Rt(n.inputs,o,n.description.typeName),write:(o,a)=>Qt(n.outputs,o,a,n.description.typeName),configuration:this.configuration,graph:this.graph})});this.execInner=n.exec}}const po="abcdefghijklmnop",Ct=e=>po[e];function It(e,t){return!e||e.length===0?[]:e.map((n,o)=>typeof n=="string"?{key:t(o),valueType:n}:{key:Object.keys(n)[0],valueType:n[Object.keys(n)[0]]})}function r({in:e,out:t,exec:n,category:o,...a}){const s=It(e,Ct),i=typeof t=="string"||t.length>1?()=>"result":Ct,l=It(typeof t=="string"?[t]:t,i);return me({typeName:a.name,label:a.label,in:()=>s,out:()=>l,category:o,exec:({read:m,write:f})=>{const h=s.map(({key:d})=>m(d)),g=n(...h);l.length===1&&l[0].key==="result"?f("result",g):l.forEach(({key:d})=>{f(d,g[d])})}})}function j(e){return Object.values(e).filter(t=>typeof t=="object")}class Ze{constructor(t,n,o="",a,s=[],i="",c={}){p(this,"nodeFactory");this.typeName=t,this.category=n,this.label=o,this.otherTypeNames=s,this.helpDescription=i,this.configuration=c,this.nodeFactory=(l,u)=>a(this,l,u)}}class Le extends Ze{constructor(t){super(t.typeName,t.category,t.label,t.factory,t.otherTypeNames,t.helpDescription,t.configuration),this.properties=t}}const oe=1e-6;function V(e,t,n=oe){return Math.abs(e-t)<n}function bo(e){return e*(Math.PI/180)}function wo(e){return e*(180/Math.PI)}function ae(e){let t;return()=>(t===void 0&&(t=e()),t)}const xo=/[^\d+.-]+/;function Ht(e,t=0){try{return Number.parseFloat(e)}catch{return t}}function fe(e,t=0){return e.split(xo).filter(Boolean).map(n=>Ht(n,t))}function*Y(e,t,n=1){let o=e;for(;o<t;)yield o,o+=n}function yo(e){return e.length>0?e.slice(0,1).toLocaleUpperCase()+e.slice(1):e}class vo{log(t,n){le.log(t,n)}}class Eo{constructor(){p(this,"startEvent",new K);p(this,"endEvent",new K);p(this,"tickEvent",new K)}}const $e=class $e extends co{constructor(n,o,a){const s=o.customEvents[a.customEventId]||new Xe("-1","undefined");super({description:n,graph:o,outputs:[new $("flow","flow"),...s.parameters.map(i=>new $(i.valueTypeName,i.name,i.value,i.label))],configuration:a});p(this,"customEvent");p(this,"onCustomEvent");this.customEvent=s,o.customEvents[a.customEventId]=s}init(n){z.mustBeTrue(this.onCustomEvent===void 0),this.onCustomEvent=o=>{this.customEvent.parameters.forEach(a=>{if(!(a.name in o))throw new Error(`parameters of custom event do not align with parameters of custom event node, missing ${a.name}`);this.writeOutput(a.name,o[a.name])}),n.commitToNewFiber(this,"flow")},this.customEvent.eventEmitter.addListener(this.onCustomEvent)}dispose(n){z.mustBeTrue(this.onCustomEvent!==void 0),this.onCustomEvent!==void 0&&this.customEvent.eventEmitter.removeListener(this.onCustomEvent)}};p($e,"Description",new Le({typeName:"customEvent/onTriggered",category:"Event",label:"On Triggered",configuration:{customEventId:{valueType:"string",defaultValue:"-1"}},factory:(n,o,a)=>new $e(n,o,a)}));let qt=$e;const ze=class ze extends uo{constructor(n,o,a){const s=o.customEvents[a.customEventId]||new Xe("-1","undefined");super({description:n,graph:o,inputs:[new $("flow","flow"),...s.parameters.map(i=>new $(i.valueTypeName,i.name,i.value,i.label))],outputs:[new $("flow","flow")],configuration:a});p(this,"customEvent");this.customEvent=s,o.customEvents[a.customEventId]=s}triggered(n,o){const a={};this.customEvent.parameters.forEach(s=>{a[s.name]=this.readInput(s.name)}),this.customEvent.eventEmitter.emit(a),n.commit(this,"flow")}};p(ze,"Description",new Le({typeName:"customEvent/trigger",category:"Action",label:"Trigger",configuration:{customEventId:{valueType:"string",defaultValue:"-1"}},factory:(n,o,a)=>new ze(n,o,a)}));let Ot=ze;const So=A({typeName:"debug/expectTrue",category:v.Action,label:"Assert Expect True",in:()=>[{key:"flow",valueType:"flow"},{key:"condition",valueType:"boolean"},{key:"description",valueType:"string"}],initialState:void 0,out:{flow:"flow"},triggered:({read:e,commit:t})=>{z.mustBeTrue(e("condition"),e("description")),t("flow")}}),To=A({typeName:"debug/log",category:v.Debug,label:"Debug Log",in:{flow:"flow",text:"string",severity:{valueType:"string",defaultValue:"info",choices:["verbose","info","warning","error"],label:"severity"}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t,graph:{getDependency:n}})=>{const o=n("ILogger");o==null||o.log(e("severity"),e("text")),t("flow")}}),No=A({typeName:"flow/decision/branch",category:v.Flow,label:"Branch",helpDescription:"Checks the value of the 'condition' input and if true, executes the 'true' branch, otherwise it executes the 'false' branch.",in:{flow:"flow",condition:"boolean"},out:{true:"flow",false:"flow"},triggered:({read:e,commit:t})=>{t(e("condition")===!0?"true":"false")},initialState:void 0}),Mo=A({typeName:"flow/counter",label:"Counter",in:{flow:"flow",reset:"flow"},out:{flow:"flow",count:"integer"},initialState:{count:0},category:v.Flow,triggered:({commit:e,write:t,triggeringSocketName:n,state:o})=>{let a=o.count;switch(n){case"flow":{a++,t("count",a),e("flow");break}case"reset":{a=0;break}default:throw new Error("should not get here")}return{count:a}}}),Ce=class Ce extends We{constructor(n,o){super(n,o,[new $("flow","flow"),new $("float","waitDuration"),new $("flow","cancel")],[new $("flow","flow")]);p(this,"triggerVersion",0)}triggered(n,o,a){if(this.triggerVersion++,o==="cancel")return;const s=this.triggerVersion;setTimeout(()=>{this.triggerVersion>s||(n.commitToNewFiber(this,"flow"),a())},this.readInput("waitDuration")*1e3)}dispose(){this.triggerVersion++}};p(Ce,"Description",new Ze("flow/rate/debounce","Flow","Debounce",(n,o)=>new Ce(n,o)));let Be=Ce;const $o=A({typeName:"flow/repeat/n",label:"Repeat N Times",category:v.Flow,in:{flow:"flow",n:{valueType:"integer",defaultValue:1},reset:"flow"},out:{flow:"flow",count:"integer"},initialState:{count:0},triggered:({commit:e,read:t,write:n,triggeringSocketName:o,state:a})=>o==="reset"?{count:0}:a.count<Number(t("n"))?(n("count",a.count),e("flow"),{count:a.count+1}):a}),zo=A({typeName:"flow/repeat/None",label:"No Repeat",category:v.Flow,in:{flow:"flow",reset:"flow"},out:{flow:"flow"},initialState:{firedOnce:!1},triggered:({commit:e,triggeringSocketName:t,state:n})=>t==="reset"?{firedOnce:!1}:n.firedOnce?n:(e("flow"),{firedOnce:!0})}),Co=A({typeName:"flow/decision/flipFlop",category:v.Flow,label:"Flip Flop",in:{flow:"flow"},out:{on:"flow",off:"flow",isOn:"boolean"},initialState:{isOn:!0},triggered:({commit:e,write:t,state:n})=>(t("isOn",n.isOn),e(n.isOn?"on":"off"),{isOn:!n.isOn})}),Io=A({typeName:"flow/forLoop",category:v.Flow,label:"For Loop",in:{flow:"flow",startIndex:"integer",endIndex:"integer"},out:{loopBody:"flow",index:"integer",completed:"flow"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("startIndex"),a=e("endIndex"),s=i=>{i<a?(t("index",i),n("loopBody",()=>{s(i+BigInt(1))})):n("completed")};s(o)}}),qo=A({typeName:"flow/gate",label:"Gate",category:v.Flow,in:{flow:"flow",open:"flow",close:"flow",toggle:"flow",startClosed:"boolean"},out:{flow:"flow"},initialState:{isInitialized:!1,isClosed:!0},triggered:({commit:e,read:t,triggeringSocketName:n,state:o})=>{let a=o.isClosed,s=o.isInitialized;switch(o.isInitialized||(a=!!t("startClosed"),s=!0),n){case"flow":a||e("flow");break;case"open":a=!1;break;case"close":a=!0;break;case"toggle":a=!a;break;default:throw new Error(`Unexpected triggering socket: ${n}`)}return{isClosed:a,isInitialized:s}}}),Oo=A({typeName:"flow/multiGate",category:v.Flow,label:"MultiGate",in:{flow:"flow",reset:"flow",loop:"boolean",startIndex:"integer"},out:{1:"flow",2:"flow",3:"flow"},initialState:{isInitialized:!1,nextIndex:0},triggered:({state:e,commit:t,read:n,outputSocketKeys:o,triggeringSocketName:a})=>{let s=e.nextIndex,i=e.isInitialized;switch(i||(s=Number(n("startIndex")),i=!0),n("loop")&&(s=s%o.length),a){case"reset":return s=0,{isInitialized:i,nextIndex:s};case"flow":{if(0<=s&&s<o.length){const l=o[s];t(l)}return s++,{isInitialized:i,nextIndex:s}}}const c=l=>{if(l<o.length){const u=o[l];t(u,()=>{c(l+1)})}};return c(0),{isInitialized:i,nextIndex:s}}}),ko=A({typeName:"flow/decision/sequence",label:"Sequence",configuration:{numOutputs:{valueType:"number",defaultValue:4}},in:{flow:"flow"},out:e=>{const t=e.numOutputs??4,n=[];for(let o=1;o<=t;o++){const a=`${o}`;n.push({key:a,valueType:"flow"})}return n},initialState:void 0,triggered:({commit:e,outputSocketKeys:t})=>{const n=o=>{if(o<t.length){const a=t[o];e(a,()=>{n(o+1)})}};n(0)}}),Ie=class Ie extends We{constructor(n,o){super(n,o,[new $("flow","flow"),new $("float","duration",1),new $("flow","cancel")],[new $("flow","flow")]);p(this,"triggerVersion",0);p(this,"timeoutPending",!1)}triggered(n,o,a){if(o==="cancel"){this.timeoutPending&&(this.triggerVersion++,this.timeoutPending=!1);return}if(this.timeoutPending)return;this.triggerVersion++;const s=this.triggerVersion;this.timeoutPending=!0,setTimeout(()=>{this.triggerVersion===s&&(z.mustBeTrue(this.timeoutPending),this.timeoutPending=!1,n.commitToNewFiber(this,"flow"),a())},this.readInput("duration")*1e3)}dispose(){this.triggerVersion++,this.timeoutPending=!1}};p(Ie,"Description",new Ze("flow/rate/throttle",v.Flow,"Throttle",(n,o)=>new Ie(n,o)));let _e=Ie;const qe=class qe extends Ut{constructor(n,o,a){const s=[];for(let i=1;i<=a;i++)s.push(new $("flow",`${i}`));super(n,o,[...s,new $("flow","reset"),new $("boolean","autoReset")],[new $("flow","flow")]);p(this,"isOn",!0);p(this,"triggeredMap",{});p(this,"triggeredCount",0);p(this,"outputTriggered",!1);this.numInputs=a,this.reset()}reset(){for(let n=1;n<=this.numInputs;n++)this.triggeredMap[`${n}`]=!1;this.triggeredCount=0,this.outputTriggered=!1}triggered(n,o){if(o==="reset"){this.reset();return}this.triggeredMap[o]||(this.triggeredMap[o]=!0,this.triggeredCount++,this.triggeredCount===this.numInputs&&!this.outputTriggered&&(n.commit(this,"flow"),this.outputTriggered=!0,this.readInput("autoReset")===!0&&this.reset()))}};p(qe,"Description",new Le({typeName:"flow/waitAll",category:"Flow",label:"WaitAll",configuration:{numInputs:{valueType:"number",defaultValue:3}},factory:(n,o,a)=>new qe(n,o,a.numInputs)}));let Re=qe;const Lo=()=>({onEndEvent:void 0});ke({typeName:"flow/lifecycle/onEnd",label:"On End",category:v.Flow,in:{},out:{flow:"flow"},initialState:Lo(),init:({state:e,commit:t,graph:{getDependency:n}})=>{z.mustBeTrue(e.onEndEvent===void 0);const o=()=>{t("flow")},a=n("ILifecycleEventEmitter");return a==null||a.endEvent.addListener(o),{onEndEvent:o}},dispose:({state:{onEndEvent:e},graph:{getDependency:t}})=>{z.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.endEvent.removeListener(e)),{}}});const jo=()=>({onStartEvent:void 0}),Fo=ke({typeName:"flow/lifecycle/onStart",label:"On Start",category:v.Flow,in:{},out:{flow:"flow"},initialState:jo(),init:({state:e,commit:t,graph:{getDependency:n}})=>{z.mustBeTrue(e.onStartEvent===void 0);const o=()=>{t("flow")},a=n("ILifecycleEventEmitter");return a==null||a.startEvent.addListener(o),{onStartEvent:o}},dispose:({state:{onStartEvent:e},graph:{getDependency:t}})=>{z.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.startEvent.removeListener(e)),{}}}),Ao=()=>({onTickEvent:void 0});ke({typeName:"flow/lifecycle/onTick",label:"On Tick",category:v.Flow,in:{},out:{flow:"flow",deltaSeconds:"float"},initialState:Ao(),init:({state:e,commit:t,write:n,graph:{getDependency:o}})=>{z.mustBeTrue(e.onTickEvent===void 0);let a=Date.now();const s=()=>{const c=Date.now(),l=(c-a)*.001;n("deltaSeconds",l),t("flow"),a=c},i=o("ILifecycleEventEmitter");return i==null||i.tickEvent.addListener(s),{onTickEvent:s}},dispose:({state:{onTickEvent:e},graph:{getDependency:t}})=>{z.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.tickEvent.removeListener(e)),{}}});function Je({values:e,valueTypeName:t}){const n=yo(t);return[r({name:`logic/string/convert/to${n}`,label:`To ${n}`,in:["string"],out:t,exec:o=>{var a;return(a=e[t])==null?void 0:a.deserialize(o)}}),r({name:`math/${t}/convert/toString`,label:"To String",in:[t],out:"string",exec:o=>{var a;return`${(a=e[t])==null?void 0:a.serialize(o)}`}})]}const Po=A({typeName:"flow/decision/switch/integer",label:"Switch on Int",configuration:{numCases:{valueType:"number"}},in:e=>{const t=[];t.push({key:"flow",valueType:"flow"},{key:"selection",valueType:"integer"});for(const n of Y(1,e.numCases+1))t.push({key:`${n}`,valueType:"integer"});return t},out:e=>{const t=[];t.push({key:"default",valueType:"flow"});for(const n of Y(1,e.numCases+1))t.push({key:`${n}`,valueType:"flow"});return t},initialState:void 0,triggered:({read:e,commit:t,configuration:n})=>{const o=e("selection");for(const a of Y(1,n.numCases+1))if(o===e(`${a}`)){t(`${a}`);return}t("default")}}),Do=A({typeName:"flow/decision/switch/string",label:"Switch on String",configuration:{numCases:{valueType:"number"}},in:e=>{const t=[];t.push({key:"flow",valueType:"flow"},{key:"selection",valueType:"string"});for(const n of Y(1,e.numCases+1))t.push({key:`${n}`,valueType:"string"});return t},out:e=>{const t=[];t.push({key:"default",valueType:"flow"});for(const n of Y(1,e.numCases+1))t.push({key:`${n}`,valueType:"flow"});return t},initialState:void 0,triggered:({read:e,commit:t,configuration:n})=>{const o=e("selection");for(const a of Y(1,n.numCases+1))if(o===e(`${a}`)){t(`${a}`);return}t("default")}}),Vo=me({typeName:"math/easing",category:v.Math,label:"Easing",in:{easingFunction:{valueType:"string",name:"easingFunction",defaultValue:"linear",options:Object.keys(Et)},easingMode:{valueType:"string",name:"easingMode",defaultValue:"inOut",options:Object.keys(St)},t:"float"},out:{t:"float"},exec:({read:e,write:t})=>{const n=Et[e("easingFunction")],o=St[e("easingMode")],a=o(n),s=e("t");t("t",a(s))}}),Oe=class Oe extends We{constructor(n,o){super(n,o,[new $("flow","flow"),new $("float","duration",1)],[new $("flow","flow")]);p(this,"timeoutPending",!1)}triggered(n,o,a){this.timeoutPending||(this.timeoutPending=!0,setTimeout(()=>{this.timeoutPending&&(this.timeoutPending=!1,n.commitToNewFiber(this,"flow"),a())},this.readInput("duration")*1e3))}dispose(){this.timeoutPending=!1}};p(Oe,"Description",new Le({typeName:"flow/time/delay",category:"Time",label:"Delay",factory:(n,o)=>new Oe(n,o)}));let Qe=Oe;const Bo=r({name:"flow/time/now",label:"Now",out:"float",exec:()=>Date.now()/1e3}),_o=Object.freeze(Object.defineProperty({__proto__:null,Now:Bo},Symbol.toStringTag,{value:"Module"})),Ro=r({name:"math/boolean/constant",label:"Boolean",in:["boolean"],out:"boolean",exec:e=>e}),Qo=r({name:"math/boolean/and",label:"∧",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e&&t}),Go=r({name:"math/boolean/or",label:"∨",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e||t}),Uo=r({name:"math/boolean/xor",label:"⊻",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>(e||t)&&!(e&&t)}),Ho=r({name:"math/boolean/negate",label:"¬",in:["boolean"],out:"boolean",exec:e=>!e}),Xo=r({name:"math/boolean/convert/toFloat",label:"To Float",in:["boolean"],out:"float",exec:e=>e?1:0}),Ko=r({name:"math/boolean/compare/equal",label:"=",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e===t}),Wo=r({name:"math/boolean/convert/toInteger",label:"To Integer",in:["boolean"],out:"integer",exec:e=>e?1n:0n}),Yo=Object.freeze(Object.defineProperty({__proto__:null,And:Qo,Constant:Ro,Equal:Ko,Not:Ho,Or:Go,ToFloat:Xo,Xor:Uo,toInteger:Wo},Symbol.toStringTag,{value:"Module"})),Xt={name:"boolean",creator:()=>!1,deserialize:e=>typeof e=="string"?e.toLowerCase()==="true":e,serialize:e=>e,lerp:(e,t,n)=>n<.5?e:t,equals:(e,t)=>e===t,clone:e=>e},Zo=r({name:"math/float/constant",label:"Float",in:["float"],out:"float",exec:e=>e}),Jo=r({name:"math/float/basic/add",label:"+",in:["float","float"],out:"float",exec:(e,t)=>e+t}),ea=r({name:"math/float/basic/subtract",label:"-",in:["float","float"],out:"float",exec:(e,t)=>e-t}),ta=r({name:"math/float/negate",label:"-",in:["float"],out:"float",exec:e=>-e}),na=r({name:"math/float/basic/multiply",label:"×",in:["float","float"],out:"float",exec:(e,t)=>e*t}),oa=r({name:"math/float/basic/divide",label:"÷",in:["float","float"],out:"float",exec:(e,t)=>e/t}),aa=r({name:"math/float/basic/modulus",label:"MOD",in:["float","float"],out:"float",exec:(e,t)=>e%t}),sa=r({name:"math/float/transcendental/pow",label:"POW",in:["float","float"],out:"float",exec:Math.pow}),ia=r({name:"math/float/transcendental/sqrt",label:"√",in:["float"],out:"float",exec:Math.sqrt}),ra=r({name:"math/float/constant/e",label:"𝑒",out:"float",exec:()=>Math.E}),ca=r({name:"math/float/constant/phi",label:"Φ",out:"float",exec:()=>1.6180339887}),la=r({name:"math/float/transcendental/exp",label:"EXP",in:["float"],out:"float",exec:Math.exp}),ua=r({name:"math/float/transcendental/ln",label:"LN",in:["float"],out:"float",exec:Math.log}),ma=r({name:"math/float/transcendental/log2",label:"LOG2",in:["float"],out:"float",exec:Math.log2}),fa=r({name:"math/float/transcendental/log10",label:"LOG10",in:["float"],out:"float",exec:Math.log10}),ha=r({name:"math/float/constant/pi",label:"π",out:"float",exec:()=>Math.PI}),da=r({name:"math/float/trig/sin",label:"SIN",in:["float"],out:"float",exec:Math.sin}),ga=r({name:"math/float/trig/asin",label:"ASIN",in:["float"],out:"float",exec:Math.asin}),pa=r({name:"math/float/trig/cos",label:"COS",in:["float"],out:"float",exec:Math.cos}),ba=r({name:"math/float/trig/acos",label:"ACOS",in:["float"],out:"float",exec:Math.acos}),wa=r({name:"math/float/trig/tan",label:"TAN",in:["float"],out:"float",exec:Math.tan}),xa=r({name:"math/float/trig/radiansToDegrees",label:"To Degrees",in:["float"],out:"float",exec:wo}),ya=r({name:"math/float/trig/degreesToRadians",label:"To Radians",in:["float"],out:"float",exec:bo}),va=r({name:"math/float/trig/atan",label:"ATAN",in:["float"],out:"float",exec:Math.atan}),Ea=r({name:"math/float/basic/mix",label:"MIX",in:["float","float","float"],out:"float",exec:(e,t,n)=>{const o=1-n;return e*o+t*n}}),Sa=r({name:"math/float/convert/toFloat",label:"To Float",in:["float"],out:"float",exec:e=>Number(e)}),Ta=r({name:"math/float/basic/min",label:"MIN",in:["float","float"],out:"float",exec:(e,t)=>Math.min(e,t)}),Na=r({name:"math/float/basic/max",label:"MAX",in:["float","float"],out:"float",exec:(e,t)=>Math.max(e,t)}),Ma=r({name:"math/float/precision/clamp",label:"CLAMP",in:[{value:"float"},{min:"float"},{max:"float"}],out:"float",exec:(e,t,n)=>e<t?t:e>n?n:e}),$a=r({name:"math/float/abs",label:"ABS",in:["float"],out:"float",exec:Math.abs}),za=r({name:"math/float/sign",label:"SIGN",in:["float"],out:"float",exec:Math.sign}),Ca=r({name:"math/float/precision/floor",label:"FLOOR",in:["float"],out:"float",exec:Math.floor}),Ia=r({name:"math/float/precision/ceil",label:"CEIL",in:["float"],out:"float",exec:Math.ceil}),qa=r({name:"math/float/precision/round",label:"ROUND",in:["float"],out:"float",exec:Math.round}),Oa=r({name:"math/float/precision/trunc",label:"TRUNC",in:["float"],out:"float",exec:Math.trunc}),ka=r({name:"math/float/random",label:"RANDOM",out:"float",exec:Math.random}),La=r({name:"math/float/compare/equal",label:"=",in:["float","float"],out:"boolean",exec:(e,t)=>e===t}),ja=r({name:"math/float/compare/equalTolerance",label:"=",in:["float","float","float"],out:"boolean",exec:(e,t,n)=>V(e,t,n)}),Fa=r({name:"math/float/compare/greaterThan",label:">",in:["float","float"],out:"boolean",exec:(e,t)=>e>t}),Aa=r({name:"math/float/compare/greaterThanOrEqual",label:"≥",in:["float","float"],out:"boolean",exec:(e,t)=>e>=t}),Pa=r({name:"math/float/compare/lessThan",label:"<",in:["float","float"],out:"boolean",exec:(e,t)=>e<t}),Da=r({name:"math/float/compare/lessThanOrEqual",label:"≤",in:["float","float"],out:"boolean",exec:(e,t)=>e<=t}),Va=r({name:"math/float/compare/isNaN",label:"isNaN",in:["float"],out:"boolean",exec:Number.isNaN}),Ba=r({name:"math/float/compare/isInf",label:"isInf",in:["float"],out:"boolean",exec:e=>!Number.isFinite(e)&&!Number.isNaN(e)}),_a=Object.freeze(Object.defineProperty({__proto__:null,Abs:$a,Acos:ba,Add:Jo,Asin:ga,Atan:va,Ceil:Ia,Clamp:Ma,Constant:Zo,Cos:pa,DegreesToRadians:ya,Divide:oa,E:ra,Equal:La,EqualTolerance:ja,Exp:la,Floor:Ca,GreaterThan:Fa,GreaterThanOrEqual:Aa,IsInf:Ba,IsNaN:Va,LessThan:Pa,LessThanOrEqual:Da,Ln:ua,Log10:fa,Log2:ma,Max:Na,Min:Ta,Mix:Ea,Modulus:aa,Multiply:na,Negate:ta,PI:ha,Phi:ca,Power:sa,RadiansToDegrees:xa,Random:ka,Round:qa,Sign:za,Sin:da,SquareRoot:ia,Subtract:ea,Tan:wa,ToFloat:Sa,Trunc:Oa},Symbol.toStringTag,{value:"Module"})),Kt={name:"float",creator:()=>0,deserialize:e=>typeof e=="string"?Ht(e,0):e,serialize:e=>e,lerp:(e,t,n)=>e*(1-n)+t*n,equals:(e,t)=>e===t,clone:e=>e},Ra=r({name:"math/integer/constant",label:"Integer",in:["integer"],out:"integer",exec:e=>e}),Qa=r({name:"math/integer/basic/add",label:"+",in:["integer","integer"],out:"integer",exec:(e,t)=>e+t}),Ga=r({name:"math/integer/basic/subtract",label:"-",in:["integer","integer"],out:"integer",exec:(e,t)=>e-t}),Ua=r({name:"math/integer/negate",label:"-",in:["integer"],out:"integer",exec:e=>-e}),Ha=r({name:"math/integer/basic/multiply",label:"×",in:["integer","integer"],out:"integer",exec:(e,t)=>e*t}),Xa=r({name:"math/integer/basic/divide",label:"÷",in:["integer","integer"],out:"integer",exec:(e,t)=>e/t}),Ka=r({name:"math/integer/basic/modulus",label:"MOD",in:["integer","integer"],out:"integer",exec:(e,t)=>e%t}),Wa=r({name:"math/integer/convert/toFloat",label:"To Float",in:["integer"],out:"float",exec:e=>Number(e)}),Ya=r({name:"math/integer/basic/min",label:"MIN",in:["integer","integer"],out:"integer",exec:(e,t)=>e>t?t:e}),Za=r({name:"math/integer/basic/max",label:"MAX",in:["integer","integer"],out:"integer",exec:(e,t)=>e>t?e:t}),Ja=r({name:"math/integer/precision/clamp",label:"CLAMP",in:[{value:"integer"},{min:"integer"},{max:"integer"}],out:"integer",exec:(e,t,n)=>e<t?t:e>n?n:e}),es=r({name:"math/integer/abs",label:"ABS",in:["integer"],out:"integer",exec:e=>e<BigInt(0)?-e:e}),ts=r({name:"math/integer/sign",label:"SIGN",in:["integer"],out:"integer",exec:e=>BigInt(e<0?-1:e>0?1:0)}),ns=r({name:"math/integer/compare/equal",label:"=",in:["integer","integer"],out:"boolean",exec:(e,t)=>e===t}),os=r({name:"math/integer/compare/greaterThan",label:">",in:["integer","integer"],out:"boolean",exec:(e,t)=>e>t}),as=r({name:"math/integer/compare/greaterThanOrEqual",label:"≥",in:["integer","integer"],out:"boolean",exec:(e,t)=>e>=t}),ss=r({name:"math/integer/compare/lessThan",label:"<",in:["integer","integer"],out:"boolean",exec:(e,t)=>e<t}),is=r({name:"math/integer/compare/lessThanOrEqual",label:"≤",in:["integer","integer"],out:"boolean",exec:(e,t)=>e<=t}),rs=r({name:"math/integer/convert/toBoolean",label:"To Boolean",in:["integer"],out:"boolean",exec:e=>e!==0n}),cs=Object.freeze(Object.defineProperty({__proto__:null,Abs:es,Add:Qa,Clamp:Ja,Constant:Ra,Divide:Xa,Equal:ns,GreaterThan:os,GreaterThanOrEqual:as,LessThan:ss,LessThanOrEqual:is,Max:Za,Min:Ya,Modulus:Ka,Multiply:Ha,Negate:Ua,Sign:ts,Subtract:Ga,ToFloat:Wa,toBoolean:rs},Symbol.toStringTag,{value:"Module"})),Wt={name:"integer",creator:()=>BigInt(0),deserialize:e=>BigInt(e),serialize:e=>Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?Number(e):e.toString(),lerp:(e,t,n)=>BigInt(Number(e)*(1-n)+Number(t)*n),equals:(e,t)=>e===t,clone:e=>e},ls=r({name:"logic/string/constant",label:"String",in:["string"],out:"string",exec:e=>e}),us=r({name:"logic/string/concat",label:"Concat",in:["string","string"],out:"string",exec:(e,t)=>e.concat(t)}),ms=r({name:"logic/string/includes",label:"Includes",in:["string","string"],out:"boolean",exec:(e,t)=>e.includes(t)}),fs=r({name:"logic/string/length",label:"Length",in:["string"],out:"integer",exec:e=>BigInt(e.length)}),hs=r({name:"math/string/compare/equal",label:"=",in:["string","string"],out:"boolean",exec:(e,t)=>e===t}),ds=Object.freeze(Object.defineProperty({__proto__:null,Concat:us,Constant:ls,Equal:hs,Includes:ms,Length:fs},Symbol.toStringTag,{value:"Module"})),Yt={name:"string",creator:()=>"",deserialize:e=>e,serialize:e=>e,lerp:(e,t,n)=>n<.5?e:t,equals:(e,t)=>e===t,clone:e=>e},he=ae(()=>Object.fromEntries([Xt,Yt,Wt,Kt].map(t=>[t.name,t])));function gs(e){return Object.keys(he()).filter(t=>t!=="string").flatMap(t=>Je({values:e,valueTypeName:t}))}const ps=ae(()=>{const e=[...j(ds),...j(Yo),...j(cs),...j(_a),Vo,To,So,Fo,Qe.Description,...j(_o),No,Co,Io,ko,Po,Do,Be.Description,_e.Description,$o,zo,qo,Oo,Re.Description,Mo,...gs(he())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),bs=e=>({values:{...e.values,...he()},nodes:{...e.nodes,...ps()},dependencies:{...e.dependencies}});class F{constructor(t=0,n=0){this.x=t,this.y=n}clone(t=new F){return t.set(this.x,this.y)}set(t,n){return this.x=t,this.y=n,this}}function ws(e,t,n=oe){return V(e.x,t.x,n)&&V(e.y,t.y,n)}function xs(e,t,n=new F){return n.set(e.x+t.x,e.y+t.y)}function ys(e,t,n=new F){return n.set(e.x-t.x,e.y-t.y)}function Zt(e,t,n=new F){return n.set(e.x*t,e.y*t)}function vs(e,t=new F){return t.set(-e.x,-e.y)}function Jt(e){return Math.sqrt(en(e,e))}function Es(e,t=new F){const n=1/Jt(e);return Zt(e,n,t)}function en(e,t){return e.x*t.x+e.y*t.y}function tn(e,t,n,o=new F){const a=1-n;return o.set(e.x*a+t.x*n,e.y*a+t.y*n)}function Ss(e,t=0,n=new F){return n.set(e[t+0],e[t+1])}function Ts(e,t,n=0){t[n+0]=e.x,t[n+1]=e.y}function Ns(e,t=new F){return Ss(fe(e),0,t)}const et=3,Se=3,P=et*Se;class C{constructor(t=[1,0,0,0,1,0,0,0,1]){if(this.elements=t,t.length!==P)throw new Error(`elements must have length ${P}, got ${t.length}`)}clone(t=new C){return t.set(this.elements)}set(t){if(t.length!==P)throw new Error(`elements must have length ${P}, got ${t.length}`);for(let n=0;n<P;n++)this.elements[n]=t[n];return this}}function Ms(e,t,n,o=new C){const a=o.set(e.elements).elements,s=t*et;return a[s+0]=n.x,a[s+1]=n.y,a[s+2]=n.z,o}function $s(e,t,n,o=new C){const a=o.set(e.elements).elements;return a[t+Se*0]=n.x,a[t+Se*1]=n.y,a[t+Se*2]=n.z,o}function zs(e,t,n,o=new C){const a=o.elements,s=[e,t,n];for(let i=0;i<s.length;i++){const c=i*et,l=s[i];a[c+0]=l.x,a[c+1]=l.y,a[c+2]=l.z}return o}function nn(e,t,n=oe){for(let o=0;o<P;o++)if(!V(e.elements[o],t.elements[o],n))return!1;return!0}function Cs(e,t,n=new C){for(let o=0;o<P;o++)n.elements[o]=e.elements[o]+t.elements[o];return n}function Is(e,t,n=new C){for(let o=0;o<P;o++)n.elements[o]=e.elements[o]-t.elements[o];return n}function qs(e,t,n=new C){for(let o=0;o<P;o++)n.elements[o]=e.elements[o]*t;return n}function Os(e,t=new C){for(let n=0;n<P;n++)t.elements[n]=-e.elements[n];return t}function ks(e,t,n=new C){const o=e.elements,a=t.elements,s=n.elements,i=o[0],c=o[3],l=o[6],u=o[1],m=o[4],f=o[7],h=o[2],g=o[5],d=o[8],w=a[0],b=a[3],x=a[6],y=a[1],I=a[4],q=a[7],O=a[2],k=a[5],L=a[8];return s[0]=i*w+c*y+l*O,s[3]=i*b+c*I+l*k,s[6]=i*x+c*q+l*L,s[1]=u*w+m*y+f*O,s[4]=u*b+m*I+f*k,s[7]=u*x+m*q+f*L,s[2]=h*w+g*y+d*O,s[5]=h*b+g*I+d*k,s[8]=h*x+g*q+d*L,n}function Ls(e){const t=e.elements,n=t[0],o=t[1],a=t[2],s=t[3],i=t[4],c=t[5],l=t[6],u=t[7],m=t[8];return n*i*m-n*c*u-o*s*m+o*c*l+a*s*u-a*i*l}function js(e,t=new C){const n=e.elements,o=t.elements;return o[0]=n[0],o[4]=n[4],o[8]=n[8],o[1]=n[3],o[3]=n[1],o[2]=n[6],o[6]=n[2],o[5]=n[7],o[7]=n[5],t}function Fs(e,t=new C){const n=e.elements,o=n[0],a=n[1],s=n[2],i=n[3],c=n[4],l=n[5],u=n[6],m=n[7],f=n[8],h=f*c-l*m,g=l*u-f*i,d=m*i-c*u,w=o*h+a*g+s*d;if(w===0)throw new Error("can not invert degenerate matrix");const b=1/w,x=t.elements;return x[0]=h*b,x[1]=(s*m-f*a)*b,x[2]=(l*a-s*c)*b,x[3]=g*b,x[4]=(f*o-s*u)*b,x[5]=(s*i-l*o)*b,x[6]=d*b,x[7]=(a*u-m*o)*b,x[8]=(c*o-a*i)*b,t}function on(e,t,n,o=new C){const a=1-n;for(let s=0;s<P;s++)o.elements[s]=e.elements[s]*a+t.elements[s]*n;return o}function As(e,t=0,n=new C){for(let o=0;o<P;o++)n.elements[o]=e[t+o];return n}function Ps(e,t=new C){return As(fe(e),0,t)}function tt(e,t=new C){const n=t.elements,o=e.x,a=e.y,s=e.z,i=Math.cos(o),c=Math.sin(o),l=Math.cos(a),u=Math.sin(a),m=Math.cos(s),f=Math.sin(s),h=i*m,g=i*f,d=c*m,w=c*f;return n[0]=l*m,n[3]=-l*f,n[6]=u,n[1]=g+d*u,n[4]=h-w*u,n[7]=-c*l,n[2]=w-h*u,n[5]=d+g*u,n[8]=i*l,t}function an(e,t=new C){const n=e.x,o=e.y,a=e.z,s=e.w,i=n+n,c=o+o,l=a+a,u=n*i,m=n*c,f=n*l,h=o*c,g=o*l,d=a*l,w=s*i,b=s*c,x=s*l;return t.set([1-(h+d),m-x,f+b,m+x,1-(u+d),g-w,f-b,g+w,1-(u+h)])}function Ds(e,t=new C){return t.set([e.x,0,0,0,e.y,0,0,0,1])}function Vs(e,t=new F){const n=e.elements,o=n[0],a=n[1],s=n[3],i=n[4];return t.set(Math.sqrt(o*o+a*a),Math.sqrt(s*s+i*i))}function Bs(e,t=new C){return t.set([1,0,e.x,0,1,e.y,0,0,1])}function _s(e,t=new F){return t.set(e.elements[2],e.elements[5])}function nt(e,t=new C){const n=e.elements;return t.set([n[0],n[1],n[2],n[4],n[5],n[6],n[8],n[9],n[10]])}class E{constructor(t=0,n=0,o=0){this.x=t,this.y=n,this.z=o}clone(t=new E){return t.set(this.x,this.y,this.z)}set(t,n,o){return this.x=t,this.y=n,this.z=o,this}}function se(e,t,n=oe){return V(e.x,t.x,n)&&V(e.y,t.y,n)&&V(e.z,t.z,n)}function ot(e,t,n=new E){return n.set(e.x+t.x,e.y+t.y,e.z+t.z)}function je(e,t,n=new E){return n.set(e.x-t.x,e.y-t.y,e.z-t.z)}function te(e,t,n=new E){return n.set(e.x*t,e.y*t,e.z*t)}function at(e,t=new E){return t.set(-e.x,-e.y,-e.z)}function Me(e){return Math.sqrt(sn(e,e))}function st(e,t=new E){const n=1/Me(e);return te(e,n,t)}function sn(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function Te(e,t,n=new E){const o=e.x,a=e.y,s=e.z,i=t.x,c=t.y,l=t.z;return n.set(a*l-s*c,s*i-o*l,o*c-a*i)}function ie(e,t,n,o=new E){const a=1-n;return o.set(e.x*a+t.x*n,e.y*a+t.y*n,e.z*a+t.z*n)}function Rs(e,t=0,n=new E){return n.set(e[t+0],e[t+1],e[t+2])}function it(e,t=new E){return Rs(fe(e),0,t)}function Qs(e,t=new E){function n(l,u,m){return m<0&&(m+=1),m>1&&(m-=1),m<1/6?l+(u-l)*6*m:m<1/2?u:m<2/3?l+(u-l)*6*(2/3-m):l}const o=(e.x%1+1)%1,a=Math.min(Math.max(e.y,0),1),s=Math.min(Math.max(e.z,0),1);if(a===0)return t.set(1,1,1);const i=s<=.5?s*(1+a):s+a-s*a,c=2*s-i;return t.set(n(c,i,o+1/3),n(c,i,o),n(c,i,o-1/3))}function Gs(e,t=new E){const n=e.x,o=e.y,a=e.z,s=Math.max(n,o,a),i=Math.min(n,o,a);let c=0,l=0;const u=(i+s)/2;if(i===s)c=0,l=0;else{const m=s-i;switch(l=u<=.5?m/(s+i):m/(2-s-i),s){case n:c=(o-a)/m+(o<a?6:0);break;case o:c=(a-n)/m+2;break;case a:c=(n-o)/m+4;break}c/=6}return t.set(c,l,u)}function Us(e,t=new E){return e=Math.floor(e),t.set((e>>16&255)/255,(e>>8&255)/255,(e&255)/255)}function Hs(e){return e.x*255<<16^e.y*255<<8^e.z*255<<0}function rt(e,t=new E){const n=e.elements,o=n[0],a=n[3],s=n[6];n[1];const i=n[4],c=n[7];n[2];const l=n[5],u=n[8];return t.y=Math.asin(Gn.clamp(s,-1,1)),Math.abs(s)<.9999999?(t.x=Math.atan2(-c,u),t.z=Math.atan2(-a,o)):(t.x=Math.atan2(l,i),t.z=0),t}function Xs(e,t=new E){return rt(nt(e),t)}function Ks(e,t=new E){return rt(an(e),t)}const rn={name:"color",creator:()=>new E,deserialize:e=>typeof e=="string"?it(e):new E(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>ie(e,t,n),equals:(e,t)=>se(e,t),clone:e=>e.clone()},cn={name:"euler",creator:()=>new E,deserialize:e=>typeof e=="string"?it(e):new E(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>ie(e,t,n),equals:(e,t)=>se(e,t),clone:e=>e.clone()};class M{constructor(t=0,n=0,o=0,a=0){this.x=t,this.y=n,this.z=o,this.w=a}clone(t=new M){return t.set(this.x,this.y,this.z,this.w)}set(t,n,o,a){return this.x=t,this.y=n,this.z=o,this.w=a,this}}function Fe(e,t,n=oe){return V(e.x,t.x,n)&&V(e.y,t.y,n)&&V(e.z,t.z,n)&&V(e.w,t.w,n)}function Ws(e,t,n=new M){return n.set(e.x+t.x,e.y+t.y,e.z+t.z,e.w+t.w)}function Ys(e,t,n=new M){return n.set(e.x-t.x,e.y-t.y,e.z-t.z,e.w-t.w)}function Ae(e,t,n=new M){return n.set(e.x*t,e.y*t,e.z*t,e.w*t)}function ln(e,t=new M){return t.set(-e.x,-e.y,-e.z,-e.w)}function ct(e){return Math.sqrt(Pe(e,e))}function lt(e,t=new M){const n=1/ct(e);return Ae(e,n,t)}function Pe(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function ut(e,t,n,o=new M){const a=1-n;return o.set(e.x*a+t.x*n,e.y*a+t.y*n,e.z*a+t.z*n,e.w*a+t.w*n)}function Zs(e,t=0,n=new M){return n.set(e[t+0],e[t+1],e[t+2],e[t+3])}function Js(e,t,n=0){t[n+0]=e.x,t[n+1]=e.y,t[n+2]=e.z,t[n+3]=e.w}function un(e,t=new M){return Zs(fe(e),0,t)}function ei(e,t=new M){return t.set(-e.x,-e.y,-e.z,e.w)}function ti(e,t,n=new M){const o=e.x,a=e.y,s=e.z,i=e.w,c=t.x,l=t.y,u=t.z,m=t.w;return n.set(o*m+i*c+a*u-s*l,a*m+i*l+s*c-o*u,s*m+i*u+o*l-a*c,i*m-o*c-a*l-s*u)}function mn(e,t,n,o=new M){if(n<=0)return e.clone(o);if(n>=1)return t.clone(o);let a=Pe(e,t);if(a<0?(ln(t,o),a=-a):t.clone(o),a>=1)return o;const s=1-a*a;if(s<=Number.EPSILON)return ut(e,o,n),lt(o,o),o;const i=Math.sqrt(s),c=Math.atan2(i,a),l=Math.sin((1-n)*c)/i,u=Math.sin(n*c)/i;return o.w=e.w*l+o.w*u,o.x=e.x*l+o.x*u,o.y=e.y*l+o.y*u,o.z=e.z*l+o.z*u,o}function fn(e,t=new M){const n=e.x,o=e.y,a=e.z,s=e.w,i=Math.sqrt(n*n+o*o+a*a),c=Math.exp(s),l=i>0?c*Math.sin(i)/i:0;return t.set(n*l,o*l,a*l,c*Math.cos(i))}function hn(e,t=new M){const n=e.x,o=e.y,a=e.z,s=e.w,i=Math.sqrt(n*n+o*o+a*a),c=i>0?Math.atan2(i,s)/i:0;return t.set(n*c,o*c,a*c,.5*Math.log(n*n+o*o+a*a+s*s))}function ni(e,t,n=new M){const o=hn(e),a=Ae(o,t);return fn(a,n),n}function oi(e,t=new M){const n=Math.cos(e.x/2),o=Math.cos(e.y/2),a=Math.cos(e.z/2),s=Math.sin(e.x/2),i=Math.sin(e.y/2),c=Math.sin(e.z/2);return t.set(s*o*a+n*i*c,n*i*a-s*o*c,n*o*c+s*i*a,n*o*a-s*i*c)}function ai(e,t,n=new M){const o=e/2,a=Math.sin(o);return n.set(t.x*a,t.y*a,t.z*a,Math.cos(o))}function si(e,t=new M){return dn(nt(e),t)}function dn(e,t=new M){const n=e.elements,o=n[0],a=n[3],s=n[6],i=n[1],c=n[4],l=n[7],u=n[2],m=n[5],f=n[8],h=o+c+f;if(h>0){const d=.5/Math.sqrt(h+1);return t.set((m-l)*d,(s-u)*d,(i-a)*d,.25/d)}if(o>c&&o>f){const d=2*Math.sqrt(1+o-c-f);return t.set(.25*d,(a+i)/d,(s+u)/d,(m-l)/d)}if(c>f){const d=2*Math.sqrt(1+c-o-f);return t.set((a+i)/d,.25*d,(l+m)/d,(s-u)/d)}const g=2*Math.sqrt(1+f-o-c);return t.set((s+u)/g,(l+m)/g,.25*g,(i-a)/g)}const gn={name:"quat",creator:()=>new M,deserialize:e=>typeof e=="string"?un(e):new M(e[0],e[1],e[2],e[3]),serialize:e=>[e.x,e.y,e.z,e.w],lerp:(e,t,n)=>mn(e,t,n),equals:(e,t)=>Fe(e,t),clone:e=>e.clone()},pn={name:"vec2",creator:()=>new F,deserialize:e=>typeof e=="string"?Ns(e):new F(e[0],e[1]),serialize:e=>[e.x,e.y],lerp:(e,t,n)=>tn(e,t,n),equals:(e,t)=>e.x===t.x&&e.y===t.y,clone:e=>e.clone()},bn={name:"vec3",creator:()=>new E,deserialize:e=>typeof e=="string"?it(e):new E(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>ie(e,t,n),equals:(e,t)=>se(e,t),clone:e=>e.clone()},wn={name:"vec4",creator:()=>new M,deserialize:e=>typeof e=="string"?un(e):new M(e[0],e[1],e[2],e[3]),serialize:e=>[e.x,e.y,e.z,e.w],lerp:(e,t,n)=>ut(e,t,n),equals:(e,t)=>Fe(e,t),clone:e=>e.clone()},ii=()=>({});ke({typeName:"scene/nodeClick",category:v.None,label:"On Scene Node Click",in:{jsonPath:(e,t)=>{const n=t.getDependency("IScene");return{valueType:"string",choices:n==null?void 0:n.getRaycastableProperties()}}},out:{flow:"flow"},initialState:ii(),init:({read:e,commit:t,graph:n})=>{const o=()=>{t("flow")},a=e("jsonPath"),s=n.getDependency("IScene");return s==null||s.addOnClickedListener(a,o),{handleNodeClick:o,jsonPath:a}},dispose:({state:{handleNodeClick:e,jsonPath:t},graph:{getDependency:n}})=>{if(z.mustBeTrue(e!==void 0),z.mustBeTrue(t!==void 0),!t||!e)return{};const o=n("scene");return o==null||o.removeOnClickedListener(t,e),{}}});const ri=r({name:"math/color/constant",label:"Color",in:["color"],out:"color",exec:e=>e}),ci=r({name:"math/color/convert/toColor/rgb",label:"RGB To Color",in:[{r:"float"},{g:"float"},{b:"float"}],out:"color",exec:(e,t,n)=>new E(e,t,n)}),li=r({name:"math/color/toRgb",label:"Color to RGB",in:["color"],out:[{r:"float"},{g:"float"},{b:"float"}],exec:e=>({r:e.x,g:e.y,b:e.z})}),ui=r({name:"math/color/basic/add",label:"+",in:["color","color"],out:"color",exec:ot}),mi=r({name:"math/color/basic/subtract",label:"-",in:["color","color"],out:"color",exec:je}),fi=r({name:"math/color/negate",label:"-",in:["color"],out:"color",exec:at}),hi=r({name:"math/color/basic/scale",label:"×",in:["color","float"],out:"color",exec:te}),di=r({name:"math/color/basic/mix",label:"÷",in:[{a:"color"},{b:"color"},{t:"float"}],out:"color",exec:ie}),gi=r({name:"math/color/convert/toColor/hsl",label:"HSL to Color",in:["vec3"],out:"color",exec:Qs}),pi=r({name:"math/color/toHsl",label:"Color to HSL",in:["color"],out:"vec3",exec:Gs}),bi=r({name:"math/color/convert/toColor/hex",label:"HEX to Color",in:["float"],out:"color",exec:Us}),wi=r({name:"math/color/toHex",label:"Color to HEX",in:["color"],out:"float",exec:Hs}),xi=r({name:"math/color/compare/equal",label:"=",in:[{a:"color"},{b:"color"},{tolerance:"float"}],out:"boolean",exec:se}),yi=Object.freeze(Object.defineProperty({__proto__:null,Add:ui,ColorToHex:wi,ColorToHsl:pi,Constant:ri,Create:ci,Elements:li,Equal:xi,HexToColor:bi,HslToColor:gi,Mix:di,Negate:fi,Scale:hi,Subtract:mi},Symbol.toStringTag,{value:"Module"})),vi=r({name:"math/euler/constant",label:"Euler",in:["euler"],out:"euler",exec:e=>e}),Ei=r({name:"math/float/convert/toEuler",label:"Float to Euler",in:[{x:"float"},{y:"float"},{z:"float"}],out:"euler",exec:(e,t,n)=>new E(e,t,n)}),Si=r({name:"math/euler/convert/toFloat",label:"Euler to Float",in:["euler"],out:[{x:"float"},{y:"float"},{z:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z})}),Ti=r({name:"math/euler/basic/add",label:"+",in:["euler","euler"],out:"euler",exec:ot}),Ni=r({name:"math/euler/basic/subtract",label:"-",in:["euler","euler"],out:"euler",exec:je}),Mi=r({name:"math/euler/negate",label:"-",in:["euler"],out:"euler",exec:at}),$i=r({name:"math/euler/basic/scale",label:"×",in:["euler","float"],out:"euler",exec:te}),zi=r({name:"math/euler/basic/mix",label:"÷",in:[{a:"euler"},{b:"euler"},{t:"float"}],out:"euler",exec:(e,t,n)=>(console.warn("TODO: this is not shortest path"),ie(e,t,n))}),Ci=r({name:"math/mat3/convert/toEuler",label:"To Euler",in:["mat3"],out:"euler",exec:rt}),Ii=r({name:"math/mat4/convert/toEuler",label:"To Euler",in:["mat4"],out:"euler",exec:Xs}),qi=r({name:"math/quat/convert/toEuler",label:"To Euler",in:["quat"],out:"euler",exec:Ks}),Oi=r({name:"math/euler/compare/equal",label:"=",in:[{a:"euler"},{b:"euler"},{tolerance:"float"}],out:"boolean",exec:se}),ki=Object.freeze(Object.defineProperty({__proto__:null,Add:Ti,Constant:vi,Create:Ei,Elements:Si,Equal:Oi,Mat3ToEuler:Ci,Mat4ToEuler:Ii,Mix:zi,Negate:Mi,QuatToEuler:qi,Scale:$i,Subtract:Ni},Symbol.toStringTag,{value:"Module"})),Li=r({name:"math/mat3/constant",label:"Mat3",in:["mat3"],out:"mat3",exec:e=>e}),ji=r({name:"math/mat3/convert/toMat3/column3",label:"Columns to Mat3",in:["vec3","vec3","vec3"],out:"mat3",exec:zs}),Fi=r({name:"math/mat3/setColumn",label:"Set Column",in:["mat3","integer","vec3"],out:"mat3",exec:Ms}),Ai=r({name:"math/mat3/setRow",label:"Set Row",in:["mat3","integer","vec3"],out:"mat3",exec:$s}),Pi=r({name:"math/mat3/convert/toVec3",label:"Mat3 To Vec3",in:["mat3"],out:[{x:"vec3"},{y:"vec3"},{z:"vec3"}],exec:e=>{throw new Error("not implemented")}}),Di=r({name:"math/mat3/basic/add",label:"+",in:["mat3","mat3"],out:"mat3",exec:Cs}),Vi=r({name:"math/mat3/basic/subtract",label:"-",in:["mat3","mat3"],out:"mat3",exec:Is}),Bi=r({name:"math/mat3/negate",label:"-",in:["mat3"],out:"mat3",exec:Os}),_i=r({name:"math/mat3/basic/scale",label:"×",in:["mat3","float"],out:"mat3",exec:qs}),Ri=r({name:"math/mat3/determinant",label:"Determinant",in:["mat3"],out:"float",exec:Ls}),Qi=r({name:"math/mat3/basic/inverse",label:"Inverse",in:["mat3"],out:"mat3",exec:Fs}),Gi=r({name:"math/mat4/convert/toMat3",label:"Mat4 To Mat3",in:["mat4"],out:"mat3",exec:nt}),Ui=r({name:"math/mat3/transpose",label:"Transpose",in:["mat3"],out:"mat3",exec:js}),Hi=r({name:"math/mat3/basic/multiply",label:"Cross",in:["mat3","mat3"],out:"mat3",exec:ks}),Xi=r({name:"math/mat3/basic/mix",label:"÷",in:[{a:"mat3"},{b:"mat3"},{t:"float"}],out:"mat3",exec:on}),Ki=r({name:"math/mat3/compare/equal",label:"=",in:[{a:"mat3"},{b:"mat3"},{tolerance:"float"}],out:"boolean",exec:nn}),Wi=r({name:"math/euler/convert/toMat3",label:"To Mat3",in:["euler"],out:"mat3",exec:tt}),Yi=r({name:"math/quat/convert/toMat3",label:"To Mat3",in:["quat"],out:"mat3",exec:tt}),Zi=r({name:"math/mat3/convert/toMat3/scale2",label:"Scale2 To Mat3",in:["vec2"],out:"mat3",exec:Ds}),Ji=r({name:"math/mat3/toScale2",label:"Mat3 to Scale2",in:["mat3"],out:"vec2",exec:Vs}),er=r({name:"math/mat3/convert/toMat3/translation2",label:"Translation2 To Mat3",in:["vec2"],out:"mat3",exec:Bs}),tr=r({name:"math/mat3/toTranslation2",label:"Mat3 to Translation2",in:["mat3"],out:"vec2",exec:_s}),nr=Object.freeze(Object.defineProperty({__proto__:null,Add:Di,Column3ToMat3:ji,Constant:Li,Determinant:Ri,Elements:Pi,Equal:Ki,EulerToMat3:Wi,Inverse:Qi,Mat3ToScale2:Ji,Mat3ToTranslation3:tr,Mat4ToMat3:Gi,Mix:Xi,Multiply:Hi,Negate:Bi,QuatToMat3:Yi,Scale:_i,Scale2ToMat3:Zi,SetColumn:Fi,SetRow:Ai,Subtract:Vi,Translation2ToMat3:er,Transpose:Ui},Symbol.toStringTag,{value:"Module"})),mt=4,ce=4,D=mt*ce;class S{constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){if(this.elements=t,t.length!==D)throw new Error(`elements must have length ${D}, got ${t.length}`)}clone(t=new S){return t.set(this.elements)}set(t){if(t.length!==D)throw new Error(`elements must have length ${D}, got ${t.length}`);for(let n=0;n<D;n++)this.elements[n]=t[n];return this}}function or(e,t,n,o=new S){const a=o.set(e.elements).elements,s=Number(t)*mt;return a[s+0]=n.x,a[s+1]=n.y,a[s+2]=n.z,a[s+3]=n.w,o}function ar(e,t,n,o=new S){const a=o.set(e.elements).elements,s=Number(t);return a[s+ce*0]=n.x,a[s+ce*1]=n.y,a[s+ce*2]=n.z,a[s+ce*3]=n.w,o}function sr(e,t,n,o,a=new S){const s=a.elements,i=[e,t,n,o];for(let c=0;c<i.length;c++){const l=c*mt,u=i[c];s[l+0]=u.x,s[l+1]=u.y,s[l+2]=u.z,s[l+3]=u.w}return a}function xn(e,t,n=oe){for(let o=0;o<D;o++)if(!V(e.elements[o],t.elements[o],n))return!1;return!0}function ir(e,t,n=new S){for(let o=0;o<D;o++)n.elements[o]=e.elements[o]+t.elements[o];return n}function rr(e,t,n=new S){for(let o=0;o<D;o++)n.elements[o]=e.elements[o]-t.elements[o];return n}function cr(e,t,n=new S){for(let o=0;o<D;o++)n.elements[o]=e.elements[o]*t;return n}function lr(e,t=new S){for(let n=0;n<D;n++)t.elements[n]=-e.elements[n];return t}function de(e,t,n=new S){const o=e.elements,a=t.elements,s=n.elements,i=o[0],c=o[4],l=o[8],u=o[12],m=o[1],f=o[5],h=o[9],g=o[13],d=o[2],w=o[6],b=o[10],x=o[14],y=o[3],I=o[7],q=o[11],O=o[15],k=a[0],L=a[4],T=a[8],N=a[12],R=a[1],Q=a[5],G=a[9],U=a[13],H=a[2],X=a[6],ge=a[10],pe=a[14],be=a[3],we=a[7],xe=a[11],ye=a[15];return s[0]=i*k+c*R+l*H+u*be,s[4]=i*L+c*Q+l*X+u*we,s[8]=i*T+c*G+l*ge+u*xe,s[12]=i*N+c*U+l*pe+u*ye,s[1]=m*k+f*R+h*H+g*be,s[5]=m*L+f*Q+h*X+g*we,s[9]=m*T+f*G+h*ge+g*xe,s[13]=m*N+f*U+h*pe+g*ye,s[2]=d*k+w*R+b*H+x*be,s[6]=d*L+w*Q+b*X+x*we,s[10]=d*T+w*G+b*ge+x*xe,s[14]=d*N+w*U+b*pe+x*ye,s[3]=y*k+I*R+q*H+O*be,s[7]=y*L+I*Q+q*X+O*we,s[11]=y*T+I*G+q*ge+O*xe,s[15]=y*N+I*U+q*pe+O*ye,n}function ur(e){const t=e.elements,n=t[0],o=t[1],a=t[2],s=t[3],i=t[4],c=t[5],l=t[6],u=t[7],m=t[8],f=t[9],h=t[10],g=t[11],d=t[12],w=t[13],b=t[14],x=t[15],y=f*b*u-w*h*u+w*l*g-c*b*g-f*l*x+c*h*x,I=d*h*u-m*b*u-d*l*g+i*b*g+m*l*x-i*h*x,q=m*w*u-d*f*u+d*c*g-i*w*g-m*c*x+i*f*x,O=d*f*l-m*w*l-d*c*h+i*w*h+m*c*b-i*f*b;return n*y+o*I+a*q+s*O}function mr(e,t=new S){const n=e.elements,o=t.elements,a=n[0],s=n[1],i=n[2],c=n[3],l=n[4],u=n[5],m=n[6],f=n[7],h=n[8],g=n[9],d=n[10],w=n[11],b=n[12],x=n[13],y=n[14],I=n[15],q=a*u-s*l,O=a*m-i*l,k=a*f-c*l,L=s*m-i*u,T=s*f-c*u,N=i*f-c*m,R=h*x-g*b,Q=h*y-d*b,G=h*I-w*b,U=g*y-d*x,H=g*I-w*x,X=d*I-w*y;return o[0]=u*X-m*H+f*U,o[1]=i*H-s*X-c*U,o[2]=x*N-y*T+I*L,o[3]=d*T-g*N-w*L,o[4]=m*G-l*X-f*Q,o[5]=a*X-i*G+c*Q,o[6]=y*k-b*N-I*O,o[7]=h*N-d*k+w*O,o[8]=l*H-u*G+f*R,o[9]=s*G-a*H-c*R,o[10]=b*T-x*k+I*q,o[11]=g*k-h*T-w*q,o[12]=u*Q-l*U-m*R,o[13]=a*U-s*Q+i*R,o[14]=x*O-b*L-y*q,o[15]=h*L-g*O+d*q,t}function fr(e,t=new S){const n=e.clone(t).elements;let o;return o=n[1],n[1]=n[4],n[4]=o,o=n[2],n[2]=n[8],n[8]=o,o=n[6],n[6]=n[9],n[9]=o,o=n[3],n[3]=n[12],n[12]=o,o=n[7],n[7]=n[13],n[13]=o,o=n[11],n[11]=n[14],n[14]=o,t}function hr(e,t=new S){const n=e.elements,o=n[0],a=n[1],s=n[2],i=n[3],c=n[4],l=n[5],u=n[6],m=n[7],f=n[8],h=n[9],g=n[10],d=n[11],w=n[12],b=n[13],x=n[14],y=n[15],I=h*x*m-b*g*m+b*u*d-l*x*d-h*u*y+l*g*y,q=w*g*m-f*x*m-w*u*d+c*x*d+f*u*y-c*g*y,O=f*b*m-w*h*m+w*l*d-c*b*d-f*l*y+c*h*y,k=w*h*u-f*b*u-w*l*g+c*b*g+f*l*x-c*h*x,L=o*I+a*q+s*O+i*k;if(L===0)throw new Error("can not invert degenerate matrix");const T=1/L,N=t.elements;return N[0]=I*T,N[1]=(b*g*i-h*x*i-b*s*d+a*x*d+h*s*y-a*g*y)*T,N[2]=(l*x*i-b*u*i+b*s*m-a*x*m-l*s*y+a*u*y)*T,N[3]=(h*u*i-l*g*i-h*s*m+a*g*m+l*s*d-a*u*d)*T,N[4]=q*T,N[5]=(f*x*i-w*g*i+w*s*d-o*x*d-f*s*y+o*g*y)*T,N[6]=(w*u*i-c*x*i-w*s*m+o*x*m+c*s*y-o*u*y)*T,N[7]=(c*g*i-f*u*i+f*s*m-o*g*m-c*s*d+o*u*d)*T,N[8]=O*T,N[9]=(w*h*i-f*b*i-w*a*d+o*b*d+f*a*y-o*h*y)*T,N[10]=(c*b*i-w*l*i+w*a*m-o*b*m-c*a*y+o*l*y)*T,N[11]=(f*l*i-c*h*i-f*a*m+o*h*m+c*a*d-o*l*d)*T,N[12]=k*T,N[13]=(f*b*s-w*h*s+w*a*g-o*b*g-f*a*x+o*h*x)*T,N[14]=(w*l*s-c*b*s-w*a*u+o*b*u+c*a*x-o*l*x)*T,N[15]=(c*h*s-f*l*s+f*a*u-o*h*u-c*a*g+o*l*g)*T,t}function yn(e,t,n,o=new S){const a=1-n;for(let s=0;s<D;s++)o.elements[s]=e.elements[s]*a+t.elements[s]*n;return o}function dr(e,t=0,n=new S){for(let o=0;o<D;o++)n.elements[o]=e[t+o];return n}function gr(e,t=new S){return dr(fe(e),0,t)}function ft(e,t=new S){const n=e.elements;return t.set([n[0],n[1],n[2],0,n[3],n[4],n[5],0,n[6],n[7],n[8],0,0,0,0,1])}function vn(e,t=new S){return ft(tt(e),t)}function En(e,t=new S){return ft(an(e),t)}function Sn(e,t=new S){return t.set([e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1])}function Tn(e,t=new S){return t.set([1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1])}function pr(e,t,n=new S){return de(e,Tn(t),n)}function br(e,t,n=new S){return de(e,Sn(t),n)}function wr(e,t,n=new S){return de(e,En(t),n)}function xr(e,t,n=new S){return de(e,vn(t),n)}function yr(e,t,n=new E){const o=t.x,a=t.y,s=t.z,i=e.elements,c=1/(i[3]*o+i[7]*a+i[11]*s+i[15]);return n.x=(i[0]*o+i[4]*a+i[8]*s+i[12])*c,n.y=(i[1]*o+i[5]*a+i[9]*s+i[13])*c,n.z=(i[2]*o+i[6]*a+i[10]*s+i[14])*c,n}function vr(e,t,n=new E){const o=e.x,a=e.y,s=e.z,i=t.elements;return n.x=i[0]*o+i[4]*a+i[8]*s,n.y=i[1]*o+i[5]*a+i[9]*s,n.z=i[2]*o+i[6]*a+i[10]*s,st(n,n)}function Er(e,t,n,o=new S){const a=o.elements,s=je(e,t),i=Me(s);i===0?s.z=1:te(s,1/i,s);const c=Te(n,s),l=Me(c);l===0?(Math.abs(n.z)===1?n.x+=1e-4:n.z+=1e-4,st(n,n),Te(c,n,c)):te(c,1/l,c);const u=Te(s,c);return a[0]=c.x,a[4]=u.x,a[8]=s.x,a[1]=c.y,a[5]=u.y,a[9]=s.y,a[2]=c.z,a[6]=u.z,a[10]=s.z,o}const Sr=r({name:"math/mat4/constant",label:"Mat4",in:["mat4"],out:"mat4",exec:e=>e}),Tr=r({name:"math/mat4/convert/toMat4/column4",label:"Columns to Mat4",in:[{x:"vec4"},{y:"vec4"},{z:"vec4"},{w:"vec4"}],out:"mat4",exec:sr}),Nr=r({name:"math/mat4/setColumn",label:"Set Column",in:["mat4","integer","vec4"],out:"mat4",exec:or}),Mr=r({name:"math/mat4/setRow",label:"Set Row",in:["mat4","integer","vec4"],out:"mat4",exec:ar}),$r=r({name:"math/mat4/convert/toVec4",label:"Mat4 To Vec4",in:["mat4"],out:[{x:"vec4"},{y:"vec4"},{z:"vec4"},{w:"vec4"}],exec:()=>{throw new Error("not implemented")}}),zr=r({name:"math/mat4/basic/add",label:"+",in:["mat4","mat4"],out:"mat4",exec:ir}),Cr=r({name:"math/mat4/basic/subtract",label:"-",in:["mat4","mat4"],out:"mat4",exec:rr}),Ir=r({name:"math/mat4/negate",label:"-",in:["mat4"],out:"mat4",exec:lr}),qr=r({name:"math/mat4/basic/multiplyByScalar",label:"×",in:["mat4","float"],out:"mat4",exec:cr}),Or=r({name:"math/mat4/determinant",label:"Determinant",in:["mat4"],out:"float",exec:ur}),kr=r({name:"math/mat4/basic/adjoint",label:"Adjoint",in:["mat4"],out:"mat4",exec:mr}),Lr=r({name:"math/mat4/basic/inverse",label:"Inverse",in:["mat4"],out:"mat4",exec:hr}),jr=r({name:"math/mat4/transpose",label:"Transpose",in:["mat4"],out:"mat4",exec:fr}),Fr=r({name:"math/mat3/convert/toMat4",label:"Mat3 To Mat4",in:["mat3"],out:"mat4",exec:ft}),Ar=r({name:"math/mat4/convert/toMat4/scale3",label:"Scale3 To Mat4",in:["vec3"],out:"mat4",exec:Sn}),Pr=r({name:"math/mat4/convert/toMat4/translate3",label:"Translate3 To Mat4",in:["vec3"],out:"mat4",exec:Tn}),Dr=r({name:"math/quat/convert/toMat4",label:"Quat To Mat4",in:["quat"],out:"mat4",exec:En}),Vr=r({name:"math/euler/convert/toMat4",label:"Euler To Mat4",in:["euler"],out:"mat4",exec:vn}),Br=r({name:"math/mat4/translate",label:"Translate",in:["mat4","vec3"],out:"mat4",exec:pr}),_r=r({name:"math/mat4/basic/scale",label:"Scale",in:["mat4","vec3"],out:"mat4",exec:br}),Rr=r({name:"math/mat4/rotateByQuat",label:"Rotate",in:["mat4","quat"],out:"mat4",exec:wr}),Qr=r({name:"math/mat4/rotateByEuler",label:"Rotate",in:["mat4","euler"],out:"mat4",exec:xr}),Gr=r({name:"math/mat4/basic/multiply",label:"Matrix4 Multiply",in:["mat4","mat4"],out:"mat4",exec:de}),Ur=r({name:"math/mat4/basic/mix",label:"Matrix4 Mix",in:[{a:"mat4"},{b:"mat4"},{t:"float"}],out:"mat4",exec:yn}),Hr=r({name:"math/mat4/convert/equal",label:"=",in:[{a:"mat4"},{b:"mat4"},{tolerance:"float"}],out:"boolean",exec:xn}),Xr=r({name:"math/mat4/transformPoint3",label:"Transform Point3",in:["mat4","vec3"],out:"vec3",exec:yr}),Kr=r({name:"math/mat4/transformNormal3",label:"Transform Normal",in:["mat4","vec3"],out:"vec3",exec:vr}),Wr=r({name:"math/mat4/lookAt",label:"Look At",in:[{eye:"vec3"},{target:"vec3"},{up:"vec3"}],out:"mat4",exec:Er}),Yr=Object.freeze(Object.defineProperty({__proto__:null,Add:zr,Adjoint:kr,Column4ToMat4:Tr,Constant:Sr,Determinant:Or,Elements:$r,Equal:Hr,EulerToMat4:Vr,Inverse:Lr,LookAt:Wr,Mat3ToMat4:Fr,Mix:Ur,Multiply:Gr,MultiplyByScalar:qr,Negate:Ir,QuatToMat4:Dr,RotateByEuler:Qr,RotateByQuat:Rr,Scale:_r,Scale3ToMat4:Ar,SetColumn:Nr,SetRow:Mr,Subtract:Cr,TransformNormal3:Kr,TransformPoint3:Xr,Translate:Br,Translate3ToMat4:Pr,Transpose:jr},Symbol.toStringTag,{value:"Module"})),Zr=r({name:"math/quat/constants",label:"Quaternion",in:["quat"],out:"quat",exec:e=>e}),Jr=r({name:"math/float/convert/toQuat",label:"Float to Quat",in:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],out:"quat",exec:(e,t,n,o)=>new M(e,t,n,o)}),ec=r({name:"math/quat/convert/toFloat",label:"Quat to Float",in:["quat"],out:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],exec:Js}),tc=r({name:"math/quat/conjugate",label:"Conjugate",in:["quat"],out:"quat",exec:ei}),nc=r({name:"math/quat/basic/multiply",label:"×",in:["quat","quat"],out:"quat",exec:ti}),oc=r({name:"math/quat/basic/scale",label:"×",in:["quat","float"],out:"quat",exec:Ae}),ac=r({name:"math/quat/length",label:"Length",in:["quat"],out:"float",exec:ct}),sc=r({name:"math/quat/normalize",label:"Normalize",in:["quat"],out:"quat",exec:lt}),ic=r({name:"math/quat/basic/dot",label:"Dot Product",in:["quat","quat"],out:"float",exec:Pe}),rc=r({name:"math/quat/transcendental/ln",label:"Ln",in:["quat"],out:"quat",exec:hn}),cc=r({name:"math/quat/transcendental/exp",label:"Exp",in:["quat"],out:"quat",exec:fn}),lc=r({name:"math/quat/transcendental/pow",label:"Pow",in:["quat","float"],out:"quat",exec:ni}),uc=r({name:"math/mat3/convert/toQuat",label:"To Quat",in:["mat3"],out:"quat",exec:dn}),mc=r({name:"math/mat4/convert/toQuat",label:"To Quat",in:["mat4"],out:"quat",exec:si}),fc=r({name:"math/euler/convert/toQuat",label:"÷",in:["euler"],out:"quat",exec:oi}),hc=r({name:"math/quat/convert/toQuat/angleAxis",label:"Angle Axis to Quat",in:["float","vec3"],out:"quat",exec:ai}),dc=r({name:"math/quat/slerp",label:"Slerp",in:[{a:"quat"},{b:"quat"},{t:"float"}],out:"quat",exec:mn}),gc=r({name:"math/quat/compare/equal",label:"=",in:[{a:"quat"},{b:"quat"},{tolerance:"float"}],out:"boolean",exec:Fe}),pc=Object.freeze(Object.defineProperty({__proto__:null,AngleAxisToQuat:hc,Constant:Zr,Create:Jr,Dot:ic,Elements:ec,Equal:gc,EulerToQuat:fc,Exp:cc,Length:ac,Ln:rc,Mat3ToQuat:uc,Mat4ToQuat:mc,Multiply:nc,Negate:tc,Normalize:sc,Pow:lc,Scale:oc,Slerp:dc},Symbol.toStringTag,{value:"Module"})),bc=r({name:"math/vec2/constant",label:"Vec2",in:["vec2"],out:"vec2",exec:e=>e}),wc=r({name:"math/float/convert/toVec2",label:"Float to Vec2",in:[{x:"float"},{y:"float"}],out:"vec2",exec:(e,t)=>new F(e,t)}),xc=r({name:"math/vec2/convert/toFloat",label:"Vec2 To Float",in:["vec2"],out:[{x:"float"},{y:"float"}],exec:Ts}),yc=r({name:"math/vec2/basic/add",label:"+",in:["vec2","vec2"],out:"vec2",exec:xs}),vc=r({name:"math/vec2/basic/subtract",label:"-",in:["vec2","vec2"],out:"vec2",exec:ys}),Ec=r({name:"math/vec2/negate",label:"-",in:["vec2"],out:"vec2",exec:vs}),Sc=r({name:"math/vec2/basic/scale",label:"×",in:["vec2","float"],out:"vec2",exec:Zt}),Tc=r({name:"math/vec2/length",label:"Length",in:["vec2"],out:"float",exec:Jt}),Nc=r({name:"math/vec2/normalize",label:"Normalize",in:["vec2"],out:"vec2",exec:Es}),Mc=r({name:"math/vec2/basic/dot",label:"Dot Product",in:["vec2","vec2"],out:"float",exec:en}),$c=r({name:"math/vec2/basic/mix",label:"÷",in:[{a:"vec2"},{b:"vec2"},{t:"float"}],out:"vec2",exec:tn}),zc=r({name:"math/vec2/compare/equal",label:"=",in:[{a:"vec2"},{b:"vec2"},{tolerance:"float"}],out:"boolean",exec:ws}),Cc=Object.freeze(Object.defineProperty({__proto__:null,Add:yc,Constant:bc,Create:wc,Dot:Mc,Elements:xc,Equal:zc,Length:Tc,Mix:$c,Negate:Ec,Normalize:Nc,Scale:Sc,Subtract:vc},Symbol.toStringTag,{value:"Module"})),Ic=r({name:"math/vec3/constant",label:"Vec3",in:["vec3"],out:"vec3",exec:e=>e}),qc=r({name:"math/float/convert/toVec3",label:"Float to Vec3",in:[{x:"float"},{y:"float"},{z:"float"}],out:"vec3",exec:(e,t,n)=>new E(e,t,n)}),Oc=r({name:"math/vec3/convert/toFloat",label:"Vec3 To Float",in:["vec3"],out:[{x:"float"},{y:"float"},{z:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z})}),kc=r({name:"math/vec3/basic/add",label:"+",in:["vec3","vec3"],out:"vec3",exec:ot}),Lc=r({name:"math/vec3/basic/subtract",label:"-",in:["vec3","vec3"],out:"vec3",exec:je}),jc=r({name:"math/vec3/negate",label:"-",in:["vec3"],out:"vec3",exec:at}),Fc=r({name:"math/vec3/basic/scale",label:"×",in:["vec3","float"],out:"vec3",exec:te}),Ac=r({name:"math/vec3/length",label:"Length",in:["vec3"],out:"float",exec:Me}),Pc=r({name:"math/vec3/normalize",label:"Normalize",in:["vec3"],out:"vec3",exec:st}),Dc=r({name:"math/vec3/basic/cross",label:"Cross",in:["vec3","vec3"],out:"vec3",exec:Te}),Vc=r({name:"math/vec3/basic/dot",label:"Dot",in:["vec3","vec3"],out:"float",exec:sn}),Bc=r({name:"math/vec3/basic/mix",label:"÷",in:[{a:"vec3"},{b:"vec3"},{t:"float"}],out:"vec3",exec:ie}),_c=r({name:"math/vec3/compare/equal",label:"=",in:[{a:"vec3"},{b:"vec3"},{tolerance:"float"}],out:"boolean",exec:se}),Rc=Object.freeze(Object.defineProperty({__proto__:null,Add:kc,Constant:Ic,Create:qc,Cross:Dc,Dot:Vc,Elements:Oc,Equal:_c,Length:Ac,Mix:Bc,Negate:jc,Normalize:Pc,Scale:Fc,Subtract:Lc},Symbol.toStringTag,{value:"Module"})),Qc=r({name:"math/vec4/constant",label:"Vec4",in:["vec4"],out:"vec4",exec:e=>e}),Gc=r({name:"math/float/convert/toVec4",label:"Float to Vec4",in:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],out:"vec4",exec:(e,t,n,o)=>new M(e,t,n,o)}),Uc=r({name:"math/vec4/convert/toFloat",label:"Vec4 to Float",in:["vec4"],out:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z,w:e.z})}),Hc=r({name:"math/vec4/basic/add",label:"+",in:["vec4","vec4"],out:"vec4",exec:Ws}),Xc=r({name:"math/vec4/basic/subtract",label:"-",in:["vec4","vec4"],out:"vec4",exec:Ys}),Kc=r({name:"math/vec4/negate",label:"-",in:["vec4"],out:"vec4",exec:ln}),Wc=r({name:"math/vec4/basic/scale",label:"×",in:["vec4","float"],out:"vec4",exec:Ae}),Yc=r({name:"math/vec4/length",label:"Length",in:["vec4"],out:"float",exec:ct}),Zc=r({name:"math/vec4/normalize",label:"Normalize",in:["vec4"],out:"vec4",exec:lt}),Jc=r({name:"math/vec4/basic/dot",label:"Dot Product",in:["vec4","vec4"],out:"float",exec:Pe}),el=r({name:"math/vec4/basic/mix",label:"÷",in:[{a:"vec4"},{b:"vec4"},{t:"float"}],out:"vec4",exec:ut}),tl=r({name:"math/vec4/compare/equal",label:"=",in:[{a:"vec4"},{b:"vec4"},{tolerance:"float"}],out:"boolean",exec:Fe}),nl=Object.freeze(Object.defineProperty({__proto__:null,Add:Hc,Constant:Qc,Create:Gc,Dot:Jc,Elements:Uc,Equal:tl,Length:Yc,Mix:el,Negate:Kc,Normalize:Zc,Scale:Wc,Subtract:Xc},Symbol.toStringTag,{value:"Module"})),Ge=ae(()=>Object.fromEntries([pn,bn,wn,rn,cn,gn,il,rl].map(n=>[n.name,n]))),ol=e=>Object.keys(e).flatMap(t=>Je({values:e,valueTypeName:t})),al=ae(()=>{Object.keys({...he(),...Ge()});const e=[...j(Cc),...j(Rc),...j(nl),...j(yi),...j(ki),...j(pc),...j(nr),...j(Yr),...ol(Ge())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),sl=e=>({values:{...e.values,...he(),...Ge()},nodes:{...e.nodes,...al()},dependencies:{...e.dependencies}}),il={name:"mat3",creator:()=>new C,deserialize:e=>typeof e=="string"?Ps(e):new C(e),serialize:e=>e.elements,lerp:(e,t,n)=>on(e,t,n),equals:(e,t)=>nn(e,t),clone:e=>e.clone()},rl={name:"mat4",creator:()=>new S,deserialize:e=>typeof e=="string"?gr(e):new S(e),serialize:e=>e.elements,lerp:(e,t,n)=>yn(e,t,n),equals:(e,t)=>xn(e,t),clone:e=>e.clone()};function ue(e){if(e===null)return"Null";if(e===void 0)return"Undefined";if(Number.isNaN(e))return"NaN";const t=Object.prototype.toString.call(e).slice(8,-1);return t==="AsyncFunction"?"Promise":t}const{isArray:ht}=Array;function cl(e,t="."){return typeof e=="string"?e.split(t):e}const ll=e=>Array.prototype.slice.call(e);function ul(e){return e<<0===e}const Ve=Number.isInteger||ul;function dt(e,t=[]){return(...n)=>(o=>o.length>=e.length?e(...o):dt(e,o))([...t,...n])}function ml(e,t,n){return Object.assign({},n,{[e]:t})}const fl=dt(ml);function Nn(e,t,n){const o=typeof e=="string"?e.split(".").map(s=>Ve(Number(s))?Number(s):s):e;if(o.length===0)return t;const a=o[0];if(o.length>1){const i=typeof n!="object"||n===null||!n.hasOwnProperty(a)?Ve(o[1])?[]:{}:n[a];t=Nn(Array.prototype.slice.call(o,1),t,i)}if(Ve(a)&&ht(n)){const s=ll(n);return s[a]=t,s}return fl(a,t,n)}const hl=dt(Nn);function De(e,t){if(arguments.length===1)return s=>De(e,s);if(t==null)return;let n=t,o=0;const a=cl(e);for(;o<a.length;){if(n==null||n[a[o]]===null)return;n=n[a[o]],o++}return n}function dl(e,t){if(!ht(t))throw new Error(`Cannot read property 'indexOf' of ${t}`);const n=ue(e);if(!["Object","Array","NaN","RegExp"].includes(n))return t.indexOf(e);let o=-1,a=-1;const{length:s}=t;for(;++o<s&&a===-1;)Z(t[o],e)&&(a=o);return a}function kt(e){const t=[];let n;for(;!(n=e.next()).done;)t.push(n.value);return t}function gl(e,t){if(e.size!==t.size)return!1;const n=kt(e.values()),o=kt(t.values());return n.filter(s=>dl(s,o)===-1).length===0}function Lt(e){const t=e.__proto__.toString();return["Error","TypeError"].includes(t)?[t,e.message]:[]}function jt(e){return e.toDateString?[!0,e.getTime()]:[!1]}function Ft(e){return e.constructor!==RegExp?[!1]:[!0,e.toString()]}function Z(e,t){if(arguments.length===1)return u=>Z(e,u);const n=ue(e);if(n!==ue(t))return!1;if(n==="Function")return e.name===void 0?!1:e.name===t.name;if(["NaN","Undefined","Null"].includes(n))return!0;if(n==="Number")return Object.is(-0,e)!==Object.is(-0,t)?!1:e.toString()===t.toString();if(["String","Boolean"].includes(n))return e.toString()===t.toString();if(n==="Array"){const u=Array.from(e),m=Array.from(t);if(u.toString()!==m.toString())return!1;let f=!0;return u.forEach((h,g)=>{f&&h!==m[g]&&!Z(h,m[g])&&(f=!1)}),f}const o=Ft(e),a=Ft(t);if(o[0])return a[0]?o[1]===a[1]:!1;if(a[0])return!1;const s=jt(e),i=jt(t);if(s[0])return i[0]?s[1]===i[1]:!1;if(i[0])return!1;const c=Lt(e),l=Lt(t);if(c[0])return l[0]?c[0]===l[0]&&c[1]===l[1]:!1;if(n==="Set")return gl(e,t);if(n==="Object"){const u=Object.keys(e);if(u.length!==Object.keys(t).length)return!1;let m=!0;return u.forEach(f=>{if(m){const h=e[f],g=t[f];h!==g&&!Z(h,g)&&(m=!1)}}),m}return!1}function Mn(e){const t=ht(e)?Array(e.length):{};if(e&&e.getTime)return new Date(e.getTime());for(const n in e){const o=e[n];t[n]=typeof o=="object"&&o!==null?o.getTime?new Date(o.getTime()):Mn(o):o}return t}function Ue(e,t){if(arguments.length===1)return o=>Ue(e,o);const n=Mn(e);return Object.keys(t).forEach(o=>{ue(t[o])==="Object"&&ue(e[o])==="Object"?n[o]=Ue(e[o],t[o]):n[o]=t[o]}),n}function $n(e,t){return arguments.length===1?n=>$n(e,n):typeof e=="string"?`${e}${t}`:[...e,...t]}const pl={name:"list",creator:()=>[],deserialize:e=>typeof e=="string"?JSON.parse(e):e,serialize:e=>JSON.stringify(e),equals:(e,t)=>Z(e,t),clone:e=>e,lerp:e=>{throw new Error("Not implemented")}},zn=ae(()=>Object.fromEntries([Ol,pl].map(n=>[n.name,n]))),bl=e=>Object.keys(e).flatMap(t=>Je({values:e,valueTypeName:t})),wl=ae(()=>{const e=[...j(Xn),...j(Hn),...bl(zn())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),xl=e=>({values:{...e.values,...zn()},nodes:{...e.nodes,...wl()},dependencies:{...e.dependencies}}),yl=r({name:"logic/list/constant",category:v.Logic,label:"List",in:["list"],out:"list",exec:e=>e}),vl=r({name:"logic/list/compare/equal",category:v.Logic,label:"=",in:["list","list"],out:"boolean",exec:(e,t)=>Z(e,t)}),He=me({typeName:"logic/list/concat",category:v.Logic,configuration:{numInputs:{valueType:"number",defaultValue:2}},label:"Concat",in:e=>{var o;const t=[],n=a=>({key:`list${a}`,valueType:"list"});for(const a of Y(1,(e.numInputs??((o=He.configuration)==null?void 0:o.numInputs.defaultValue))+1))t.push({...n(a)});return t},out:{result:"list"},exec:({read:e,write:t,configuration:n})=>{var a;let o=[];for(const s of Y(1,(n.numInputs??((a=He.configuration)==null?void 0:a.numInputs.defaultValue))+1)){const i=e(`componentName${s}`);o=$n(o,i)}t("result",o)}}),El=A({typeName:"logic/list/loop",category:v.Logic,label:"list Loop",in:{flow:"flow",list:"list",startIndex:"integer",endIndex:"integer"},out:{loopBody:"flow",index:"integer",value:"string",completed:"flow"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("list"),a=Math.max(0,Number(e("startIndex"))||0),s=Math.min(o.length,Number(e("endIndex"))||o.length),i=c=>{c<s?(t("value",JSON.stringify(o[c])),t("index",c),n("loopBody",()=>{i(c+1)})):n("completed")};i(a)}}),Sl=me({typeName:"logic/list/getIndex",category:v.Logic,label:"get Index",in:{list:"list",index:"integer"},out:{index:"integer",value:"string"},exec:({read:e,write:t})=>{const n=e("list"),o=e("index");z.mustBeTrue(o>=0&&o<n.length,"ERROR: index out of range"),t("index",o),t("value",JSON.stringify(n[o]))}}),Tl=me({typeName:"logic/list/getLength",category:v.Logic,label:"get Length",in:{list:"list"},out:{length:"integer"},exec:({read:e,write:t})=>{const n=e("list");t("length",n.length)}}),Nl=r({name:"logic/object/constant",category:v.Logic,label:"Object",in:["object"],out:"object",exec:e=>e}),Ml=r({name:"logic/object/compare/equal",category:v.Logic,label:"=",in:["object","object"],out:"boolean",exec:(e,t)=>Z(e,t)}),$l=r({name:"logic/assocPath/object",category:v.Logic,label:"Assoc Path",in:[{path:"string"},{newValue:"object"},{obj:"object"}],out:"object",exec:(e,t,n)=>{const o=e.split(".");return hl(o,t,n)}}),zl=r({name:"logic/object/mergeDeep",category:v.Logic,label:"Merge Deep",in:["object","object"],out:"object",exec:(e,t)=>Ue(e,t)}),Cl=r({name:"logic/object/path/object",category:v.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"object",exec:(e,t)=>De(e,t)}),Il=r({name:"logic/object/path/string",category:v.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"string",exec:(e,t)=>De(e,t)}),ql=r({name:"logic/object/path/integer",category:v.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"integer",exec:(e,t)=>De(e,t)}),Ol={name:"object",creator:()=>[],deserialize:e=>typeof e=="string"?JSON.parse(e):e,serialize:e=>JSON.stringify(e),equals:(e,t)=>e===t,clone:e=>e,lerp:e=>{throw new Error("Not implemented")}};class kl{constructor(){p(this,"onSceneChanged",new K);p(this,"sceneVariables",{});p(this,"statePropertiesPaths",{});p(this,"valueRegistry");this.valueRegistry=Object.fromEntries([Xt,Yt,Wt,Kt,pn,bn,wn,rn,cn,gn].map(t=>[t.name,t])),Object.entries(Bn.store.stateMap).forEach(t=>{const n={};Object.keys(t[1]).forEach(o=>{n[o]=o}),this.statePropertiesPaths[t[0]]=n})}getProperty(t){const n=t.split(".");let o=this.sceneVariables;for(const a of n){if(!o[a])return;o=o[a]}return o}setProperty(t,n,o){var s;const a=t.split(".");o=o??((s=this.valueRegistry[n])==null?void 0:s.creator()),this.sceneVariables=a.reduceRight((i,c)=>({[c]:i}),o),this.onSceneChanged.emit()}addOnClickedListener(t,n){console.log("added on clicked listener")}removeOnClickedListener(t,n){console.log("removed on clicked listener")}getQueryableProperties(){return[]}getRaycastableProperties(){return[]}getStateProperties(t){const n=t?this.statePropertiesPaths[t]:this.statePropertiesPaths,o=[],a=[{node:n,path:""}];for(;a.length>0;){const{node:s,path:i}=a.pop();for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const l=i?`${i}.${c}`:c;typeof s[c]=="object"?a.push({node:s[c],path:l}):o.push(l)}}return o}getProperties(){const t=[],n=[{node:this.sceneVariables,path:""}];for(;n.length>0;){const{node:o,path:a}=n.pop();for(const s in o)if(Object.prototype.hasOwnProperty.call(o,s)){const i=a?`${a}.${s}`:s;typeof o[s]=="object"?n.push({node:o[s],path:i}):t.push(i)}}return t}addOnSceneChangedListener(){console.log("added on scene changed listener")}removeOnSceneChangedListener(){console.log("removed on scene changed listener")}}const Ll=()=>{let e=bs({values:{},nodes:{},dependencies:{ILogger:new vo,ILifecycleEventEmitter:new Eo,IScene:new kl}});return e=sl(e),e=xl(e),e},jl=[{id:"4bb99f89-11c4-471e-ba46-f507d86ffc93",type:"flow/lifecycle/onExecute",metadata:{positionX:"4.753700030301175",positionY:"-330.7364926607548"}},{id:"0",type:"flow/lifecycle/onStart",metadata:{positionX:"2.1104424778760915",positionY:"-501.2300884955752"},flows:{flow:{nodeId:"2",socket:"flow"}}},{id:"2",type:"debug/log",metadata:{positionX:"270.5933446233562",positionY:"-504.0538689099578"},parameters:{text:{value:"DEBUG hello"}}}],Fl=[],Al=[],Pl={nodes:jl,variables:Fl,customEvents:Al},Cn=_n({name:"VisualScriptState",initial:()=>{const e=Ll();return{templates:[],registries:{ECS:e}}},registerProfile:(e,t)=>{Rn(Cn).registries[t].set(n=>e(n))}});let In=0,ve;const Dl=()=>"visual-script-asyncExecute"+In,Vl=({visualScriptJson:e,autoRun:t=!1,registry:n})=>{var m;const[o,a]=B.useState(),[s,i]=B.useState(t),c=B.useCallback(()=>{i(!0)},[]),l=B.useCallback(()=>{i(!1)},[]),u=B.useCallback(()=>{i(f=>!f)},[]);return B.useEffect(()=>{if(!e||!n.values||!s||!n.dependencies)return;let f;try{f=to({graphJson:e,registry:n}).nodes}catch(g){console.error(g);return}const h=new Yn(f);return a(h),()=>{h.dispose(),a(void 0)}},[e,n.values,s,n.nodes,n.dependencies]),B.useEffect(()=>{var h;if(!o||!s)return;const f=(h=n.dependencies)==null?void 0:h.ILifecycleEventEmitter;if(o.executeAllSync(),f.startEvent.listenerCount===0){console.warn("No onStart Node found in graph.  Graph will not run.");return}return f.startEvent.emit(),o.asyncNodes.length&&ve===void 0&&(In++,ve=kn({uuid:Dl(),execute:()=>{!o||!s||o.executeAllAsync(500)},insert:{after:Ln}})),()=>{ve!==void 0&&(ve=void 0)}},[o,(m=n.dependencies)==null?void 0:m.ILifecycleEventEmitter,s]),{engine:o,playing:s,play:c,togglePlay:u,pause:l}},At={ECS:"ECS"},J=jn({name:"VisualScriptComponent",jsonID:"EE_visual_script",schema:re.Object({domain:re.Enum(At,{$comment:"A string enum, ie. one of the following values: 'ECS'",default:At.ECS}),visualScript:re.Type({default:()=>wt(Pl),deserialize(e,t){return t&&wt(t)}}),run:re.Bool(),disabled:re.Bool()}),reactor:()=>{const e=Fn(),t=Bt(e,J),n=Qn(Cn),o=t.run.value&&!t.disabled.value,a=n.registries[t.domain.value].get({noproxy:!0}),s=An(e,[_t]),i=Vl({visualScriptJson:t.visualScript.get({noproxy:!0}),autoRun:o,registry:a});return B.useEffect(()=>{t.disabled.value||(t.run.value?i.play():i.pause())},[t.run]),B.useEffect(()=>{t.disabled.value&&t.run.set(!1)},[t.disabled]),s?ee.createElement(Bl,{entity:e,gltfAncestor:s,key:s}):null}}),Bl=e=>{const t=_t.useSceneLoaded(e.gltfAncestor);return B.useEffect(()=>(pt(e.entity,J,{run:!0}),()=>{Pn(e.entity,J)&&pt(e.entity,J,{run:!1})}),[t]),null},gt=e=>{const{t}=Un(),n=Bt(e.entity,J);return ee.createElement(Vn,{...e,name:"Visual Script Component",description:" Adds a visual script to the entity",Icon:gt.iconComponent},ee.createElement(yt,{name:"Disable Visual Script",label:"Disable Visual Script"},ee.createElement(xt,{checked:n.disabled.value,onChange:bt(J,"disabled")})),ee.createElement(yt,{name:"Play Visual Script",label:"Play Visual Script"},ee.createElement(xt,{checked:n.run.value,onChange:bt(J,"run")})))};gt.iconComponent=Dn;const _l={},$u={title:"Editor/Properties/VisualScript",component:gt,parameters:{componentSubtitle:"VisualScriptNodeEditor",jest:"visualScriptNodeEditor.test.tsx",design:{type:"figma",url:""}},argTypes:_l},Ee={args:{}};var Pt,Dt,Vt;Ee.parameters={...Ee.parameters,docs:{...(Pt=Ee.parameters)==null?void 0:Pt.docs,source:{originalSource:`{
  args: {}
}`,...(Vt=(Dt=Ee.parameters)==null?void 0:Dt.docs)==null?void 0:Vt.source}}};const zu=["Default"];export{Ee as Default,zu as __namedExportsOrder,$u as default};
