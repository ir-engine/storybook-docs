var w2=Object.defineProperty;var S2=(e,t,n)=>t in e?w2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var F=(e,t,n)=>(S2(e,typeof t!="symbol"?t+"":t,n),n);import{R as te,r as A}from"./index-CBqU2yxZ.js";import{U as Se,s as O,c as yt,S as _,o as ue,h as de,b as M,d as ie,a as ee,E as ht,G as T2,J as $g,p as ye,r as Qe,g as gt,e as je,m as Gt,l as It,Q as Xt,P as Yt,q as E2,i as Zn,v as M2,N as Zf,f as se,K as Rn,H as e1,k as Li,n as t1,w as n1,L as vn,M as Bs,O as Kf,R as Ft,V as P2,t as N2,C as _h}from"./index-_wFD3GG2.js";import{l as A2}from"./index-DJX7trsF.js";import{c as Hh}from"./Util-CG5_y5Pm.js";import{aL as C2,bq as _c,N as at,br as Ti,z as q,p as Lt,bs as L2,t as he,bt as o1,c as Hc,a as js,V as D2,q as yn,bu as i1,aF as On,bv as I2,bw as F2,bx as R2,by as O2,bz as k2,bA as V2,bB as U2,bC as qc,y as io,bf as Wc,bD as uc,h as Tt,bE as z2,aE as B2,bF as rn,bG as fc,bH as dc,bI as j2,aq as Yf,bJ as Qf,r as _2,bK as H2,bL as r1,aM as qh,bM as s1,aG as Kn,aK as Di,bN as q2,bO as Dt,bP as Wh,bQ as W2,aC as a1,k as Ei,aA as c1,bR as l1,bS as G2,av as Mi,aH as aa,at as _s,bT as tr,bU as Hs,F as Fu,bV as Gh,bW as u1,bX as f1,bY as X2,aD as Ns,n as Rt,w as Qo,aB as Z2,be as mt,bZ as Ru,a6 as Ii,b_ as K2,b$ as Y2,c0 as Ou,c1 as Q2,c2 as d1,c3 as J2,a9 as Jo,c4 as h1,c5 as ku,c6 as Xh,c7 as qs,c8 as $2,aj as p1,c9 as m1,ca as Zh,cb as ps,cc as Ro,cd as e3,ce as g1,a0 as v1,an as ms,cf as Kh,cg as Yh,ch as t3,ci as ca,v as Vu,O as Dn,R as Pr,cj as be,ck as n3,cl as o3,cm as i3,cn as ot,co as y1,cp as r3,cq as s3,cr as a3,cs as c3,ct as l3,cu as $o,aI as qt,cv as u3,cw as f3,cx as d3,cy as h3,cz as p3,cA as m3,cB as g3,cC as v3,cD as y3,cE as Ws,cF as di,cG as b3,cH as Xa,cI as x3,cJ as w3,cK as S3,cL as T3,cM as E3,cN as M3,cO as P3,cP as N3,cQ as A3,cR as C3,cS as L3,cT as D3,cU as I3,cV as F3,cW as R3,cX as O3,cY as $t,b6 as Jf,cZ as b1,c_ as k3,c$ as V3,d0 as U3,d1 as Uu,d2 as x1,M as Ye,d3 as w1,d4 as z3,d5 as B3,d6 as j3,ap as S1,ae as _3,bj as H3,j as q3,l as gs,d7 as W3,d8 as G3,d9 as zn,da as Vl,db as X3,dc as Z3,H as zu,dd as K3,de as Qh,T as Ul,b1 as Y3,df as Gc,dg as Bu,o as ju,bk as T1,X as E1,dh as Q3,U as J3,di as $3,dj as Jh,dk as M1,aP as P1,dl as $h,dm as ep,bn as N1,b9 as A1,L as Yn,ab as Xc,dn as e4,dp as tp,dq as $f,dr as t4,Z as C1,ds as n4,dt as o4,du as i4,dv as np,af as r4,a5 as L1,dw as D1,dx as I1,dy as s4,dz as op,dA as a4,x as c4,dB as zl,dC as l4,dD as u4,i as f4,dE as d4}from"./EditorServices-BJKHmurs.js";import{a as Oi,b as Q,n as W,u as Nr,c as We,g as B,N as dr,s as h4,e as ei,i as Ar,B as Zc,m as dt,H as p4,A as hc,X as m4,d as la}from"./ActionFunctions-CxzuxLxN.js";import{A as ge,b as g4,c as v4,d as y4,t as b4,e as ip,f as x4,g as ed,m as w4,u as S4,h as T4,M as Bl,S as F1,i as E4}from"./MountPointComponent-DF1pgIm2.js";import{L as Kc}from"./LoopAnimationComponent-DGEmReL7.js";import{V as P,k as ne,Q as re,M as Ht,E as Yc,g as Qn,t as As,i as ri,w as _u,v as Qc,S as Hu,F as vt,B as Cr,e as Jn,n as Gs,m as R1,at as O1,au as td,av as M4,h as k1,a as Me,G as j,as as V1,aw as Oe,a1 as hr,ax as U1,ag as me,l as nd,a4 as ki,ay as bt,az as z1,aA as B1,R as Jc,aB as qu,p as Wu,ap as jl,U as Gu,aC as P4,aD as Xu,H as Vi,K as Xs,aE as vs,a2 as rp,aF as N4,aG as A4,aH as j1,aI as C4,aJ as sp,q as L4,aK as _l,aL as D4,aM as _1,aN as I4,aO as F4,O as $c,a3 as ap,$ as R4,j as H1,aP as O4,aQ as k4,aR as V4,aS as U4,am as z4,aT as B4,aU as j4,aV as _4,aW as H4,aX as q4,aY as W4,aZ as cp,J as ko,T as cs,ai as q1,o as kt,a0 as lp,an as G4,a_ as X4,a$ as Z4,b0 as K4,ao as Y4,s as W1,N as Q4,A as J4,b as $4,c as eb,d as tb}from"./three.module-D2RMN07C.js";import{f as G1,g as X1,a as nb}from"./VideoComponent-TZ9Icu9Q.js";import{X as xt,R as Z1,a as up,i as Lr}from"./XRState-BS8ja_cl.js";import{e as ua,f as ob,c as od,b as pc,a as K1,O as Y1,g as ib}from"./MathLerpFunctions-CYXVD2J2.js";import{P as mc}from"./PositionalAudioComponent-CGM_4wyN.js";import{a as rb,b as sb,M as ti,P as gc}from"./MediaComponent-BbvQujMt.js";import"./MediaSystem-C5w1lrFL.js";import{e as ab,d as cb,W as lb}from"./WebContainer3D-CgDOwl0k.js";import{b as K}from"./EditorControlFunctions-DO7c3hDV.js";import{l as oi}from"./lodash-BYTxXjAY.js";import"./CameraSettingsComponent-DBFrQ73i.js";import{P as ub,c as ir,b as Q1}from"./PortalComponent-CME2GO_9.js";import{V as id}from"./VolumetricComponent-ByPzRWY2.js";import{d as fb}from"./ParticleSystemComponent-DGK1fC-S.js";import{S as Zu}from"./SceneDynamicLoadTagComponent-DABH_32v.js";import"./ScenePreviewCamera-C6tUz1E8.js";import"./SpawnPointComponent-DjObVp3f.js";import{S as J1}from"./SplineComponent-B7IoO90d.js";import{S as fp}from"./SplineTrackComponent-vG19gFTT.js";import"./TextComponent-WCDSB2u1.js";import{g as Ku}from"./meshUtils-uAuBfJNJ.js";import{B as dp}from"./index-CCAuFDbE.js";import{I as hp}from"./index-DZ02_pf3.js";import{N as db}from"./index-BXX5lIfA.js";import{u as hb}from"./useTranslation-C8TD7CCW.js";import"./_commonjsHelpers-BosuxZz1.js";import"./v4-Dz_GI0CC.js";import"./iconBase-vdkxwKJc.js";import"./AssetType-LSGL9ANY.js";import"./NotificationService-BtHCxsFA.js";import"./index-DfU-XIjm.js";import"./index-DaaykCGs.js";import"./client-DMi1NERe.js";import"./ArrowHelperComponent-C9MpZgBb.js";import"./iframe-BwaUBtZe.js";import"../sb-preview/runtime.js";import"./index-DCS5Ru-F.js";import"./index-vJCBmx79.js";import"./index-CqRG3f1I.js";import"./tw-merge-Ds6tgvmq.js";import"./index-DWVs1sLR.js";import"./index-6-YOBPgK.js";/* empty css                */import"./index-DVAwpzAq.js";import"./index-ChWBCYBM.js";import"./index-BqFAen_F.js";import"./index-DGVNGK2X.js";import"./index-CGhkeU3i.js";import"./nonIterableRest-Y-KoC6Zs.js";const pb=Object.freeze(Object.defineProperty({__proto__:null,get Concat(){return Hf},get Constant(){return MC},get Equal(){return PC},get ListLoop(){return NC},get getIndex(){return AC},get getLength(){return CC}},Symbol.toStringTag,{value:"Module"})),mb=Object.freeze(Object.defineProperty({__proto__:null,get AssocPath(){return IC},get Constant(){return LC},get Equal(){return DC},get MergeDeep(){return FC},get Path(){return RC},get PathAsInteger(){return kC},get PathAsString(){return OC}},Symbol.toStringTag,{value:"Module"})),pp=/^(?:.*\/(?:projects|static-resources)\/([^\/]*)\/([^\/]*)\/((?:assets\/|).*)$)/,Za=Oi({name:"ee.engine.avatar.AvatarIKTargetState",initial:{},receptors:{onSpawn:C2.spawnIKTarget.receive(e=>{Q(Za)[e.entityUUID].merge({name:e.name})}),onDestroyObject:_c.destroyEntity.receive(e=>{Q(Za)[e.entityUUID].set(W)})},reactor:()=>{const e=Nr(Za);return te.createElement(te.Fragment,null,e.keys.map(t=>te.createElement(gb,{key:t,entityUUID:t})))}}),gb=({entityUUID:e})=>{const t=We(Q(Za)[e]),n=Se.useEntityByUUID(e);return A.useLayoutEffect(()=>{n&&(O(n,at,t.name.value),O(n,ge))},[n]),null},Xn=yt({name:"TweenComponent",schema:_.Type()}),$1=(e,t)=>{var o;const n=e.humanoid._normalizedHumanBones;for(const i of Ti){const r=n.original.getBoneNode(i);if(r!=null){const s=n.getBoneNode(i);delete q.dirtyTransforms[s.entity];const a=n._parentWorldRotations[i],c=vb.copy(a).invert(),l=n._boneRotations[i];if(r.quaternion.copy(s.quaternion).multiply(a).premultiply(c).multiply(l),i==="hips"){const u=r.entity,d=(o=ue(u,Lt))==null?void 0:o.parentEntity;if(!d)continue;const f=ue(d,L2)??ue(d,q);if(!f)continue;fa.copy(s.position).applyMatrix4(f==null?void 0:f.matrixWorld),mp.copy(f.matrixWorld).invert(),fa.applyMatrix4(mp),de(t,he)&&fa.multiplyScalar(M(t,he).hipsHeight),r.position.copy(fa)}}}},vb=new re,fa=new P,mp=new ne,yb=ie([Xn]),bb=ie([Hc,yn]),xb=ie([Hc,Kc,js,q]),wb=()=>{const{deltaSeconds:e}=B(ht);for(const t of yb())M(t,Xn).update();for(const t of bb()){const n=M(t,Hc),o=e;n.mixer.update(o);const i=T2(t,Kc);i!=null&&i._action.value&&(i==null||i.time.set(i._action.value.time))}for(const t of xb()){const n=M(t,js);n.asset instanceof D2&&$1(n.asset,t)}},Sb=ee({uuid:"ee.engine.AnimationSystem",insert:{before:o1},execute:wb}),gp=(e,t,n)=>{const o=Object.values(i1);for(let i=0;i<o.length;i++){const r=o[i],s=`${t}${r}`,a=e.humanoid.getNormalizedBone(s);a!=null&&a.node&&a.node.quaternion.fromArray(n,i*4)}},vp=(e,t,n,o,i,r)=>{const s=M(e,q),a=Tb.copy(s.matrixWorld).invert();yp.copy(t).applyMatrix4(a);const c=Eb.copy(s.rotation).invert().multiply(n);r.set(i==="left"?-.25:.25,-.25,0).applyQuaternion(c).add(yp);const l=Mb.copy(o).applyMatrix4(a);r.x=i==="left"?Math.max(r.x,l.x+.05):Math.min(r.x,l.x-.05),r.applyMatrix4(s.matrixWorld)},Tb=new ne,Eb=new re,Mb=new P,yp=new P;function bp(e,t,n){const o=Ht.clamp((t*t+n*n-e*e)/(t*n*2),-1,1);return Math.acos(o)}new P;function da(e,t,n,o,i,r,s=null){xp.copy(i),Xl.copy(r),t.world.multiplyMatrices(e,t.local),gi.setFromMatrixPosition(t.world),n.world.multiplyMatrices(t.world,n.local),qr.setFromMatrixPosition(n.world),o.world.multiplyMatrices(n.world,o.local),Wr.setFromMatrixPosition(o.world),Bi.subVectors(qr,gi),ql.subVectors(Wr,qr),Gr.subVectors(Wr,gi),Xr.subVectors(xp,gi);const a=Bi.length(),c=ql.length(),l=Gr.length(),u=a+c;Xr.lengthSq()>u*u&&Xr.normalize().multiplyScalar((a+c)*.999);const d=Xr.length(),f=bp(l,a,c),h=bp(d,a,c),p=f-h;wp.crossVectors(Bi,ql),zi.setFromAxisAngle(wp.normalize(),p);const g=Ka(n.world,new re);g.premultiply(zi),ha(g,t.world),n.local.compose(pa.setFromMatrixPosition(n.local),g,ua),n.world.multiplyMatrices(t.world,n.local),o.world.multiplyMatrices(n.world,o.local),zi.setFromUnitVectors(ji.copy(Gr).normalize(),Nb.copy(Xr).normalize());const m=Ka(t.world,new re);if(m.premultiply(zi),ha(m,e),t.local.compose(pa.setFromMatrixPosition(t.local),m,ua),s&&l>0&&(n.world.multiplyMatrices(t.world,n.local),o.world.multiplyMatrices(n.world,o.local),t.world.multiplyMatrices(e,t.local),qr.setFromMatrixPosition(n.world),Wr.setFromMatrixPosition(o.world),Bi.subVectors(qr,gi),Gr.subVectors(Wr,gi),Wl.copy(s).sub(gi),ji.copy(Gr).divideScalar(l),Sp.copy(Bi).addScaledVector(ji,-Bi.dot(ji)),Gl.copy(Wl).addScaledVector(ji,-Wl.dot(ji)),Gl.lengthSq()>0)){zi.setFromUnitVectors(Sp,Gl);const v=Ka(t.world,new re);v.premultiply(zi),ha(v,e),t.local.compose(pa.setFromMatrixPosition(t.local),v,ua)}ha(Xl,n.world),o.local.compose(pa.setFromMatrixPosition(o.local),Xl,ua)}const Hl=new P,Mn=new ne,Ka=(e,t)=>{const n=e.elements;let o=Hl.set(n[0],n[1],n[2]).length();const i=Hl.set(n[4],n[5],n[6]).length(),r=Hl.set(n[8],n[9],n[10]).length();e.determinant()<0&&(o=-o),Mn.copy(e);const a=1/o,c=1/i,l=1/r;return Mn.elements[0]*=a,Mn.elements[1]*=a,Mn.elements[2]*=a,Mn.elements[4]*=c,Mn.elements[5]*=c,Mn.elements[6]*=c,Mn.elements[8]*=l,Mn.elements[9]*=l,Mn.elements[10]*=l,t.setFromRotationMatrix(Mn),t},Pb=new re,ha=(e,t)=>{if(!t)return e;const n=Ka(t,Pb).invert();return e.premultiply(n),e},xp=new P,gi=new P,qr=new P,Wr=new P,zi=new re,wp=new P,Bi=new P,ql=new P,Gr=new P,Xr=new P,Wl=new P,ji=new P,Nb=new P,Sp=new P,Gl=new P,Xl=new re,pa=new P,Tp=new re,ma=(e,t,n)=>{const o=M(e,On);for(const i of t){const r=o.ikMatrices[i];if(r){const s=o.vrm.humanoid.getNormalizedBoneNode(i);Tp.setFromRotationMatrix(r.local),s.quaternion.fastSlerp(Tp,n)}}},Ab=(e,t)=>{const n=I2(e);let o=0;F2(n,1<<o++)&&R2(e,ge.blendWeight,t)},Cb=(e,t)=>{const n=O2(e),o=k2(e);let i=0,r=0;const s=de(t,V2)&&Math.round(B(ht).simulationTime%B(ht).periodicUpdateFrequency)===0;return i|=U2(e,ge.blendWeight,t,s)?1<<r++:r++&&0,i>0&&o(i)||n()},ga={ID:"ee.engine.avatar.ik",readBlendWeight:Ab,writeBlendWeight:Cb},Lb=Oi({name:"AvatarAnimationState",initial:()=>({priorityQueue:G1({accumulationBudget:100}),sortedTransformEntities:[],visualizers:[]})}),Db=ie([Hc,uc,On]),e0=ie([he,Tt,uc]),Ib=new re,Ep=new re,Zl=new P,Wo=new P,Fb=new ne,va=new P(0,0,1),Rb=X1(e0,s1),Ob=()=>{var c;const{priorityQueue:e,sortedTransformEntities:t,visualizers:n}=B(Lb),{elapsedSeconds:o,deltaSeconds:i}=B(ht),r=he.getSelfAvatarEntity();for(const l of e0()){const u=M(l,uc),d=M(l,Tt);u.locomotion.x=0,u.locomotion.y=d.linearVelocity.y,u.locomotion.z=Ht.lerp(u.locomotion.z||0,Zl.copy(d.linearVelocity).setComponent(1,0).length(),10*i)}Rb(e,t,i);const s=Db(),a=[];for(let l=0;l<s.length;l++){const u=s[l];(e.priorityEntities.has(u)||u===r)&&a.push(u)}z2(a);for(const l of a){const u=M(l,On),d=M(l,he),f=M(l,uc);f.deltaAccumulator=o;const h=u.rawRig,p=u.normalizedRig;if(!((c=h==null?void 0:h.hips)!=null&&c.node))continue;const g=M(l,B2).ownerId,m=ge.getTargetEntity(g,rn.leftFoot),v=ue(m,q),y=ge.blendWeight[m],w=ge.getTargetEntity(g,rn.rightFoot),S=ue(w,q),T=ge.blendWeight[w],x=ge.getTargetEntity(g,rn.leftHand),E=ue(x,q),C=ge.blendWeight[x],L=ge.getTargetEntity(g,rn.rightHand),D=ue(L,q),R=ge.blendWeight[L],I=ge.getTargetEntity(g,rn.head),k=ge.blendWeight[I],V=M(l,q),X=M(l,Tt);if(k){const $=M(I,q);p.hips.node.position.set($.position.x,$.position.y-d.torsoLength-.125,$.position.z),va.set(0,0,1),va.applyQuaternion(X.rotation),va.multiplyScalar(.125),p.hips.node.position.sub(va),p.hips.node.position.applyMatrix4(Fb.copy(V.matrixWorld).invert()),Ep.copy($.rotation),p.head.node.quaternion.multiplyQuaternions(p.spine.node.getWorldQuaternion(Ib).invert(),Ep);const _e=V.matrixWorld.clone();_e.elements[13]=h.hips.node.position.y-V.position.y,p.hips.node.matrix.setPosition(new P),p.hips.node.matrixWorld.multiplyMatrices(_e,p.hips.node.matrix);for(const it of Ti){const rt=u.vrm.humanoid.getNormalizedBoneNode(it);if(!rt||(rt.scale.setScalar(1),rt.updateMatrix(),it==="hips"))continue;rt.updateMatrixWorld();const qo=h[it].node.matrixWorld.elements;rt.matrixWorld.elements[13]=qo[13],rt.matrixWorld.elements[12]=qo[12],rt.matrixWorld.elements[14]=qo[14]}}R&&D&&(vp(l,D.position,D.rotation,h.rightUpperArm.node.getWorldPosition(Zl),"right",Wo),da(p.rightUpperArm.node.parent.matrixWorld,u.ikMatrices.rightUpperArm,u.ikMatrices.rightLowerArm,u.ikMatrices.rightHand,D.position,D.rotation,Wo),ma(l,["rightUpperArm","rightLowerArm","rightHand"],R)),C&&E&&(vp(l,E.position,E.rotation,h.leftUpperArm.node.getWorldPosition(Zl),"left",Wo),da(p.leftUpperArm.node.parent.matrixWorld,u.ikMatrices.leftUpperArm,u.ikMatrices.leftLowerArm,u.ikMatrices.leftHand,E.position,E.rotation,Wo),ma(l,["leftUpperArm","leftLowerArm","leftHand"],C)),T&&S&&(Wo.set(-d.footGap*1.5,0,1).applyQuaternion(V.rotation).add(V.position),da(p.hips.node.matrixWorld,u.ikMatrices.rightUpperLeg,u.ikMatrices.rightLowerLeg,u.ikMatrices.rightFoot,S.position,S.rotation,Wo),ma(l,["rightUpperLeg","rightLowerLeg","rightFoot"],T)),y&&v&&(Wo.set(-d.footGap*1.5,0,1).applyQuaternion(V.rotation).add(V.position),da(p.hips.node.matrixWorld,u.ikMatrices.leftUpperLeg,u.ikMatrices.leftLowerLeg,u.ikMatrices.leftFoot,v.position,v.rotation,Wo),ma(l,["leftUpperLeg","leftLowerLeg","leftFoot"],y)),de(l,fc)&&gp(u.vrm,"right",M(l,fc).rotations),de(l,dc)&&gp(u.vrm,"left",M(l,dc).rotations),$1(u.vrm,l)}},kb=()=>{const e=[qh.locomotion,qh.emotes],[t]=j2(e.map(i=>`${B(Yf).cloudDomain}/projects/ir-engine/default-project/assets/animations/${i}.glb`)),n=Nr(Qf);A.useEffect(()=>{const i=t.get(dr);if(i.length===e.length)for(let r=0;r<i.length;r++){const s=i[r];if(s&&!n.loadedAnimations[e[r]].value){s.scene.traverse(a=>{delete a.geometry,delete a.material});for(let a=0;a<s.animations.length;a++)_2(s.animations[a],s.scene);s.scene.animations=s.animations,n.loadedAnimations[e[r]].set(s)}}},[t]);const o=We(Q(H2).avatarReady);return A.useEffect(()=>{const i=he.getSelfAvatarEntity();if(!i){xt.setTrackingSpace();return}const r=M(i,he).eyeHeight;Q(xt).userEyeHeight.set(r),xt.setTrackingSpace()},[o]),null},rd=ee({uuid:"ee.engine.AvatarAnimationSystem",insert:{after:Sb},execute:Ob,reactor:()=>(A.useEffect(()=>{const e=Q(qc);return e.networkSchema[ga.ID].set({read:ga.readBlendWeight,write:ga.writeBlendWeight}),()=>{e.networkSchema[ga.ID].set(W)}},[]),Nr(io).viewerEntity.value?te.createElement(kb,null):null)}),Vb=ie([r1]),Ub=()=>{for(const e of Vb()){const t=M(e,r1);t.bindMode==="attached"?t.bindMatrixInverse.copy(t.matrixWorld).invert():t.bindMode==="detached"?t.bindMatrixInverse.copy(t.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+t.bindMode)}};ee({uuid:"ee.engine.SkinnedMeshTransformSystem",insert:{after:Wc},execute:Ub});const zb=ie([Kn,Di]),Bb=()=>{for(const e of zb())g4(e)},jb=ee({uuid:"ee.engine.AvatarMovementSystem",insert:{with:$g},execute:Bb}),_b=ie([Kn,Di]),Hb=()=>{for(const e of _b())v4(e)};ee({uuid:"ee.engine.AvatarAutopilotSystem",insert:{after:jb},execute:Hb});const ys=yt({name:"AvatarTeleportComponent",schema:_.Object({side:q2})}),Cs={Move:"AvatarControlScheme_Move",Teleport:"AvatarControlScheme_Teleport"},qb={None:"AvatarControllerType_None",XRHands:"AvatarControllerType_XRHands",OculusQuest:"AvatarControllerType_OculusQuest"},Wb=Oi({name:"AvatarInputSettingsState",initial:()=>({controlType:qb.None,leftAxesControlScheme:Cs.Move,rightAxesControlScheme:Cs.Teleport,invertRotationAndMoveSticks:!0,showAvatar:!0}),extension:h4(["controlType","leftAxesControlScheme","rightAxesControlScheme","invertRotationAndMoveSticks","showAvatar"])}),Mp=new ne,Pp=new ne,Np=new ne,ya=new re,Gb=(e,t)=>{const n=e.hand,o=B(xt).xrFrame,i=new Float32Array(16*25);o.fillPoses(n.values(),e.gripSpace,i);const r=e.handedness==="right"?fc:dc,s=M(t,r).rotations;for(let a=1;a<25;a++){const c=Wh[a];if(c.includes("tip"))continue;const l=W2[c];if(!l)continue;const u=Wh.indexOf(l);Pp.fromArray(i,u*16).invert(),Mp.fromArray(i,a*16),Np.multiplyMatrices(Mp,Pp),ya.setFromRotationMatrix(Np),c==="thumb-metacarpal"&&ya.multiply(e.handedness=="right"?Qa:Ya),ya.invert();const d=Object.keys(i1).indexOf(c);ya.toArray(s,d*4)}},Ya=new re().setFromEuler(new Yc(0,Math.PI/2,0)),Qa=new re().setFromEuler(new Yc(0,-Math.PI/2,0)),Xb=ie([Dt]),Zb=e=>{const t=B(xt).xrFrame,n=Z1.origin,o=he.getUserAvatarEntity(e),i=ge.getTargetEntity(e,rn.leftHand),r=ge.getTargetEntity(e,rn.rightHand),s=ge.getTargetEntity(e,rn.head),a=ge.getTargetEntity(e,rn.leftFoot),c=ge.getTargetEntity(e,rn.rightFoot);if(s&&(ge.blendWeight[s]=0),i&&(ge.blendWeight[i]=0),r&&(ge.blendWeight[r]=0),a&&(ge.blendWeight[a]=0),c&&(ge.blendWeight[c]=0),!(t&&n))return;const u=xt.isCameraAttachedToAvatar;if(u&&s){const d=M(ye.instance.cameraEntity,q),f=M(s,q);f.position.copy(d.position),f.rotation.copy(d.rotation).multiply(ob),ge.blendWeight[s]=1;const h=M(o,On),p=M(o,he);if(h){const g=M(o,q);d.position.y-g.position.y<p.avatarHeight&&(ge.blendWeight[a]=1,ge.blendWeight[c]=1)}}if(u){1/xt.worldScale,M(o,q);for(const d of Xb()){const f=M(d,Dt),h=f.source.handedness;if(h==="none")continue;const p=h==="right"?r:i,g=h==="right"?fc:dc;if(p){const m=M(p,q),v=f.source.hand;if(v&&t.fillPoses&&t.getJointPose){de(o,g)||O(o,g,{hand:v});const y=v.get("wrist");if(y){const w=t.getJointPose(y,n);w&&(m.position.copy(w.transform.position),m.rotation.copy(w.transform.orientation).multiply(h==="right"?Qa:Ya))}Gb(f.source,o),ge.blendWeight[p]=1}else if(Qe(o,g),f.source.gripSpace){const y=t.getPose(f.source.gripSpace,n);y&&(m.position.copy(y.transform.position),m.rotation.copy(y.transform.orientation).multiply(h==="right"?Qa:Ya),ge.blendWeight[p]=1)}else{const y=t.getPose(f.source.targetRaySpace,n);y&&(m.position.copy(y.transform.position),m.rotation.copy(y.transform.orientation).multiply(h==="right"?Qa:Ya),ge.blendWeight[p]=1)}}}}};new P;new P;new P;new P;new re().setFromEuler(new Yc(0,Math.PI,0));const Kb=(e,t)=>{const n=he.getUserAvatarEntity(e),o=Se.getEntityByUUID(e+rn.leftFoot),i=Se.getEntityByUUID(e+rn.rightFoot);if(!o||!i)return;const r=ge.blendWeight[o],s=ge.blendWeight[i];if(!r||!s)return;const a=M(n,q),c=M(n,he),l=M(o,q);l.position.set(c.footGap,c.footHeight,0).applyQuaternion(a.rotation).add(a.position),l.rotation.copy(a.rotation);const u=M(i,q);u.position.set(-c.footGap,c.footHeight,0).applyQuaternion(a.rotation).add(a.position),u.rotation.copy(a.rotation)},Yb=new re,ba=new WeakMap,Qb={[Cs.Move]:(e,t,n)=>{const[o,i]=Gh(e,n);t.gamepadLocalInput.x+=o,t.gamepadLocalInput.z+=i},[Cs.Teleport]:(e,t,n)=>{var c;const o=he.getSelfAvatarEntity(),[i,r]=Gh(e,n);if(i===0&&r===0&&(ba.set(e,!0),e.handedness===((c=ue(o,ys))==null?void 0:c.side)&&Qe(o,ys)),!ba.get(e))return;const s=r<-.75;if(Math.abs(i)>.1&&Math.abs(r)<.1){const l=Math.PI/6*(i>0?-1:1);b4(o,pc,Yb.setFromAxisAngle(od,l)),ba.set(e,!1)}else s&&(O(o,ys,{side:e.handedness}),ba.set(e,!1))}},Jb=a1(Ei.Default,Ei.Avatars);c1.Closest,new P,new P;const $b=()=>{const e=he.getSelfAvatarEntity();if(!e)return;const t=gt(e,Kn);t.isWalking.set(!t.isWalking.value)},ex=e=>!1,tx=ie([u1,Mi]);let Kl=!1;const nx=()=>{var p,g,m,v,y,w,S,T,x,E,C,L,D,R,I,k;const e=he.getSelfAvatarEntity();if(!e)return;Zb(ye.instance.userID),B(ht),Kb(ye.instance.userID);const t=B(G2),n=B(Wb),o=M(e,Kn),i=B(xt),r=xt.isCameraAttachedToAvatar;if(!xt.isMovementControlsEnabled)return;if(!r&&!B(xt).session){const V=tx().find(X=>{var $;return($=M(X,Mi))==null?void 0:$.inputSources.length});if(V){const X=M(V,Mi),$=X==null?void 0:X.inputSources[0];if($&&de($,aa)){const _e=M($,aa),it=M($,Dt);(p=it==null?void 0:it.buttons.PrimaryClick)!=null&&p.touched&&(_e.movement.lengthSq()>0&&(Kl=!0),it.buttons.PrimaryClick.up&&(Kl?Kl=!1:y4(e)))}}}o.gamepadLocalInput.set(0,0,0);const a=ye.instance.viewerEntity,c=aa.getPointersForCamera(a)[0];if(!_s&&!c&&!i.session)return;const l=Mi.getMergedButtons(a);(g=l.ShiftLeft)!=null&&g.down&&$b();const u=(m=l[tr.StandardGamepadButtonA])==null?void 0:m.down,d=r?!1:ex(),f=((v=l.KeyA)!=null&&v.pressed?-1:0)+((y=l.KeyD)!=null&&y.pressed?1:0)+((w=l.ArrowLeft)!=null&&w.pressed?-1:0)+((S=l.ArrowRight)!=null&&S.pressed?1:0)+((T=l[tr.StandardGamepadDPadLeft])!=null&&T.pressed?-1:0)+((x=l[tr.StandardGamepadDPadRight])!=null&&x.pressed?1:0),h=((E=l.KeyW)!=null&&E.pressed?-1:0)+((C=l.KeyS)!=null&&C.pressed?1:0)+((L=l.ArrowUp)!=null&&L.pressed?-1:0)+((D=l.ArrowDown)!=null&&D.pressed?1:0)+((R=l[tr.StandardGamepadDPadUp])!=null&&R.pressed?-1:0)+((I=l[tr.StandardGamepadDPadDown])!=null&&I.pressed?-1:0);if(h===1){const V=ue(o.cameraEntity,Hs);((V==null?void 0:V.mode)===Fu.ThirdPerson||(V==null?void 0:V.mode)===Fu.ShoulderCam)&&(V.targetDistance=Math.max(V.targetDistance,V.effectiveMaxDistance*.5))}o.gamepadLocalInput.set(f,0,h).normalize(),o.gamepadJumpActive=!!((k=l.Space)!=null&&k.pressed)||u||d;for(const V of Dt.nonCapturedInputSources()){if(de(V,aa))continue;const X=M(V,Dt),$=!r||X.source.handedness==="none"?Cs.Move:X.source.handedness===t.preferredHand?n.rightAxesControlScheme:n.leftAxesControlScheme;Qb[$](X.source,o,t.preferredHand==="left"?"right":"left")}},ox=ee({uuid:"ee.engine.AvatarInputSystem",insert:{after:l1},execute:nx}),ix=ie([Kn,Di]),rx=()=>{const e=ix();for(const t of e){const n=M(t,Kn),o=ue(n.cameraEntity,Hs);o&&(o.distance<.3?O(t,ip,!0):Qe(t,ip)),n.movementCaptured.length||!de(t,Di)&&qc.worldNetwork&&n.gamepadLocalInput.lengthSq()>0&&(ei(_c.transferAuthorityOfObject({ownerID:ye.instance.userID,entityUUID:M(t,Se),newAuthority:ye.instance.store.peerID})),O(t,Di))}};ee({uuid:"ee.engine.AvatarControllerSystem",insert:{after:ox},execute:rx});const sx=ie([q,f1]);ee({uuid:"ee.engine.AvatarPostTransformSystem",insert:{after:Wc},execute:()=>{const e=he.getSelfAvatarEntity();if(!e)return;const t=q.getWorldPosition(e,ax);if(t)for(const n of sx())f1.squaredDistance[n]=X2(n,t)}});const ax=new P;var ur=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var t=1.70158;return e===1?1:e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return e===0?0:--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}}),Bounce:Object.freeze({In:function(e){return 1-ur.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?ur.Bounce.In(e*2)*.5:ur.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(t){return Math.pow(t,e)},Out:function(t){return 1-Math.pow(1-t,e)},InOut:function(t){return t<.5?Math.pow(t*2,e)/2:(1-Math.pow(2-t*2,e))/2+.5}}}}),ls=function(){return performance.now()},cx=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map(function(n){return t._tweens[n]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},e.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},e.prototype.update=function(t,n){t===void 0&&(t=ls()),n===void 0&&(n=!1);var o=Object.keys(this._tweens);if(o.length===0)return!1;for(;o.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<o.length;i++){var r=this._tweens[o[i]],s=!n;r&&r.update(t,s)===!1&&!n&&delete this._tweens[o[i]]}o=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),rr={Linear:function(e,t){var n=e.length-1,o=n*t,i=Math.floor(o),r=rr.Utils.Linear;return t<0?r(e[0],e[1],o):t>1?r(e[n],e[n-1],n-o):r(e[i],e[i+1>n?n:i+1],o-i)},Bezier:function(e,t){for(var n=0,o=e.length-1,i=Math.pow,r=rr.Utils.Bernstein,s=0;s<=o;s++)n+=i(1-t,o-s)*i(t,s)*e[s]*r(o,s);return n},CatmullRom:function(e,t){var n=e.length-1,o=n*t,i=Math.floor(o),r=rr.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(i=Math.floor(o=n*(1+t))),r(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],o-i)):t<0?e[0]-(r(e[0],e[0],e[1],e[1],-o)-e[0]):t>1?e[n]-(r(e[n],e[n],e[n-1],e[n-1],o-n)-e[n]):r(e[i?i-1:0],e[i],e[n<i+1?n:i+1],e[n<i+2?n:i+2],o-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=rr.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var o=t;o>1;o--)n*=o;return e[t]=n,n}}(),CatmullRom:function(e,t,n,o,i){var r=(n-e)*.5,s=(o-t)*.5,a=i*i,c=i*a;return(2*t-2*n+r+s)*c+(-3*t+3*n-2*r-s)*a+r*i+t}}},lx=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),Yu=new cx,Ls=function(){function e(t,n){n===void 0&&(n=Yu),this._object=t,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=ur.Linear.None,this._interpolationFunction=rr.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=lx.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(t,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=t,this._propertiesAreSetUp=!1,this._duration=n<0?0:n,this},e.prototype.duration=function(t){return t===void 0&&(t=1e3),this._duration=t<0?0:t,this},e.prototype.dynamic=function(t){return t===void 0&&(t=!1),this._isDynamic=t,this},e.prototype.start=function(t,n){if(t===void 0&&(t=ls()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var o in this._valuesStartRepeat)this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=t,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var r in this._valuesEnd)i[r]=this._valuesEnd[r];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},e.prototype.startFromCurrentValues=function(t){return this.start(t,!0)},e.prototype._setupProperties=function(t,n,o,i,r){for(var s in o){var a=t[s],c=Array.isArray(a),l=c?"array":typeof a,u=!c&&Array.isArray(o[s]);if(!(l==="undefined"||l==="function")){if(u){var d=o[s];if(d.length===0)continue;for(var f=[a],h=0,p=d.length;h<p;h+=1){var g=this._handleRelativeValue(a,d[h]);if(isNaN(g)){u=!1,console.warn("Found invalid interpolation list. Skipping.");break}f.push(g)}u&&(o[s]=f)}if((l==="object"||c)&&a&&!u){n[s]=c?[]:{};var m=a;for(var v in m)n[s][v]=m[v];i[s]=c?[]:{};var d=o[s];if(!this._isDynamic){var y={};for(var v in d)y[v]=d[v];o[s]=d=y}this._setupProperties(m,n[s],d,i[s],r)}else(typeof n[s]>"u"||r)&&(n[s]=a),c||(n[s]*=1),u?i[s]=o[s].slice().reverse():i[s]=n[s]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(t){return t===void 0&&(t=ls()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this),this)},e.prototype.resume=function(t){return t===void 0&&(t=ls()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var t=0,n=this._chainedTweens.length;t<n;t++)this._chainedTweens[t].stop();return this},e.prototype.group=function(t){return t===void 0&&(t=Yu),this._group=t,this},e.prototype.delay=function(t){return t===void 0&&(t=0),this._delayTime=t,this},e.prototype.repeat=function(t){return t===void 0&&(t=0),this._initialRepeat=t,this._repeat=t,this},e.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},e.prototype.yoyo=function(t){return t===void 0&&(t=!1),this._yoyo=t,this},e.prototype.easing=function(t){return t===void 0&&(t=ur.Linear.None),this._easingFunction=t,this},e.prototype.interpolation=function(t){return t===void 0&&(t=rr.Linear),this._interpolationFunction=t,this},e.prototype.chain=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._chainedTweens=t,this},e.prototype.onStart=function(t){return this._onStartCallback=t,this},e.prototype.onEveryStart=function(t){return this._onEveryStartCallback=t,this},e.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},e.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},e.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},e.prototype.onStop=function(t){return this._onStopCallback=t,this},e.prototype.update=function(t,n){var o=this,i;if(t===void 0&&(t=ls()),n===void 0&&(n=!0),this._isPaused)return!0;var r,s=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>s)return!1;n&&this.start(t,!0)}if(this._goToEnd=!1,t<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var a=t-this._startTime,c=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),l=this._duration+this._repeat*c,u=function(){if(o._duration===0||a>l)return 1;var m=Math.trunc(a/c),v=a-m*c,y=Math.min(v/o._duration,1);return y===0&&a===o._duration?1:y},d=u(),f=this._easingFunction(d);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,f),this._onUpdateCallback&&this._onUpdateCallback(this._object,d),this._duration===0||a>=this._duration)if(this._repeat>0){var h=Math.min(Math.trunc((a-this._duration)/c)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=h);for(r in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[r]=="string"&&(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=c*h,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var p=0,g=this._chainedTweens.length;p<g;p++)this._chainedTweens[p].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(t,n,o,i){for(var r in o)if(n[r]!==void 0){var s=n[r]||0,a=o[r],c=Array.isArray(t[r]),l=Array.isArray(a),u=!c&&l;u?t[r]=this._interpolationFunction(a,i):typeof a=="object"&&a?this._updateProperties(t[r],s,a,i):(a=this._handleRelativeValue(s,a),typeof a=="number"&&(t[r]=s+(a-s)*i))}},e.prototype._handleRelativeValue=function(t,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?t+parseFloat(n):parseFloat(n)},e.prototype._swapEndStartRepeatValues=function(t){var n=this._valuesStartRepeat[t],o=this._valuesEnd[t];typeof o=="string"?this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(o):this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=n},e}(),$n=Yu;$n.getAll.bind($n);$n.removeAll.bind($n);$n.add.bind($n);$n.remove.bind($n);$n.update.bind($n);const et=yt({name:"SpawnEffectComponent",schema:_.Object({sourceEntity:_.Entity(),opacityMultiplier:_.Number(1),plateEntity:_.Entity(),lightEntities:_.Array(_.Entity())}),reactor:()=>{const e=je();return A.useEffect(()=>{const t=M(e,et),n=M(t.sourceEntity,q);O(e,q,{position:n.position.clone()});const o=M(e,q);O(e,yn,!0),Ap.origin.copy(n.position);const i=Ns.getWorld(e),r=Ns.castRay(i,Ap);return r.length&&(o.position.y=r[0].position.y),ux(e),fx(e),et.fadeIn(e),()=>{Gt(t.plateEntity);for(const s of t.lightEntities)Gt(s)}},[]),null},fadeIn:e=>{const t=M(e,et);O(e,Xn,new Ls(t).to({opacityMultiplier:1},1e3).easing(ur.Exponential.Out).start().onComplete(()=>{Qe(e,Xn)}))},fadeOut:e=>{const t=M(e,et);O(e,Xn,new Ls(t).to({opacityMultiplier:0},2e3).start().onComplete(()=>{Gt(e)}))},lightMesh:new Qn(new As(.04,3.2),new ri({transparent:!0,blending:_u,depthWrite:!1,side:Qc})),plateMesh:new Qn(new As(1.6,1.6),new ri({transparent:!1,blending:_u,depthWrite:!1}))}),ux=e=>{const t=new Qn(et.plateMesh.geometry,et.plateMesh.material),n=It();O(n,at,"Spawn Plate "+e),O(n,Lt,{parentEntity:e}),Rt(n,t),Qo(n,!0);const o=M(n,q);o.rotation.setFromAxisAngle(K1,-.5*Math.PI),o.position.y=.01,gt(e,et).plateEntity.set(n)},fx=e=>{const t=.6*et.plateMesh.geometry.boundingSphere.radius,n=5+10*t*Math.random();for(let o=0;o<n;o+=1){const i=et.lightMesh.clone(),r=It();O(r,at,"Spawn Ray "+e),O(r,Lt,{parentEntity:e}),Rt(r,i);const s=M(r,q);Qo(r,!0),gt(e,et).lightEntities.merge([r]);const a=2*Math.PI*o/n,c=t*Math.random();s.position.x+=c*Math.cos(a),s.position.y+=.5*i.geometry.boundingSphere.radius*Math.random(),s.position.z+=c*Math.sin(a),s.rotation.setFromAxisAngle(od,Math.random()*2*Math.PI)}},Ap={type:c1.Closest,origin:new P,direction:Y1.Down,maxDistance:10,groups:a1(Ei.Avatars,Z2)},dx=(e,t)=>Math.min(1,Math.max(.001,e/t)),hx=(e,t)=>Math.min(1,Math.max(0,1-(e-t)*.5)),px=ie([et]),mx=ie([Ru]),gx=()=>{const e=B(ht).deltaSeconds;for(const t of px()){q.dirtyTransforms[t]=!0;const{opacityMultiplier:n,plateEntity:o,lightEntities:i}=M(t,et);if(!o)continue;const r=M(o,mt)[0];r.material.opacity=n*(.7+.5*Math.sin(Date.now()%6283*.005));for(const s of i){const a=M(s,mt)[0],c=M(s,q);c.position.y+=2*e,c.scale.y=dx(c.position.y,a.geometry.boundingSphere.radius),a.material.opacity=hx(c.position.y,a.geometry.boundingSphere.radius),a.material.opacity<.001&&(c.position.y=r.position.y),a.material.opacity*=n}}for(const t of mx()){const n=M(t,Ru);Ru.updateDissolveEffect(n.dissolveMaterials,t,e)}},vx=()=>{const e=je();return A.useEffect(()=>{const t=It();return O(t,et,{sourceEntity:e,opacityMultiplier:1}),()=>{et.fadeOut(t)}},[]),null},yx=()=>{if(!Ar)return null;const e=We(!1),[t]=Ii("/static/itemLight.png"),[n]=Ii("/static/itemPlate.png");return A.useEffect(()=>{const i=t;i&&(i.colorSpace=Hu,i.needsUpdate=!0,et.lightMesh.material.map=i)},[t]),A.useEffect(()=>{const i=n;i&&(i.colorSpace=Hu,i.needsUpdate=!0,et.plateMesh.material.map=i)},[n]),A.useEffect(()=>{t&&n&&e.set(!0)},[t,n]),A.useEffect(()=>{et.lightMesh.geometry.computeBoundingSphere(),et.plateMesh.geometry.computeBoundingSphere(),et.lightMesh.name="light_obj",et.plateMesh.name="plate_obj"},[]),!We(Q(Qf).avatarLoadingEffect).value||!e.value?null:te.createElement(Xt,{Components:[K2],ChildEntityReactor:vx})};ee({uuid:"ee.engine.AvatarLoadingSystem",insert:{after:rd},execute:gx,reactor:yx});const Cp=(e,t,n,o,i)=>(e.copy(n),e.addScaledVector(o,t),e.addScaledVector(i,.5*t**2),e),bx=4,xx=6,Yl=new P(0,-9.8,0),Go=new P,vi=new P,Ql=new P,wx=new P,Sx=new P,Tx=new vt("white"),Ex=new vt("red"),Mx=(e,t,n,o)=>{const i=wx.copy(e),r=Sx.set(0,0,1).applyQuaternion(t);let s=1-Y2(r.y,-1,1);r.multiplyScalar(n+xx*s);const a=(-r.y+Math.sqrt(r.y**2-2*i.y*o.y))/o.y;return{p:i,v:r,t:a}},Px=(e,t,n,o)=>{for(let i=n;i<=o;i++)e.toArray(t,i*3)},Qu=Oi({name:"AvatarTeleportSystemState",initial:{}}),sr=64,ar=new Float32Array((sr+1)*3),Lp=new Float32Array((sr+1)*3),Nx=new ne;let Zr=!1;const Jl=ie([ys]);let Kr=-1,xa=2;const Ax=()=>{if(!xt.isCameraAttachedToAvatar)return;const t=he.getSelfAvatarEntity(),{guideCursor:n,transition:o,guideline:i,guidelineEntity:r,guideCursorEntity:s,lineMaterial:a}=B(Qu);if(!r)return;Kr>=0&&(Kr+=B(ht).deltaSeconds,Kr>.25&&(Kr=-1,ed(t,M(s,q).position),ei(Ou.fadeToBlack({in:!1})),ei(up.vibrateController({handedness:"left",value:.5,duration:100})),ei(up.vibrateController({handedness:"right",value:.5,duration:100}))));for(const d of Jl.exit())xa=1,o.setState("OUT"),Zr&&(Kr=0,ei(Ou.fadeToBlack({in:!0})));for(const d of Jl.enter())Qo(r,!0),o.setState("IN");const c=M(r,q),l=Dt.nonCapturedInputSources();for(const d of Jl()){const f=M(t,ys).side,h=Z1.origin;for(const T of l){const x=M(T,Dt);if(x.source.handedness===f){const E=B(xt).xrFrame.getPose(x.source.targetRaySpace,h);c.position.copy(E.transform.position),c.rotation.copy(E.transform.orientation),c.matrix.fromArray(E.transform.matrix)}}const p=Nx.copy(c.matrix).invert(),{p:g,v:m,t:v}=Mx(c.position,c.rotation,bx,Yl);ar.fill(0),Go.set(0,0,0);let y=null,w=!1,S=0;for(xa<sr&&(xa+=8),S=1;S<=xa&&!w;S++){Cp(vi,S*v/sr,g,m,Yl),Go.copy(vi),Go.applyMatrix4(p),Go.toArray(ar,S*3),Cp(Ql,(S+1)*v/sr,g,m,Yl);const T=Ql.subVectors(Ql,vi),x=Ns.getWorld(t),E=x4(x,vi,!1,T);E.raycastHit!==null&&(w=!0,vi.copy(E.raycastHit.position)),y=E}y.positionValid?Zr=!0:Zr=!1,Go.copy(vi),Go.applyMatrix4(p),Go.toArray(ar,S*3),Px(Go,ar,S+1,sr),i.geometry.attributes.position.needsUpdate=!0,Zr?(M(s,q).position.copy(vi),n.visible=!0,a.color=Tx):(n.visible=!1,a.color=Ex),Qo(s,Zr)}const u=B(ht).deltaSeconds;o.update(u,d=>{d===0&&o.state==="OUT"&&(Qo(r,!1),Qo(s,!1));const f=Q2(d);n.material.opacity=f,n.scale.setScalar(f*.2+.8)})},Cx=()=>{const e=xt.useCameraAttachedToAvatar();return A.useEffect(()=>{if(!e)return;const t=B(io).originEntity,n=new Cr;ar.fill(0),Lp.fill(.5),n.setAttribute("position",new Jn(ar,3)),n.setAttribute("color",new Jn(Lp,3));const o=new Gs({vertexColors:!0,blending:_u}),i=new R1(n,o);i.frustumCulled=!1,i.name="teleport-guideline";const r=It();Rt(r,i),O(r,at,"Teleport Guideline"),O(r,Lt,{parentEntity:t});const s=new O1(.45,.5,32);s.name="teleport-guide-cursor",s.rotateX(-Math.PI/2),s.translate(0,.01,0);const a=new ri({color:16777215,side:Qc,transparent:!0}),c=new Qn(s,a);c.frustumCulled=!1;const l=It();Rt(l,c),O(l,at,"Teleport Guideline Cursor"),O(l,Lt,{parentEntity:t});const u=d1(.5);return Q(Qu).set({guideCursor:c,transition:u,guideline:i,guidelineEntity:r,guideCursorEntity:l,lineMaterial:o}),()=>{Gt(r),Gt(l),Q(Qu).set({})}},[e]),null};ee({uuid:"ee.engine.AvatarTeleportSystem",insert:{after:rd},execute:Ax,reactor:Cx});const Yr=0,wa=1,Lx=ie([he]),Dx=()=>{const e=he.getSelfAvatarEntity();if(!e)return;const t=xt.isCameraAttachedToAvatar;for(const n of Lx()){const o=ue(n,ku),i=o==null?void 0:o.materials;i||O(n,ku,{materials:[]});const r=M(n,he),s=ue(B(io).viewerEntity,Hs);if(!(i!=null&&i.length))return;for(const a of i){const c=ue(Se.getEntityByUUID(a),h1);if(!c)continue;const l=M(ye.instance.viewerEntity,q).position;if(c.centers.value[wa].set(l.x,l.y,l.z),c.distances.value[wa]=t?8:3,c.exponents.value[wa]=t?10:6,c.useWorldCalculation.value[wa]=Xh.worldTransformed,n!==e){c.distances.value[Yr]=10;continue}c.centers.value[Yr].setY(r.eyeHeight),c.distances.value[Yr]=s&&!t?Math.max(Math.pow(s.distance*5,2.5),3):3.5,c.exponents.value[Yr]=t?12:8,c.useWorldCalculation.value[Yr]=Xh.localPosition}}};ee({uuid:"AvatarTransparencySystem",execute:Dx,insert:{with:Yt},reactor:()=>{he.useSelfAvatarEntity();const e=E2([he]);return te.createElement(te.Fragment,null,e.map(t=>te.createElement(Ix,{key:t,entity:t})))}});const Ix=e=>{var i;const t=e.entity,n=J2(t),o=We(Jo.entitiesBySourceState[n]);return te.createElement(te.Fragment,null,(i=o.value)==null?void 0:i.map(r=>te.createElement(Fx,{key:r,entity:r,rootEntity:t})))},Fx=e=>{var o;const t=e.entity,n=(o=Zn(t,qs))==null?void 0:o.uuid;return A.useEffect(()=>{if(n!=null&&n.value)for(const i of n.value){const r=Se.getEntityByUUID(i),s=gt(e.rootEntity,ku);s.materials.value.includes(i)||s.materials.set([...s.materials.value,i]),O(r,h1)}},[n]),null},Rx=()=>{const e=he.getSelfAvatarEntity();e&&(w4(e),S4(e),p1(e))};ee({uuid:"ee.engine.ReferenceSpaceTransformSystem",insert:{before:$2},execute:Rx});const Ja=Oi({name:"ee.engine.grabbables.GrabbableState",initial:{},receptors:{onSetGrabbedObject:m1.setGrabbedObject.receive(e=>{const t=Q(Ja);e.grabbed?t[e.entityUUID].set({attachmentPoint:e.attachmentPoint??"right",grabberUserId:e.grabberUserId}):t[e.entityUUID].set(W)}),onDestroyObject:_c.destroyEntity.receive(e=>{Q(Ja)[e.entityUUID].set(W)})},reactor:()=>{const e=Nr(Ja);return te.createElement(te.Fragment,null,e.keys.map(t=>te.createElement(Ox,{key:t,entityUUID:t})))}}),Ox=({entityUUID:e})=>{const t=We(Q(Ja)[e]),n=Se.useEntityByUUID(e),o=Se.useEntityByUUID(t.grabberUserId.value),i=t.attachmentPoint.value;return A.useEffect(()=>{if(!(!n||!o))return O(o,Zh,{[i]:n}),O(n,ps,{grabberEntity:o,attachmentPoint:i}),de(n,Tt)&&O(n,Tt,{type:Ro.Kinematic}),()=>{de(o,ps)&&O(o,Zh,{[i]:null}),M2(n)&&(Qe(n,ps),de(n,Tt)&&O(n,Tt,{type:Ro.Dynamic}))}},[n,o]),null};function kx(e){var n;if(e.newAuthority!==ye.instance.store.peerID)return;const t=Se.getEntityByUUID(e.entityUUID);if(de(t,g1)){const o=(n=qc.worldNetwork.peers[e.newAuthority])==null?void 0:n.userId;ei(m1.setGrabbedObject({entityUUID:M(t,Se),grabberUserId:o,grabbed:!de(t,ps),attachmentPoint:"right"}))}}const Vx=Zc(_c.transferAuthorityOfObject.matches),Ux=ie([g1,Di]),zx=()=>{if(!B(io).isEditing){for(const e of Vx())kx(e);for(const e of Ux()){const t=ue(e,ps);if(!t)return;const n=t.attachmentPoint,o=T4(t.grabberEntity,n??"right"),i=ue(e,Tt),r=Ns.getWorld(e);i&&(i.targetKinematicPosition.copy(o.position),i.targetKinematicRotation.copy(o.rotation),Ns.setRigidbodyPose(r,e,o.position,o.rotation,pc,pc));const s=M(e,q);s.position.copy(o.position),s.rotation.copy(o.rotation)}}},Bx=()=>{var n;const e=Dt.nonCapturedInputSources();(n=Mi.getMergedButtonsForInputSources(e).KeyU)!=null&&n.down&&e3()};ee({uuid:"ee.engine.GrabbableSystem",insert:{with:$g},execute:zx});ee({uuid:"ee.engine.GrabbableInputSystem",insert:{after:l1},execute:Bx});const Dp=ie([v1,Zf(he),ms]);ie([v1,Mi]);let Sa=0;const jx=()=>{Sa+=B(ht).deltaSeconds,Sa>.1&&(Sa=0);for(const t of Dp.exit())Kh.has(t)&&Kh.delete(t),de(t,Yh)&&Qe(t,Yh);const e=Dp();Sa===0&&t3(e)};ee({uuid:"ee.engine.InteractableSystem",insert:{before:Wc},execute:jx});const vc=yt({name:"EE_audio_analyzer",jsonID:"audio-analyzer",schema:_.Object({src:_.String(""),session:_.Nullable(_.Type(),null),bassEnabled:_.Bool(!0),midEnabled:_.Bool(!0),trebleEnabled:_.Bool(!0),bassMultiplier:_.Number(1),midMultiplier:_.Number(1),trebleMultiplier:_.Number(1)}),reactor:()=>{const e=je(),t=se(e,vc),n=Zn(e,mc),o=Zn(e,sb),i=se(e,ti);return A.useEffect(()=>{O(e,yn),O(e,at,"AudioAnalysis"),O(e,q)},[]),A.useEffect(()=>{t.src.set(i==null?void 0:i.path.values[0])},[i.path]),A.useEffect(()=>{if(!n||!(o!=null&&o.value.element))return;const r=o.value.element;r.onplay=()=>{const s=rb.get(r);if(s){const c=s.source.context.createAnalyser();c.fftSize=2**5,s.source.connect(c),t.session.set({analyser:c,frequencyData:new Uint8Array(c.frequencyBinCount)})}}},[t,n,o]),null}}),_x=ie([vc]),Hx=new Map([[{start:0/3,end:1/3},e=>e.bassMultiplier*(e.bassEnabled?1:0)],[{start:1/3,end:2/3},e=>e.midMultiplier*(e.midEnabled?1:0)],[{start:2/3,end:3/3},e=>e.trebleMultiplier*(e.trebleEnabled?1:0)]]);ee({uuid:"ee.engine.AudioAnalysisSystem",insert:{after:Yt},execute:()=>{for(const e of _x()){const t=M(e,vc),n=t.session;if(n==null)continue;const{analyser:o,frequencyData:i}=n,r=o.frequencyBinCount;o.getByteFrequencyData(i);for(const[s,a]of Hx){const c=Math.floor(s.start*r),l=Math.floor(s.end*r),u=a(t);for(let d=c;d<l;d++)i[d]*=u}O(e,vc,{session:n})}}});const z=yt({name:"MotionCaptureRigComponent",schema:{rig:Object.fromEntries(Ti.map(e=>[e,ca.Quaternion])),slerpedRig:Object.fromEntries(Ti.map(e=>[e,ca.Quaternion])),hipPosition:ca.Vec3,hipRotation:ca.Quaternion,footOffset:"f64",solvingLowerBody:"ui8"},onInit:e=>({prevWorldLandmarks:null,prevScreenLandmarks:null}),reactor:function(){const e=je();return A.useEffect(()=>{for(const t of Ti);z.solvingLowerBody[e]=1},[]),null}}),qx=_.LiteralUnion(["sitting","standing"]),$a=yt({name:"MotionCapturePoseComponent",schema:_.Record(qx,_.Object({begun:_.Bool()}))}),Ip=1.25,Wx=.25;let $l=0;const Gx=e=>{const t=M(e,On).normalizedRig;if(!t)return;const n=B(ht).deltaSeconds;de(e,$a)||O(e,$a);const o=gt(e,$a);if(!z.solvingLowerBody[e])return"none";const i=r=>{let s=t.rightUpperLeg.node.quaternion.angleTo(t.spine.node.quaternion)<Ip&&t.leftUpperLeg.node.quaternion.angleTo(t.spine.node.quaternion)<Ip;return s=r=="sitting"?!s:s,!s||o[r].value?!1:($l+=n,$l>Wx?(o[r==="standing"?"sitting":"standing"].set(W),$l=0,!0):!1)};i("sitting")?o.sitting.set({begun:!0}):o.sitting.value&&o.sitting.begun.value&&o.sitting.begun.set(!1),i("standing")?o.standing.set({begun:!0}):o.standing.value&&o.standing.begun.value&&o.standing.begun.set(!1)},Xx=ie([z,On,Kn]),Zx=()=>{for(const e of Xx())Gx(e)};ee({uuid:"ee.engine.MotionCaptureInputSystem",insert:{before:Rn},execute:Zx});var sd=typeof self<"u"?self:{};function t0(e){e:{for(var t=["CLOSURE_FLAGS"],n=sd,o=0;o<t.length;o++)if((n=n[t[o]])==null){t=null;break e}t=n}return(e=t&&t[e])!=null&&e}function yi(){throw Error("Invalid UTF8")}function Fp(e,t){return t=String.fromCharCode.apply(null,t),e==null?t:e+t}let Ta,eu;const Kx=typeof TextDecoder<"u";let Yx;const Qx=typeof TextEncoder<"u";function n0(e){if(Qx)e=(Yx||(Yx=new TextEncoder)).encode(e);else{let n=0;const o=new Uint8Array(3*e.length);for(let i=0;i<e.length;i++){var t=e.charCodeAt(i);if(128>t)o[n++]=t;else{if(2048>t)o[n++]=t>>6|192;else{if(55296<=t&&57343>=t){if(56319>=t&&i<e.length){const r=e.charCodeAt(++i);if(56320<=r&&57343>=r){t=1024*(t-55296)+r-56320+65536,o[n++]=t>>18|240,o[n++]=t>>12&63|128,o[n++]=t>>6&63|128,o[n++]=63&t|128;continue}i--}t=65533}o[n++]=t>>12|224,o[n++]=t>>6&63|128}o[n++]=63&t|128}}e=n===o.length?o:o.subarray(0,n)}return e}var Ds,o0=t0(610401301),Jx=t0(188588736);const Rp=sd.navigator;function Ju(e){return!!o0&&!!Ds&&Ds.brands.some(({brand:t})=>t&&t.indexOf(e)!=-1)}function on(e){var t;return(t=sd.navigator)&&(t=t.userAgent)||(t=""),t.indexOf(e)!=-1}function Yo(){return!!o0&&!!Ds&&0<Ds.brands.length}function tu(){return Yo()?Ju("Chromium"):(on("Chrome")||on("CriOS"))&&!(!Yo()&&on("Edge"))||on("Silk")}Ds=Rp&&Rp.userAgentData||null;var $x=!Yo()&&(on("Trident")||on("MSIE"));!on("Android")||tu(),tu(),on("Safari")&&(tu()||!Yo()&&on("Coast")||!Yo()&&on("Opera")||!Yo()&&on("Edge")||(Yo()?Ju("Microsoft Edge"):on("Edg/"))||Yo()&&Ju("Opera"));var i0={},us=null;function ew(e){var t=e.length,n=3*t/4;n%3?n=Math.floor(n):"=.".indexOf(e[t-1])!=-1&&(n="=.".indexOf(e[t-2])!=-1?n-2:n-1);var o=new Uint8Array(n),i=0;return function(r,s){function a(h){for(;c<r.length;){var p=r.charAt(c++),g=us[p];if(g!=null)return g;if(!/^[\s\xa0]*$/.test(p))throw Error("Unknown base64 encoding at char: "+p)}return h}r0();for(var c=0;;){var l=a(-1),u=a(0),d=a(64),f=a(64);if(f===64&&l===-1)break;s(l<<2|u>>4),d!=64&&(s(u<<4&240|d>>2),f!=64&&s(d<<6&192|f))}}(e,function(r){o[i++]=r}),i!==n?o.subarray(0,i):o}function r0(){if(!us){us={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++){var o=e.concat(t[n].split(""));i0[n]=o;for(var i=0;i<o.length;i++){var r=o[i];us[r]===void 0&&(us[r]=i)}}}}var s0=typeof Uint8Array<"u",a0=!$x&&typeof btoa=="function";function Op(e){if(!a0){var t;t===void 0&&(t=0),r0(),t=i0[t];var n=Array(Math.floor(e.length/3)),o=t[64]||"";let c=0,l=0;for(;c<e.length-2;c+=3){var i=e[c],r=e[c+1],s=e[c+2],a=t[i>>2];i=t[(3&i)<<4|r>>4],r=t[(15&r)<<2|s>>6],s=t[63&s],n[l++]=a+i+r+s}switch(a=0,s=o,e.length-c){case 2:s=t[(15&(a=e[c+1]))<<2]||o;case 1:e=e[c],n[l]=t[e>>2]+t[(3&e)<<4|a>>4]+s+o}return n.join("")}for(t="",n=0,o=e.length-10240;n<o;)t+=String.fromCharCode.apply(null,e.subarray(n,n+=10240));return t+=String.fromCharCode.apply(null,n?e.subarray(n):e),btoa(t)}const kp=/[-_.]/g,tw={"-":"+",_:"/",".":"="};function nw(e){return tw[e]||""}function c0(e){if(!a0)return ew(e);kp.test(e)&&(e=e.replace(kp,nw)),e=atob(e);const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}function Zs(e){return s0&&e!=null&&e instanceof Uint8Array}let ow;function el(){return ow||(ow=new Uint8Array(0))}var pr={};let iw;function l0(e){if(e!==pr)throw Error("illegal external caller")}function Fi(){return iw||(iw=new Vo(null,pr))}function ad(e){l0(pr);var t=e.g;return(t=t==null||Zs(t)?t:typeof t=="string"?c0(t):null)==null?t:e.g=t}var Vo=class{constructor(e,t){if(l0(t),this.g=e,e!=null&&e.length===0)throw Error("ByteString should be constructed with non-empty values")}h(){const e=ad(this);return e?new Uint8Array(e):el()}};function u0(e,t){return Error(`Invalid wire type: ${e} (at position ${t})`)}function cd(){return Error("Failed to read varint, encoding is invalid.")}function f0(e,t){return Error(`Tried to read past the end of the data ${t} > ${e}`)}function ld(e){if(typeof e=="string")return{buffer:c0(e),N:!1};if(Array.isArray(e))return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Uint8Array)return{buffer:e,N:!1};if(e.constructor===ArrayBuffer)return{buffer:new Uint8Array(e),N:!1};if(e.constructor===Vo)return{buffer:ad(e)||el(),N:!0};if(e instanceof Uint8Array)return{buffer:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),N:!1};throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, a ByteString or an Array of numbers")}function ud(){return typeof BigInt=="function"}const rw=typeof Uint8Array.prototype.slice=="function";let d0,Ae=0,$e=0;function Pi(e){const t=0>e;let n=(e=Math.abs(e))>>>0;if(e=Math.floor((e-n)/4294967296),t){const[o,i]=hd(n,e);e=i,n=o}Ae=n>>>0,$e=e>>>0}function fd(e){const t=d0||(d0=new DataView(new ArrayBuffer(8)));t.setFloat32(0,+e,!0),$e=0,Ae=t.getUint32(0,!0)}function $u(e,t){return 4294967296*t+(e>>>0)}function dd(e,t){const n=2147483648&t;return n&&(t=~t>>>0,(e=1+~e>>>0)==0&&(t=t+1>>>0)),e=$u(e,t),n?-e:e}function yc(e,t){if(e>>>=0,2097151>=(t>>>=0))var n=""+(4294967296*t+e);else ud()?n=""+(BigInt(t)<<BigInt(32)|BigInt(e)):(e=(16777215&e)+6777216*(n=16777215&(e>>>24|t<<8))+6710656*(t=t>>16&65535),n+=8147497*t,t*=2,1e7<=e&&(n+=Math.floor(e/1e7),e%=1e7),1e7<=n&&(t+=Math.floor(n/1e7),n%=1e7),n=t+Vp(n)+Vp(e));return n}function Vp(e){return e=String(e),"0000000".slice(e.length)+e}function h0(){var e=Ae,t=$e;if(2147483648&t)if(ud())e=""+(BigInt(0|t)<<BigInt(32)|BigInt(e>>>0));else{const[n,o]=hd(e,t);e="-"+yc(n,o)}else e=yc(e,t);return e}function tl(e){if(16>e.length)Pi(Number(e));else if(ud())e=BigInt(e),Ae=Number(e&BigInt(4294967295))>>>0,$e=Number(e>>BigInt(32)&BigInt(4294967295));else{const t=+(e[0]==="-");$e=Ae=0;const n=e.length;for(let o=t,i=(n-t)%6+t;i<=n;o=i,i+=6){const r=Number(e.slice(o,i));$e*=1e6,Ae=1e6*Ae+r,4294967296<=Ae&&($e+=Math.trunc(Ae/4294967296),$e>>>=0,Ae>>>=0)}if(t){const[o,i]=hd(Ae,$e);Ae=o,$e=i}}}function hd(e,t){return t=~t,e?e=1+~e:t+=1,[e,t]}function pd(e,t){let n,o=0,i=0,r=0;const s=e.h;let a=e.g;do n=s[a++],o|=(127&n)<<r,r+=7;while(32>r&&128&n);for(32<r&&(i|=(127&n)>>4),r=3;32>r&&128&n;r+=7)n=s[a++],i|=(127&n)<<r;if(Ni(e,a),128>n)return t(o>>>0,i>>>0);throw cd()}function md(e){let t=0,n=e.g;const o=n+10,i=e.h;for(;n<o;){const r=i[n++];if(t|=r,(128&r)==0)return Ni(e,n),!!(127&t)}throw cd()}function si(e){const t=e.h;let n=e.g,o=t[n++],i=127&o;if(128&o&&(o=t[n++],i|=(127&o)<<7,128&o&&(o=t[n++],i|=(127&o)<<14,128&o&&(o=t[n++],i|=(127&o)<<21,128&o&&(o=t[n++],i|=o<<28,128&o&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++]&&128&t[n++])))))throw cd();return Ni(e,n),i}function ai(e){return si(e)>>>0}function ef(e){var t=e.h;const n=e.g,o=t[n],i=t[n+1],r=t[n+2];return t=t[n+3],Ni(e,e.g+4),(o<<0|i<<8|r<<16|t<<24)>>>0}function tf(e){var t=ef(e);e=2*(t>>31)+1;const n=t>>>23&255;return t&=8388607,n==255?t?NaN:1/0*e:n==0?e*Math.pow(2,-149)*t:e*Math.pow(2,n-150)*(t+Math.pow(2,23))}function sw(e){return si(e)}function nu(e,t,{ca:n=!1}={}){e.ca=n,t&&(t=ld(t),e.h=t.buffer,e.m=t.N,e.j=0,e.l=e.h.length,e.g=e.j)}function Ni(e,t){if(e.g=t,t>e.l)throw f0(e.l,t)}function p0(e,t){if(0>t)throw Error(`Tried to read a negative byte length: ${t}`);const n=e.g,o=n+t;if(o>e.l)throw f0(t,e.l-n);return e.g=o,n}function m0(e,t){if(t==0)return Fi();var n=p0(e,t);return e.ca&&e.m?n=e.h.subarray(n,n+t):(e=e.h,n=n===(t=n+t)?el():rw?e.slice(n,t):new Uint8Array(e.subarray(n,t))),n.length==0?Fi():new Vo(n,pr)}var Up=[];function g0(e){var t=e.g;if(t.g==t.l)return!1;e.l=e.g.g;var n=ai(e.g);if(t=n>>>3,!(0<=(n&=7)&&5>=n))throw u0(n,e.l);if(1>t)throw Error(`Invalid field number: ${t} (at position ${e.l})`);return e.m=t,e.h=n,!0}function ec(e){switch(e.h){case 0:e.h!=0?ec(e):md(e.g);break;case 1:Ni(e=e.g,e.g+8);break;case 2:if(e.h!=2)ec(e);else{var t=ai(e.g);Ni(e=e.g,e.g+t)}break;case 5:Ni(e=e.g,e.g+4);break;case 3:for(t=e.m;;){if(!g0(e))throw Error("Unmatched start-group tag: stream EOF");if(e.h==4){if(e.m!=t)throw Error("Unmatched end-group tag");break}ec(e)}break;default:throw u0(e.h,e.l)}}function Ks(e,t,n){const o=e.g.l,i=ai(e.g),r=e.g.g+i;let s=r-o;if(0>=s&&(e.g.l=r,n(t,e,void 0,void 0,void 0),s=r-e.g.g),s)throw Error(`Message parsing ended unexpectedly. Expected to read ${i} bytes, instead read ${i-s} bytes, either the data ended unexpectedly or the message misreported its own length`);return e.g.g=r,e.g.l=o,t}function gd(e){var t=ai(e.g),n=p0(e=e.g,t);if(e=e.h,Kx){var o,i=e;(o=eu)||(o=eu=new TextDecoder("utf-8",{fatal:!0})),t=n+t,i=n===0&&t===i.length?i:i.subarray(n,t);try{var r=o.decode(i)}catch(a){if(Ta===void 0){try{o.decode(new Uint8Array([128]))}catch{}try{o.decode(new Uint8Array([97])),Ta=!0}catch{Ta=!1}}throw!Ta&&(eu=void 0),a}}else{t=(r=n)+t,n=[];let a,c=null;for(;r<t;){var s=e[r++];128>s?n.push(s):224>s?r>=t?yi():(a=e[r++],194>s||(192&a)!=128?(r--,yi()):n.push((31&s)<<6|63&a)):240>s?r>=t-1?yi():(a=e[r++],(192&a)!=128||s===224&&160>a||s===237&&160<=a||(192&(o=e[r++]))!=128?(r--,yi()):n.push((15&s)<<12|(63&a)<<6|63&o)):244>=s?r>=t-2?yi():(a=e[r++],(192&a)!=128||a-144+(s<<28)>>30||(192&(o=e[r++]))!=128||(192&(i=e[r++]))!=128?(r--,yi()):(s=(7&s)<<18|(63&a)<<12|(63&o)<<6|63&i,s-=65536,n.push(55296+(s>>10&1023),56320+(1023&s)))):yi(),8192<=n.length&&(c=Fp(c,n),n.length=0)}r=Fp(c,n)}return r}function v0(e){const t=ai(e.g);return m0(e.g,t)}function nl(e,t,n){var o=ai(e.g);for(o=e.g.g+o;e.g.g<o;)n.push(t(e.g))}var Ea=[];function zp(e){return e?/^\d+$/.test(e)?(tl(e),new Bp(Ae,$e)):null:aw||(aw=new Bp(0,0))}var Bp=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let aw;function jp(e){return e?/^-?\d+$/.test(e)?(tl(e),new _p(Ae,$e)):null:cw||(cw=new _p(0,0))}var _p=class{constructor(e,t){this.h=e>>>0,this.g=t>>>0}};let cw;function bc(e,t,n){for(;0<n||127<t;)e.g.push(127&t|128),t=(t>>>7|n<<25)>>>0,n>>>=7;e.g.push(t)}function Ys(e,t){for(;127<t;)e.g.push(127&t|128),t>>>=7;e.g.push(t)}function ol(e,t){if(0<=t)Ys(e,t);else{for(let n=0;9>n;n++)e.g.push(127&t|128),t>>=7;e.g.push(1)}}function Is(e,t){e.g.push(t>>>0&255),e.g.push(t>>>8&255),e.g.push(t>>>16&255),e.g.push(t>>>24&255)}function mr(e,t){t.length!==0&&(e.l.push(t),e.h+=t.length)}function wn(e,t,n){Ys(e.g,8*t+n)}function vd(e,t){return wn(e,t,2),t=e.g.end(),mr(e,t),t.push(e.h),t}function yd(e,t){var n=t.pop();for(n=e.h+e.g.length()-n;127<n;)t.push(127&n|128),n>>>=7,e.h++;t.push(n),e.h++}function il(e,t,n){wn(e,t,2),Ys(e.g,n.length),mr(e,e.g.end()),mr(e,n)}function nf(e,t,n,o){n!=null&&(t=vd(e,t),o(n,e),yd(e,t))}class Dr{constructor(t,n,o,i){this.g=t,this.h=n,this.l=o,this.pa=i}}function Zt(e){return Array.prototype.slice.call(e)}function y0(e){return typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol():e}var eo=y0(),Hp=y0("0di"),bd=eo?(e,t)=>{e[eo]|=t}:(e,t)=>{e.g!==void 0?e.g|=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}})},xc=eo?(e,t)=>{e[eo]&=~t}:(e,t)=>{e.g!==void 0&&(e.g&=~t)};function pt(e,t,n){return n?e|t:e&~t}var Ge=eo?e=>0|e[eo]:e=>0|e.g,ve=eo?e=>e[eo]:e=>e.g,qe=eo?(e,t)=>(e[eo]=t,e):(e,t)=>(e.g!==void 0?e.g=t:Object.defineProperties(e,{g:{value:t,configurable:!0,writable:!0,enumerable:!1}}),e);function Ir(e){return bd(e,34),e}function lw(e,t){qe(t,-14591&(0|e))}function of(e,t){qe(t,-14557&(34|e))}function b0(e){return(e=e>>14&1023)===0?536870912:e}var xd,Qs={},x0={};function qp(e){return!(!e||typeof e!="object"||e.Ja!==x0)}function wd(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)&&e.constructor===Object}function Sd(e,t,n){if(e!=null){if(typeof e=="string")e=e?new Vo(e,pr):Fi();else if(e.constructor!==Vo)if(Zs(e))e=e.length?new Vo(n?e:new Uint8Array(e),pr):Fi();else{if(!t)throw Error();e=void 0}}return e}function wc(e,t,n){if(!Array.isArray(e)||e.length)return!1;const o=Ge(e);return!!(1&o)||!(!t||!(Array.isArray(t)?t.includes(n):t.has(n)))&&(qe(e,1|o),!0)}const Wp=[];function ro(e){if(2&e)throw Error()}qe(Wp,55),xd=Object.freeze(Wp);class Sc{constructor(t,n,o){this.l=0,this.g=t,this.h=n,this.m=o}next(){if(this.l<this.g.length){const t=this.g[this.l++];return{done:!1,value:this.h?this.h.call(this.m,t):t}}return{done:!0,value:void 0}}[Symbol.iterator](){return new Sc(this.g,this.h,this.m)}}let ii,uw;function w0(e,t){(t=ii?t[ii]:void 0)&&(e[ii]=Zt(t))}function rf(e){return(e=Error(e)).__closure__error__context__984382||(e.__closure__error__context__984382={}),e.__closure__error__context__984382.severity="warning",e}function hi(e){return e==null||typeof e=="number"?e:e==="NaN"||e==="Infinity"||e==="-Infinity"?Number(e):void 0}function S0(e){return e==null||typeof e=="boolean"?e:typeof e=="number"?!!e:void 0}Object.freeze(new class{}),Object.freeze(new class{});const fw=/^-?([1-9][0-9]*|0)(\.[0-9]+)?$/;function rl(e){const t=typeof e;return t==="number"?Number.isFinite(e):t==="string"&&fw.test(e)}function Fr(e){if(e==null)return e;if(typeof e=="string"){if(!e)return;e=+e}return typeof e=="number"&&Number.isFinite(e)?0|e:void 0}function dw(e){if(e==null)return e;if(typeof e=="string"){if(!e)return;e=+e}return typeof e=="number"&&Number.isFinite(e)?e>>>0:void 0}function Gp(e){return e[0]!=="-"&&(20>e.length||e.length===20&&184467>Number(e.substring(0,6)))}function T0(e){return e[0]==="-"?20>e.length||e.length===20&&-922337<Number(e.substring(0,7)):19>e.length||e.length===19&&922337>Number(e.substring(0,6))}function Td(e){return e=Math.trunc(e),Number.isSafeInteger(e)||(Pi(e),e=dd(Ae,$e)),e}function Ed(e){var t=Math.trunc(Number(e));return Number.isSafeInteger(t)?String(t):((t=e.indexOf("."))!==-1&&(e=e.substring(0,t)),T0(e)||(tl(e),e=h0()),e)}function Tc(e){return e==null?e:rl(e)?typeof e=="number"?Td(e):Ed(e):void 0}function Js(e){if(typeof e!="string")throw Error();return e}function Rr(e){if(e!=null&&typeof e!="string")throw Error();return e}function Fs(e){return e==null||typeof e=="string"?e:void 0}function Md(e,t,n,o){if(e!=null&&typeof e=="object"&&e.X===Qs)return e;if(!Array.isArray(e))return n?2&o?(e=t[Hp])?t=e:(Ir((e=new t).u),t=t[Hp]=e):t=new t:t=void 0,t;let i=n=Ge(e);return i===0&&(i|=32&o),i|=2&o,i!==n&&qe(e,i),new t(e)}function hw(e,t,n){if(t){var o=!!o;if(!rl(t=e))throw rf("int64");typeof t=="string"?o=Ed(t):o?(o=Math.trunc(t),Number.isSafeInteger(o)?o=String(o):T0(t=String(o))?o=t:(Pi(o),o=h0())):o=Td(t)}else o=Tc(e);return typeof(n=(e=o)==null?n?0:void 0:e)=="string"&&(o=+n,Number.isSafeInteger(o))?o:n}let Ec,Pd,pw;function Mc(e){switch(typeof e){case"boolean":return Pd||(Pd=[0,void 0,!0]);case"number":return 0<e?void 0:e===0?pw||(pw=[0,void 0]):[-e,void 0];case"string":return[0,e];case"object":return e}}function Ai(e,t){return E0(e,t[0],t[1])}function E0(e,t,n){if(e==null&&(e=Ec),Ec=void 0,e==null){var o=96;n?(e=[n],o|=512):e=[],t&&(o=-16760833&o|(1023&t)<<14)}else{if(!Array.isArray(e)||2048&(o=Ge(e)))throw Error();if(64&o)return e;if(o|=64,n&&(o|=512,n!==e[0]))throw Error();e:{const i=(n=e).length;if(i){const r=i-1;if(wd(n[r])){if(1024<=(t=r-(+!!(512&(o|=256))-1)))throw Error();o=-16760833&o|(1023&t)<<14;break e}}if(t){if(1024<(t=Math.max(t,i-(+!!(512&o)-1))))throw Error();o=-16760833&o|(1023&t)<<14}}}return qe(e,o),e}const mw={};let gw=function(){try{return new class extends Map{constructor(){super()}},!1}catch{return!0}}();class ou{constructor(){this.g=new Map}get(t){return this.g.get(t)}set(t,n){return this.g.set(t,n),this.size=this.g.size,this}delete(t){return t=this.g.delete(t),this.size=this.g.size,t}clear(){this.g.clear(),this.size=this.g.size}has(t){return this.g.has(t)}entries(){return this.g.entries()}keys(){return this.g.keys()}values(){return this.g.values()}forEach(t,n){return this.g.forEach(t,n)}[Symbol.iterator](){return this.entries()}}const vw=gw?(Object.setPrototypeOf(ou.prototype,Map.prototype),Object.defineProperties(ou.prototype,{size:{value:0,configurable:!0,enumerable:!0,writable:!0}}),ou):class extends Map{constructor(){super()}};function Xp(e){return e}function iu(e){if(2&e.L)throw Error("Cannot mutate an immutable Map")}var bn=class extends vw{constructor(e,t,n=Xp,o=Xp){super();let i=Ge(e);i|=64,qe(e,i),this.L=i,this.U=t,this.S=n,this.Z=this.U?yw:o;for(let r=0;r<e.length;r++){const s=e[r],a=n(s[0],!1,!0);let c=s[1];t?c===void 0&&(c=null):c=o(s[1],!1,!0,void 0,void 0,i),super.set(a,c)}}oa(e=Zp){if(this.size!==0)return this.Y(e)}Y(e=Zp){const t=[],n=super.entries();for(var o;!(o=n.next()).done;)(o=o.value)[0]=e(o[0]),o[1]=e(o[1]),t.push(o);return t}clear(){iu(this),super.clear()}delete(e){return iu(this),super.delete(this.S(e,!0,!1))}entries(){var e=this.na();return new Sc(e,bw,this)}keys(){return this.Ia()}values(){var e=this.na();return new Sc(e,bn.prototype.get,this)}forEach(e,t){super.forEach((n,o)=>{e.call(t,this.get(o),o,this)})}set(e,t){return iu(this),(e=this.S(e,!0,!1))==null?this:t==null?(super.delete(e),this):super.set(e,this.Z(t,!0,!0,this.U,!1,this.L))}Oa(e){const t=this.S(e[0],!1,!0);e=e[1],e=this.U?e===void 0?null:e:this.Z(e,!1,!0,void 0,!1,this.L),super.set(t,e)}has(e){return super.has(this.S(e,!1,!1))}get(e){e=this.S(e,!1,!1);const t=super.get(e);if(t!==void 0){var n=this.U;return n?((n=this.Z(t,!1,!0,n,this.ta,this.L))!==t&&super.set(e,n),n):t}}na(){return Array.from(super.keys())}Ia(){return super.keys()}[Symbol.iterator](){return this.entries()}};function yw(e,t,n,o,i,r){return e=Md(e,o,n,r),i&&(e=al(e)),e}function Zp(e){return e}function bw(e){return[e,this.get(e)]}let xw;function Kp(){return xw||(xw=new bn(Ir([]),void 0,void 0,void 0,mw))}function Nd(e,t,n,o,i){if(e!=null){if(Array.isArray(e))e=wc(e,void 0,0)?void 0:i&&2&Ge(e)?e:sl(e,t,n,o!==void 0,i);else if(wd(e)){const r={};for(let s in e)r[s]=Nd(e[s],t,n,o,i);e=r}else e=t(e,o);return e}}function sl(e,t,n,o,i){const r=o||n?Ge(e):0;o=o?!!(32&r):void 0;const s=Zt(e);for(let a=0;a<s.length;a++)s[a]=Nd(s[a],t,n,o,i);return n&&(w0(s,e),n(r,s)),s}function ww(e){return Nd(e,Ad,void 0,void 0,!1)}function Ad(e){return e.X===Qs?e.toJSON():e instanceof bn?e.oa(ww):function(t){switch(typeof t){case"number":return isFinite(t)?t:String(t);case"boolean":return t?1:0;case"object":if(t)if(Array.isArray(t)){if(wc(t,void 0,0))return}else{if(Zs(t))return Op(t);if(t instanceof Vo){const n=t.g;return n==null?"":typeof n=="string"?n:t.g=Op(n)}if(t instanceof bn)return t.oa()}}return t}(e)}function sf(e,t,n=of){if(e!=null){if(s0&&e instanceof Uint8Array)return t?e:new Uint8Array(e);if(Array.isArray(e)){var o=Ge(e);return 2&o?e:(t&&(t=o===0||!!(32&o)&&!(64&o||!(16&o))),t?qe(e,-12293&(34|o)):sl(e,sf,4&o?of:n,!0,!0))}return e.X===Qs?(n=e.u,e=2&(o=ve(n))?e:Cd(e,n,o,!0)):e instanceof bn&&!(2&e.L)&&(n=Ir(e.Y(sf)),e=new bn(n,e.U,e.S,e.Z)),e}}function Cd(e,t,n,o){return e=e.constructor,Ec=t=M0(t,n,o),t=new e(t),Ec=void 0,t}function M0(e,t,n){const o=n||2&t?of:lw,i=!!(32&t);return e=function(r,s,a){const c=Zt(r);var l=c.length;const u=256&s?c[l-1]:void 0;for(l+=u?-1:0,s=512&s?1:0;s<l;s++)c[s]=a(c[s]);if(u){s=c[s]={};for(const d in u)s[d]=a(u[d])}return w0(c,r),c}(e,t,r=>sf(r,i,o)),bd(e,32|(n?2:0)),e}function al(e){const t=e.u,n=ve(t);return 2&n?Cd(e,t,n,!1):e}function gr(e,t){return so(e=e.u,ve(e),t)}function so(e,t,n,o){if(n===-1)return null;if(n>=b0(t)){if(256&t)return e[e.length-1][n]}else{var i=e.length;if(o&&256&t&&(o=e[i-1][n])!=null)return o;if((t=n+(+!!(512&t)-1))<i)return e[t]}}function Ee(e,t,n,o){const i=e.u;let r=ve(i);return ro(r),Ce(i,r,t,n,o),e}function Ce(e,t,n,o,i){const r=b0(t);if(n>=r||i){let s=t;if(256&t)i=e[e.length-1];else{if(o==null)return s;i=e[r+(+!!(512&t)-1)]={},s|=256}return i[n]=o,n<r&&(e[n+(+!!(512&t)-1)]=void 0),s!==t&&qe(e,s),s}return e[n+(+!!(512&t)-1)]=o,256&t&&n in(e=e[e.length-1])&&delete e[n],t}function Or(e,t,n,o,i){var r=2&t;let s=so(e,t,n,i);Array.isArray(s)||(s=xd);const a=!(2&o);o=!(1&o);const c=!!(32&t);let l=Ge(s);return l!==0||!c||r||a?1&l||(l|=1,qe(s,l)):(l|=33,qe(s,l)),r?(e=!1,2&l||(Ir(s),e=!!(4&l)),(o||e)&&Object.freeze(s)):(r=!!(2&l)||!!(2048&l),o&&r?(s=Zt(s),o=1,c&&!a&&(o|=32),qe(s,o),Ce(e,t,n,s,i)):a&&32&l&&!r&&xc(s,32)),s}function tc(e,t){e=e.u;let n=ve(e);const o=so(e,n,t),i=hi(o);return i!=null&&i!==o&&Ce(e,n,t,i),i}function P0(e){e=e.u;let t=ve(e);const n=so(e,t,1),o=Sd(n,!0,!!(34&t));return o!=null&&o!==n&&Ce(e,t,1,o),o}function cr(e,t,n){e=e.u;let o=ve(e);const i=2&o?1:2;let r=N0(e,o,t);var s=Ge(r);if(!(4&s)){(4&s||Object.isFrozen(r))&&(r=Zt(r),s=Ri(s,o,!1),o=Ce(e,o,t,r));var a=0;let c=0;for(;a<r.length;a++){const l=n(r[a]);l!=null&&(r[c++]=l)}c<a&&(r.length=c),s=pt(s=A0(s,o,!1),20,!0),s=pt(s,4096,!1),s=pt(s,8192,!1),qe(r,s),2&s&&Object.freeze(r)}return bs(s)||(n=s,(s=(a=i===1)?pt(s,2,!0):pt(s,32,!1))!==n&&qe(r,s),a&&Object.freeze(r)),i===2&&bs(s)&&(r=Zt(r),s=Ri(s,o,!1),qe(r,s),Ce(e,o,t,r)),r}function N0(e,t,n){return e=so(e,t,n),Array.isArray(e)?e:xd}function A0(e,t,n){return e===0&&(e=Ri(e,t,n)),pt(e,1,!0)}function bs(e){return!!(2&e)&&!!(4&e)||!!(2048&e)}function C0(e){e=Zt(e);for(let t=0;t<e.length;t++){const n=e[t]=Zt(e[t]);Array.isArray(n[1])&&(n[1]=Ir(n[1]))}return e}function Pc(e,t,n){{const s=e.u;let a=ve(s);if(ro(a),n==null)Ce(s,a,t);else{var o,i=e=Ge(n),r=!!(2&e)||Object.isFrozen(n);if((o=!r)&&(o=!1),!(4&e))for(e=21,r&&(n=Zt(n),i=0,e=Ri(e,a,!0)),r=0;r<n.length;r++)n[r]=Js(n[r]);o&&(n=Zt(n),i=0,e=Ri(e,a,!0)),e!==i&&qe(n,e),Ce(s,a,t,n)}}}function af(e,t,n,o){e=e.u;let i=ve(e);ro(i),Ce(e,i,t,(o==="0"?Number(n)===0:n===o)?void 0:n)}function $s(e,t,n,o){const i=ve(e);ro(i),e=Or(e,i,t,2),o=n(o,!!(4&(t=Ge(e)))&&!!(4096&t)),e.push(o)}function Sw(e){return e}function ru(e,t){return Ld(e=e.u,ve(e),hv)===t?t:-1}function Ld(e,t,n){let o=0;for(let i=0;i<n.length;i++){const r=n[i];so(e,t,r)!=null&&(o!==0&&(t=Ce(e,t,o)),o=r)}return o}function Dd(e,t,n,o){let i=ve(e);ro(i);const r=so(e,i,n,o);let s;if(r!=null&&r.X===Qs)return(t=al(r))!==r&&Ce(e,i,n,t,o),t.u;if(Array.isArray(r)){const a=Ge(r);s=2&a?M0(r,a,!1):r,s=Ai(s,t)}else s=Ai(void 0,t);return s!==r&&Ce(e,i,n,s,o),s}function L0(e,t,n,o){e=e.u;let i=ve(e);const r=so(e,i,n,o);return(t=Md(r,t,!1,i))!==r&&t!=null&&Ce(e,i,n,t,o),t}function fe(e,t,n,o=!1){if((t=L0(e,t,n,o))==null)return t;e=e.u;let i=ve(e);if(!(2&i)){const r=al(t);r!==t&&Ce(e,i,n,t=r,o)}return t}function D0(e,t,n,o,i,r){var s=!!(2&t),a=s?1:2;const c=a===1;a=a===2,i=!!i,r&&(r=!s),s=N0(e,t,o);var l=Ge(s);const u=!!(4&l);if(!u){var d=s,f=t;const h=!!(2&(l=A0(l,t,i)));h&&(f=pt(f,2,!0));let p=!h,g=!0,m=0,v=0;for(;m<d.length;m++){const y=Md(d[m],n,!1,f);if(y instanceof n){if(!h){const w=!!(2&Ge(y.u));p&&(p=!w),g&&(g=w)}d[v++]=y}}v<m&&(d.length=v),l=pt(l,4,!0),l=pt(l,16,g),l=pt(l,8,p),qe(d,l),h&&Object.freeze(d)}if(n=!!(8&l)||c&&!s.length,r&&!n){for(bs(l)&&(s=Zt(s),l=Ri(l,t,i),t=Ce(e,t,o,s)),r=s,n=l,d=0;d<r.length;d++)(l=r[d])!==(f=al(l))&&(r[d]=f);n=pt(n,8,!0),n=pt(n,16,!r.length),qe(r,n),l=n}return bs(l)||(r=l,c?l=pt(l,!s.length||16&l&&(!u||32&l)?2:2048,!0):i||(l=pt(l,32,!1)),l!==r&&qe(s,l),c&&Object.freeze(s)),a&&bs(l)&&(s=Zt(s),l=Ri(l,t,i),qe(s,l),Ce(e,t,o,s)),s}function _o(e,t,n){e=e.u;const o=ve(e);return D0(e,o,t,n,!1,!(2&o))}function Y(e,t,n,o,i){return o==null&&(o=void 0),Ee(e,n,o,i)}function xs(e,t,n,o){o==null&&(o=void 0),e=e.u;let i=ve(e);ro(i),(n=Ld(e,i,n))&&n!==t&&o!=null&&(i=Ce(e,i,n)),Ce(e,i,t,o)}function Ri(e,t,n){return e=pt(e,2,!!(2&t)),e=pt(e,32,!!(32&t)&&n),pt(e,2048,!1)}function Nc(e,t,n,o){e=e.u;const i=ve(e);ro(i),t=D0(e,i,n,t,!0),n=o??new n,t.push(n),2&Ge(n.u)?xc(t,8):xc(t,16)}function cn(e,t){return Fr(gr(e,t))}function xn(e,t){return Fs(gr(e,t))}function to(e){return e??0}function Ke(e,t){return to(tc(e,t))}function Rs(e,t,n){if(n!=null&&typeof n!="boolean")throw e=typeof n,Error(`Expected boolean but got ${e!="object"?e:n?Array.isArray(n)?"array":e:"null"}: ${n}`);Ee(e,t,n)}function no(e,t,n){if(n!=null){if(typeof n!="number"||!Number.isFinite(n))throw rf("int32");n|=0}Ee(e,t,n)}function Z(e,t,n){if(n!=null&&typeof n!="number")throw Error(`Value of float/double field must be a number, found ${typeof n}: ${n}`);Ee(e,t,n)}function kn(e,t,n){t.g?t.m(e,t.g,t.h,n,!0):t.m(e,t.h,n,!0)}bn.prototype.toJSON=void 0,bn.prototype.Ja=x0;var G=class{constructor(e,t){this.u=E0(e,t)}toJSON(){return I0(this,sl(this.u,Ad,void 0,void 0,!1),!0)}l(){var e=AS;return e.g?e.l(this,e.g,e.h,!0):e.l(this,e.h,e.defaultValue,!0)}clone(){const e=this.u;return Cd(this,e,ve(e),!1)}N(){return!!(2&Ge(this.u))}};function I0(e,t,n){var o=Jx?void 0:e.constructor.A;const i=ve(n?e.u:t);if(!(e=t.length))return t;let r,s;if(wd(n=t[e-1])){e:{var a=n;let u={},d=!1;for(var c in a){let f=a[c];if(Array.isArray(f)){let h=f;(wc(f,o,+c)||qp(f)&&f.size===0)&&(f=null),f!=h&&(d=!0)}f!=null?u[c]=f:d=!0}if(d){for(var l in u){a=u;break e}a=null}}a!=n&&(r=!0),e--}for(c=+!!(512&i)-1;0<e&&(n=t[l=e-1],l-=c,n==null||wc(n,o,l)||qp(n)&&n.size===0);e--)s=!0;return(r||s)&&(t=Array.prototype.slice.call(t,0,e),a&&t.push(a)),t}function F0(e){return Array.isArray(e)?e[0]instanceof Dr?e:[Fw,e]:[e,void 0]}function kr(e,t){if(Array.isArray(t)){var n=Ge(t);if(4&n)return t;for(var o=0,i=0;o<t.length;o++){const r=e(t[o]);r!=null&&(t[i++]=r)}return i<o&&(t.length=i),qe(t,-12289&(5|n)),2&n&&Object.freeze(t),t}}G.prototype.X=Qs,G.prototype.toString=function(){return I0(this,this.u,!1).toString()};const Yp=Symbol();function Id(e){let t=e[Yp];if(!t){const n=O0(e),o=Rd(e),i=o.l;t=i?(r,s)=>i(r,s,o):(r,s)=>{for(;g0(s)&&s.h!=4;){var a=s.m,c=o[a];if(!c){var l=o.ea;l&&(l=l[a])&&(c=o[a]=Tw(l))}c&&c(s,r,a)||(a=(c=s).l,ec(c),c.ia?c=void 0:(l=c.g.g-a,c.g.g=a,c=m0(c.g,l)),a=r,c&&(ii||(ii=Symbol()),(l=a[ii])?l.push(c):a[ii]=[c]))}n===R0||n===nc||n.j||(r[uw||(uw=Symbol())]=n)},e[Yp]=t}return t}function Tw(e){const t=(e=F0(e))[0].g;if(e=e[1]){const n=Id(e),o=Rd(e).T;return(i,r,s)=>t(i,r,s,o,n)}return t}class su{}let R0,nc;const ws=Symbol();function Ew(e,t,n){const o=n[1];let i;if(o){const r=o[ws];i=r?r.T:Mc(o[0]),e[t]=r??o}i&&i===Pd?(e.g||(e.g=new Set)).add(t):n[0]&&(e.h||(e.h=new Set)).add(t)}function Qp(e,t){return[e.l,!t||0<t[0]?void 0:t]}function O0(e){var t=e[ws];if(t)return t;if(!(t=Fd(e,e[ws]=new su,Qp,Qp,Ew)).ea&&!t.h&&!t.g){let n=!0;for(let o in t)isNaN(o)||(n=!1);n?(Mc(e[0])===Pd?nc?t=nc:((t=new su).T=Mc(!0),t=nc=t):t=R0||(R0=new su),t=e[ws]=t):t.j=!0}return t}function Mw(e,t,n){e[t]=n}function Fd(e,t,n,o,i=Mw){t.T=Mc(e[0]);let r=0;var s=e[++r];s&&s.constructor===Object&&(t.ea=s,typeof(s=e[++r])=="function"&&(t.l=s,t.m=e[++r],s=e[++r]));const a={};for(;Array.isArray(s)&&typeof s[0]=="number"&&0<s[0];){for(var c=0;c<s.length;c++)a[s[c]]=s;s=e[++r]}for(c=1;s!==void 0;){let d;typeof s=="number"&&(c+=s,s=e[++r]);var l=void 0;if(s instanceof Dr?d=s:(d=Rw,r--),d.pa){s=e[++r],l=e;var u=r;typeof s=="function"&&(s=s(),l[u]=s),l=s}for(u=c+1,typeof(s=e[++r])=="number"&&0>s&&(u-=s,s=e[++r]);c<u;c++){const f=a[c];i(t,c,l?o(d,l,f):n(d,f))}}return t}const Jp=Symbol();function k0(e){let t=e[Jp];if(!t){const n=cl(e);t=(o,i)=>U0(o,i,n),e[Jp]=t}return t}const cf=Symbol();function Pw(e){return e.h}function Nw(e,t){let n,o;const i=e.h;return(r,s,a)=>i(r,s,a,o||(o=cl(t).T),n||(n=k0(t)))}function cl(e){let t=e[cf];return t||(t=Fd(e,e[cf]={},Pw,Nw),V0(e),t)}const lf=Symbol();function Aw(e,t){const n=e.g;return t?(o,i,r)=>n(o,i,r,t):n}function Cw(e,t,n){const o=e.g;let i,r;return(s,a,c)=>o(s,a,c,r||(r=Rd(t).T),i||(i=Id(t)),n)}function Rd(e){let t=e[lf];return t||(O0(e),t=Fd(e,e[lf]={},Aw,Cw),V0(e),t)}function V0(e){lf in e&&ws in e&&cf in e&&(e.length=0)}function $p(e,t){var n=e[t];if(n)return n;if((n=e.ea)&&(n=n[t])){var o=(n=F0(n))[0].h;if(n=n[1]){const i=k0(n),r=cl(n).T;n=(n=e.m)?n(r,i):(s,a,c)=>o(s,a,c,r,i)}else n=o;return e[t]=n}}function U0(e,t,n){for(var o=ve(e),i=+!!(512&o)-1,r=e.length,s=512&o?1:0,a=r+(256&o?-1:0);s<a;s++){const c=e[s];if(c==null)continue;const l=s-i,u=$p(n,l);u&&u(t,c,l)}if(256&o){o=e[r-1];for(let c in o)i=+c,Number.isNaN(i)||(r=o[c])!=null&&(a=$p(n,i))&&a(t,r,i)}if(e=ii?e[ii]:void 0)for(mr(t,t.g.end()),n=0;n<e.length;n++)mr(t,ad(e[n])||el())}function Vt(e,t){return new Dr(e,t,!1,!1)}function Vr(e,t){return new Dr(e,t,!0,!1)}function ll(e,t){return new Dr(e,t,!1,!0)}function Ut(e,t,n){Ce(e,ve(e),t,n)}var Lw=ll(function(e,t,n,o,i){return e.h===2&&(e=Ks(e,Ai([void 0,void 0],o),i),ro(o=ve(t)),(i=so(t,o,n))instanceof bn?2&i.L?((i=i.Y()).push(e),Ce(t,o,n,i)):i.Oa(e):Array.isArray(i)?(2&Ge(i)&&Ce(t,o,n,i=C0(i)),i.push(e)):Ce(t,o,n,[e]),!0)},function(e,t,n,o,i){if(t instanceof bn)t.forEach((r,s)=>{nf(e,n,Ai([s,r],o),i)});else if(Array.isArray(t))for(let r=0;r<t.length;r++){const s=t[r];Array.isArray(s)&&nf(e,n,Ai(s,o),i)}});function z0(e,t,n){e:if(t!=null){if(rl(t)){if(typeof t=="string"){t=Ed(t);break e}if(typeof t=="number"){t=Td(t);break e}}t=void 0}t!=null&&(typeof t=="string"&&jp(t),t!=null&&(wn(e,n,0),typeof t=="number"?(e=e.g,Pi(t),bc(e,Ae,$e)):(n=jp(t),bc(e.g,n.h,n.g))))}function B0(e,t,n){(t=Fr(t))!=null&&t!=null&&(wn(e,n,0),ol(e.g,t))}function j0(e,t,n){(t=S0(t))!=null&&(wn(e,n,0),e.g.g.push(t?1:0))}function _0(e,t,n){(t=Fs(t))!=null&&il(e,n,n0(t))}function ul(e,t,n,o,i){nf(e,n,t instanceof G?t.u:Array.isArray(t)?Ai(t,o):void 0,i)}function H0(e,t,n){(t=t==null||typeof t=="string"||Zs(t)||t instanceof Vo?t:void 0)!=null&&il(e,n,ld(t).buffer)}function q0(e,t,n){return(e.h===5||e.h===2)&&(t=Or(t,ve(t),n,2,!1),e.h==2?nl(e,tf,t):t.push(tf(e.g)),!0)}var st,Uo=Vt(function(e,t,n){if(e.h!==1)return!1;var o=e.g;e=ef(o);const i=ef(o);o=2*(i>>31)+1;const r=i>>>20&2047;return e=4294967296*(1048575&i)+e,Ut(t,n,r==2047?e?NaN:1/0*o:r==0?o*Math.pow(2,-1074)*e:o*Math.pow(2,r-1075)*(e+4503599627370496)),!0},function(e,t,n){(t=hi(t))!=null&&(wn(e,n,1),e=e.g,(n=d0||(d0=new DataView(new ArrayBuffer(8)))).setFloat64(0,+t,!0),Ae=n.getUint32(0,!0),$e=n.getUint32(4,!0),Is(e,Ae),Is(e,$e))}),ct=Vt(function(e,t,n){return e.h===5&&(Ut(t,n,tf(e.g)),!0)},function(e,t,n){(t=hi(t))!=null&&(wn(e,n,5),e=e.g,fd(t),Is(e,Ae))}),Dw=Vr(q0,function(e,t,n){if((t=kr(hi,t))!=null)for(let s=0;s<t.length;s++){var o=e,i=n,r=t[s];r!=null&&(wn(o,i,5),o=o.g,fd(r),Is(o,Ae))}}),Od=Vr(q0,function(e,t,n){if((t=kr(hi,t))!=null&&t.length){wn(e,n,2),Ys(e.g,4*t.length);for(let o=0;o<t.length;o++)n=e.g,fd(t[o]),Is(n,Ae)}}),ci=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,pd(e.g,dd)),!0)},z0),au=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,(e=pd(e.g,dd))===0?void 0:e),!0)},z0),Iw=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,pd(e.g,$u)),!0)},function(e,t,n){e:if(t!=null){if(rl(t)){if(typeof t=="string"){var o=Math.trunc(Number(t));Number.isSafeInteger(o)&&0<=o?t=String(o):((o=t.indexOf("."))!==-1&&(t=t.substring(0,o)),Gp(t)||(tl(t),t=yc(Ae,$e)));break e}if(typeof t=="number"){t=0<=(t=Math.trunc(t))&&Number.isSafeInteger(t)?t:function(i){if(0>i){Pi(i);const r=yc(Ae,$e);return i=Number(r),Number.isSafeInteger(i)?i:r}return Gp(String(i))?i:(Pi(i),$u(Ae,$e))}(t);break e}}t=void 0}t!=null&&(typeof t=="string"&&zp(t),t!=null&&(wn(e,n,0),typeof t=="number"?(e=e.g,Pi(t),bc(e,Ae,$e)):(n=zp(t),bc(e.g,n.h,n.g))))}),Ze=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,si(e.g)),!0)},B0),kd=Vr(function(e,t,n){return(e.h===0||e.h===2)&&(t=Or(t,ve(t),n,2,!1),e.h==2?nl(e,si,t):t.push(si(e.g)),!0)},function(e,t,n){if((t=kr(Fr,t))!=null&&t.length){n=vd(e,n);for(let o=0;o<t.length;o++)ol(e.g,t[o]);yd(e,n)}}),vr=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,(e=si(e.g))===0?void 0:e),!0)},B0),nt=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,md(e.g)),!0)},j0),Ss=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,(e=md(e.g))===!1?void 0:e),!0)},j0),Et=Vr(function(e,t,n){return e.h===2&&($s(t,n,Sw,e=gd(e)),!0)},function(e,t,n){if((t=kr(Fs,t))!=null)for(let s=0;s<t.length;s++){var o=e,i=n,r=t[s];r!=null&&il(o,i,n0(r))}}),li=Vt(function(e,t,n){return e.h===2&&(Ut(t,n,(e=gd(e))===""?void 0:e),!0)},_0),Ie=Vt(function(e,t,n){return e.h===2&&(Ut(t,n,gd(e)),!0)},_0),Fw=ll(function(e,t,n,o,i){return e.h===2&&(Ks(e,Dd(t,o,n,!0),i),!0)},ul),Rw=ll(function(e,t,n,o,i){return e.h===2&&(Ks(e,Dd(t,o,n),i),!0)},ul);st=new Dr(function(e,t,n,o,i){if(e.h!==2)return!1;o=Ai(void 0,o);let r=ve(t);ro(r);let s=Or(t,r,n,3);return r=ve(t),4&Ge(s)&&(s=Zt(s),qe(s,-2079&(1|Ge(s))),Ce(t,r,n,s)),s.push(o),Ks(e,o,i),!0},function(e,t,n,o,i){if(Array.isArray(t))for(let r=0;r<t.length;r++)ul(e,t[r],n,o,i)},!0,!0);var Re=ll(function(e,t,n,o,i,r){if(e.h!==2)return!1;let s=ve(t);return ro(s),(r=Ld(t,s,r))&&n!==r&&Ce(t,s,r),Ks(e,t=Dd(t,o,n),i),!0},ul),W0=Vt(function(e,t,n){return e.h===2&&(Ut(t,n,v0(e)),!0)},H0),Ow=Vr(function(e,t,n){return(e.h===0||e.h===2)&&(t=Or(t,ve(t),n,2,!1),e.h==2?nl(e,ai,t):t.push(ai(e.g)),!0)},function(e,t,n){if((t=kr(dw,t))!=null)for(let s=0;s<t.length;s++){var o=e,i=n,r=t[s];r!=null&&(wn(o,i,0),Ys(o.g,r))}}),oo=Vt(function(e,t,n){return e.h===0&&(Ut(t,n,si(e.g)),!0)},function(e,t,n){(t=Fr(t))!=null&&(t=parseInt(t,10),wn(e,n,0),ol(e.g,t))}),kw=Vr(function(e,t,n){return(e.h===0||e.h===2)&&(t=Or(t,ve(t),n,2,!1),e.h==2?nl(e,sw,t):t.push(si(e.g)),!0)},function(e,t,n){if((t=kr(Fr,t))!=null&&t.length){n=vd(e,n);for(let o=0;o<t.length;o++)ol(e.g,t[o]);yd(e,n)}});class Vw{constructor(t,n){this.h=t,this.g=n,this.l=fe,this.m=Y,this.defaultValue=void 0}}function Vn(e,t){return new Vw(e,t)}function pi(e,t){return(n,o)=>{e:{if(Ea.length){const r=Ea.pop();r.o(o),nu(r.g,n,o),n=r}else n=new class{constructor(r,s){if(Up.length){const a=Up.pop();nu(a,r,s),r=a}else r=new class{constructor(a,c){this.h=null,this.m=!1,this.g=this.l=this.j=0,nu(this,a,c)}clear(){this.h=null,this.m=!1,this.g=this.l=this.j=0,this.ca=!1}}(r,s);this.g=r,this.l=this.g.g,this.h=this.m=-1,this.o(s)}o({ia:r=!1}={}){this.ia=r}}(n,o);try{const r=new e,s=r.u;Id(t)(s,n);var i=r;break e}finally{n.g.clear(),n.m=-1,n.h=-1,100>Ea.length&&Ea.push(n)}i=void 0}return i}}function fl(e){return function(){const t=new class{constructor(){this.l=[],this.h=0,this.g=new class{constructor(){this.g=[]}length(){return this.g.length}end(){const s=this.g;return this.g=[],s}}}};U0(this.u,t,cl(e)),mr(t,t.g.end());const n=new Uint8Array(t.h),o=t.l,i=o.length;let r=0;for(let s=0;s<i;s++){const a=o[s];n.set(a,r),r+=a.length}return t.l=[n],n}}var em=class extends G{constructor(e){super(e)}},G0=[0,li,Vt(function(e,t,n){return e.h===2&&(Ut(t,n,(e=v0(e))===Fi()?void 0:e),!0)},function(e,t,n){if(t!=null){if(t instanceof G){const o=t.Qa;return void(o&&(t=o(t),t!=null&&il(e,n,ld(t).buffer)))}if(Array.isArray(t))return}H0(e,t,n)})],Uw=[0,Ie],X0=[0,Ze,oo,nt,-1,kd,oo,-1],zw=[0,nt,-1],Z0=class extends G{constructor(){super()}};Z0.A=[6];var K0=[0,nt,Ie,nt,oo,-1,kw,Ie,-1,zw,oo],Y0=[0,Ie,-2],tm=class extends G{constructor(){super()}},Q0=[0],J0=[0,Ze,nt,-3],Kt=class extends G{constructor(e){super(e,2)}},Ve={},Bw=[-2,Ve,nt];Ve[336783863]=[0,Ie,nt,-1,Ze,[0,[1,2,3,4,5],Re,Q0,Re,K0,Re,Y0,Re,J0,Re,X0],Uw];var jw=[0,li,Ss],$0=[0,au,-1,Ss,-3,au,kd,li,vr,au,-1,Ss,vr,Ss,-2,li],ea=[-1,{}],ev=[0,Ie,1,ea],tv=[0,Ie,Et,ea];function Qt(e,t){af(e,2,Rr(t),"")}function Pe(e,t){$s(e.u,3,Js,t)}function ce(e,t){$s(e.u,4,Js,t)}var wt=class extends G{constructor(e){super(e,500)}o(e){return Y(this,0,7,e)}};wt.A=[3,4,5,6,8,13,17,1005];var _w=[-500,li,-1,Et,-3,Bw,st,G0,vr,-1,ev,tv,st,jw,li,$0,vr,Et,987,Et],Hw=[0,li,-1,ea],qw=[-500,Ie,-1,[-1,{}],998,Ie],Ww=[-500,Ie,Et,-1,[-2,{},nt],997,Et,-1],Gw=[-500,Ie,Et,ea,998,Et];function Jt(e,t){Nc(e,1,wt,t)}function Le(e,t){$s(e.u,10,Js,t)}function pe(e,t){$s(e.u,15,Js,t)}var Pt=class extends G{constructor(e){super(e,500)}o(e){return Y(this,0,1001,e)}};Pt.A=[1,6,7,9,10,15,16,17,14,1002];var nv=[-500,st,_w,4,st,qw,st,Ww,vr,st,Gw,Et,vr,ev,tv,st,Hw,Et,-2,$0,li,-1,Ss,979,ea,st,G0],Xw=pi(Pt,nv);Pt.prototype.g=fl(nv);var Zw=[0,st,[0,Ze,-2]],Kw=class extends G{constructor(e){super(e)}},Yw=[0,Ze,ct,Ie,-1],Vd=class extends G{constructor(e){super(e)}g(){return _o(this,Kw,1)}};Vd.A=[1];var ov=[0,st,Yw],dl=pi(Vd,ov),Qw=[0,Ze,ct],Jw=[0,Ze,-1,Zw],$w=class extends G{constructor(e){super(e)}},eS=[0,Ze,-3],tS=[0,ct,-3],nS=class extends G{constructor(e){super(e)}},oS=[0,ct,-1,Ie,ct],oc=class extends G{constructor(e){super(e)}h(){return fe(this,$w,2)}g(){return _o(this,nS,5)}};oc.A=[5];var iS=[0,oo,eS,tS,Jw,st,oS],iv=class extends G{constructor(e){super(e)}};iv.A=[1,2,3,8,9];var rv=pi(iv,[0,Et,kd,Od,iS,Ie,-1,ci,st,Qw,Et,ci]),sv=class extends G{constructor(e){super(e)}},rS=[0,ct,-4],av=class extends G{constructor(e){super(e)}};av.A=[1];var fr=pi(av,[0,st,rS]),cv=class extends G{constructor(e){super(e)}},sS=[0,ct,-4],lv=class extends G{constructor(e){super(e)}};lv.A=[1];var ta=pi(lv,[0,st,sS]),uv=class extends G{constructor(e){super(e)}};uv.A=[3];var aS=[0,Ze,-1,Od,oo],fv=class extends G{constructor(){super()}};fv.prototype.g=fl([0,ct,-4,ci]);var cS=class extends G{constructor(e){super(e)}},lS=[0,1,Ze,Ie,ov],dv=class extends G{constructor(e){super(e)}};dv.A=[1];var uS=pi(dv,[0,st,lS,ci]),uf=class extends G{constructor(e){super(e)}};uf.A=[1];var fS=class extends G{constructor(e){super(e)}qa(){const e=P0(this);return e??Fi()}},dS=class extends G{constructor(e){super(e)}},hv=[1,2],hS=[0,hv,Re,[0,Od],Re,[0,W0],Ze,Ie],pv=class extends G{constructor(e){super(e)}};pv.A=[1];var pS=pi(pv,[0,st,hS,ci]),hl=class extends G{constructor(e){super(e)}};hl.A=[4,5];var mv=[0,Ie,Ze,ct,Et,-1],nm=class extends G{constructor(e){super(e)}},mS=[0,nt,-1],om=class extends G{constructor(e){super(e)}},ic=[1,2,3,4,5],Ac=class extends G{constructor(e){super(e)}g(){return P0(this)!=null}h(){return xn(this,2)!=null}},gv=[0,W0,Ie,[0,Ze,ci,-1],[0,Iw,ci]],Ue=class extends G{constructor(e){super(e)}g(){return S0(gr(this,2))??!1}},Je=[0,gv,nt,[0,ic,Re,J0,Re,K0,Re,X0,Re,Q0,Re,Y0],oo],pl=class extends G{constructor(e){super(e)}},Ud=[0,Je,ct,-1,Ze],gS=Vn(502141897,pl);Ve[502141897]=Ud;var vv=[0,gv];Ve[512499200]=vv;var yv=[0,vv];Ve[515723506]=yv;var vS=pi(class extends G{constructor(e){super(e)}},[0,[0,oo,-1,Dw,Ow],aS]),bv=[0,Je];Ve[508981768]=bv;var xv=class extends G{constructor(e){super(e)}},zd=[0,Je,ct,bv,nt],wv=class extends G{constructor(e){super(e)}},Sv=[0,Je,Ud,zd,ct,yv];Ve[508968149]=zd;var yS=Vn(508968150,wv);Ve[508968150]=Sv;var Tv=class extends G{constructor(e){super(e)}},bS=Vn(513916220,Tv);Ve[513916220]=[0,Je,Sv,Ze];var _i=class extends G{constructor(e){super(e)}h(){return fe(this,hl,2)}g(){Ee(this,2)}},Ev=[0,Je,mv];Ve[478825465]=Ev;var Mv=[0,Je];Ve[478825422]=Mv;var xS=class extends G{constructor(e){super(e)}},Pv=[0,Je,Mv,Ev,-1],Nv=class extends G{constructor(e){super(e)}},Av=[0,Je,ct,Ze],Bd=class extends G{constructor(e){super(e)}},jd=[0,Je,ct],_d=class extends G{constructor(e){super(e)}},Cv=[0,Je,Av,jd,ct],Lv=class extends G{constructor(e){super(e)}},wS=[0,Je,Cv,Pv];Ve[463370452]=Pv,Ve[464864288]=Av,Ve[474472470]=jd;var SS=Vn(462713202,_d);Ve[462713202]=Cv;var TS=Vn(479097054,Lv);Ve[479097054]=wS;var ES=class extends G{constructor(e){super(e)}},MS=[0,Je],Dv=class extends G{constructor(e){super(e)}},Hd=[0,Je,ct,-1,Ze];Ve[514774813]=Hd;var Iv=class extends G{constructor(e){super(e)}},qd=[0,Je,ct,nt];Ve[518928384]=qd;var Fv=class extends G{constructor(){super()}};Fv.prototype.g=fl([0,Je,jd,MS,Ud,zd,Hd,qd]);var Rv=class extends G{constructor(e){super(e)}},PS=Vn(456383383,Rv);Ve[456383383]=[0,Je,mv];var Ov=class extends G{constructor(e){super(e)}},NS=Vn(476348187,Ov);Ve[476348187]=[0,Je,mS];var kv=class extends G{constructor(e){super(e)}},Vv=[0,oo,-1],ff=class extends G{constructor(e){super(e)}};ff.A=[3];var AS=Vn(458105876,class extends G{constructor(e){super(e)}g(){var e=this.u;const t=ve(e);var n=2&t;return e=function(o,i,r){var s=ff;const a=2&i;let c=!1;if(r==null){if(a)return Kp();r=[]}else if(r.constructor===bn){if(!(2&r.L)||a)return r;r=r.Y()}else Array.isArray(r)?c=!!(2&Ge(r)):r=[];if(a){if(!r.length)return Kp();c||(c=!0,Ir(r))}else c&&(c=!1,r=C0(r));return c||(64&Ge(r)?xc(r,32):32&i&&bd(r,32)),Ce(o,i,2,s=new bn(r,s,hw,void 0),!1),s}(e,t,so(e,t,2)),e==null||!n&&ff&&(e.ta=!0),n=e}});Ve[458105876]=[0,Vv,Lw,[!0,ci,[0,Ie,-1,Et]]];var Wd=class extends G{constructor(e){super(e)}},Uv=Vn(458105758,Wd);Ve[458105758]=[0,Je,Ie,Vv];var Gd=class extends G{constructor(e){super(e)}};Gd.A=[5,6];var CS=Vn(443442058,Gd);Ve[443442058]=[0,Je,Ie,Ze,ct,Et,-1];var zv=class extends G{constructor(e){super(e)}},LS=Vn(516587230,zv);function df(e,t){return t=t?t.clone():new hl,e.displayNamesLocale!==void 0?Ee(t,1,Rr(e.displayNamesLocale)):e.displayNamesLocale===void 0&&Ee(t,1),e.maxResults!==void 0?no(t,2,e.maxResults):"maxResults"in e&&Ee(t,2),e.scoreThreshold!==void 0?Z(t,3,e.scoreThreshold):"scoreThreshold"in e&&Ee(t,3),e.categoryAllowlist!==void 0?Pc(t,4,e.categoryAllowlist):"categoryAllowlist"in e&&Ee(t,4),e.categoryDenylist!==void 0?Pc(t,5,e.categoryDenylist):"categoryDenylist"in e&&Ee(t,5),t}function Xd(e,t=-1,n=""){return{categories:e.map(o=>({index:to(cn(o,1))??-1,score:Ke(o,2)??0,categoryName:xn(o,3)??""??"",displayName:xn(o,4)??""??""})),headIndex:t,headName:n}}function Bv(e){var s,a;var t=cr(e,3,hi),n=cr(e,2,Fr),o=cr(e,1,Fs),i=cr(e,9,Fs);const r={categories:[],keypoints:[]};for(let c=0;c<t.length;c++)r.categories.push({score:t[c],index:n[c]??-1,categoryName:o[c]??"",displayName:i[c]??""});if((t=(s=fe(e,oc,4))==null?void 0:s.h())&&(r.boundingBox={originX:cn(t,1)??0,originY:cn(t,2)??0,width:cn(t,3)??0,height:cn(t,4)??0,angle:0}),(a=fe(e,oc,4))==null?void 0:a.g().length)for(const c of fe(e,oc,4).g())r.keypoints.push({x:tc(c,1)??0,y:tc(c,2)??0,score:tc(c,4)??0,label:xn(c,3)??""});return r}function ml(e){const t=[];for(const n of _o(e,cv,1))t.push({x:Ke(n,1)??0,y:Ke(n,2)??0,z:Ke(n,3)??0,visibility:Ke(n,4)??0});return t}function Ts(e){const t=[];for(const n of _o(e,sv,1))t.push({x:Ke(n,1)??0,y:Ke(n,2)??0,z:Ke(n,3)??0,visibility:Ke(n,4)??0});return t}function im(e){return Array.from(e,t=>127<t?t-256:t)}function rm(e,t){if(e.length!==t.length)throw Error(`Cannot compute cosine similarity between embeddings of different sizes (${e.length} vs. ${t.length}).`);let n=0,o=0,i=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r],o+=e[r]*e[r],i+=t[r]*t[r];if(0>=o||0>=i)throw Error("Cannot compute cosine similarity on embedding with 0 norm.");return n/Math.sqrt(o*i)}Ve[516587230]=[0,Je,Hd,qd,ct];function jv(){const e=navigator.userAgent;return e.includes("Safari")&&!e.includes("Chrome")}async function sm(e){if(typeof importScripts!="function"){const t=document.createElement("script");return t.src=e.toString(),t.crossOrigin="anonymous",new Promise((n,o)=>{t.addEventListener("load",()=>{n()},!1),t.addEventListener("error",i=>{o(i)},!1),document.body.appendChild(t)})}importScripts(e.toString())}function _v(e){return e.videoWidth!==void 0?[e.videoWidth,e.videoHeight]:e.naturalWidth!==void 0?[e.naturalWidth,e.naturalHeight]:e.displayWidth!==void 0?[e.displayWidth,e.displayHeight]:[e.width,e.height]}function J(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target"),n(t=e.i.stringToNewUTF8(t)),e.i._free(t)}function am(e,t,n){if(!e.i.canvas)throw Error("No OpenGL canvas configured.");if(n?e.i._bindTextureToStream(n):e.i._bindTextureToCanvas(),!(n=e.i.canvas.getContext("webgl2")||e.i.canvas.getContext("webgl")))throw Error("Failed to obtain WebGL context from the provided canvas. `getContext()` should only be invoked with `webgl` or `webgl2`.");e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!0),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),e.i.gpuOriginForWebTexturesIsBottomLeft&&n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);const[o,i]=_v(t);return!e.l||o===e.i.canvas.width&&i===e.i.canvas.height||(e.i.canvas.width=o,e.i.canvas.height=i),[o,i]}function cm(e,t,n){e.m||console.error("No wasm multistream support detected: ensure dependency inclusion of :gl_graph_runner_internal_multi_input target");const o=new Uint32Array(t.length);for(let i=0;i<t.length;i++)o[i]=e.i.stringToNewUTF8(t[i]);t=e.i._malloc(4*o.length),e.i.HEAPU32.set(o,t>>2),n(t);for(const i of o)e.i._free(i);e.i._free(t)}function co(e,t,n){e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=n}function bi(e,t,n){let o=[];e.i.simpleListeners=e.i.simpleListeners||{},e.i.simpleListeners[t]=(i,r,s)=>{r?(n(o,s),o=[]):o.push(i)}}async function DS(e,t,n,o){return e=await(async(i,r,s,a,c)=>{if(r&&await sm(r),!self.ModuleFactory||s&&(await sm(s),!self.ModuleFactory))throw Error("ModuleFactory not set.");return self.Module&&c&&((r=self.Module).locateFile=c.locateFile,c.mainScriptUrlOrBlob&&(r.mainScriptUrlOrBlob=c.mainScriptUrlOrBlob)),c=await self.ModuleFactory(self.Module||c),self.ModuleFactory=self.Module=void 0,new i(c,a)})(e,n.wasmLoaderPath,n.assetLoaderPath,t,{locateFile:i=>i.endsWith(".wasm")?n.wasmBinaryPath.toString():n.assetBinaryPath&&i.endsWith(".data")?n.assetBinaryPath.toString():i}),await e.o(o),e}function lm(e,t){const n=fe(e.baseOptions,Ac,1)||new Ac;typeof t=="string"?(Ee(n,2,Rr(t)),Ee(n,1)):t instanceof Uint8Array&&(Ee(n,1,Sd(t,!1,!1)),Ee(n,2)),Y(e.baseOptions,0,1,n)}function um(e){try{const t=e.H.length;if(t===1)throw Error(e.H[0].message);if(1<t)throw Error("Encountered multiple errors: "+e.H.map(n=>n.message).join(", "))}finally{e.H=[]}}function H(e,t){e.C=Math.max(e.C,t)}function gl(e,t){e.B=new wt,Qt(e.B,"PassThroughCalculator"),Pe(e.B,"free_memory"),ce(e.B,"free_memory_unused_out"),Le(t,"free_memory"),Jt(t,e.B)}function yr(e,t){Pe(e.B,t),ce(e.B,t+"_unused_out")}function vl(e){e.g.addBoolToStream(!0,"free_memory",e.C)}var hf=class{constructor(e){this.g=e,this.H=[],this.C=0,this.g.setAutoRenderToScreen(!1)}l(e,t=!0){var n,o,i,r,s,a;if(t){const c=e.baseOptions||{};if((n=e.baseOptions)!=null&&n.modelAssetBuffer&&((o=e.baseOptions)!=null&&o.modelAssetPath))throw Error("Cannot set both baseOptions.modelAssetPath and baseOptions.modelAssetBuffer");if(!((i=fe(this.baseOptions,Ac,1))!=null&&i.g()||(r=fe(this.baseOptions,Ac,1))!=null&&r.h()||(s=e.baseOptions)!=null&&s.modelAssetBuffer||(a=e.baseOptions)!=null&&a.modelAssetPath))throw Error("Either baseOptions.modelAssetPath or baseOptions.modelAssetBuffer must be set");if(function(l,u){let d=fe(l.baseOptions,om,3);if(!d){var f=d=new om,h=new tm;xs(f,4,ic,h)}"delegate"in u&&(u.delegate==="GPU"?(u=d,f=new Z0,xs(u,2,ic,f)):(u=d,f=new tm,xs(u,4,ic,f))),Y(l.baseOptions,0,3,d)}(this,c),c.modelAssetPath)return fetch(c.modelAssetPath.toString()).then(l=>{if(l.ok)return l.arrayBuffer();throw Error(`Failed to fetch model: ${c.modelAssetPath} (${l.status})`)}).then(l=>{try{this.g.i.FS_unlink("/model.dat")}catch{}this.g.i.FS_createDataFile("/","model.dat",new Uint8Array(l),!0,!1,!1),lm(this,"/model.dat"),this.m(),this.K()});lm(this,c.modelAssetBuffer)}return this.m(),this.K(),Promise.resolve()}K(){}fa(){let e;if(this.g.fa(t=>{e=Xw(t)}),!e)throw Error("Failed to retrieve CalculatorGraphConfig");return e}setGraph(e,t){this.g.attachErrorListener((n,o)=>{this.H.push(Error(o))}),this.g.Ma(),this.g.setGraph(e,t),this.B=void 0,um(this)}finishProcessing(){this.g.finishProcessing(),um(this)}close(){this.B=void 0,this.g.closeGraph()}};function zo(e,t){if(!e)throw Error(`Unable to obtain required WebGL resource: ${t}`);return e}hf.prototype.close=hf.prototype.close;class IS{constructor(t,n,o,i){this.g=t,this.h=n,this.m=o,this.l=i}bind(){this.g.bindVertexArray(this.h)}close(){this.g.deleteVertexArray(this.h),this.g.deleteBuffer(this.m),this.g.deleteBuffer(this.l)}}function fm(e,t,n){const o=e.g;if(n=zo(o.createShader(n),"Failed to create WebGL shader"),o.shaderSource(n,t),o.compileShader(n),!o.getShaderParameter(n,o.COMPILE_STATUS))throw Error(`Could not compile WebGL shader: ${o.getShaderInfoLog(n)}`);return o.attachShader(e.h,n),n}function dm(e,t){const n=e.g,o=zo(n.createVertexArray(),"Failed to create vertex array");n.bindVertexArray(o);const i=zo(n.createBuffer(),"Failed to create buffer");n.bindBuffer(n.ARRAY_BUFFER,i),n.enableVertexAttribArray(e.P),n.vertexAttribPointer(e.P,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),n.STATIC_DRAW);const r=zo(n.createBuffer(),"Failed to create buffer");return n.bindBuffer(n.ARRAY_BUFFER,r),n.enableVertexAttribArray(e.O),n.vertexAttribPointer(e.O,2,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(t?[0,1,0,0,1,0,1,1]:[0,0,0,1,1,1,1,0]),n.STATIC_DRAW),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindVertexArray(null),new IS(n,o,i,r)}function Zd(e,t){if(e.g){if(t!==e.g)throw Error("Cannot change GL context once initialized")}else e.g=t}function Kd(e,t,n,o){return Zd(e,t),e.h||(e.m(),e.D()),n?(e.s||(e.s=dm(e,!0)),n=e.s):(e.v||(e.v=dm(e,!1)),n=e.v),t.useProgram(e.h),n.bind(),e.l(),e=o(),n.g.bindVertexArray(null),e}function yl(e,t,n){return Zd(e,t),e=zo(t.createTexture(),"Failed to create texture"),t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,n??t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,n??t.LINEAR),t.bindTexture(t.TEXTURE_2D,null),e}function bl(e,t,n){Zd(e,t),e.B||(e.B=zo(t.createFramebuffer(),"Failed to create framebuffe.")),t.bindFramebuffer(t.FRAMEBUFFER,e.B),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}function Yd(e){var t;(t=e.g)==null||t.bindFramebuffer(e.g.FRAMEBUFFER,null)}var Qd=class{H(){return`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D inputTexture;
  void main() {
    gl_FragColor = texture2D(inputTexture, vTex);
  }
 `}m(){const e=this.g;if(this.h=zo(e.createProgram(),"Failed to create WebGL program"),this.ba=fm(this,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,e.VERTEX_SHADER),this.aa=fm(this,this.H(),e.FRAGMENT_SHADER),e.linkProgram(this.h),!e.getProgramParameter(this.h,e.LINK_STATUS))throw Error(`Error during program linking: ${e.getProgramInfoLog(this.h)}`);this.P=e.getAttribLocation(this.h,"aVertex"),this.O=e.getAttribLocation(this.h,"aTex")}D(){}l(){}close(){if(this.h){const e=this.g;e.deleteProgram(this.h),e.deleteShader(this.ba),e.deleteShader(this.aa)}this.B&&this.g.deleteFramebuffer(this.B),this.v&&this.v.close(),this.s&&this.s.close()}};function Oo(e,t){switch(t){case 0:return e.g.find(n=>n instanceof Uint8Array);case 1:return e.g.find(n=>n instanceof Float32Array);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function pf(e){var t=Oo(e,1);if(!t){if(t=Oo(e,0))t=new Float32Array(t).map(o=>o/255);else{t=new Float32Array(e.width*e.height);const o=br(e);var n=Jd(e);if(bl(n,o,Hv(e)),"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in self.document){n=new Float32Array(e.width*e.height*4),o.readPixels(0,0,e.width,e.height,o.RGBA,o.FLOAT,n);for(let i=0,r=0;i<t.length;++i,r+=4)t[i]=n[r]}else o.readPixels(0,0,e.width,e.height,o.RED,o.FLOAT,t)}e.g.push(t)}return t}function Hv(e){let t=Oo(e,2);if(!t){const n=br(e);t=Wv(e);const o=pf(e),i=qv(e);n.texImage2D(n.TEXTURE_2D,0,i,e.width,e.height,0,n.RED,n.FLOAT,o),mf(e)}return t}function br(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when initializing the image.");return e.h||(e.h=zo(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function qv(e){if(e=br(e),!Ma)if(e.getExtension("EXT_color_buffer_float")&&e.getExtension("OES_texture_float_linear")&&e.getExtension("EXT_float_blend"))Ma=e.R32F;else{if(!e.getExtension("EXT_color_buffer_half_float"))throw Error("GPU does not fully support 4-channel float32 or float16 formats");Ma=e.R16F}return Ma}function Jd(e){return e.l||(e.l=new Qd),e.l}function Wv(e){const t=br(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Oo(e,2);return n||(n=yl(Jd(e),t,e.m?t.LINEAR:t.NEAREST),e.g.push(n),e.j=!0),t.bindTexture(t.TEXTURE_2D,n),n}function mf(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}var Ma,lt=class{constructor(e,t,n,o,i,r,s){this.g=e,this.m=t,this.j=n,this.canvas=o,this.l=i,this.width=r,this.height=s,this.j&&--hm===0&&console.error("You seem to be creating MPMask instances without invoking .close(). This leaks resources.")}Ha(){return!!Oo(this,0)}la(){return!!Oo(this,1)}R(){return!!Oo(this,2)}ka(){return(t=Oo(e=this,0))||(t=pf(e),t=new Uint8Array(t.map(n=>255*n)),e.g.push(t)),t;var e,t}ja(){return pf(this)}M(){return Hv(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof Uint8Array)n=new Uint8Array(t);else if(t instanceof Float32Array)n=new Float32Array(t);else{if(!(t instanceof WebGLTexture))throw Error(`Type is not supported: ${t}`);{const o=br(this),i=Jd(this);o.activeTexture(o.TEXTURE1),n=yl(i,o,this.m?o.LINEAR:o.NEAREST),o.bindTexture(o.TEXTURE_2D,n);const r=qv(this);o.texImage2D(o.TEXTURE_2D,0,r,this.width,this.height,0,o.RED,o.FLOAT,null),o.bindTexture(o.TEXTURE_2D,null),bl(i,o,n),Kd(i,o,!1,()=>{Wv(this),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.drawArrays(o.TRIANGLE_FAN,0,4),mf(this)}),Yd(i),mf(this)}}e.push(n)}return new lt(e,this.m,this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&br(this).deleteTexture(Oo(this,2)),hm=-1}};lt.prototype.close=lt.prototype.close,lt.prototype.clone=lt.prototype.clone,lt.prototype.getAsWebGLTexture=lt.prototype.M,lt.prototype.getAsFloat32Array=lt.prototype.ja,lt.prototype.getAsUint8Array=lt.prototype.ka,lt.prototype.hasWebGLTexture=lt.prototype.R,lt.prototype.hasFloat32Array=lt.prototype.la,lt.prototype.hasUint8Array=lt.prototype.Ha;var hm=250;function Gn(e,t){switch(t){case 0:return e.g.find(n=>n instanceof ImageData);case 1:return e.g.find(n=>typeof ImageBitmap<"u"&&n instanceof ImageBitmap);case 2:return e.g.find(n=>typeof WebGLTexture<"u"&&n instanceof WebGLTexture);default:throw Error(`Type is not supported: ${t}`)}}function Gv(e){var t=Gn(e,0);if(!t){t=xr(e);const n=xl(e),o=new Uint8Array(e.width*e.height*4);bl(n,t,rc(e)),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,o),Yd(n),t=new ImageData(new Uint8ClampedArray(o.buffer),e.width,e.height),e.g.push(t)}return t}function rc(e){let t=Gn(e,2);if(!t){const n=xr(e);t=sc(e);const o=Gn(e,1)||Gv(e);n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,o),fs(e)}return t}function xr(e){if(!e.canvas)throw Error("Conversion to different image formats require that a canvas is passed when iniitializing the image.");return e.h||(e.h=zo(e.canvas.getContext("webgl2"),"You cannot use a canvas that is already bound to a different type of rendering context.")),e.h}function xl(e){return e.l||(e.l=new Qd),e.l}function sc(e){const t=xr(e);t.viewport(0,0,e.width,e.height),t.activeTexture(t.TEXTURE0);let n=Gn(e,2);return n||(n=yl(xl(e),t),e.g.push(n),e.m=!0),t.bindTexture(t.TEXTURE_2D,n),n}function fs(e){e.h.bindTexture(e.h.TEXTURE_2D,null)}function pm(e){const t=xr(e);return Kd(xl(e),t,!0,()=>function(n,o){const i=n.canvas;if(i.width===n.width&&i.height===n.height)return o();const r=i.width,s=i.height;return i.width=n.width,i.height=n.height,n=o(),i.width=r,i.height=s,n}(e,()=>{if(t.bindFramebuffer(t.FRAMEBUFFER,null),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLE_FAN,0,4),!(e.canvas instanceof OffscreenCanvas))throw Error("Conversion to ImageBitmap requires that the MediaPipe Tasks is initialized with an OffscreenCanvas");return e.canvas.transferToImageBitmap()}))}var ut=class{constructor(e,t,n,o,i,r,s){this.g=e,this.j=t,this.m=n,this.canvas=o,this.l=i,this.width=r,this.height=s,(this.j||this.m)&&--mm===0&&console.error("You seem to be creating MPImage instances without invoking .close(). This leaks resources.")}Ga(){return!!Gn(this,0)}ma(){return!!Gn(this,1)}R(){return!!Gn(this,2)}Ea(){return Gv(this)}Da(){var e=Gn(this,1);return e||(rc(this),sc(this),e=pm(this),fs(this),this.g.push(e),this.j=!0),e}M(){return rc(this)}clone(){const e=[];for(const t of this.g){let n;if(t instanceof ImageData)n=new ImageData(t.data,this.width,this.height);else if(t instanceof WebGLTexture){const o=xr(this),i=xl(this);o.activeTexture(o.TEXTURE1),n=yl(i,o),o.bindTexture(o.TEXTURE_2D,n),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,this.width,this.height,0,o.RGBA,o.UNSIGNED_BYTE,null),o.bindTexture(o.TEXTURE_2D,null),bl(i,o,n),Kd(i,o,!1,()=>{sc(this),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.drawArrays(o.TRIANGLE_FAN,0,4),fs(this)}),Yd(i),fs(this)}else{if(!(t instanceof ImageBitmap))throw Error(`Type is not supported: ${t}`);rc(this),sc(this),n=pm(this),fs(this)}e.push(n)}return new ut(e,this.ma(),this.R(),this.canvas,this.l,this.width,this.height)}close(){this.j&&Gn(this,1).close(),this.m&&xr(this).deleteTexture(Gn(this,2)),mm=-1}};ut.prototype.close=ut.prototype.close,ut.prototype.clone=ut.prototype.clone,ut.prototype.getAsWebGLTexture=ut.prototype.M,ut.prototype.getAsImageBitmap=ut.prototype.Da,ut.prototype.getAsImageData=ut.prototype.Ea,ut.prototype.hasWebGLTexture=ut.prototype.R,ut.prototype.hasImageBitmap=ut.prototype.ma,ut.prototype.hasImageData=ut.prototype.Ga;var mm=250;function Un(...e){return e.map(([t,n])=>({start:t,end:n}))}const FS=function(e){return class extends e{Ma(){this.i._registerModelResourcesGraphService()}}}((gm=class{constructor(e,t){this.l=!0,this.i=e,this.g=null,this.h=0,this.m=typeof this.i._addIntToInputStream=="function",t!==void 0?this.i.canvas=t:typeof OffscreenCanvas>"u"||jv()?(console.warn("OffscreenCanvas not supported and GraphRunner constructor glCanvas parameter is undefined. Creating backup canvas."),this.i.canvas=document.createElement("canvas")):this.i.canvas=new OffscreenCanvas(1,1)}async initializeGraph(e){const t=await(await fetch(e)).arrayBuffer();e=!(e.endsWith(".pbtxt")||e.endsWith(".textproto")),this.setGraph(new Uint8Array(t),e)}setGraphFromString(e){this.setGraph(new TextEncoder().encode(e),!1)}setGraph(e,t){const n=e.length,o=this.i._malloc(n);this.i.HEAPU8.set(e,o),t?this.i._changeBinaryGraph(n,o):this.i._changeTextGraph(n,o),this.i._free(o)}configureAudio(e,t,n,o,i){this.i._configureAudio||console.warn('Attempting to use configureAudio without support for input audio. Is build dep ":gl_graph_runner_audio" missing?'),J(this,o||"input_audio",r=>{J(this,i=i||"audio_header",s=>{this.i._configureAudio(r,s,e,t,n)})})}setAutoResizeCanvas(e){this.l=e}setAutoRenderToScreen(e){this.i._setAutoRenderToScreen(e)}setGpuBufferVerticalFlip(e){this.i.gpuOriginForWebTexturesIsBottomLeft=e}fa(e){co(this,"__graph_config__",t=>{e(t)}),J(this,"__graph_config__",t=>{this.i._getGraphConfig(t,void 0)}),delete this.i.simpleListeners.__graph_config__}attachErrorListener(e){this.i.errorListener=e}attachEmptyPacketListener(e,t){this.i.emptyPacketListeners=this.i.emptyPacketListeners||{},this.i.emptyPacketListeners[e]=t}addAudioToStream(e,t,n){this.addAudioToStreamWithShape(e,0,0,t,n)}addAudioToStreamWithShape(e,t,n,o,i){const r=4*e.length;this.h!==r&&(this.g&&this.i._free(this.g),this.g=this.i._malloc(r),this.h=r),this.i.HEAPF32.set(e,this.g/4),J(this,o,s=>{this.i._addAudioToInputStream(this.g,t,n,s,i)})}addGpuBufferToStream(e,t,n){J(this,t,o=>{const[i,r]=am(this,e,o);this.i._addBoundTextureToStream(o,i,r,n)})}addBoolToStream(e,t,n){J(this,t,o=>{this.i._addBoolToInputStream(e,o,n)})}addDoubleToStream(e,t,n){J(this,t,o=>{this.i._addDoubleToInputStream(e,o,n)})}addFloatToStream(e,t,n){J(this,t,o=>{this.i._addFloatToInputStream(e,o,n)})}addIntToStream(e,t,n){J(this,t,o=>{this.i._addIntToInputStream(e,o,n)})}addStringToStream(e,t,n){J(this,t,o=>{J(this,e,i=>{this.i._addStringToInputStream(i,o,n)})})}addStringRecordToStream(e,t,n){J(this,t,o=>{cm(this,Object.keys(e),i=>{cm(this,Object.values(e),r=>{this.i._addFlatHashMapToInputStream(i,r,Object.keys(e).length,o,n)})})})}addProtoToStream(e,t,n,o){J(this,n,i=>{J(this,t,r=>{const s=this.i._malloc(e.length);this.i.HEAPU8.set(e,s),this.i._addProtoToInputStream(s,e.length,r,i,o),this.i._free(s)})})}addEmptyPacketToStream(e,t){J(this,e,n=>{this.i._addEmptyPacketToInputStream(n,t)})}addBoolVectorToStream(e,t,n){J(this,t,o=>{const i=this.i._allocateBoolVector(e.length);if(!i)throw Error("Unable to allocate new bool vector on heap.");for(const r of e)this.i._addBoolVectorEntry(i,r);this.i._addBoolVectorToInputStream(i,o,n)})}addDoubleVectorToStream(e,t,n){J(this,t,o=>{const i=this.i._allocateDoubleVector(e.length);if(!i)throw Error("Unable to allocate new double vector on heap.");for(const r of e)this.i._addDoubleVectorEntry(i,r);this.i._addDoubleVectorToInputStream(i,o,n)})}addFloatVectorToStream(e,t,n){J(this,t,o=>{const i=this.i._allocateFloatVector(e.length);if(!i)throw Error("Unable to allocate new float vector on heap.");for(const r of e)this.i._addFloatVectorEntry(i,r);this.i._addFloatVectorToInputStream(i,o,n)})}addIntVectorToStream(e,t,n){J(this,t,o=>{const i=this.i._allocateIntVector(e.length);if(!i)throw Error("Unable to allocate new int vector on heap.");for(const r of e)this.i._addIntVectorEntry(i,r);this.i._addIntVectorToInputStream(i,o,n)})}addStringVectorToStream(e,t,n){J(this,t,o=>{const i=this.i._allocateStringVector(e.length);if(!i)throw Error("Unable to allocate new string vector on heap.");for(const r of e)J(this,r,s=>{this.i._addStringVectorEntry(i,s)});this.i._addStringVectorToInputStream(i,o,n)})}addBoolToInputSidePacket(e,t){J(this,t,n=>{this.i._addBoolToInputSidePacket(e,n)})}addDoubleToInputSidePacket(e,t){J(this,t,n=>{this.i._addDoubleToInputSidePacket(e,n)})}addFloatToInputSidePacket(e,t){J(this,t,n=>{this.i._addFloatToInputSidePacket(e,n)})}addIntToInputSidePacket(e,t){J(this,t,n=>{this.i._addIntToInputSidePacket(e,n)})}addStringToInputSidePacket(e,t){J(this,t,n=>{J(this,e,o=>{this.i._addStringToInputSidePacket(o,n)})})}addProtoToInputSidePacket(e,t,n){J(this,n,o=>{J(this,t,i=>{const r=this.i._malloc(e.length);this.i.HEAPU8.set(e,r),this.i._addProtoToInputSidePacket(r,e.length,i,o),this.i._free(r)})})}addBoolVectorToInputSidePacket(e,t){J(this,t,n=>{const o=this.i._allocateBoolVector(e.length);if(!o)throw Error("Unable to allocate new bool vector on heap.");for(const i of e)this.i._addBoolVectorEntry(o,i);this.i._addBoolVectorToInputSidePacket(o,n)})}addDoubleVectorToInputSidePacket(e,t){J(this,t,n=>{const o=this.i._allocateDoubleVector(e.length);if(!o)throw Error("Unable to allocate new double vector on heap.");for(const i of e)this.i._addDoubleVectorEntry(o,i);this.i._addDoubleVectorToInputSidePacket(o,n)})}addFloatVectorToInputSidePacket(e,t){J(this,t,n=>{const o=this.i._allocateFloatVector(e.length);if(!o)throw Error("Unable to allocate new float vector on heap.");for(const i of e)this.i._addFloatVectorEntry(o,i);this.i._addFloatVectorToInputSidePacket(o,n)})}addIntVectorToInputSidePacket(e,t){J(this,t,n=>{const o=this.i._allocateIntVector(e.length);if(!o)throw Error("Unable to allocate new int vector on heap.");for(const i of e)this.i._addIntVectorEntry(o,i);this.i._addIntVectorToInputSidePacket(o,n)})}addStringVectorToInputSidePacket(e,t){J(this,t,n=>{const o=this.i._allocateStringVector(e.length);if(!o)throw Error("Unable to allocate new string vector on heap.");for(const i of e)J(this,i,r=>{this.i._addStringVectorEntry(o,r)});this.i._addStringVectorToInputSidePacket(o,n)})}attachBoolListener(e,t){co(this,e,t),J(this,e,n=>{this.i._attachBoolListener(n)})}attachBoolVectorListener(e,t){bi(this,e,t),J(this,e,n=>{this.i._attachBoolVectorListener(n)})}attachIntListener(e,t){co(this,e,t),J(this,e,n=>{this.i._attachIntListener(n)})}attachIntVectorListener(e,t){bi(this,e,t),J(this,e,n=>{this.i._attachIntVectorListener(n)})}attachDoubleListener(e,t){co(this,e,t),J(this,e,n=>{this.i._attachDoubleListener(n)})}attachDoubleVectorListener(e,t){bi(this,e,t),J(this,e,n=>{this.i._attachDoubleVectorListener(n)})}attachFloatListener(e,t){co(this,e,t),J(this,e,n=>{this.i._attachFloatListener(n)})}attachFloatVectorListener(e,t){bi(this,e,t),J(this,e,n=>{this.i._attachFloatVectorListener(n)})}attachStringListener(e,t){co(this,e,t),J(this,e,n=>{this.i._attachStringListener(n)})}attachStringVectorListener(e,t){bi(this,e,t),J(this,e,n=>{this.i._attachStringVectorListener(n)})}attachProtoListener(e,t,n){co(this,e,t),J(this,e,o=>{this.i._attachProtoListener(o,n||!1)})}attachProtoVectorListener(e,t,n){bi(this,e,t),J(this,e,o=>{this.i._attachProtoVectorListener(o,n||!1)})}attachAudioListener(e,t,n){this.i._attachAudioListener||console.warn('Attempting to use attachAudioListener without support for output audio. Is build dep ":gl_graph_runner_audio_out" missing?'),co(this,e,(o,i)=>{o=new Float32Array(o.buffer,o.byteOffset,o.length/4),t(o,i)}),J(this,e,o=>{this.i._attachAudioListener(o,n||!1)})}finishProcessing(){this.i._waitUntilIdle()}closeGraph(){this.i._closeGraph(),this.i.simpleListeners=void 0,this.i.emptyPacketListeners=void 0}},class extends gm{get ha(){return this.i}sa(e,t,n){J(this,t,o=>{const[i,r]=am(this,e,o);this.ha._addBoundTextureAsImageToStream(o,i,r,n)})}W(e,t){co(this,e,t),J(this,e,n=>{this.ha._attachImageListener(n)})}da(e,t){bi(this,e,t),J(this,e,n=>{this.ha._attachImageVectorListener(n)})}}));var gm,Sn=class extends FS{};async function ae(e,t,n){return async function(o,i,r,s){return DS(o,i,r,s)}(e,n.canvas??(typeof OffscreenCanvas>"u"||jv()?document.createElement("canvas"):void 0),t,n)}function Xv(e,t,n,o){if(e.V){const r=new fv;if(n!=null&&n.regionOfInterest){if(!e.ra)throw Error("This task doesn't support region-of-interest.");var i=n.regionOfInterest;if(i.left>=i.right||i.top>=i.bottom)throw Error("Expected RectF with left < right and top < bottom.");if(0>i.left||0>i.top||1<i.right||1<i.bottom)throw Error("Expected RectF values to be in [0,1].");Z(r,1,(i.left+i.right)/2),Z(r,2,(i.top+i.bottom)/2),Z(r,4,i.right-i.left),Z(r,3,i.bottom-i.top)}else Z(r,1,.5),Z(r,2,.5),Z(r,4,1),Z(r,3,1);if(n!=null&&n.rotationDegrees){if((n==null?void 0:n.rotationDegrees)%90!=0)throw Error("Expected rotation to be a multiple of 90.");if(Z(r,5,-Math.PI*n.rotationDegrees/180),(n==null?void 0:n.rotationDegrees)%180!=0){const[s,a]=_v(t);n=Ke(r,3)*a/s,i=Ke(r,4)*s/a,Z(r,4,n),Z(r,3,i)}}e.g.addProtoToStream(r.g(),"mediapipe.NormalizedRect",e.V,o)}e.g.sa(t,e.ba,o??performance.now()),e.finishProcessing()}function Tn(e,t,n){var o;if((o=e.baseOptions)!=null&&o.g())throw Error("Task is not initialized with image mode. 'runningMode' must be set to 'IMAGE'.");Xv(e,t,n,e.C+1)}function ao(e,t,n,o){var i;if(!((i=e.baseOptions)!=null&&i.g()))throw Error("Task is not initialized with video mode. 'runningMode' must be set to 'VIDEO'.");Xv(e,t,n,o)}function wr(e,t,n,o){var i=t.data;const r=t.width,s=r*(t=t.height);if((i instanceof Uint8Array||i instanceof Float32Array)&&i.length!==s)throw Error("Unsupported channel count: "+i.length/s);return e=new lt([i],n,!1,e.g.i.canvas,e.O,r,t),o?e.clone():e}var Ot=class extends hf{constructor(e,t,n,o){super(e),this.g=e,this.ba=t,this.V=n,this.ra=o,this.O=new Qd}l(e,t=!0){if("runningMode"in e&&Rs(this.baseOptions,2,!!e.runningMode&&e.runningMode!=="IMAGE"),e.canvas!==void 0&&this.g.i.canvas!==e.canvas)throw Error("You must create a new task to reset the canvas.");return super.l(e,t)}close(){this.O.close(),super.close()}};Ot.prototype.close=Ot.prototype.close;var en=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect_in",!1),this.j={detections:[]},Y(e=this.h=new pl,0,1,t=new Ue),Z(this.h,2,.5),Z(this.h,3,.3)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return"minDetectionConfidence"in e&&Z(this.h,2,e.minDetectionConfidence??.5),"minSuppressionThreshold"in e&&Z(this.h,3,e.minSuppressionThreshold??.3),this.l(e)}F(e,t){return this.j={detections:[]},Tn(this,e,t),this.j}G(e,t,n){return this.j={detections:[]},ao(this,e,n,t),this.j}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect_in"),pe(e,"detections");const t=new Kt;kn(t,gS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.face_detector.FaceDetectorGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect_in"),ce(n,"DETECTIONS:detections"),n.o(t),Jt(e,n),this.g.attachProtoVectorListener("detections",(o,i)=>{for(const r of o)o=rv(r),this.j.detections.push(Bv(o));H(this,i)}),this.g.attachEmptyPacketListener("detections",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};en.prototype.detectForVideo=en.prototype.G,en.prototype.detect=en.prototype.F,en.prototype.setOptions=en.prototype.o,en.createFromModelPath=async function(e,t){return ae(en,e,{baseOptions:{modelAssetPath:t}})},en.createFromModelBuffer=function(e,t){return ae(en,e,{baseOptions:{modelAssetBuffer:t}})},en.createFromOptions=function(e,t){return ae(en,e,t)};var $d=Un([61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]),eh=Un([263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]),th=Un([276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]),Zv=Un([474,475],[475,476],[476,477],[477,474]),nh=Un([33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]),oh=Un([46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]),Kv=Un([469,470],[470,471],[471,472],[472,469]),ih=Un([10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]),Yv=[...$d,...eh,...th,...nh,...oh,...ih],Qv=Un([127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]);function vm(e){e.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]}}var He=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!1),this.j={faceLandmarks:[],faceBlendshapes:[],facialTransformationMatrixes:[]},this.outputFacialTransformationMatrixes=this.outputFaceBlendshapes=!1,Y(e=this.h=new wv,0,1,t=new Ue),this.v=new xv,Y(this.h,0,3,this.v),this.s=new pl,Y(this.h,0,2,this.s),no(this.s,4,1),Z(this.s,2,.5),Z(this.v,2,.5),Z(this.h,4,.5)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return"numFaces"in e&&no(this.s,4,e.numFaces??1),"minFaceDetectionConfidence"in e&&Z(this.s,2,e.minFaceDetectionConfidence??.5),"minTrackingConfidence"in e&&Z(this.h,4,e.minTrackingConfidence??.5),"minFacePresenceConfidence"in e&&Z(this.v,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"outputFacialTransformationMatrixes"in e&&(this.outputFacialTransformationMatrixes=!!e.outputFacialTransformationMatrixes),this.l(e)}F(e,t){return vm(this),Tn(this,e,t),this.j}G(e,t,n){return vm(this),ao(this,e,n,t),this.j}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"face_landmarks");const t=new Kt;kn(t,yS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.face_landmarker.FaceLandmarkerGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"NORM_LANDMARKS:face_landmarks"),n.o(t),Jt(e,n),this.g.attachProtoVectorListener("face_landmarks",(o,i)=>{for(const r of o)o=ta(r),this.j.faceLandmarks.push(ml(o));H(this,i)}),this.g.attachEmptyPacketListener("face_landmarks",o=>{H(this,o)}),this.outputFaceBlendshapes&&(pe(e,"blendshapes"),ce(n,"BLENDSHAPES:blendshapes"),this.g.attachProtoVectorListener("blendshapes",(o,i)=>{if(this.outputFaceBlendshapes)for(const r of o)o=dl(r),this.j.faceBlendshapes.push(Xd(o.g()??[]));H(this,i)}),this.g.attachEmptyPacketListener("blendshapes",o=>{H(this,o)})),this.outputFacialTransformationMatrixes&&(pe(e,"face_geometry"),ce(n,"FACE_GEOMETRY:face_geometry"),this.g.attachProtoVectorListener("face_geometry",(o,i)=>{if(this.outputFacialTransformationMatrixes)for(const r of o)(o=fe(vS(r),uv,2))&&this.j.facialTransformationMatrixes.push({rows:to(cn(o,1))??0,columns:to(cn(o,2))??0,data:cr(o,3,hi).slice()??[]});H(this,i)}),this.g.attachEmptyPacketListener("face_geometry",o=>{H(this,o)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};He.prototype.detectForVideo=He.prototype.G,He.prototype.detect=He.prototype.F,He.prototype.setOptions=He.prototype.o,He.createFromModelPath=function(e,t){return ae(He,e,{baseOptions:{modelAssetPath:t}})},He.createFromModelBuffer=function(e,t){return ae(He,e,{baseOptions:{modelAssetBuffer:t}})},He.createFromOptions=function(e,t){return ae(He,e,t)},He.FACE_LANDMARKS_LIPS=$d,He.FACE_LANDMARKS_LEFT_EYE=eh,He.FACE_LANDMARKS_LEFT_EYEBROW=th,He.FACE_LANDMARKS_LEFT_IRIS=Zv,He.FACE_LANDMARKS_RIGHT_EYE=nh,He.FACE_LANDMARKS_RIGHT_EYEBROW=oh,He.FACE_LANDMARKS_RIGHT_IRIS=Kv,He.FACE_LANDMARKS_FACE_OVAL=ih,He.FACE_LANDMARKS_CONTOURS=Yv,He.FACE_LANDMARKS_TESSELATION=Qv;var Bn=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!0),Y(e=this.j=new Tv,0,1,t=new Ue)}get baseOptions(){return fe(this.j,Ue,1)}set baseOptions(e){Y(this.j,0,1,e)}o(e){return super.l(e)}Pa(e,t,n){const o=typeof t!="function"?t:{};if(this.h=typeof t=="function"?t:n,Tn(this,e,o??{}),!this.h)return this.s}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"stylized_image");const t=new Kt;kn(t,bS,this.j);const n=new wt;Qt(n,"mediapipe.tasks.vision.face_stylizer.FaceStylizerGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"STYLIZED_IMAGE:stylized_image"),n.o(t),Jt(e,n),this.g.W("stylized_image",(o,i)=>{var r=!this.h,s=o.data,a=o.width;const c=a*(o=o.height);if(s instanceof Uint8Array)if(s.length===3*c){const l=new Uint8ClampedArray(4*c);for(let u=0;u<c;++u)l[4*u]=s[3*u],l[4*u+1]=s[3*u+1],l[4*u+2]=s[3*u+2],l[4*u+3]=255;s=new ImageData(l,a,o)}else{if(s.length!==4*c)throw Error("Unsupported channel count: "+s.length/c);s=new ImageData(new Uint8ClampedArray(s.buffer,s.byteOffset,s.length),a,o)}else if(!(s instanceof WebGLTexture))throw Error(`Unsupported format: ${s.constructor.name}`);a=new ut([s],!1,!1,this.g.i.canvas,this.O,a,o),this.s=r=r?a.clone():a,this.h&&this.h(r),H(this,i)}),this.g.attachEmptyPacketListener("stylized_image",o=>{this.s=null,this.h&&this.h(null),H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Bn.prototype.stylize=Bn.prototype.Pa,Bn.prototype.setOptions=Bn.prototype.o,Bn.createFromModelPath=function(e,t){return ae(Bn,e,{baseOptions:{modelAssetPath:t}})},Bn.createFromModelBuffer=function(e,t){return ae(Bn,e,{baseOptions:{modelAssetBuffer:t}})},Bn.createFromOptions=function(e,t){return ae(Bn,e,t)};var rh=Un([0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[0,17],[17,18],[18,19],[19,20]);function ym(e){e.gestures=[],e.landmarks=[],e.worldLandmarks=[],e.handedness=[]}function bm(e){return e.gestures.length===0?{gestures:[],landmarks:[],worldLandmarks:[],handedness:[],handednesses:[]}:{gestures:e.gestures,landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handedness:e.handedness,handednesses:e.handedness}}function xm(e,t=!0){const n=[];for(const i of e){var o=dl(i);e=[];for(const r of o.g())o=t&&cn(r,1)!=null?to(cn(r,1)):-1,e.push({score:Ke(r,2)??0,index:o,categoryName:xn(r,3)??""??"",displayName:xn(r,4)??""??""});n.push(e)}return n}var Bt=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!1),this.gestures=[],this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Y(e=this.j=new Lv,0,1,t=new Ue),this.s=new _d,Y(this.j,0,2,this.s),this.D=new Bd,Y(this.s,0,3,this.D),this.v=new Nv,Y(this.s,0,2,this.v),this.h=new xS,Y(this.j,0,3,this.h),Z(this.v,2,.5),Z(this.s,4,.5),Z(this.D,2,.5)}get baseOptions(){return fe(this.j,Ue,1)}set baseOptions(e){Y(this.j,0,1,e)}o(e){var i,r,s,a;if(no(this.v,3,e.numHands??1),"minHandDetectionConfidence"in e&&Z(this.v,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Z(this.s,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Z(this.D,2,e.minHandPresenceConfidence??.5),e.cannedGesturesClassifierOptions){var t=new _i,n=t,o=df(e.cannedGesturesClassifierOptions,(i=fe(this.h,_i,3))==null?void 0:i.h());Y(n,0,2,o),Y(this.h,0,3,t)}else e.cannedGesturesClassifierOptions===void 0&&((r=fe(this.h,_i,3))==null||r.g());return e.customGesturesClassifierOptions?(Y(n=t=new _i,0,2,o=df(e.customGesturesClassifierOptions,(s=fe(this.h,_i,4))==null?void 0:s.h())),Y(this.h,0,4,t)):e.customGesturesClassifierOptions===void 0&&((a=fe(this.h,_i,4))==null||a.g()),this.l(e)}Ka(e,t){return ym(this),Tn(this,e,t),bm(this)}La(e,t,n){return ym(this),ao(this,e,n,t),bm(this)}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"hand_gestures"),pe(e,"hand_landmarks"),pe(e,"world_hand_landmarks"),pe(e,"handedness");const t=new Kt;kn(t,TS,this.j);const n=new wt;Qt(n,"mediapipe.tasks.vision.gesture_recognizer.GestureRecognizerGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"HAND_GESTURES:hand_gestures"),ce(n,"LANDMARKS:hand_landmarks"),ce(n,"WORLD_LANDMARKS:world_hand_landmarks"),ce(n,"HANDEDNESS:handedness"),n.o(t),Jt(e,n),this.g.attachProtoVectorListener("hand_landmarks",(o,i)=>{for(const r of o){o=ta(r);const s=[];for(const a of _o(o,cv,1))s.push({x:Ke(a,1)??0,y:Ke(a,2)??0,z:Ke(a,3)??0,visibility:Ke(a,4)??0});this.landmarks.push(s)}H(this,i)}),this.g.attachEmptyPacketListener("hand_landmarks",o=>{H(this,o)}),this.g.attachProtoVectorListener("world_hand_landmarks",(o,i)=>{for(const r of o){o=fr(r);const s=[];for(const a of _o(o,sv,1))s.push({x:Ke(a,1)??0,y:Ke(a,2)??0,z:Ke(a,3)??0,visibility:Ke(a,4)??0});this.worldLandmarks.push(s)}H(this,i)}),this.g.attachEmptyPacketListener("world_hand_landmarks",o=>{H(this,o)}),this.g.attachProtoVectorListener("hand_gestures",(o,i)=>{this.gestures.push(...xm(o,!1)),H(this,i)}),this.g.attachEmptyPacketListener("hand_gestures",o=>{H(this,o)}),this.g.attachProtoVectorListener("handedness",(o,i)=>{this.handedness.push(...xm(o)),H(this,i)}),this.g.attachEmptyPacketListener("handedness",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};function wm(e){return{landmarks:e.landmarks,worldLandmarks:e.worldLandmarks,handednesses:e.handedness,handedness:e.handedness}}Bt.prototype.recognizeForVideo=Bt.prototype.La,Bt.prototype.recognize=Bt.prototype.Ka,Bt.prototype.setOptions=Bt.prototype.o,Bt.createFromModelPath=function(e,t){return ae(Bt,e,{baseOptions:{modelAssetPath:t}})},Bt.createFromModelBuffer=function(e,t){return ae(Bt,e,{baseOptions:{modelAssetBuffer:t}})},Bt.createFromOptions=function(e,t){return ae(Bt,e,t)},Bt.HAND_CONNECTIONS=rh;var jt=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Y(e=this.h=new _d,0,1,t=new Ue),this.s=new Bd,Y(this.h,0,3,this.s),this.j=new Nv,Y(this.h,0,2,this.j),no(this.j,3,1),Z(this.j,2,.5),Z(this.s,2,.5),Z(this.h,4,.5)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return"numHands"in e&&no(this.j,3,e.numHands??1),"minHandDetectionConfidence"in e&&Z(this.j,2,e.minHandDetectionConfidence??.5),"minTrackingConfidence"in e&&Z(this.h,4,e.minTrackingConfidence??.5),"minHandPresenceConfidence"in e&&Z(this.s,2,e.minHandPresenceConfidence??.5),this.l(e)}F(e,t){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],Tn(this,e,t),wm(this)}G(e,t,n){return this.landmarks=[],this.worldLandmarks=[],this.handedness=[],ao(this,e,n,t),wm(this)}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"hand_landmarks"),pe(e,"world_hand_landmarks"),pe(e,"handedness");const t=new Kt;kn(t,SS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.hand_landmarker.HandLandmarkerGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"LANDMARKS:hand_landmarks"),ce(n,"WORLD_LANDMARKS:world_hand_landmarks"),ce(n,"HANDEDNESS:handedness"),n.o(t),Jt(e,n),this.g.attachProtoVectorListener("hand_landmarks",(o,i)=>{for(const r of o)o=ta(r),this.landmarks.push(ml(o));H(this,i)}),this.g.attachEmptyPacketListener("hand_landmarks",o=>{H(this,o)}),this.g.attachProtoVectorListener("world_hand_landmarks",(o,i)=>{for(const r of o)o=fr(r),this.worldLandmarks.push(Ts(o));H(this,i)}),this.g.attachEmptyPacketListener("world_hand_landmarks",o=>{H(this,o)}),this.g.attachProtoVectorListener("handedness",(o,i)=>{var r=this.handedness,s=r.push;const a=[];for(const c of o){o=dl(c);const l=[];for(const u of o.g())l.push({score:Ke(u,2)??0,index:to(cn(u,1))??-1,categoryName:xn(u,3)??""??"",displayName:xn(u,4)??""??""});a.push(l)}s.call(r,...a),H(this,i)}),this.g.attachEmptyPacketListener("handedness",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};jt.prototype.detectForVideo=jt.prototype.G,jt.prototype.detect=jt.prototype.F,jt.prototype.setOptions=jt.prototype.o,jt.createFromModelPath=function(e,t){return ae(jt,e,{baseOptions:{modelAssetPath:t}})},jt.createFromModelBuffer=function(e,t){return ae(jt,e,{baseOptions:{modelAssetBuffer:t}})},jt.createFromOptions=function(e,t){return ae(jt,e,t)},jt.HAND_CONNECTIONS=rh;var Jv=Un([0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]);function Sm(e){e.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]}}function Tm(e){try{if(!e.D)return e.h;e.D(e.h)}finally{vl(e)}}function Pa(e,t){e=ta(e),t.push(ml(e))}var Fe=class extends Ot{constructor(e,t){super(new Sn(e,t),"input_frames_image",null,!1),this.h={faceLandmarks:[],faceBlendshapes:[],poseLandmarks:[],poseWorldLandmarks:[],poseSegmentationMasks:[],leftHandLandmarks:[],leftHandWorldLandmarks:[],rightHandLandmarks:[],rightHandWorldLandmarks:[]},this.outputPoseSegmentationMasks=this.outputFaceBlendshapes=!1,Y(e=this.j=new Fv,0,1,t=new Ue),this.I=new Bd,Y(this.j,0,2,this.I),this.aa=new ES,Y(this.j,0,3,this.aa),this.s=new pl,Y(this.j,0,4,this.s),this.P=new xv,Y(this.j,0,5,this.P),this.v=new Dv,Y(this.j,0,6,this.v),this.J=new Iv,Y(this.j,0,7,this.J),Z(this.s,2,.5),Z(this.s,3,.3),Z(this.P,2,.5),Z(this.v,2,.5),Z(this.v,3,.3),Z(this.J,2,.5),Z(this.I,2,.5)}get baseOptions(){return fe(this.j,Ue,1)}set baseOptions(e){Y(this.j,0,1,e)}o(e){return"minFaceDetectionConfidence"in e&&Z(this.s,2,e.minFaceDetectionConfidence??.5),"minFaceSuppressionThreshold"in e&&Z(this.s,3,e.minFaceSuppressionThreshold??.3),"minFacePresenceConfidence"in e&&Z(this.P,2,e.minFacePresenceConfidence??.5),"outputFaceBlendshapes"in e&&(this.outputFaceBlendshapes=!!e.outputFaceBlendshapes),"minPoseDetectionConfidence"in e&&Z(this.v,2,e.minPoseDetectionConfidence??.5),"minPoseSuppressionThreshold"in e&&Z(this.v,3,e.minPoseSuppressionThreshold??.3),"minPosePresenceConfidence"in e&&Z(this.J,2,e.minPosePresenceConfidence??.5),"outputPoseSegmentationMasks"in e&&(this.outputPoseSegmentationMasks=!!e.outputPoseSegmentationMasks),"minHandLandmarksConfidence"in e&&Z(this.I,2,e.minHandLandmarksConfidence??.5),this.l(e)}F(e,t,n){const o=typeof t!="function"?t:{};return this.D=typeof t=="function"?t:n,Sm(this),Tn(this,e,o),Tm(this)}G(e,t,n,o){const i=typeof n!="function"?n:{};return this.D=typeof n=="function"?n:o,Sm(this),ao(this,e,i,t),Tm(this)}m(){var e=new Pt;Le(e,"input_frames_image"),pe(e,"pose_landmarks"),pe(e,"pose_world_landmarks"),pe(e,"face_landmarks"),pe(e,"left_hand_landmarks"),pe(e,"left_hand_world_landmarks"),pe(e,"right_hand_landmarks"),pe(e,"right_hand_world_landmarks");const t=new Kt,n=new em;af(n,1,Rr("type.googleapis.com/mediapipe.tasks.vision.holistic_landmarker.proto.HolisticLandmarkerGraphOptions"),""),function(i,r){if(r!=null)if(Array.isArray(r))Ee(i,2,sl(r,Ad,void 0,void 0,!1));else{if(!(typeof r=="string"||r instanceof Vo||Zs(r)))throw Error("invalid value in Any.value field: "+r+" expected a ByteString, a base64 encoded string, a Uint8Array or a jspb array");af(i,2,Sd(r,!1,!1),Fi())}}(n,this.j.g());const o=new wt;Qt(o,"mediapipe.tasks.vision.holistic_landmarker.HolisticLandmarkerGraph"),Nc(o,8,em,n),Pe(o,"IMAGE:input_frames_image"),ce(o,"POSE_LANDMARKS:pose_landmarks"),ce(o,"POSE_WORLD_LANDMARKS:pose_world_landmarks"),ce(o,"FACE_LANDMARKS:face_landmarks"),ce(o,"LEFT_HAND_LANDMARKS:left_hand_landmarks"),ce(o,"LEFT_HAND_WORLD_LANDMARKS:left_hand_world_landmarks"),ce(o,"RIGHT_HAND_LANDMARKS:right_hand_landmarks"),ce(o,"RIGHT_HAND_WORLD_LANDMARKS:right_hand_world_landmarks"),o.o(t),Jt(e,o),gl(this,e),this.g.attachProtoListener("pose_landmarks",(i,r)=>{Pa(i,this.h.poseLandmarks),H(this,r)}),this.g.attachEmptyPacketListener("pose_landmarks",i=>{H(this,i)}),this.g.attachProtoListener("pose_world_landmarks",(i,r)=>{var s=this.h.poseWorldLandmarks;i=fr(i),s.push(Ts(i)),H(this,r)}),this.g.attachEmptyPacketListener("pose_world_landmarks",i=>{H(this,i)}),this.outputPoseSegmentationMasks&&(ce(o,"POSE_SEGMENTATION_MASK:pose_segmentation_mask"),yr(this,"pose_segmentation_mask"),this.g.W("pose_segmentation_mask",(i,r)=>{this.h.poseSegmentationMasks=[wr(this,i,!0,!this.D)],H(this,r)}),this.g.attachEmptyPacketListener("pose_segmentation_mask",i=>{this.h.poseSegmentationMasks=[],H(this,i)})),this.g.attachProtoListener("face_landmarks",(i,r)=>{Pa(i,this.h.faceLandmarks),H(this,r)}),this.g.attachEmptyPacketListener("face_landmarks",i=>{H(this,i)}),this.outputFaceBlendshapes&&(pe(e,"extra_blendshapes"),ce(o,"FACE_BLENDSHAPES:extra_blendshapes"),this.g.attachProtoListener("extra_blendshapes",(i,r)=>{var s=this.h.faceBlendshapes;this.outputFaceBlendshapes&&(i=dl(i),s.push(Xd(i.g()??[]))),H(this,r)}),this.g.attachEmptyPacketListener("extra_blendshapes",i=>{H(this,i)})),this.g.attachProtoListener("left_hand_landmarks",(i,r)=>{Pa(i,this.h.leftHandLandmarks),H(this,r)}),this.g.attachEmptyPacketListener("left_hand_landmarks",i=>{H(this,i)}),this.g.attachProtoListener("left_hand_world_landmarks",(i,r)=>{var s=this.h.leftHandWorldLandmarks;i=fr(i),s.push(Ts(i)),H(this,r)}),this.g.attachEmptyPacketListener("left_hand_world_landmarks",i=>{H(this,i)}),this.g.attachProtoListener("right_hand_landmarks",(i,r)=>{Pa(i,this.h.rightHandLandmarks),H(this,r)}),this.g.attachEmptyPacketListener("right_hand_landmarks",i=>{H(this,i)}),this.g.attachProtoListener("right_hand_world_landmarks",(i,r)=>{var s=this.h.rightHandWorldLandmarks;i=fr(i),s.push(Ts(i)),H(this,r)}),this.g.attachEmptyPacketListener("right_hand_world_landmarks",i=>{H(this,i)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};Fe.prototype.detectForVideo=Fe.prototype.G,Fe.prototype.detect=Fe.prototype.F,Fe.prototype.setOptions=Fe.prototype.o,Fe.createFromModelPath=function(e,t){return ae(Fe,e,{baseOptions:{modelAssetPath:t}})},Fe.createFromModelBuffer=function(e,t){return ae(Fe,e,{baseOptions:{modelAssetBuffer:t}})},Fe.createFromOptions=function(e,t){return ae(Fe,e,t)},Fe.HAND_CONNECTIONS=rh,Fe.POSE_CONNECTIONS=Jv,Fe.FACE_LANDMARKS_LIPS=$d,Fe.FACE_LANDMARKS_LEFT_EYE=eh,Fe.FACE_LANDMARKS_LEFT_EYEBROW=th,Fe.FACE_LANDMARKS_LEFT_IRIS=Zv,Fe.FACE_LANDMARKS_RIGHT_EYE=nh,Fe.FACE_LANDMARKS_RIGHT_EYEBROW=oh,Fe.FACE_LANDMARKS_RIGHT_IRIS=Kv,Fe.FACE_LANDMARKS_FACE_OVAL=ih,Fe.FACE_LANDMARKS_CONTOURS=Yv,Fe.FACE_LANDMARKS_TESSELATION=Qv;var tn=class extends Ot{constructor(e,t){super(new Sn(e,t),"input_image","norm_rect",!0),this.j={classifications:[]},Y(e=this.h=new Rv,0,1,t=new Ue)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return Y(this.h,0,2,df(e,fe(this.h,hl,2))),this.l(e)}ua(e,t){return this.j={classifications:[]},Tn(this,e,t),this.j}va(e,t,n){return this.j={classifications:[]},ao(this,e,n,t),this.j}m(){var e=new Pt;Le(e,"input_image"),Le(e,"norm_rect"),pe(e,"classifications");const t=new Kt;kn(t,PS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.image_classifier.ImageClassifierGraph"),Pe(n,"IMAGE:input_image"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"CLASSIFICATIONS:classifications"),n.o(t),Jt(e,n),this.g.attachProtoListener("classifications",(o,i)=>{this.j=function(r){const s={classifications:_o(r,cS,1).map(a=>{var c;return Xd(((c=fe(a,Vd,4))==null?void 0:c.g())??[],to(cn(a,2)),xn(a,3)??"")})};return Tc(gr(r,2))!=null&&(s.timestampMs=to(Tc(gr(r,2)))),s}(uS(o)),H(this,i)}),this.g.attachEmptyPacketListener("classifications",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};tn.prototype.classifyForVideo=tn.prototype.va,tn.prototype.classify=tn.prototype.ua,tn.prototype.setOptions=tn.prototype.o,tn.createFromModelPath=function(e,t){return ae(tn,e,{baseOptions:{modelAssetPath:t}})},tn.createFromModelBuffer=function(e,t){return ae(tn,e,{baseOptions:{modelAssetBuffer:t}})},tn.createFromOptions=function(e,t){return ae(tn,e,t)};var _t=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!0),this.h=new Ov,this.embeddings={embeddings:[]},Y(e=this.h,0,1,t=new Ue)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){var t=this.h,n=fe(this.h,nm,2);return n=n?n.clone():new nm,e.l2Normalize!==void 0?Rs(n,1,e.l2Normalize):"l2Normalize"in e&&Ee(n,1),e.quantize!==void 0?Rs(n,2,e.quantize):"quantize"in e&&Ee(n,2),Y(t,0,2,n),this.l(e)}Ba(e,t){return Tn(this,e,t),this.embeddings}Ca(e,t,n){return ao(this,e,n,t),this.embeddings}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"embeddings_out");const t=new Kt;kn(t,NS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.image_embedder.ImageEmbedderGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"EMBEDDINGS:embeddings_out"),n.o(t),Jt(e,n),this.g.attachProtoListener("embeddings_out",(o,i)=>{o=pS(o),this.embeddings=function(r){return{embeddings:_o(r,dS,1).map(s=>{var c,l;const a={headIndex:to(cn(s,3))??-1,headName:xn(s,4)??""??""};if(L0(s,uf,ru(s,1))!==void 0)s=cr(s=fe(s,uf,ru(s,1)),1,hi),a.floatEmbedding=s.slice();else{const u=new Uint8Array(0);a.quantizedEmbedding=((l=(c=fe(s,fS,ru(s,2)))==null?void 0:c.qa())==null?void 0:l.h())??u}return a}),timestampMs:to(Tc(gr(r,2)))}}(o),H(this,i)}),this.g.attachEmptyPacketListener("embeddings_out",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};_t.cosineSimilarity=function(e,t){if(e.floatEmbedding&&t.floatEmbedding)e=rm(e.floatEmbedding,t.floatEmbedding);else{if(!e.quantizedEmbedding||!t.quantizedEmbedding)throw Error("Cannot compute cosine similarity between quantized and float embeddings.");e=rm(im(e.quantizedEmbedding),im(t.quantizedEmbedding))}return e},_t.prototype.embedForVideo=_t.prototype.Ca,_t.prototype.embed=_t.prototype.Ba,_t.prototype.setOptions=_t.prototype.o,_t.createFromModelPath=function(e,t){return ae(_t,e,{baseOptions:{modelAssetPath:t}})},_t.createFromModelBuffer=function(e,t){return ae(_t,e,{baseOptions:{modelAssetBuffer:t}})},_t.createFromOptions=function(e,t){return ae(_t,e,t)};var gf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};function Em(e){e.categoryMask=void 0,e.confidenceMasks=void 0,e.qualityScores=void 0}function Mm(e){try{const t=new gf(e.confidenceMasks,e.categoryMask,e.qualityScores);if(!e.j)return t;e.j(t)}finally{vl(e)}}gf.prototype.close=gf.prototype.close;var At=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!1),this.s=[],this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new Wd,this.v=new kv,Y(this.h,0,3,this.v),Y(e=this.h,0,1,t=new Ue)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?Ee(this.h,2,Rr(e.displayNamesLocale)):"displayNamesLocale"in e&&Ee(this.h,2),"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}K(){(function(e){var n,o;const t=_o(e.fa(),wt,1).filter(i=>(xn(i,1)??"").includes("mediapipe.tasks.TensorsToSegmentationCalculator"));if(e.s=[],1<t.length)throw Error("The graph has more than one mediapipe.tasks.TensorsToSegmentationCalculator.");t.length===1&&(((o=(n=fe(t[0],Kt,7))==null?void 0:n.l())==null?void 0:o.g())??new Map).forEach((i,r)=>{e.s[Number(r)]=xn(i,1)??""})})(this)}ga(e,t,n){const o=typeof t!="function"?t:{};return this.j=typeof t=="function"?t:n,Em(this),Tn(this,e,o),Mm(this)}Na(e,t,n,o){const i=typeof n!="function"?n:{};return this.j=typeof n=="function"?n:o,Em(this),ao(this,e,i,t),Mm(this)}Fa(){return this.s}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect");const t=new Kt;kn(t,Uv,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.image_segmenter.ImageSegmenterGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),n.o(t),Jt(e,n),gl(this,e),this.outputConfidenceMasks&&(pe(e,"confidence_masks"),ce(n,"CONFIDENCE_MASKS:confidence_masks"),yr(this,"confidence_masks"),this.g.da("confidence_masks",(o,i)=>{this.confidenceMasks=o.map(r=>wr(this,r,!0,!this.j)),H(this,i)}),this.g.attachEmptyPacketListener("confidence_masks",o=>{this.confidenceMasks=[],H(this,o)})),this.outputCategoryMask&&(pe(e,"category_mask"),ce(n,"CATEGORY_MASK:category_mask"),yr(this,"category_mask"),this.g.W("category_mask",(o,i)=>{this.categoryMask=wr(this,o,!1,!this.j),H(this,i)}),this.g.attachEmptyPacketListener("category_mask",o=>{this.categoryMask=void 0,H(this,o)})),pe(e,"quality_scores"),ce(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(o,i)=>{this.qualityScores=o,H(this,i)}),this.g.attachEmptyPacketListener("quality_scores",o=>{this.categoryMask=void 0,H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};At.prototype.getLabels=At.prototype.Fa,At.prototype.segmentForVideo=At.prototype.Na,At.prototype.segment=At.prototype.ga,At.prototype.setOptions=At.prototype.o,At.createFromModelPath=function(e,t){return ae(At,e,{baseOptions:{modelAssetPath:t}})},At.createFromModelBuffer=function(e,t){return ae(At,e,{baseOptions:{modelAssetBuffer:t}})},At.createFromOptions=function(e,t){return ae(At,e,t)};var vf=class{constructor(e,t,n){this.confidenceMasks=e,this.categoryMask=t,this.qualityScores=n}close(){var e,t;(e=this.confidenceMasks)==null||e.forEach(n=>{n.close()}),(t=this.categoryMask)==null||t.close()}};vf.prototype.close=vf.prototype.close;var RS=class extends G{constructor(e){super(e)}},Sr=[0,Ze,-2],OS=[0,Uo,-3,nt],wl=[0,Uo,-3,nt,Uo,-1],$v=[0,wl],kS=[0,$v,Sr],VS=[0,wl,Sr],ey=[0,wl,Ze,-1],US=[0,ey,Sr],zS=[0,Uo,-3,nt,Sr,-1],BS=[0,Uo,-3,nt,oo],cu=class extends G{constructor(e){super(e)}},Pm=[0,Uo,-1,nt],ty=class extends G{constructor(){super()}};ty.A=[1];var Nm=class extends G{constructor(e){super(e)}},yf=[1,2,3,4,5,6,7,8,9,10,14,15],jS=[0,yf,Re,wl,Re,VS,Re,$v,Re,kS,Re,Pm,Re,BS,Re,OS,Re,[0,Ie,Uo,-2,nt,Ze,nt,-1,2,Uo,Sr],Re,ey,Re,US,Uo,Sr,Ie,Re,zS,Re,[0,st,Pm]],_S=[0,Ie,Ze,-1,nt],bf=class extends G{constructor(){super()}};bf.A=[1],bf.prototype.g=fl([0,st,jS,Ie,_S]);var jn=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect_in",!1),this.outputCategoryMask=!1,this.outputConfidenceMasks=!0,this.h=new Wd,this.s=new kv,Y(this.h,0,3,this.s),Y(e=this.h,0,1,t=new Ue)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return"outputCategoryMask"in e&&(this.outputCategoryMask=e.outputCategoryMask??!1),"outputConfidenceMasks"in e&&(this.outputConfidenceMasks=e.outputConfidenceMasks??!0),super.l(e)}ga(e,t,n,o){const i=typeof n!="function"?n:{};this.j=typeof n=="function"?n:o,this.qualityScores=this.categoryMask=this.confidenceMasks=void 0,n=this.C+1,o=new bf;const r=new Nm;var s=new RS;if(no(s,1,255),Y(r,0,12,s),t.keypoint&&t.scribble)throw Error("Cannot provide both keypoint and scribble.");if(t.keypoint){var a=new cu;Rs(a,3,!0),Z(a,1,t.keypoint.x),Z(a,2,t.keypoint.y),xs(r,5,yf,a)}else{if(!t.scribble)throw Error("Must provide either a keypoint or a scribble.");for(a of(s=new ty,t.scribble))Rs(t=new cu,3,!0),Z(t,1,a.x),Z(t,2,a.y),Nc(s,1,cu,t);xs(r,15,yf,s)}Nc(o,1,Nm,r),this.g.addProtoToStream(o.g(),"drishti.RenderData","roi_in",n),Tn(this,e,i);e:{try{const l=new vf(this.confidenceMasks,this.categoryMask,this.qualityScores);if(!this.j){var c=l;break e}this.j(l)}finally{vl(this)}c=void 0}return c}m(){var e=new Pt;Le(e,"image_in"),Le(e,"roi_in"),Le(e,"norm_rect_in");const t=new Kt;kn(t,Uv,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.interactive_segmenter.InteractiveSegmenterGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"ROI:roi_in"),Pe(n,"NORM_RECT:norm_rect_in"),n.o(t),Jt(e,n),gl(this,e),this.outputConfidenceMasks&&(pe(e,"confidence_masks"),ce(n,"CONFIDENCE_MASKS:confidence_masks"),yr(this,"confidence_masks"),this.g.da("confidence_masks",(o,i)=>{this.confidenceMasks=o.map(r=>wr(this,r,!0,!this.j)),H(this,i)}),this.g.attachEmptyPacketListener("confidence_masks",o=>{this.confidenceMasks=[],H(this,o)})),this.outputCategoryMask&&(pe(e,"category_mask"),ce(n,"CATEGORY_MASK:category_mask"),yr(this,"category_mask"),this.g.W("category_mask",(o,i)=>{this.categoryMask=wr(this,o,!1,!this.j),H(this,i)}),this.g.attachEmptyPacketListener("category_mask",o=>{this.categoryMask=void 0,H(this,o)})),pe(e,"quality_scores"),ce(n,"QUALITY_SCORES:quality_scores"),this.g.attachFloatVectorListener("quality_scores",(o,i)=>{this.qualityScores=o,H(this,i)}),this.g.attachEmptyPacketListener("quality_scores",o=>{this.categoryMask=void 0,H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};jn.prototype.segment=jn.prototype.ga,jn.prototype.setOptions=jn.prototype.o,jn.createFromModelPath=function(e,t){return ae(jn,e,{baseOptions:{modelAssetPath:t}})},jn.createFromModelBuffer=function(e,t){return ae(jn,e,{baseOptions:{modelAssetBuffer:t}})},jn.createFromOptions=function(e,t){return ae(jn,e,t)};var nn=class extends Ot{constructor(e,t){super(new Sn(e,t),"input_frame_gpu","norm_rect",!1),this.j={detections:[]},Y(e=this.h=new Gd,0,1,t=new Ue)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return e.displayNamesLocale!==void 0?Ee(this.h,2,Rr(e.displayNamesLocale)):"displayNamesLocale"in e&&Ee(this.h,2),e.maxResults!==void 0?no(this.h,3,e.maxResults):"maxResults"in e&&Ee(this.h,3),e.scoreThreshold!==void 0?Z(this.h,4,e.scoreThreshold):"scoreThreshold"in e&&Ee(this.h,4),e.categoryAllowlist!==void 0?Pc(this.h,5,e.categoryAllowlist):"categoryAllowlist"in e&&Ee(this.h,5),e.categoryDenylist!==void 0?Pc(this.h,6,e.categoryDenylist):"categoryDenylist"in e&&Ee(this.h,6),this.l(e)}F(e,t){return this.j={detections:[]},Tn(this,e,t),this.j}G(e,t,n){return this.j={detections:[]},ao(this,e,n,t),this.j}m(){var e=new Pt;Le(e,"input_frame_gpu"),Le(e,"norm_rect"),pe(e,"detections");const t=new Kt;kn(t,CS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.ObjectDetectorGraph"),Pe(n,"IMAGE:input_frame_gpu"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"DETECTIONS:detections"),n.o(t),Jt(e,n),this.g.attachProtoVectorListener("detections",(o,i)=>{for(const r of o)o=rv(r),this.j.detections.push(Bv(o));H(this,i)}),this.g.attachEmptyPacketListener("detections",o=>{H(this,o)}),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};nn.prototype.detectForVideo=nn.prototype.G,nn.prototype.detect=nn.prototype.F,nn.prototype.setOptions=nn.prototype.o,nn.createFromModelPath=async function(e,t){return ae(nn,e,{baseOptions:{modelAssetPath:t}})},nn.createFromModelBuffer=function(e,t){return ae(nn,e,{baseOptions:{modelAssetBuffer:t}})},nn.createFromOptions=function(e,t){return ae(nn,e,t)};var xf=class{constructor(e,t,n){this.landmarks=e,this.worldLandmarks=t,this.segmentationMasks=n}close(){var e;(e=this.segmentationMasks)==null||e.forEach(t=>{t.close()})}};function Am(e){e.landmarks=[],e.worldLandmarks=[],e.segmentationMasks=void 0}function Cm(e){try{const t=new xf(e.landmarks,e.worldLandmarks,e.segmentationMasks);if(!e.s)return t;e.s(t)}finally{vl(e)}}xf.prototype.close=xf.prototype.close;var ft=class extends Ot{constructor(e,t){super(new Sn(e,t),"image_in","norm_rect",!1),this.landmarks=[],this.worldLandmarks=[],this.outputSegmentationMasks=!1,Y(e=this.h=new zv,0,1,t=new Ue),this.v=new Iv,Y(this.h,0,3,this.v),this.j=new Dv,Y(this.h,0,2,this.j),no(this.j,4,1),Z(this.j,2,.5),Z(this.v,2,.5),Z(this.h,4,.5)}get baseOptions(){return fe(this.h,Ue,1)}set baseOptions(e){Y(this.h,0,1,e)}o(e){return"numPoses"in e&&no(this.j,4,e.numPoses??1),"minPoseDetectionConfidence"in e&&Z(this.j,2,e.minPoseDetectionConfidence??.5),"minTrackingConfidence"in e&&Z(this.h,4,e.minTrackingConfidence??.5),"minPosePresenceConfidence"in e&&Z(this.v,2,e.minPosePresenceConfidence??.5),"outputSegmentationMasks"in e&&(this.outputSegmentationMasks=e.outputSegmentationMasks??!1),this.l(e)}F(e,t,n){const o=typeof t!="function"?t:{};return this.s=typeof t=="function"?t:n,Am(this),Tn(this,e,o),Cm(this)}G(e,t,n,o){const i=typeof n!="function"?n:{};return this.s=typeof n=="function"?n:o,Am(this),ao(this,e,i,t),Cm(this)}m(){var e=new Pt;Le(e,"image_in"),Le(e,"norm_rect"),pe(e,"normalized_landmarks"),pe(e,"world_landmarks"),pe(e,"segmentation_masks");const t=new Kt;kn(t,LS,this.h);const n=new wt;Qt(n,"mediapipe.tasks.vision.pose_landmarker.PoseLandmarkerGraph"),Pe(n,"IMAGE:image_in"),Pe(n,"NORM_RECT:norm_rect"),ce(n,"NORM_LANDMARKS:normalized_landmarks"),ce(n,"WORLD_LANDMARKS:world_landmarks"),n.o(t),Jt(e,n),gl(this,e),this.g.attachProtoVectorListener("normalized_landmarks",(o,i)=>{this.landmarks=[];for(const r of o)o=ta(r),this.landmarks.push(ml(o));H(this,i)}),this.g.attachEmptyPacketListener("normalized_landmarks",o=>{this.landmarks=[],H(this,o)}),this.g.attachProtoVectorListener("world_landmarks",(o,i)=>{this.worldLandmarks=[];for(const r of o)o=fr(r),this.worldLandmarks.push(Ts(o));H(this,i)}),this.g.attachEmptyPacketListener("world_landmarks",o=>{this.worldLandmarks=[],H(this,o)}),this.outputSegmentationMasks&&(ce(n,"SEGMENTATION_MASK:segmentation_masks"),yr(this,"segmentation_masks"),this.g.da("segmentation_masks",(o,i)=>{this.segmentationMasks=o.map(r=>wr(this,r,!0,!this.s)),H(this,i)}),this.g.attachEmptyPacketListener("segmentation_masks",o=>{this.segmentationMasks=[],H(this,o)})),e=e.g(),this.setGraph(new Uint8Array(e),!0)}};ft.prototype.detectForVideo=ft.prototype.G,ft.prototype.detect=ft.prototype.F,ft.prototype.setOptions=ft.prototype.o,ft.createFromModelPath=function(e,t){return ae(ft,e,{baseOptions:{modelAssetPath:t}})},ft.createFromModelBuffer=function(e,t){return ae(ft,e,{baseOptions:{modelAssetBuffer:t}})},ft.createFromOptions=function(e,t){return ae(ft,e,t)},ft.POSE_CONNECTIONS=Jv;const le={NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,MOUTH_LEFT:9,MOUTH_RIGHT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32},Lm=new vt(.5,.5,.5),Qr=[],Jr=[],HS={rightFoot:0,leftFoot:1},wi=[!1,!1],qS=.05,WS=.035,GS=.5,XS=.2,ZS=Ti.filter(e=>/Leg|Foot|hips/i.test(e)),KS=e=>{const t=[e[le.RIGHT_ANKLE].y,e[le.LEFT_ANKLE].y];if(!t[0]||!t[1])return;const n=[Qr.reduce((o,i)=>o+i,0)/Qr.length,Jr.reduce((o,i)=>o+i,0)/Jr.length];Qr.push(t[0]),Jr.push(t[1]),Qr.length>10&&Qr.shift(),Jr.length>10&&Jr.shift();for(let o=0;o<2;o++){const i=Math.abs(t[o]-n[o])>qS,r=Math.abs(t[o]-t[o==0?1:0])<WS,s=t[o]>t[o==0?1:0];wi[o]?i&&!r&&(wi[o]=!1):(s||r)&&!i&&(wi[o]=!0)}return wi},YS=Object.fromEntries(Object.entries(Object.entries(le)).map(([e,t])=>[t,e])),sh=e=>{if(!ft.POSE_CONNECTIONS)return()=>{};const t={};let n=null;const o=new M4(new Cr,new Gs({vertexColors:!0}));o.material.linewidth=4;const i=new Jn(new Float32Array(ft.POSE_CONNECTIONS.length*2*3).fill(0),3);o.geometry.setAttribute("position",i);const r=new Jn(new Float32Array(ft.POSE_CONNECTIONS.length*2*4).fill(1),4);return o.geometry.setAttribute("color",r),(s,a)=>{if(!a){for(const[l,u]of Object.entries(t))delete t[l],Gt(u);n&&(Gt(n),n=null);return}if(!s)return;const c=s.reduce((l,u)=>l.y>u.y?l:u).y;for(const[l,u]of Object.entries(s)){const d=u.visibility??0,f=new vt().set(1-d,d,0);if(!t[l]){const g=new Qn(new k1(.01),new ri({color:f})),m=It();t[l]=m,Rt(m,g),Qo(m,!0),O(m,at,`Mocap Debug ${e} ${YS[l]}`),Vu(g,Dn.AvatarHelper)}const h=t[l],p=M(h,mt)[0];p.material.color.set(f),l===`${le.RIGHT_WRIST}`&&p.material.color.set(16711680),l===`${le.RIGHT_PINKY}`&&p.material.color.set(65280),l===`${le.RIGHT_INDEX}`&&p.material.color.set(255),l===`${le.LEFT_ANKLE}`&&p.material.color.setHex(wi[1]?65280:16711680),l===`${le.RIGHT_ANKLE}`&&p.material.color.setHex(wi[0]?65280:16711680),M(h,q).matrix.setPosition(u.x,c-u.y,u.z)}n||(n=It(),Rt(n,o),Qo(n,!0),O(n,at,"Mocap Debug Line Segment "+e),Vu(o,Dn.AvatarHelper));for(let l=0;l<ft.POSE_CONNECTIONS.length*2;l+=2){const{start:u,end:d}=ft.POSE_CONNECTIONS[l/2],f=M(t[u],mt)[0],h=M(t[d],mt)[0];i.setXYZ(l,f.matrixWorld.elements[12],f.matrixWorld.elements[13],f.matrixWorld.elements[14]),i.setXYZ(l+1,h.matrixWorld.elements[12],h.matrixWorld.elements[13],h.matrixWorld.elements[14]);const p=f.material.color.g>Tr&&h.material.color.g>Tr,g=p?f.material.color:Lm,m=p?h.material.color:Lm;r.setXYZW(l,g.r,g.g,g.b,1),r.setXYZW(l+1,m.r,m.g,m.b,1)}i.needsUpdate=!0,r.needsUpdate=!0}},QS=sh("Raw"),JS=sh("Screen"),$S=sh("Final"),eT=(e,t=.5)=>{const n=(e[le.RIGHT_HIP].visibility+e[le.LEFT_HIP].visibility)*.5>Tr,o=(e[le.LEFT_KNEE].visibility+e[le.RIGHT_KNEE].visibility)*.5>Tr;return n&&o};function tT(e,t,n){const o=(d,f,h)=>{if(!f.length)return d;const p=[],g=[];for(let m=0;m<d.length;m++){if(d[m].visibility<.1){g[m]=f[m],p[m]=f[m];continue}const v=h;g[m]={visibility:Ht.lerp(f[m].visibility,d[m].visibility,v),x:Ht.lerp(f[m].x,d[m].x,d[m].visibility),y:Ht.lerp(f[m].y,d[m].y,d[m].visibility),z:Ht.lerp(f[m].z,d[m].z,d[m].visibility)},p[m]={visibility:Ht.lerp(f[m].visibility,g[m].visibility,v),x:Ht.lerp(f[m].x,g[m].x,v),y:Ht.lerp(f[m].y,g[m].y,v),z:Ht.lerp(f[m].z,g[m].z,v)}}return p},i=M(e,On);if(!i||!i.normalizedRig||!i.normalizedRig.hips||!i.normalizedRig.hips.node||!(t!=null&&t.length)||!n)return;const r=B(Pr).avatarDebug,s=M(e,z);s.prevWorldLandmarks||(s.prevWorldLandmarks=t.map(d=>({...d}))),s.prevScreenLandmarks||(s.prevScreenLandmarks=n.map(d=>({...d})));const a=o(t,s.prevWorldLandmarks,GS),c=o(n,s.prevScreenLandmarks,XS);s.prevWorldLandmarks=a,s.prevScreenLandmarks=c;const l=a.reduce((d,f)=>d.y>f.y?d:f).y,u=eT(a);if(z.solvingLowerBody[e]=u?1:0,KS(a),e===he.getSelfAvatarEntity()&&(QS(t,r),JS(n,!!n&&r),$S(a,r)),oT(e,l,a,u),Na(e,l,a[le.LEFT_SHOULDER],a[le.LEFT_ELBOW],a[le.LEFT_WRIST],new P(-1,0,0),be.Chest,be.LeftUpperArm,be.LeftLowerArm,.75),Na(e,l,a[le.RIGHT_SHOULDER],a[le.RIGHT_ELBOW],a[le.RIGHT_WRIST],new P(1,0,0),be.Chest,be.RightUpperArm,be.RightLowerArm,.75),u)Na(e,l,c[le.LEFT_HIP],c[le.LEFT_KNEE],c[le.LEFT_ANKLE],new P(0,1,0),be.Hips,be.LeftUpperLeg,be.LeftLowerLeg),Na(e,l,c[le.RIGHT_HIP],c[le.RIGHT_KNEE],c[le.RIGHT_KNEE],new P(0,1,0),be.Hips,be.RightUpperLeg,be.RightLowerLeg),z.solvingLowerBody[e]||(z.solvingLowerBody[e]=1);else{z.solvingLowerBody[e]&&(z.solvingLowerBody[e]=0);for(const d of ZS)z.rig[d].x[e]=0,z.rig[d].y[e]=0,z.rig[d].z[e]=0,z.rig[d].w[e]=0}rT(e,c[le.RIGHT_EAR],c[le.LEFT_EAR],c[le.NOSE])}const Tr=.6,wf=new P,xi=new re,$r=new re,Hi=new P,Dm=new re,nT=new re,oT=(e,t,n,o)=>{const i=M(e,On),r=M(e,he),s=n[le.RIGHT_HIP],a=n[le.LEFT_HIP];if(!s||!a)return;const c=n[le.RIGHT_SHOULDER],l=n[le.LEFT_SHOULDER];if(c.visibility<Tr||l.visibility<Tr)return;xi.identity(),$r.identity();const u=new P(s.x,t-s.y,s.z),d=new P(a.x,t-a.y,a.z);if(o){for(let m=0;m<2;m++)if(wi[m]){const y=n[m==HS.rightFoot?le.RIGHT_ANKLE:le.LEFT_ANKLE].y*-1+i.normalizedRig.hips.node.position.y;z.footOffset[e]=y}Hi.copy(u).add(d).multiplyScalar(.5)}else Hi.copy(new P(0,r.hipsHeight,0));const f=new P(-c.x,t-c.y,-c.z),h=new P(-l.x,t-l.y,-l.z),p=new P().copy(f).add(h).multiplyScalar(.5);nT.setFromUnitVectors(od,wf.subVectors(p,Hi).normalize());const g=ny(d,u,p,new re,!1);g.multiply(new re().setFromEuler(new Yc(0,Math.PI,Math.PI))),o?(z.hipRotation.x[e]=g.x,z.hipRotation.y[e]=g.y,z.hipRotation.z[e]=g.z,z.hipRotation.w[e]=g.w):a.visibility+s.visibility>1?xi.copy(g):(Dm.setFromUnitVectors(K1,new P().subVectors(h,f)),xi.copy(Dm)),g.set(z.hipRotation.x[e],z.hipRotation.y[e],z.hipRotation.z[e],z.hipRotation.w[e]),z.hipPosition.x[e]=Hi.x,z.hipPosition.y[e]=Hi.y,z.hipPosition.z[e]=Hi.z,z.rig[be.Hips].x[e]=g.x,z.rig[be.Hips].y[e]=g.y,z.rig[be.Hips].z[e]=g.z,z.rig[be.Hips].w[e]=g.w,z.rig[be.Spine].x[e]=xi.x,z.rig[be.Spine].y[e]=xi.y,z.rig[be.Spine].z[e]=xi.z,z.rig[be.Spine].w[e]=xi.w,z.rig[be.Chest].x[e]=$r.x,z.rig[be.Chest].y[e]=$r.y,z.rig[be.Chest].z[e]=$r.z,z.rig[be.Chest].w[e]=$r.w},Im=new P,lu=new P,Fm=new P,Na=(e,t,n,o,i,r,s=null,a,c,l=-1)=>{if(!n||!o||!i||l>-1&&(n.visibility+o.visibility+i.visibility)/3<l)return;Im.set(n.x,t-n.y,-n.z),lu.set(o.x,t-o.y,-o.z),Fm.set(i.x,t-i.y,-i.z);const u=new re().setFromUnitVectors(r,wf.subVectors(Im,lu).normalize()),d=new re().setFromUnitVectors(r,wf.subVectors(lu,Fm).normalize()),f=new re().copy(u);s&&f.premultiply(new re(z.rig[s].x[e],z.rig[s].y[e],z.rig[s].z[e],z.rig[s].w[e]).invert());const h=new re().copy(d).premultiply(u.clone().invert());z.rig[a].x[e]=f.x,z.rig[a].y[e]=f.y,z.rig[a].z[e]=f.z,z.rig[a].w[e]=f.w,z.rig[c].x[e]=h.x,z.rig[c].y[e]=h.y,z.rig[c].z[e]=h.z,z.rig[c].w[e]=h.w};new P;new P;const qi=new re,Rm=new P,Om=new P,km=new P,iT=new re().setFromAxisAngle(new P(1,0,0),-Math.PI/2),rT=(e,t,n,o)=>{Rm.set(-t.x,-t.y,-t.z),Om.set(-n.x,-n.y,-n.z),km.set(-o.x,-o.y,-o.z),ny(Rm,Om,km,qi,!0),qi.multiply(iT),z.rig[be.Head].x[e]=qi.x,z.rig[be.Head].y[e]=qi.y,z.rig[be.Head].z[e]=qi.z,z.rig[be.Head].w[e]=qi.w},Vm=new td,Aa=new P,Um=new P,zm=new ne,ny=(e,t,n,o,i=!1)=>{Vm.setFromCoplanarPoints(i?t:e,i?e:t,n);const r=Vm.normal;return Aa.subVectors(e,t).normalize(),Um.crossVectors(r,i?Aa.reflect(new P(0,1,0)):Aa),zm.makeBasis(Aa,Um,r),o.setFromRotationMatrix(zm)},sT=e=>ab({timestamp:Date.now(),results:e}),aT=e=>cb(new Uint8Array(e)),cT={sendResults:sT,receiveResults:aT},Bm="ee.core.mocap.dataChannel",jm=(e,t,n,o)=>{e.isHosting&&e.bufferToAll(t,n,o);const i=cT.receiveResults(o);Si.has(n)||Si.set(n,new i3(10)),Si.get(n).add(i)},lT=ie([z,On]),Si=new Map,uu=new Map,uT=25,fT=()=>{var t;if(!Ar)return;const e=qc.worldNetwork;if(e){for(const[n,o]of Si)(!e.peers[n]||uu.get(n)<Date.now()-1e3)&&(Si.delete(n),uu.delete(n));for(const[n,o]of Si){const i=o.getFirst(),r=e.peers[n].userId,s=he.getUserAvatarEntity(r);s&&(uu.set(n,Date.now()),O(s,z),tT(s,i==null?void 0:i.results.worldLandmarks,i==null?void 0:i.results.landmarks),o.clear())}for(const n of lT()){const o=Object.keys(e.peers).find(a=>Si.has(a)),i=M(n,On);if(!i.normalizedRig)continue;const r=i.normalizedRig.hips.node.parent;if(!o){Qe(n,z),r==null||r.position.setY(0);continue}for(const a of Ti){const c=(t=i.vrm.humanoid.normalizedHumanBones[a])==null?void 0:t.node;if(!c||z.rig[a].x[n]===0&&z.rig[a].y[n]===0&&z.rig[a].z[n]===0&&z.rig[a].w[n]===0)continue;const l=new re().set(z.slerpedRig[a].x[n],z.slerpedRig[a].y[n],z.slerpedRig[a].z[n],z.slerpedRig[a].w[n]).normalize().fastSlerp(new re().set(z.rig[a].x[n],z.rig[a].y[n],z.rig[a].z[n],z.rig[a].w[n]).normalize(),B(ht).deltaSeconds*uT);c.quaternion.copy(l),z.slerpedRig[a].x[n]=l.x,z.slerpedRig[a].y[n]=l.y,z.slerpedRig[a].z[n]=l.z,z.slerpedRig[a].w[n]=l.w}i.normalizedRig.hips.node.position.set(z.hipPosition.x[n],z.hipPosition.y[n],z.hipPosition.z[n])}}},dT=()=>(A.useEffect(()=>(n3(Bm,jm),()=>{o3(Bm,jm)}),[]),null);ee({uuid:"ee.engine.MotionCaptureSystem",insert:{before:rd},execute:fT,reactor:dT});var N=(e=>(e[e.BlendFunction=0]="BlendFunction",e[e.Number=1]="Number",e[e.Boolean=2]="Boolean",e[e.Color=3]="Color",e[e.ColorSpace=4]="ColorSpace",e[e.KernelSize=5]="KernelSize",e[e.SMAAPreset=6]="SMAAPreset",e[e.EdgeDetectionMode=7]="EdgeDetectionMode",e[e.PredicationMode=8]="PredicationMode",e[e.Texture=9]="Texture",e[e.Vector2=10]="Vector2",e[e.Vector3=11]="Vector3",e[e.VignetteTechnique=12]="VignetteTechnique",e))(N||{});const uo="BloomEffect",hT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[uo].value||o[uo].set(r[uo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[uo].value&&i[uo].set(W);return}const s=new r3(o[uo].value);return i[uo].set(s),()=>{i[uo].set(W)}},[t]),null},pT=()=>{Q(K).merge({[uo]:{reactor:hT,defaultValues:{isActive:!0,blendFunction:ot.SCREEN,kernelSize:y1.LARGE,luminanceThreshold:.9,luminanceSmoothing:.025,mipmapBlur:!1,intensity:1,radius:.85,levels:8},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},kernelSize:{propertyType:N.KernelSize,name:"Kernel Size"},intensity:{propertyType:N.Number,name:"Intensity",min:0,max:10,step:.01},luminanceSmoothing:{propertyType:N.Number,name:"Luminance Smoothing",min:0,max:1,step:.01},luminanceThreshold:{propertyType:N.Number,name:"Luminance Threshold",min:0,max:1,step:.01},mipmapBlur:{propertyType:N.Boolean,name:"Mipmap Blur"},radius:{propertyType:N.Number,name:"Resolution Scale",min:0,max:10,step:.01},levels:{propertyType:N.Number,name:"Resolution Scale",min:1,max:10,step:1}}}})},fo="BrightnessContrastEffect",mT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[fo].value||o[fo].set(r[fo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[fo].value&&i[fo].set(W);return}const s=new s3(o[fo].value);return i[fo].set(s),()=>{i[fo].set(W)}},[t]),null},gT=()=>{Q(K).merge({[fo]:{reactor:mT,defaultValues:{isActive:!1,blendFunction:ot.SRC,brightness:0,contrast:0},schema:{brightness:{propertyType:N.Number,name:"Brightness",min:-1,max:1,step:.01},contrast:{propertyType:N.Number,name:"Contrast",min:-1,max:1,step:.01}}}})},ho="ChromaticAberrationEffect",vT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[ho].value||o[ho].set(r[ho].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[ho].value&&i[ho].set(W);return}const s=new a3(o[ho].value);return i[ho].set(s),()=>{i[ho].set(W)}},[t]),null},yT=()=>{Q(K).merge({[ho]:{reactor:vT,defaultValues:{isActive:!1,offset:new Me(.001,5e-4),radialModulation:!1,modulationOffset:.15},schema:{offset:{propertyType:N.Vector2,name:"Offset"},radialModulation:{propertyType:N.Boolean,name:"Radial Modulation"},modulationOffset:{propertyType:N.Number,name:"Modulation Offset",min:0,max:10,step:.01}}}})},po="ColorAverageEffect",bT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[po].value||o[po].set(r[po].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[po].value&&i[po].set(W);return}const s=new c3(o[po].value.blendFunction);return i[po].set(s),()=>{i[po].set(W)}},[t]),null},xT=()=>{Q(K).merge({[po]:{reactor:bT,defaultValues:{isActive:!1,blendFunction:ot.NORMAL},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"}}}})},mo="ColorDepthEffect",wT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[mo].value||o[mo].set(r[mo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[mo].value&&i[mo].set(W);return}const s=new l3(o[mo].value);return i[mo].set(s),()=>{i[mo].set(W)}},[t]),null},ST=()=>{Q(K).merge({[mo]:{reactor:wT,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,bits:16},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},bits:{propertyType:N.Number,name:"Bits",min:8,max:256,step:8}}}})},go="DepthOfFieldEffect",TT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[go].value||o[go].set(r[go].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[go].value&&i[go].set(W);return}const s=se(n,qt),a=new u3(s.value,o[go].value);return i[go].set(a),()=>{i[go].set(W)}},[t]),null},ET=()=>{Q(K).merge({[go]:{reactor:TT,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,focusDistance:0,focalLength:.1,focusRange:.1,bokehScale:1,resolutionScale:1,resolutionX:$o.AUTO_SIZE,resolutionY:$o.AUTO_SIZE},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},bokehScale:{propertyType:N.Number,name:"Bokeh Scale",min:-10,max:10,step:.01},focalLength:{propertyType:N.Number,name:"Focal Length",min:0,max:1,step:.01},focalRange:{propertyType:N.Number,name:"Focal Range",min:0,max:1,step:.01},focusDistance:{propertyType:N.Number,name:"Focus Distance",min:0,max:1,step:.01},resolutionScale:{propertyType:N.Number,name:"Resolution Scale",min:-10,max:10,step:.01}}}})},vo="DotScreenEffect",MT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[vo].value||o[vo].set(r[vo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[vo].value&&i[vo].set(W);return}const s=new f3(o[vo].value);return i[vo].set(s),()=>{i[vo].set(W)}},[t]),null},PT=()=>{Q(K).merge({[vo]:{reactor:MT,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,angle:Math.PI*.5,scale:1},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},angle:{propertyType:N.Number,name:"Angle",min:0,max:360,step:.1},scale:{propertyType:N.Number,name:"Scale",min:0,max:10,step:.1}}}})},yo="FXAAEffect",NT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[yo].value||o[yo].set(r[yo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[yo].value&&i[yo].set(W);return}const s=new d3(o[yo].value);return i[yo].set(s),()=>{i[yo].set(W)}},[t]),null},AT=()=>{Q(K).merge({[yo]:{reactor:NT,defaultValues:{isActive:!1,blendFunction:ot.SRC},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"}}}})},bo="GlitchEffect",CT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[bo].value||o[bo].set(r[bo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[bo].value&&i[bo].set(W);return}const s=new h3(o[bo].value);return i[bo].set(s),()=>{i[bo].set(W)}},[t]),null},LT=()=>{Q(K).merge({[bo]:{reactor:CT,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,chromaticAberrationOffset:void 0,delay:new Me(1.5,3.5),duration:new Me(.6,1),strength:new Me(.3,1),perturbationMap:void 0,dtSize:64,columns:.05,ratio:.85},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},chromaticAberrationOffset:{propertyType:N.Vector2,name:"Chromatic Aberration Offset"},delay:{propertyType:N.Vector2,name:"Delay"},duration:{propertyType:N.Vector2,name:"Duration"},strength:{propertyType:N.Vector2,name:"Strength"},perturbationMap:{propertyType:N.Texture,name:"Perturbation Map"},dtSize:{propertyType:N.Number,name:"DT Size",min:0,max:10,step:.1},columns:{propertyType:N.Number,name:"Columns",min:0,max:10,step:.1},ratio:{propertyType:N.Number,name:"Ratio",min:0,max:10,step:.1}}}})},xo="GridEffect",DT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[xo].value||o[xo].set(r[xo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[xo].value&&i[xo].set(W);return}const s=new p3(o[xo].value);return i[xo].set(s),()=>{i[xo].set(W)}},[t]),null},IT=()=>{Q(K).merge({[xo]:{reactor:DT,defaultValues:{isActive:!1,blendFunction:ot.OVERLAY,scale:1,lineWidth:0},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},scale:{propertyType:N.Number,name:"Scale",min:0,max:10,step:.1},lineWidth:{propertyType:N.Number,name:"Line Width",min:0,max:10,step:.1}}}})},wo="HueSaturationEffect",FT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[wo].value||o[wo].set(r[wo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[wo].value&&i[wo].set(W);return}const s=new m3(o[wo].value);return i[wo].set(s),()=>{i[wo].set(W)}},[t]),null},RT=()=>{Q(K).merge({[wo]:{reactor:FT,defaultValues:{isActive:!1,blendFunction:ot.SRC,hue:0,saturation:0},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},hue:{propertyType:N.Number,name:"Hue",min:-1,max:1,step:.01},saturation:{propertyType:N.Number,name:"Saturation",min:-1,max:1,step:.01}}}})},Pn="LUT1DEffect",OT=e=>{var c;const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K),[s,a]=Ii((c=o[Pn].value)==null?void 0:c.lutPath);return A.useEffect(()=>{o[Pn].value||o[Pn].set(r[Pn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Pn].value&&i[Pn].set(W);return}if(s){const l=new g3(s,o[Pn].value);i[Pn].set(l)}return()=>{i[Pn].set(W)}},[t,o[Pn],s]),null},kT=()=>{Q(K).merge({[Pn]:{reactor:OT,defaultValues:{isActive:!1,blendFunction:ot.SRC,lutPath:void 0,lut:void 0},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},lutPath:{propertyType:N.Texture,name:"LUT"}}}})},Nn="LUT3DEffect",VT=e=>{var c;const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K),[s,a]=Ii((c=o[Nn].value)==null?void 0:c.lutPath);return A.useEffect(()=>{o[Nn].value||o[Nn].set(r[Nn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Nn].value&&i[Nn].set(W);return}if(s){const l=new v3(s,o[Nn].value);i[Nn].set(l)}return()=>{i[Nn].set(W)}},[t,o[Nn],s]),null},UT=()=>{Q(K).merge({[Nn]:{reactor:VT,defaultValues:{isActive:!1,blendFunction:ot.SRC,lutPath:void 0,lut:void 0},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},lutPath:{propertyType:N.Texture,name:"LUT"}}}})},So="LensDistortionEffect",zT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[So].value||o[So].set(r[So].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[So].value&&i[So].set(W);return}const s=new y3(o[So].value);return i[So].set(s),()=>{i[So].set(W)}},[t]),null},BT=()=>{Q(K).merge({[So]:{reactor:zT,defaultValues:{isActive:!1,distortion:new Me(0,0),principalPoint:new Me(0,0),focalLength:new Me(1,1),skew:0},schema:{distortion:{propertyType:N.Vector2,name:"Distortion"},principalPoint:{propertyType:N.Vector2,name:"Principal Point"},focalLength:{propertyType:N.Vector2,name:"Focal Length"},skew:{propertyType:N.Number,name:"Skew",min:0,max:10,step:.05}}}})},jT=`void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {

	outputColor = LinearTosRGB(max(inputColor, 0.0));

}`;class _T extends Ws{constructor({blendFunction:t=ot.NORMAL}={}){super("LinearTosRGBEffect",jT,{blendFunction:t})}}const To="LinearTosRGBEffect",HT=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[To].value||o[To].set(r[To].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[To].value&&i[To].set(W);return}const s=new _T(o[To].value);return i[To].set(s),()=>{i[To].set(W)}},[t]),null},qT=()=>{Q(K).merge({[To]:{reactor:HT,defaultValues:{isActive:!1,skew:0},schema:{}}})},Sf=1.324717957244746,WT=1/Sf,GT=1/(Sf*Sf),_m=1.1127756842787055,XT=e=>{const t=[];for(let n=0;n<e;n++)t.push([(_m+WT*n)%1,(_m+GT*n)%1]);return t},Hm=XT(256).map(([e,t])=>[e-.5,t-.5]);function ZT(e,t,n,o,i=1){const[r,s]=Hm[o%Hm.length];n.setViewOffset&&n.setViewOffset(e,t,r*i,s*i,e,t)}var Ur=`#define GLSLIFY 1
varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}`,KT=`#define GLSLIFY 1
varying vec2 vUv;uniform highp sampler2D inputTexture;uniform highp sampler2D velocityTexture;uniform highp sampler2D depthTexture;uniform highp sampler2D lastVelocityTexture;uniform float maxBlend;uniform float neighborhoodClampIntensity;uniform bool fullAccumulate;uniform vec2 invTexSize;uniform float cameraNear;uniform float cameraFar;uniform mat4 projectionMatrix;uniform mat4 projectionMatrixInverse;uniform mat4 cameraMatrixWorld;uniform vec3 cameraPos;uniform vec3 prevCameraPos;uniform mat4 prevViewMatrix;uniform mat4 prevCameraMatrixWorld;uniform mat4 prevProjectionMatrix;uniform mat4 prevProjectionMatrixInverse;uniform float keepData;
#define EPSILON 0.00001
#define DIFFUSE_SPECULAR 0
#define DIFFUSE 1
#define SPECULAR 2
#include <gbuffer_packing>
#include <packing>
#include <reproject>
vec3 reprojectedUvDiffuse=vec3(-1.0),reprojectedUvSpecular=vec3(-1.0);void accumulate(inout vec4 outputColor,inout vec4 inp,inout vec4 acc,inout float roughness,inout float moveFactor,bool doReprojectSpecular){vec3 reprojectedUvConfidence=doReprojectSpecular ? reprojectedUvSpecular : reprojectedUvDiffuse;vec2 reprojectedUv=reprojectedUvConfidence.xy;float confidence=reprojectedUvConfidence.z;confidence=pow(confidence,confidencePower);float accumBlend=1.-1./(acc.a+1.0);accumBlend=mix(0.,accumBlend,confidence);float maxValue=(fullAccumulate ? 1. : maxBlend)*keepData;
#if inputType != DIFFUSE
const float roughnessMaximum=0.1;if(doReprojectSpecular&&roughness>=0.0&&roughness<roughnessMaximum){float maxRoughnessValue=mix(0.,maxValue,roughness/roughnessMaximum);maxValue=mix(maxValue,maxRoughnessValue,min(100.*moveFactor,1.));}
#endif
float temporalReprojectMix=min(accumBlend,maxValue);acc.a=1./(1.-temporalReprojectMix)-1.;acc.a=min(65536.,acc.a);outputColor.rgb=mix(inp.rgb,acc.rgb,temporalReprojectMix);outputColor.a=acc.a;undoColorTransform(outputColor.rgb);}void reproject(inout vec4 inp,inout vec4 acc,sampler2D accumulatedTexture,inout bool wasSampled,bool doNeighborhoodClamp,bool doReprojectSpecular){vec3 uvc=doReprojectSpecular ? reprojectedUvSpecular : reprojectedUvDiffuse;vec2 uv=uvc.xy;acc=sampleReprojectedTexture(accumulatedTexture,uv);transformColor(acc.rgb);if(!wasSampled){inp.rgb=acc.rgb;return;}acc.a++;vec3 clampedColor=acc.rgb;int clampRadius=doReprojectSpecular&&roughness<0.25 ? 1 : 2;clampNeighborhood(inputTexture,clampedColor,inp.rgb,clampRadius,doReprojectSpecular);float r=doReprojectSpecular ? roughness : 1.0;float clampAggressiveness=min(1.,uvc.z*r);float clampIntensity=mix(0.,min(1.,moveFactor*50.+neighborhoodClampIntensity),clampAggressiveness);vec3 newColor=mix(acc.rgb,clampedColor,clampIntensity);float colorDiff=min(length(newColor-acc.rgb),1.);acc.a*=1.-colorDiff;acc.rgb=newColor;}void preprocessInput(inout highp vec4 texel,inout bool sampledThisFrame){sampledThisFrame=texel.r>=0.;texel.rgb=max(texel.rgb,vec3(0.));transformColor(texel.rgb);}void getTexels(inout highp vec4 inputTexel[textureCount],inout bool sampledThisFrame[textureCount]){
#if inputType == DIFFUSE_SPECULAR
highp vec4 tex=textureLod(inputTexture,vUv,0.);unpackTwoVec4(tex,inputTexel[0],inputTexel[1]);preprocessInput(inputTexel[0],sampledThisFrame[0]);preprocessInput(inputTexel[1],sampledThisFrame[1]);
#else
inputTexel[0]=textureLod(inputTexture,vUv,0.0);preprocessInput(inputTexel[0],sampledThisFrame[0]);
#endif
}void computeGVariables(vec2 dilatedUv,float depth){worldPos=screenSpaceToWorldSpace(dilatedUv,depth,cameraMatrixWorld,projectionMatrixInverse);vec3 viewPos=(viewMatrix*vec4(worldPos,1.0)).xyz;viewDir=normalize(viewPos);vec3 viewNormal=(vec4(worldNormal,0.0)*viewMatrix).xyz;viewAngle=dot(-viewDir,viewNormal);}void computeReprojectedUv(float depth,vec3 worldPos,vec3 worldNormal){reprojectedUvDiffuse=getReprojectedUV(false,depth,worldPos,worldNormal);
#if inputType == DIFFUSE_SPECULAR || inputType == SPECULAR
reprojectedUvSpecular=getReprojectedUV(true,depth,worldPos,worldNormal);if(reprojectedUvSpecular.x==-1.0){reprojectedUvSpecular=reprojectedUvDiffuse;}
#endif
}void getRoughnessRayLength(inout highp vec4 inputTexel[textureCount]){
#if inputType == DIFFUSE_SPECULAR
rayLength=inputTexel[1].a;roughness=clamp(inputTexel[0].a,0.,1.);
#elif inputType == SPECULAR
vec2 data=unpackHalf2x16(floatBitsToUint(inputTexel[0].a));rayLength=data.r;roughness=clamp(data.g,0.,1.);
#endif
}void main(){vec2 dilatedUv=vUv;getVelocityNormalDepth(dilatedUv,velocity,worldNormal,depth);highp vec4 inputTexel[textureCount],accumulatedTexel[textureCount];bool textureSampledThisFrame[textureCount];getTexels(inputTexel,textureSampledThisFrame);
#if inputType != DIFFUSE
if(depth==1.0&&fwidth(depth)==0.0){discard;return;}
#endif
curvature=getCurvature(worldNormal);computeGVariables(dilatedUv,depth);getRoughnessRayLength(inputTexel);computeReprojectedUv(depth,worldPos,worldNormal);moveFactor=min(dot(velocity,velocity)*10000.,1.);
#pragma unroll_loop_start
for(int i=0;i<textureCount;i++){reproject(inputTexel[i],accumulatedTexel[i],accumulatedTexture[i],textureSampledThisFrame[i],neighborhoodClamp[i],reprojectSpecular[i]);accumulate(gOutput[i],inputTexel[i],accumulatedTexel[i],roughness,moveFactor,reprojectSpecular[i]);}
#pragma unroll_loop_end
}`,YT=`#define GLSLIFY 1
vec2 dilatedUv,velocity;vec3 worldNormal,worldPos,viewDir;float depth,curvature,viewAngle,rayLength,angleMix;float roughness=1.;float moveFactor=0.;
#define luminance(a) dot(vec3(0.2125, 0.7154, 0.0721), a)
float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 screenSpaceToWorldSpace(const vec2 uv,const float depth,mat4 curMatrixWorld,const mat4 projMatrixInverse){vec4 ndc=vec4((uv.x-0.5)*2.0,(uv.y-0.5)*2.0,(depth-0.5)*2.0,1.0);vec4 clip=projMatrixInverse*ndc;vec4 view=curMatrixWorld*(clip/clip.w);return view.xyz;}vec2 viewSpaceToScreenSpace(const vec3 position,const mat4 projMatrix){vec4 projectedCoord=projMatrix*vec4(position,1.0);projectedCoord.xy/=projectedCoord.w;projectedCoord.xy=projectedCoord.xy*0.5+0.5;return projectedCoord.xy;}
#ifdef logTransform
void transformColor(inout vec3 color){color=log(color+1.);}void undoColorTransform(inout vec3 color){color=exp(color)-1.;}
#else
#define transformColor
#define undoColorTransform
#endif
void getNeighborhoodAABB(const sampler2D tex,const int clampRadius,inout vec3 minNeighborColor,inout vec3 maxNeighborColor,const bool isSpecular){for(int x=-clampRadius;x<=clampRadius;x++){for(int y=-clampRadius;y<=clampRadius;y++){vec2 offset=vec2(x,y)*invTexSize;vec2 neighborUv=vUv+offset;
#if inputType == DIFFUSE_SPECULAR
vec4 t1,t2;vec4 packedNeighborTexel=textureLod(inputTexture,neighborUv,0.0);unpackTwoVec4(packedNeighborTexel,t1,t2);vec4 neighborTexel=isSpecular ? t2 : t1;
#else
vec4 neighborTexel=textureLod(inputTexture,neighborUv,0.0);
#endif
if(neighborTexel.r>=0.){minNeighborColor=min(neighborTexel.rgb,minNeighborColor);maxNeighborColor=max(neighborTexel.rgb,maxNeighborColor);}}}}void clampNeighborhood(const sampler2D tex,inout vec3 color,vec3 inputColor,const int clampRadius,const bool isSpecular){undoColorTransform(inputColor);vec3 minNeighborColor=inputColor;vec3 maxNeighborColor=inputColor;getNeighborhoodAABB(tex,clampRadius,minNeighborColor,maxNeighborColor,isSpecular);transformColor(minNeighborColor);transformColor(maxNeighborColor);color=clamp(color,minNeighborColor,maxNeighborColor);}void getVelocityNormalDepth(inout vec2 dilatedUv,out vec2 vel,out vec3 normal,out float depth){vec2 centerUv=dilatedUv;vec4 velocityTexel=textureLod(velocityTexture,centerUv,0.0);vel=velocityTexel.rg;normal=unpackNormal(velocityTexel.b);depth=velocityTexel.a;}
#define PLANE_DISTANCE 20.
#define WORLD_DISTANCE 20.
#define NORMAL_DISTANCE 15.
float planeDistanceDisocclusionCheck(const vec3 worldPos,const vec3 lastWorldPos,const vec3 worldNormal,const float distFactor){vec3 toCurrent=worldPos-lastWorldPos;float distToPlane=abs(dot(toCurrent,worldNormal));return distToPlane/PLANE_DISTANCE*distFactor;}float worldDistanceDisocclusionCheck(const vec3 worldPos,const vec3 lastWorldPos,const float distFactor){return length(worldPos-lastWorldPos)/WORLD_DISTANCE*distFactor;}float normalDisocclusionCheck(const vec3 worldNormal,const vec3 lastWorldNormal,const float distFactor){return min(1.-dot(worldNormal,lastWorldNormal),1.)/NORMAL_DISTANCE*distFactor;}float validateReprojectedUV(const vec2 reprojectedUv,const vec3 worldPos,const vec3 worldNormal,const bool isHitPoint){if(reprojectedUv.x>1.0||reprojectedUv.x<0.0||reprojectedUv.y>1.0||reprojectedUv.y<0.0)return 0.;vec2 dilatedReprojectedUv=reprojectedUv;vec2 lastVelocity=vec2(0.0);vec3 lastWorldNormal=vec3(0.0);float lastDepth=0.0;getVelocityNormalDepth(dilatedReprojectedUv,lastVelocity,lastWorldNormal,lastDepth);vec3 lastWorldPos=screenSpaceToWorldSpace(dilatedReprojectedUv,lastDepth,prevCameraMatrixWorld,prevProjectionMatrixInverse);vec3 lastViewPos=(prevViewMatrix*vec4(lastWorldPos,1.0)).xyz;vec3 lastViewDir=normalize(lastViewPos);vec3 lastViewNormal=(vec4(lastWorldNormal,0.0)*prevViewMatrix).xyz;float lastViewAngle=dot(-lastViewDir,lastViewNormal);angleMix=abs(lastViewAngle-viewAngle);float viewZ=abs(getViewZ(depth));float distFactor=1.+1./(viewZ+1.0);float disoccl=0.;disoccl+=worldDistanceDisocclusionCheck(worldPos,lastWorldPos,distFactor);disoccl+=planeDistanceDisocclusionCheck(worldPos,lastWorldPos,worldNormal,distFactor);float confidence=1.-min(disoccl,1.);confidence=max(confidence,0.);confidence=pow(confidence,confidencePower);return confidence;}vec2 reprojectHitPoint(const vec3 rayOrig,const float rayLength){if(curvature>0.05||rayLength<0.01){return vec2(-1.);}vec3 cameraRay=normalize(rayOrig-cameraPos);vec3 parallaxHitPoint=cameraPos+cameraRay*rayLength;vec4 reprojectedHitPoint=prevProjectionMatrix*prevViewMatrix*vec4(parallaxHitPoint,1.0);reprojectedHitPoint.xyz/=reprojectedHitPoint.w;reprojectedHitPoint.xy=reprojectedHitPoint.xy*0.5+0.5;vec2 diffuseUv=vUv-velocity.xy;float m=min(max(0.,roughness-0.25)/0.25,1.);return reprojectedHitPoint.xy;}vec3 getReprojectedUV(const bool doReprojectSpecular,const float depth,const vec3 worldPos,const vec3 worldNormal){if(doReprojectSpecular){vec2 reprojectedUv=reprojectHitPoint(worldPos,rayLength);float confidence=validateReprojectedUV(reprojectedUv,worldPos,worldNormal,true);return vec3(reprojectedUv,confidence);}else{vec2 reprojectedUv=vUv-velocity;float confidence=validateReprojectedUV(reprojectedUv,worldPos,worldNormal,false);return vec3(reprojectedUv,confidence);}}vec4 BiCubicCatmullRom5Tap(sampler2D tex,vec2 P){vec2 Weight[3];vec2 Sample[3];vec2 UV=P/invTexSize;vec2 tc=floor(UV-0.5)+0.5;vec2 f=UV-tc;vec2 f2=f*f;vec2 f3=f2*f;vec2 w0=f2-0.5*(f3+f);vec2 w1=1.5*f3-2.5*f2+vec2(1.);vec2 w3=0.5*(f3-f2);vec2 w2=vec2(1.)-w0-w1-w3;Weight[0]=w0;Weight[1]=w1+w2;Weight[2]=w3;Sample[0]=tc-vec2(1.);Sample[1]=tc+w2/Weight[1];Sample[2]=tc+vec2(2.);Sample[0]*=invTexSize;Sample[1]*=invTexSize;Sample[2]*=invTexSize;float sampleWeight[5];sampleWeight[0]=Weight[1].x*Weight[0].y;sampleWeight[1]=Weight[0].x*Weight[1].y;sampleWeight[2]=Weight[1].x*Weight[1].y;sampleWeight[3]=Weight[2].x*Weight[1].y;sampleWeight[4]=Weight[1].x*Weight[2].y;vec4 Ct=textureLod(tex,vec2(Sample[1].x,Sample[0].y),0.)*sampleWeight[0];vec4 Cl=textureLod(tex,vec2(Sample[0].x,Sample[1].y),0.)*sampleWeight[1];vec4 Cc=textureLod(tex,vec2(Sample[1].x,Sample[1].y),0.)*sampleWeight[2];vec4 Cr=textureLod(tex,vec2(Sample[2].x,Sample[1].y),0.)*sampleWeight[3];vec4 Cb=textureLod(tex,vec2(Sample[1].x,Sample[2].y),0.)*sampleWeight[4];float WeightMultiplier=1./(sampleWeight[0]+sampleWeight[1]+sampleWeight[2]+sampleWeight[3]+sampleWeight[4]);return max((Ct+Cl+Cc+Cr+Cb)*WeightMultiplier,vec4(0.));}vec4 sampleReprojectedTexture(const sampler2D tex,const vec2 reprojectedUv){vec4 catmull=BiCubicCatmullRom5Tap(tex,reprojectedUv);return catmull;}float getCurvature(vec3 n){float curvature=length(fwidth(n));return curvature;}`,zr=`#define GLSLIFY 1
uniform highp sampler2D gBufferTexture;struct Material{highp vec4 diffuse;highp vec3 normal;highp float roughness;highp float metalness;highp vec3 emissive;};
#define ONE_SAFE 0.999999
#define NON_ZERO_OFFSET 0.0001
const highp float c_precision=256.0;const highp float c_precisionp1=c_precision+1.0;highp float color2float(in highp vec3 color){color=min(color+NON_ZERO_OFFSET,vec3(ONE_SAFE));return floor(color.r*c_precision+0.5)+floor(color.b*c_precision+0.5)*c_precisionp1+floor(color.g*c_precision+0.5)*c_precisionp1*c_precisionp1;}highp vec3 float2color(in highp float value){highp vec3 color;color.r=mod(value,c_precisionp1)/c_precision;color.b=mod(floor(value/c_precisionp1),c_precisionp1)/c_precision;color.g=floor(value/(c_precisionp1*c_precisionp1))/c_precision;color-=NON_ZERO_OFFSET;color=max(color,vec3(0.0));return color;}highp vec2 OctWrap(highp vec2 v){highp vec2 w=1.0-abs(v.yx);if(v.x<0.0)w.x=-w.x;if(v.y<0.0)w.y=-w.y;return w;}highp vec2 encodeOctWrap(highp vec3 n){n/=(abs(n.x)+abs(n.y)+abs(n.z));n.xy=n.z>0.0 ? n.xy : OctWrap(n.xy);n.xy=n.xy*0.5+0.5;return n.xy;}highp vec3 decodeOctWrap(highp vec2 f){f=f*2.0-1.0;highp vec3 n=vec3(f.x,f.y,1.0-abs(f.x)-abs(f.y));highp float t=max(-n.z,0.0);n.x+=n.x>=0.0 ?-t : t;n.y+=n.y>=0.0 ?-t : t;return normalize(n);}highp float packNormal(highp vec3 normal){return uintBitsToFloat(packUnorm2x16(encodeOctWrap(normal)));}highp vec3 unpackNormal(highp float packedNormal){return decodeOctWrap(unpackUnorm2x16(floatBitsToUint(packedNormal)));}highp vec4 packTwoVec4(highp vec4 v1,highp vec4 v2){highp vec4 encoded=vec4(0.0);v1+=NON_ZERO_OFFSET;v2+=NON_ZERO_OFFSET;highp uint v1r=packHalf2x16(v1.rg);highp uint v1g=packHalf2x16(v1.ba);highp uint v2r=packHalf2x16(v2.rg);highp uint v2g=packHalf2x16(v2.ba);encoded.r=uintBitsToFloat(v1r);encoded.g=uintBitsToFloat(v1g);encoded.b=uintBitsToFloat(v2r);encoded.a=uintBitsToFloat(v2g);return encoded;}void unpackTwoVec4(highp vec4 encoded,out highp vec4 v1,out highp vec4 v2){highp uint r=floatBitsToUint(encoded.r);highp uint g=floatBitsToUint(encoded.g);highp uint b=floatBitsToUint(encoded.b);highp uint a=floatBitsToUint(encoded.a);v1.rg=unpackHalf2x16(r);v1.ba=unpackHalf2x16(g);v2.rg=unpackHalf2x16(b);v2.ba=unpackHalf2x16(a);v1-=NON_ZERO_OFFSET;v2-=NON_ZERO_OFFSET;v1=max(v1,vec4(0.0));v2=max(v2,vec4(0.0));}vec4 unpackTwoVec4(highp vec4 encoded,const int index){highp uint r=floatBitsToUint(index==0 ? encoded.r : encoded.b);highp uint g=floatBitsToUint(index==0 ? encoded.g : encoded.a);vec4 v;v.rg=unpackHalf2x16(r);v.ba=unpackHalf2x16(g);v-=NON_ZERO_OFFSET;v=max(v,vec4(0.0));return v;}highp float packVec2(highp vec2 value){value=min(value+NON_ZERO_OFFSET,vec2(ONE_SAFE));return uintBitsToFloat(packUnorm2x16(value));}highp vec2 unpackVec2(highp float packedValue){vec2 v=unpackUnorm2x16(floatBitsToUint(packedValue));v=max(v-NON_ZERO_OFFSET,vec2(0.0));return v;}highp vec4 encodeRGBE8(highp vec3 rgb){highp vec4 vEncoded;highp float maxComponent=max(max(rgb.r,rgb.g),rgb.b);highp float fExp=ceil(log2(maxComponent));vEncoded.rgb=rgb/exp2(fExp);vEncoded.a=(fExp+128.0)/255.0;return vEncoded;}highp vec3 decodeRGBE8(highp vec4 rgbe){highp vec3 vDecoded;highp float fExp=rgbe.a*255.0-128.0;vDecoded=rgbe.rgb*exp2(fExp);return vDecoded;}highp float vec4ToFloat(highp vec4 vec){highp uvec4 v=uvec4(vec*255.0);highp uint value=(v.a<<24u)|(v.b<<16u)|(v.g<<8u)|(v.r);return uintBitsToFloat(value);}highp vec4 floatToVec4(highp float f){highp uint value=floatBitsToUint(f);highp vec4 v;v.r=float(value&0xFFu)/255.0;v.g=float((value>>8u)&0xFFu)/255.0;v.b=float((value>>16u)&0xFFu)/255.0;v.a=float((value>>24u)&0xFFu)/255.0;return v;}highp vec4 packGBuffer(highp vec4 diffuse,highp vec3 normal,highp float roughness,highp float metalness,highp vec3 emissive){highp vec4 gBuffer;gBuffer.r=vec4ToFloat(diffuse);gBuffer.g=packNormal(normal);gBuffer.b=packVec2(vec2(roughness,metalness));gBuffer.a=vec4ToFloat(encodeRGBE8(emissive));return gBuffer;}Material getMaterial(highp sampler2D gBufferTexture,highp vec2 uv){highp vec4 gBuffer=textureLod(gBufferTexture,uv,0.0);highp vec4 diffuse=floatToVec4(gBuffer.r);highp vec3 normal=unpackNormal(gBuffer.g);highp vec2 roughnessMetalness=unpackVec2(gBuffer.b);highp float roughness=roughnessMetalness.r;highp float metalness=roughnessMetalness.g;highp vec3 emissive=decodeRGBE8(floatToVec4(gBuffer.a));return Material(diffuse,normal,roughness,metalness,emissive);}Material getMaterial(highp vec2 uv){return getMaterial(gBufferTexture,uv);}highp vec3 getNormal(highp sampler2D gBufferTexture,highp vec2 uv){return unpackNormal(textureLod(gBufferTexture,uv,0.0).g);}`;const QT=e=>{const{width:t,height:n}=e.image;return Math.floor(Math.log2(Math.max(t,n)))+1},JT=()=>{if(me.envmap_physical_pars_fragment.includes("iblRadianceDisabled")||(me.envmap_physical_pars_fragment=me.envmap_physical_pars_fragment.replace("vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {",`
		uniform bool iblRadianceDisabled;
	
		vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		 if(iblRadianceDisabled) return vec3(0.);
		`)),"iblRadianceDisabled"in jl.physical.uniforms)return jl.physical.uniforms.iblRadianceDisabled;const e={value:!1};jl.physical.uniforms.iblRadianceDisabled=e;const{clone:t}=Gu;return Gu.clone=n=>{const o=t(n);return"iblRadianceDisabled"in n&&(o.iblRadianceDisabled=e),o},e},$T=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function oy(e){return e.replace($T,eE)}function eE(e,t,n,o){let i="";for(let r=parseInt(t);r<parseInt(n);r++)i+=o.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return i}class tE extends Vi{constructor(t=1){let n=KT.replace("#include <reproject>",YT).replace("#include <gbuffer_packing>",zr),o="";for(let s=0;s<t;s++)o+=`
				uniform sampler2D accumulatedTexture${s};

				layout(location = ${s}) out vec4 gOutput${s};
			`;n=o+n.replaceAll("textureCount",t),n=oy(n);const i=n.matchAll(/accumulatedTexture\[\s*[0-9]+\s*]/g);for(const[s]of i){const a=s.replace(/[^0-9]/g,"");n=n.replace(s,"accumulatedTexture"+a)}const r=n.matchAll(/gOutput\[\s*[0-9]+\s*]/g);for(const[s]of r){const a=s.replace(/[^0-9]/g,"");n=n.replace(s,"gOutput"+a)}super({type:"TemporalReprojectMaterial",uniforms:{inputTexture:new j(null),velocityTexture:new j(null),depthTexture:new j(null),lastVelocityTexture:new j(null),neighborhoodClampIntensity:new j(0),fullAccumulate:new j(!1),keepData:new j(1),delta:new j(0),invTexSize:new j(new Me),projectionMatrix:new j(new ne),projectionMatrixInverse:new j(new ne),cameraMatrixWorld:new j(new ne),viewMatrix:new j(new ne),prevViewMatrix:new j(new ne),prevCameraMatrixWorld:new j(new ne),prevProjectionMatrix:new j(new ne),prevProjectionMatrixInverse:new j(new ne),cameraPos:new j(new P),prevCameraPos:new j(new P),cameraNear:new j(0),cameraFar:new j(0),maxBlend:new j(0)},vertexShader:Ur,fragmentShader:n,blending:Xs,depthWrite:!1,depthTest:!1,toneMapped:!1,glslVersion:j1});for(let s=0;s<t;s++)this.uniforms["inputTexture"+s]=new j(null),this.uniforms["accumulatedTexture"+s]=new j(null)}}const nE=e=>{var t;return(t=e.material.fragmentShader)==null?void 0:t.includes("float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );")},ah=(e,t=e.material)=>t.visible&&t.depthWrite&&t.depthTest&&(!t.transparent||t.opacity>0)&&!nE(e),iy=(e,t,n)=>e.position.distanceToSquared(t)>1e-6||e.quaternion.angleTo(n)>.001,ry=e=>{const t=[e],n=[];for(;t.length!==0;){const o=t.shift();o.material&&n.push(o);for(const i of o.children)i.visible&&t.push(i)}return n},Os={dilation:!1,fullAccumulate:!1,neighborhoodClamp:!1,neighborhoodClampRadius:1,neighborhoodClampIntensity:1,maxBlend:1,logTransform:!1,depthDistance:2,worldDistance:4,reprojectSpecular:!1,renderTarget:null,copyTextures:!0,confidencePower:1,inputType:"diffuse"},qm=new ne,Wm=new ne,oE=new Me;class sy extends di{constructor(t,n,o,i,r,s=Os){var a;super("TemporalReprojectPass"),this.needsSwap=!1,this.overrideAccumulatedTextures=[],this.clock=new P4,this.r2Sequence=[],this.frame=0,this.lastCameraTransform={position:new P,quaternion:new re},this._scene=t,this._camera=n,this.textureCount=r,s={...Os,...s},this.renderTarget=new Xu(1,1,r,{minFilter:Oe,magFilter:Oe,type:i.type,depthBuffer:!1}),this.renderTarget.texture.forEach((c,l)=>c.name="TemporalReprojectPass.accumulatedTexture"+l),this.fullscreenMaterial=new tE(r),this.fullscreenMaterial.defines.textureCount=r,s.dilation&&(this.fullscreenMaterial.defines.dilation=""),s.neighborhoodClamp&&(this.fullscreenMaterial.defines.neighborhoodClamp=""),s.logTransform&&(this.fullscreenMaterial.defines.logTransform=""),n.isPerspectiveCamera&&(this.fullscreenMaterial.defines.PERSPECTIVE_CAMERA=""),this.fullscreenMaterial.defines.neighborhoodClampRadius=parseInt(s.neighborhoodClampRadius),this.fullscreenMaterial.defines.depthDistance=s.depthDistance.toPrecision(5),this.fullscreenMaterial.defines.worldDistance=s.worldDistance.toPrecision(5),this.fullscreenMaterial.uniforms.fullAccumulate.value=s.fullAccumulate,this.fullscreenMaterial.uniforms.neighborhoodClampIntensity.value=s.neighborhoodClampIntensity,this.fullscreenMaterial.uniforms.maxBlend.value=s.maxBlend,this.fullscreenMaterial.uniforms.projectionMatrix.value=n.projectionMatrix.clone(),this.fullscreenMaterial.uniforms.projectionMatrixInverse.value=n.projectionMatrixInverse.clone(),this.fullscreenMaterial.uniforms.cameraMatrixWorld.value=n.matrixWorld,this.fullscreenMaterial.uniforms.viewMatrix.value=n.matrixWorldInverse,this.fullscreenMaterial.uniforms.cameraPos.value=n.position,this.fullscreenMaterial.uniforms.prevViewMatrix.value=n.matrixWorldInverse.clone(),this.fullscreenMaterial.uniforms.prevCameraMatrixWorld.value=n.matrixWorld.clone(),this.fullscreenMaterial.uniforms.prevProjectionMatrix.value=n.projectionMatrix.clone(),this.fullscreenMaterial.uniforms.prevProjectionMatrixInverse.value=n.projectionMatrixInverse.clone(),this.fullscreenMaterial.uniforms.velocityTexture.value=o.renderTarget.texture,this.fullscreenMaterial.uniforms.depthTexture.value=o.depthTexture,this.fullscreenMaterial.defines.inputType=(a=["diffuseSpecular","diffuse","specular"].indexOf(s.inputType))!==null&&a!==void 0?a:1;for(const c of["reprojectSpecular","neighborhoodClamp"]){let l=s[c];typeof l!="array"&&(l=Array(r).fill(l)),this.fullscreenMaterial.defines[c]=`bool[](${l.join(", ")})`}this.fullscreenMaterial.defines.confidencePower=s.confidencePower.toPrecision(5),this.options=s,this.velocityDepthNormalPass=o,this.fullscreenMaterial.uniforms.inputTexture.value=i}dispose(){super.dispose(),this.renderTarget.dispose(),this.fullscreenMaterial.dispose()}setSize(t,n){var o;this.renderTarget.setSize(t,n),this.fullscreenMaterial.uniforms.invTexSize.value.set(1/t,1/n),(o=this.framebufferTexture)==null||o.dispose();const i=this.fullscreenMaterial.uniforms.inputTexture.value;this.framebufferTexture=new B1(t,n,i.format),this.framebufferTexture.type=i.type,this.framebufferTexture.minFilter=Wu,this.framebufferTexture.magFilter=Wu,this.framebufferTexture.needsUpdate=!0;for(let s=0;s<this.textureCount;s++){var r;const a=(r=this.overrideAccumulatedTextures[s])!==null&&r!==void 0?r:this.framebufferTexture;this.fullscreenMaterial.uniforms["accumulatedTexture"+s].value=a}}get texture(){return this.renderTarget.texture[0]}reset(){this.fullscreenMaterial.uniforms.keepData.value=0}render(t){this.frame=(this.frame+1)%4096;const n=Math.min(1/10,this.clock.getDelta());this.fullscreenMaterial.uniforms.delta.value=n,qm.copy(this._camera.projectionMatrix),Wm.copy(this._camera.projectionMatrixInverse),this._camera.view&&(this._camera.view.enabled=!1),this._camera.updateProjectionMatrix(),this.fullscreenMaterial.uniforms.projectionMatrix.value.copy(this._camera.projectionMatrix),this.fullscreenMaterial.uniforms.projectionMatrixInverse.value.copy(this._camera.projectionMatrixInverse),this.fullscreenMaterial.uniforms.lastVelocityTexture.value=this.velocityDepthNormalPass.lastVelocityTexture,this.fullscreenMaterial.uniforms.fullAccumulate.value=this.options.fullAccumulate&&!iy(this._camera,this.lastCameraTransform.position,this.lastCameraTransform.quaternion),this.lastCameraTransform.position.copy(this._camera.position),this.lastCameraTransform.quaternion.copy(this._camera.quaternion),this._camera.view&&(this._camera.view.enabled=!0),this._camera.projectionMatrix.copy(qm),this._camera.projectionMatrixInverse.copy(Wm),this.fullscreenMaterial.uniforms.cameraNear.value=this._camera.near,this.fullscreenMaterial.uniforms.cameraFar.value=this._camera.far,t.setRenderTarget(this.renderTarget),t.render(this.scene,this.camera),this.fullscreenMaterial.uniforms.keepData.value=1,this.overrideAccumulatedTextures.length===0&&(this.framebufferTexture.needsUpdate=!0,t.copyFramebufferToTexture(oE,this.framebufferTexture)),this.fullscreenMaterial.uniforms.prevCameraMatrixWorld.value.copy(this._camera.matrixWorld),this.fullscreenMaterial.uniforms.prevViewMatrix.value.copy(this._camera.matrixWorldInverse),this.fullscreenMaterial.uniforms.prevProjectionMatrix.value.copy(this.fullscreenMaterial.uniforms.projectionMatrix.value),this.fullscreenMaterial.uniforms.prevProjectionMatrixInverse.value.copy(this.fullscreenMaterial.uniforms.projectionMatrixInverse.value),this.fullscreenMaterial.uniforms.prevCameraPos.value.copy(this._camera.position)}jitter(t=1){this.unjitter(),ZT(this.renderTarget.width,this.renderTarget.height,this._camera,this.frame,t)}unjitter(){this._camera.clearViewOffset&&this._camera.clearViewOffset()}}var iE=`#define GLSLIFY 1
uniform sampler2D accumulatedTexture;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 accumulatedTexel=textureLod(accumulatedTexture,uv,0.);outputColor=vec4(accumulatedTexel.rgb,1.);}`;class ch extends Ws{constructor(t,n,o,i=Os){super("TRAAEffect",iE,{type:"FinalTRAAEffectMaterial",uniforms:new Map([["accumulatedTexture",new j(null)]])}),this._scene=t,this._camera=n,this.velocityDepthNormalPass=o,i={...i,maxBlend:.9,neighborhoodClamp:!0,neighborhoodClampIntensity:1,neighborhoodClampRadius:1,logTransform:!0,confidencePower:4},this.options={...Os,...i},this.setSize(i.width,i.height)}setSize(t,n){var o;(o=this.temporalReprojectPass)==null||o.setSize(t,n)}dispose(){super.dispose(),this.temporalReprojectPass.dispose()}reset(){this.temporalReprojectPass.reset()}update(t,n){this.temporalReprojectPass||(this.temporalReprojectPass=new sy(this._scene,this._camera,this.velocityDepthNormalPass,n.texture,1,this.options),this.temporalReprojectPass.setSize(n.width,n.height),this.uniforms.get("accumulatedTexture").value=this.temporalReprojectPass.texture),this.temporalReprojectPass.unjitter(),this.unjitteredProjectionMatrix=this._camera.projectionMatrix.clone(),this._camera.projectionMatrix.copy(this.unjitteredProjectionMatrix),this.temporalReprojectPass.jitter(),this.temporalReprojectPass.render(t)}}ch.DefaultOptions=Os;class rE extends di{constructor(){super("CubeToEquirectEnvPass"),this.renderTarget=new ki(1,1,{depthBuffer:!1,type:bt}),this.fullscreenMaterial=new Vi({fragmentShader:`
            varying vec2 vUv;
			uniform samplerCube cubeMap;

			#define M_PI 3.1415926535897932384626433832795
			
			// source: https://github.com/spite/CubemapToEquirectangular/blob/master/src/CubemapToEquirectangular.js
            void main() {
				float longitude = vUv.x * 2. * M_PI - M_PI + M_PI / 2.;
				float latitude = vUv.y * M_PI;

				vec3 dir = vec3(
					- sin( longitude ) * sin( latitude ),
					cos( latitude ),
					- cos( longitude ) * sin( latitude )
				);

				dir.y = -dir.y;

				gl_FragColor = textureCube( cubeMap, dir );
            }
            `,vertexShader:Ur,uniforms:{cubeMap:{value:null}},blending:Xs,depthWrite:!1,depthTest:!1,toneMapped:!1})}dispose(){this.renderTarget.dispose()}generateEquirectEnvMap(t,n,o=null,i=null,r=4096){if(o===null&&i===null){const l=n.source.data[0].width,u=2**Math.ceil(Math.log2(2*l*3**.5)),d=2**Math.ceil(Math.log2(l*3**.5));o=u,i=d}o>r&&(o=r,i=r/2),this.renderTarget.setSize(o,i),this.fullscreenMaterial.uniforms.cubeMap.value=n;const{renderTarget:s}=this;t.setRenderTarget(s),t.render(this.scene,this.camera);const a=new Float32Array(o*i*4);t.readRenderTargetPixels(s,0,0,o,i,a);const c=new vs(a,o,i,Jc,bt);return c.wrapS=rp,c.wrapT=rp,c.minFilter=qu,c.magFilter=qu,c.needsUpdate=!0,c.mapping=N4,c}}var sE="data:image/png;base64,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",ay=sE,aE=`#define GLSLIFY 1
uniform sampler2D blueNoiseTexture;uniform vec2 blueNoiseSize;uniform int blueNoiseIndex;uvec4 s1;ivec2 pixel;void rng_initialize(vec2 p,int index){pixel=ivec2(p);s1=uvec4(index,index*15843,index*31+4566,index*2345+58585);}void pcg4d(inout uvec4 v){v=v*1664525u+1013904223u;v.x+=v.y*v.w;v.y+=v.z*v.x;v.z+=v.x*v.y;v.w+=v.y*v.z;v=v ^(v>>16u);v.x+=v.y*v.w;v.y+=v.z*v.x;v.z+=v.x*v.y;v.w+=v.y*v.z;}ivec2 shift2(ivec2 size){pcg4d(s1);return(pixel+ivec2(s1.xy % 0x0fffffffu))% size;}vec4 blueNoise(vec2 uv,int index){if(index==0)return textureLod(blueNoiseTexture,uv*resolution/blueNoiseSize,0.0);rng_initialize(vUv*resolution,index);vec4 blueNoise=texelFetch(blueNoiseTexture,shift2(ivec2(blueNoiseSize)),0);return blueNoise;}vec4 blueNoise(){return blueNoise(vUv,int(blueNoiseIndex));}vec4 blueNoise(vec2 uv){return blueNoise(uv,int(blueNoiseIndex));}`;const Gm=128,Xm=2147483647,nr=new V1().load(ay,()=>{nr.minFilter=Oe,nr.magFilter=Oe,nr.wrapS=hr,nr.wrapT=hr,nr.colorSpace=U1}),lh=e=>{let t=0;const n=Math.floor(Math.random()*Xm),o={blueNoiseTexture:{value:nr},blueNoiseSize:{value:new Me(Gm,Gm)},blueNoiseIndex:{get value(){return t=(n+t+1)%Xm,t},set value(i){t=i}}};return e=e.replace("uniform vec2 resolution;",`uniform vec2 resolution;
`+aE),{uniforms:o,fragmentShader:e}},cy=e=>{const{fragmentShader:t,uniforms:n}=lh(e.fragmentShader);e.fragmentShader=t,e.uniforms={...e.uniforms,...n},e.needsUpdate=!0};class cE extends A4{onBeforeCompile(t){this.uniforms=t.uniforms,t.uniforms.resolution={value:new Me(1,1)},t.uniforms.cameraNotMovedFrames={value:0},t.vertexShader=t.vertexShader.replace(/#include <lights_.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <lights_.*>/g,""),t.vertexShader=t.vertexShader.replace(/#include <alpha.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <alpha.*>/g,""),t.vertexShader=t.vertexShader.replace(/#include <aomap.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <aomap.*>/g,""),t.vertexShader=t.vertexShader.replace(/#include <lightmap.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <lightmap.*>/g,""),t.vertexShader=t.vertexShader.replace(/#include <alphahash.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <alphahash.*>/g,""),t.vertexShader=t.vertexShader.replace(/#include <alphatest.*>/g,""),t.fragmentShader=t.fragmentShader.replace(/#include <alphatest.*>/g,""),t.fragmentShader=t.fragmentShader.replace("#include <opaque_fragment>",""),t.fragmentShader=t.fragmentShader.replace("#include <colorspace_fragment>",""),t.fragmentShader=t.fragmentShader.replace("#include <fog_fragment>",""),t.fragmentShader=t.fragmentShader.replace("void main() {",`
			#define vUv gl_FragCoord.xy
            uniform vec2 resolution;
            uniform float cameraNotMovedFrames;

            ${zr}

            void main() {
					float a = opacity;

					#ifdef USE_ALPHAMAP
						a *= texture2D( alphaMap, vAlphaMapUv ).g;
					#endif

					if (cameraNotMovedFrames == 0.) {
						if(a < 0.5) {
							discard;
							return;
						}

						a = 1.;
					} else if (a != 1.) {
						float aStep = a > 0.5 ? 1. : 0.;
						a = mix(a, aStep, (1. / (cameraNotMovedFrames * 0.1 + 1.)));

						vec4 noise = blueNoise();
						if (noise.x > a) {
							discard;
							return;
						}
					}
        `).replace("#include <dithering_fragment>",`
            #include <dithering_fragment>

            vec3 worldNormal = normalize((vec4(normal, 1.) * viewMatrix).xyz);

            vec4 gBuffer = packGBuffer(diffuseColor, worldNormal, roughnessFactor, metalnessFactor, totalEmissiveRadiance);

            gl_FragColor = gBuffer;`);const{uniforms:n,fragmentShader:o}=lh(t.fragmentShader);t.uniforms={...t.uniforms,...n},t.fragmentShader=o}}const Cc=new cE;function lE(e){const t=Cc.clone();return uE(e,t),t}let Lc=Object.keys(Cc);Lc=Lc.filter(e=>!e.startsWith("_")&&!e.startsWith("is")&&e!=="uuid"&&e!=="type"&&e!=="transparent");function uE(e,t){for(const n of Lc)e[n]!==void 0&&(t[n]=e[n])}const fE=Lc.filter(e=>typeof Cc[e]=="string"||typeof Cc[e]=="number");function dE(e,t){for(const n of fE)t[n]=e[n]}const hE=new vt(0);class ly extends di{constructor(t,n){super("GBufferPass"),this.frame=21483,this.cachedMaterials=new WeakMap,this.visibleMeshes=[],this.lastCameraPosition=new P,this.lastCameraQuaternion=new re,this._scene=t,this._camera=n,this.initGBufferRenderTarget()}get texture(){return this.renderTarget.texture}get depthTexture(){return this.renderTarget.depthTexture}initGBufferRenderTarget(){this.renderTarget=new ki(1,1,{type:bt,minFilter:Oe,magFilter:Oe,depthBuffer:!0}),this.renderTarget.texture.name="GBufferPass.Texture",this.renderTarget.depthTexture=new z1(1,1),this.renderTarget.depthTexture.type=bt,this.renderTarget.depthTexture.name="GBufferPass.DepthTexture"}setSize(t,n){this.renderTarget.setSize(t,n)}dispose(){super.dispose(),this.renderTarget.dispose()}setGBufferMaterialInScene(){this.visibleMeshes=ry(this._scene);const t=iy(this._camera,this.lastCameraPosition,this.lastCameraQuaternion);for(const n of this.visibleMeshes){const o=n.material;let[i,r]=this.cachedMaterials.get(n)||[];o!==i&&(r&&r.dispose(),r=lE(o),this.cachedMaterials.set(n,[o,r])),r.uniforms&&(r.uniforms.cameraNotMovedFrames.value=t?0:(r.uniforms.cameraNotMovedFrames.value+1)%65535),n.visible=ah(n,o),dE(o,r),n.material=r}}unsetGBufferMaterialInScene(){for(const t of this.visibleMeshes){const[n]=this.cachedMaterials.get(t);t.visible=!0,t.material=n}}render(t){this.frame=(this.frame+1)%4096;const{background:n}=this._scene;this._scene.background=hE,this.setGBufferMaterialInScene(),t.setRenderTarget(this.renderTarget),t.render(this._scene,this._camera),this.unsetGBufferMaterialInScene(),this.lastCameraPosition.copy(this._camera.position),this.lastCameraQuaternion.copy(this._camera.quaternion),this._scene.background=n}}var pE=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D accumulatedTexture;uniform highp sampler2D depthTexture;uniform highp sampler2D velocityTexture;uniform sampler2D directLightTexture;uniform vec3 backgroundColor;uniform mat4 projectionMatrix;uniform mat4 projectionMatrixInverse;uniform mat4 cameraMatrixWorld;uniform float maxEnvMapMipLevel;uniform float rayDistance;uniform float thickness;uniform float envBlur;uniform vec2 resolution;uniform float cameraNear;uniform float cameraFar;uniform float nearMinusFar;uniform float nearMulFar;uniform float farMinusNear;struct EquirectHdrInfo{sampler2D marginalWeights;sampler2D conditionalWeights;sampler2D map;vec2 size;float totalSumWhole;float totalSumDecimal;};uniform EquirectHdrInfo envMapInfo;
#define INVALID_RAY_COORDS vec2(-1.0);
#define EPSILON 0.00001
#define ONE_MINUS_EPSILON 1.0 - EPSILON
vec2 invTexSize;
#define MODE_SSGI 0
#define MODE_SSR 1
#include <packing>
#include <gbuffer_packing>
#include <ssgi_utils>
vec2 RayMarch(inout vec3 dir,inout vec3 hitPos,vec4 random);vec2 BinarySearch(inout vec3 dir,inout vec3 hitPos);struct RayTracingInfo{float NoV;float NoL;float NoH;float LoH;float VoH;bool isDiffuseSample;bool isEnvSample;};struct RayTracingResult{vec3 gi;vec3 l;vec3 hitPos;bool isMissedRay;vec3 brdf;float pdf;};struct EnvMisSample{float pdf;float probability;bool isEnvSample;};vec3 worldNormal;vec3 doSample(const vec3 viewPos,const vec3 viewDir,const vec3 viewNormal,const vec3 worldPos,const float metalness,const float roughness,const bool isDiffuseSample,const bool isEnvSample,const float NoV,const float NoL,const float NoH,const float LoH,const float VoH,const vec4 random,inout vec3 l,inout vec3 hitPos,out bool isMissedRay,out vec3 brdf,out float pdf);void calculateAngles(inout vec3 h,inout vec3 l,inout vec3 v,inout vec3 n,inout float NoL,inout float NoH,inout float LoH,inout float VoH){h=normalize(v+l);NoL=clamp(dot(n,l),EPSILON,ONE_MINUS_EPSILON);NoH=clamp(dot(n,h),EPSILON,ONE_MINUS_EPSILON);LoH=clamp(dot(l,h),EPSILON,ONE_MINUS_EPSILON);VoH=clamp(dot(v,h),EPSILON,ONE_MINUS_EPSILON);}vec3 worldPos;Material mat;void main(){float unpackedDepth=textureLod(depthTexture,vUv,0.0).r;if(unpackedDepth==1.0){vec4 directLight=textureLod(directLightTexture,vUv,0.0);gl_FragColor=packTwoVec4(directLight,directLight);return;}mat=getMaterial(gBufferTexture,vUv);float roughnessSq=clamp(mat.roughness*mat.roughness,0.000001,1.0);invTexSize=1./resolution;float viewZ=getViewZ(unpackedDepth);vec3 viewPos=getViewPosition(viewZ);vec3 viewDir=normalize(viewPos);worldNormal=mat.normal;vec3 viewNormal=normalize((vec4(worldNormal,0.)*cameraMatrixWorld).xyz);worldPos=(cameraMatrixWorld*vec4(viewPos,1.)).xyz;vec3 n=viewNormal;vec3 v=-viewDir;float NoV=max(EPSILON,dot(n,v));vec3 V=(vec4(v,0.)*viewMatrix).xyz;vec3 N=worldNormal;vec4 random;vec3 H,l,h,F,T,B,envMisDir,gi;vec3 diffuseGI,specularGI,brdf,hitPos,specularHitPos;Onb(N,T,B);V=ToLocal(T,B,N,V);vec3 f0=mix(vec3(0.04),mat.diffuse.rgb,mat.metalness);float NoL,NoH,LoH,VoH,diffW,specW,invW,pdf,envPdf,diffuseSamples,specularSamples;bool isDiffuseSample,isEnvSample,isMissedRay;random=blueNoise();H=SampleGGXVNDF(V,roughnessSq,roughnessSq,random.r,random.g);if(H.z<0.0)H=-H;l=normalize(reflect(-V,H));l=ToWorld(T,B,N,l);l=(vec4(l,0.)*cameraMatrixWorld).xyz;l=normalize(l);calculateAngles(h,l,v,n,NoL,NoH,LoH,VoH);
#if mode == MODE_SSGI
F=F_Schlick(f0,VoH);diffW=(1.-mat.metalness)*luminance(mat.diffuse.rgb);specW=luminance(F);diffW=max(diffW,EPSILON);specW=max(specW,EPSILON);invW=1./(diffW+specW);diffW*=invW;isDiffuseSample=random.b<diffW;
#else
isDiffuseSample=false;
#endif
EnvMisSample ems;ems.pdf=1.;envMisDir=vec3(0.0);envPdf=1.;
#ifdef importanceSampling
ems.pdf=sampleEquirectProbability(envMapInfo,random.rg,envMisDir);envMisDir=normalize((vec4(envMisDir,0.)*cameraMatrixWorld).xyz);ems.probability=dot(envMisDir,viewNormal);ems.probability*=mat.roughness;ems.probability=min(ONE_MINUS_EPSILON,ems.probability);ems.isEnvSample=random.a<ems.probability;if(ems.isEnvSample){ems.pdf/=1.-ems.probability;l=envMisDir;calculateAngles(h,l,v,n,NoL,NoH,LoH,VoH);}else{ems.pdf=1.-ems.probability;}
#endif
vec3 diffuseRay=ems.isEnvSample ? envMisDir : cosineSampleHemisphere(viewNormal,random.rg);vec3 specularRay=ems.isEnvSample ? envMisDir : l;
#if mode == MODE_SSGI
if(isDiffuseSample){l=diffuseRay;calculateAngles(h,l,v,n,NoL,NoH,LoH,VoH);gi=doSample(viewPos,viewDir,viewNormal,worldPos,mat.metalness,roughnessSq,isDiffuseSample,ems.isEnvSample,NoV,NoL,NoH,LoH,VoH,random,l,hitPos,isMissedRay,brdf,pdf);gi*=brdf;if(ems.isEnvSample){gi*=misHeuristic(ems.pdf,pdf);}else{gi/=pdf;}gi/=ems.pdf;diffuseSamples++;diffuseGI=mix(diffuseGI,gi,1./diffuseSamples);}
#endif
l=specularRay;calculateAngles(h,l,v,n,NoL,NoH,LoH,VoH);gi=doSample(viewPos,viewDir,viewNormal,worldPos,mat.metalness,roughnessSq,isDiffuseSample,ems.isEnvSample,NoV,NoL,NoH,LoH,VoH,random,l,hitPos,isMissedRay,brdf,pdf);gi*=brdf;if(ems.isEnvSample){gi*=misHeuristic(ems.pdf,pdf);}else{gi/=pdf;}gi/=ems.pdf;specularHitPos=hitPos;specularSamples++;specularGI=mix(specularGI,gi,1./specularSamples);
#ifdef useDirectLight
vec3 directLight=textureLod(directLightTexture,vUv,0.).rgb;diffuseGI+=directLight;specularGI+=directLight;
#endif
highp vec4 gDiffuse,gSpecular;
#if mode == MODE_SSGI
if(diffuseSamples==0.0)diffuseGI=vec3(-1.0);gDiffuse=vec4(diffuseGI,mat.roughness);
#endif
highp float rayLength=0.0;vec4 hitPosWS;vec3 cameraPosWS=cameraMatrixWorld[3].xyz;isMissedRay=hitPos.x>10.0e8;if(!isMissedRay){hitPosWS=cameraMatrixWorld*vec4(specularHitPos,1.0);rayLength=distance(cameraPosWS,hitPosWS.xyz);}highp uint packedRoughnessRayLength=packHalf2x16(vec2(rayLength,mat.roughness));highp float a=uintBitsToFloat(packedRoughnessRayLength);
#if mode == MODE_SSGI
gSpecular=vec4(specularGI,rayLength);gl_FragColor=packTwoVec4(gDiffuse,gSpecular);
#else
gSpecular=vec4(specularGI,a);gl_FragColor=gSpecular;
#endif
}vec3 getEnvColor(vec3 l,vec3 worldPos,float roughness,bool isDiffuseSample,bool isEnvSample){vec3 envMapSample;
#ifdef USE_ENVMAP
vec3 reflectedWS=normalize((vec4(l,0.)*viewMatrix).xyz);
#ifdef BOX_PROJECTED_ENV_MAP
reflectedWS=parallaxCorrectNormal(reflectedWS.xyz,envMapSize,envMapPosition,worldPos);reflectedWS=normalize(reflectedWS.xyz);
#endif
float mip=envBlur*maxEnvMapMipLevel;if(!isDiffuseSample&&roughness<0.15)mip*=roughness/0.15;envMapSample=sampleEquirectEnvMapColor(reflectedWS,envMapInfo.map,mip);float maxEnvLum=isEnvSample ? 100.0 : 25.0;if(maxEnvLum!=0.0){float envLum=luminance(envMapSample);if(envLum>maxEnvLum){envMapSample*=maxEnvLum/envLum;}}return envMapSample;
#else
return vec3(0.0);
#endif
}float getSaturation(vec3 c){float maxComponent=max(max(c.r,c.g),c.b);float minComponent=min(min(c.r,c.g),c.b);float delta=maxComponent-minComponent;if(maxComponent==minComponent){return 0.0;}else{return delta/maxComponent;}}vec3 doSample(const vec3 viewPos,const vec3 viewDir,const vec3 viewNormal,const vec3 worldPos,const float metalness,const float roughness,const bool isDiffuseSample,const bool isEnvSample,const float NoV,const float NoL,const float NoH,const float LoH,const float VoH,const vec4 random,inout vec3 l,inout vec3 hitPos,out bool isMissedRay,out vec3 brdf,out float pdf){float cosTheta=max(0.0,dot(viewNormal,l));if(isDiffuseSample){vec3 diffuseBrdf=evalDisneyDiffuse(NoL,NoV,LoH,roughness,metalness);pdf=NoL/M_PI;brdf=diffuseBrdf;}else{vec3 specularBrdf=evalDisneySpecular(roughness,NoH,NoV,NoL);pdf=GGXVNDFPdf(NoH,NoV,roughness);brdf=specularBrdf;}brdf*=cosTheta;pdf=max(EPSILON,pdf);hitPos=viewPos;vec2 coords=RayMarch(l,hitPos,random);bool allowMissedRays=false;
#ifdef missedRays
allowMissedRays=true;
#endif
isMissedRay=hitPos.x==10.0e9;vec3 envMapSample=vec3(0.);if(isMissedRay&&!allowMissedRays)return getEnvColor(l,worldPos,roughness,isDiffuseSample,isEnvSample);vec4 velocity=textureLod(velocityTexture,coords.xy,0.0);vec2 reprojectedUv=coords.xy-velocity.xy;vec3 SSGI;vec3 envColor=getEnvColor(l,worldPos,roughness,isDiffuseSample,isEnvSample);if(reprojectedUv.x>=0.0&&reprojectedUv.x<=1.0&&reprojectedUv.y>=0.0&&reprojectedUv.y<=1.0){vec4 reprojectedGI=textureLod(accumulatedTexture,reprojectedUv,0.);float saturation=getSaturation(mat.diffuse.rgb);reprojectedGI.rgb=mix(reprojectedGI.rgb,vec3(luminance(reprojectedGI.rgb)),(1.-roughness)*saturation*0.4);SSGI=reprojectedGI.rgb;float aspect=resolution.x/resolution.y;float border=0.15;float borderFactor=smoothstep(0.0,border,coords.x)*smoothstep(1.0,1.0-border,coords.x)*smoothstep(0.0,border,coords.y)*smoothstep(1.0,1.0-border,coords.y);borderFactor=sqrt(borderFactor);SSGI=mix(envColor,SSGI,borderFactor);}else{return envColor;}if(allowMissedRays){float ssgiLum=luminance(SSGI);float envLum=luminance(envMapSample);if(envLum>ssgiLum)SSGI=envMapSample;}return SSGI;}vec2 RayMarch(inout vec3 dir,inout vec3 hitPos,vec4 random){float rayHitDepthDifference;dir*=rayDistance/float(steps);vec2 uv;for(int i=1;i<steps;i++){float cs=1.-exp(-0.25*pow(float(i)+random.b-0.5,2.));hitPos+=dir*cs;uv=viewSpaceToScreenSpace(hitPos);float unpackedDepth=textureLod(depthTexture,uv,0.0).r;float z=getViewZ(unpackedDepth);rayHitDepthDifference=z-hitPos.z;if(rayHitDepthDifference>=0.0&&rayHitDepthDifference<thickness){if(refineSteps==0){return uv;}else{return BinarySearch(dir,hitPos);}}}hitPos.xyz=vec3(10.0e9);return uv;}vec2 BinarySearch(inout vec3 dir,inout vec3 hitPos){float rayHitDepthDifference;vec2 uv;dir*=0.5;hitPos-=dir;for(int i=0;i<refineSteps;i++){uv=viewSpaceToScreenSpace(hitPos);float unpackedDepth=textureLod(depthTexture,uv,0.0).r;float z=getViewZ(unpackedDepth);rayHitDepthDifference=z-hitPos.z;dir*=0.5;if(rayHitDepthDifference>=0.0){hitPos-=dir;}else{hitPos+=dir;}}uv=viewSpaceToScreenSpace(hitPos);return uv;}`,mE=`#define GLSLIFY 1
#define PI M_PI
#define luminance(a) dot(vec3(0.2125, 0.7154, 0.0721), a)
float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return nearMulFar/(farMinusNear*depth-cameraFar);
#else
return depth*nearMinusFar-cameraNear;
#endif
}vec3 getViewPosition(float viewZ){float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];vec4 clipPosition=vec4((vec3(vUv,viewZ)-0.5)*2.0,1.0);clipPosition*=clipW;vec3 p=(projectionMatrixInverse*clipPosition).xyz;p.z=viewZ;return p;}vec2 viewSpaceToScreenSpace(const vec3 position){vec4 projectedCoord=projectionMatrix*vec4(position,1.0);projectedCoord.xy/=projectedCoord.w;projectedCoord.xy=projectedCoord.xy*0.5+0.5;return projectedCoord.xy;}vec3 worldSpaceToViewSpace(vec3 worldPosition){vec4 viewPosition=viewMatrix*vec4(worldPosition,1.0);return viewPosition.xyz/viewPosition.w;}
#ifdef BOX_PROJECTED_ENV_MAP
uniform vec3 envMapSize;uniform vec3 envMapPosition;vec3 parallaxCorrectNormal(const vec3 v,const vec3 cubeSize,const vec3 cubePos,const vec3 worldPosition){vec3 nDir=normalize(v);vec3 rbmax=(.5*cubeSize+cubePos-worldPosition)/nDir;vec3 rbmin=(-.5*cubeSize+cubePos-worldPosition)/nDir;vec3 rbminmax;rbminmax.x=(nDir.x>0.)? rbmax.x : rbmin.x;rbminmax.y=(nDir.y>0.)? rbmax.y : rbmin.y;rbminmax.z=(nDir.z>0.)? rbmax.z : rbmin.z;float correction=min(min(rbminmax.x,rbminmax.y),rbminmax.z);vec3 boxIntersection=worldPosition+nDir*correction;return boxIntersection-cubePos;}
#endif
#define M_PI 3.1415926535897932384626433832795
vec2 equirectDirectionToUv(const vec3 direction){vec2 uv=vec2(atan(direction.z,direction.x),acos(direction.y));uv/=vec2(2.0*M_PI,M_PI);uv.x+=0.5;uv.y=1.0-uv.y;return uv;}vec3 equirectUvToDirection(vec2 uv){uv.x-=0.5;uv.y=1.0-uv.y;float theta=uv.x*2.0*PI;float phi=uv.y*PI;float sinPhi=sin(phi);return vec3(sinPhi*cos(theta),cos(phi),sinPhi*sin(theta));}vec3 sampleEquirectEnvMapColor(const vec3 direction,const sampler2D map,const float lod){return textureLod(map,equirectDirectionToUv(direction),lod).rgb;}mat3 getBasisFromNormal(const vec3 normal){vec3 other;if(abs(normal.x)>0.5){other=vec3(0.0,1.0,0.0);}else{other=vec3(1.0,0.0,0.0);}vec3 ortho=normalize(cross(normal,other));vec3 ortho2=normalize(cross(normal,ortho));return mat3(ortho2,ortho,normal);}vec3 F_Schlick(const vec3 f0,const float theta){return f0+(1.-f0)*pow(1.0-theta,5.);}float F_Schlick(const float f0,const float f90,const float theta){return f0+(f90-f0)*pow(1.0-theta,5.0);}float D_GTR(const float roughness,const float NoH,const float k){float a2=pow(roughness,2.);return a2/(PI*pow((NoH*NoH)*(a2*a2-1.)+1.,k));}float SmithG(const float NDotV,const float alphaG){float a=alphaG*alphaG;float b=NDotV*NDotV;return(2.0*NDotV)/(NDotV+sqrt(a+b-a*b));}float GGXVNDFPdf(const float NoH,const float NoV,const float roughness){float D=D_GTR(roughness,NoH,2.);float G1=SmithG(NoV,roughness*roughness);return(D*G1)/max(0.00001,4.0*NoV);}float GeometryTerm(const float NoL,const float NoV,const float roughness){float a2=roughness*roughness;float G1=SmithG(NoV,a2);float G2=SmithG(NoL,a2);return G1*G2;}vec3 evalDisneyDiffuse(const float NoL,const float NoV,const float LoH,const float roughness,const float metalness){float FD90=0.5+2.*roughness*pow(LoH,2.);float a=F_Schlick(1.,FD90,NoL);float b=F_Schlick(1.,FD90,NoV);return vec3((a*b/PI)*(1.-metalness));}vec3 evalDisneySpecular(const float roughness,const float NoH,const float NoV,const float NoL){float D=D_GTR(roughness,NoH,2.);float G=GeometryTerm(NoL,NoV,pow(0.5+roughness*.5,2.));vec3 spec=vec3(D*G/(4.*NoL*NoV));return spec;}vec3 SampleGGXVNDF(const vec3 V,const float ax,const float ay,const float r1,const float r2){vec3 Vh=normalize(vec3(ax*V.x,ay*V.y,V.z));float lensq=Vh.x*Vh.x+Vh.y*Vh.y;vec3 T1=lensq>0. ? vec3(-Vh.y,Vh.x,0.)*inversesqrt(lensq): vec3(1.,0.,0.);vec3 T2=cross(Vh,T1);float r=sqrt(r1);float phi=2.0*PI*r2;float t1=r*cos(phi);float t2=r*sin(phi);float s=0.5*(1.0+Vh.z);t2=(1.0-s)*sqrt(1.0-t1*t1)+s*t2;vec3 Nh=t1*T1+t2*T2+sqrt(max(0.0,1.0-t1*t1-t2*t2))*Vh;return normalize(vec3(ax*Nh.x,ay*Nh.y,max(0.0,Nh.z)));}void Onb(const vec3 N,inout vec3 T,inout vec3 B){vec3 up=abs(N.z)<0.9999999 ? vec3(0,0,1): vec3(1,0,0);T=normalize(cross(up,N));B=cross(N,T);}vec3 ToLocal(const vec3 X,const vec3 Y,const vec3 Z,const vec3 V){return vec3(dot(V,X),dot(V,Y),dot(V,Z));}vec3 ToWorld(const vec3 X,const vec3 Y,const vec3 Z,const vec3 V){return V.x*X+V.y*Y+V.z*Z;}vec3 cosineSampleHemisphere(const vec3 n,const vec2 u){float r=sqrt(u.x);float theta=2.0*PI*u.y;vec3 b=normalize(cross(n,vec3(0.0,1.0,1.0)));vec3 t=cross(b,n);return normalize(r*sin(theta)*b+sqrt(1.0-u.x)*n+r*cos(theta)*t);}float equirectDirectionPdf(vec3 direction){vec2 uv=equirectDirectionToUv(direction);float theta=uv.y*PI;float sinTheta=sin(theta);if(sinTheta==0.0){return 0.0;}return 1.0/(2.0*PI*PI*sinTheta);}float sampleEquirectProbability(EquirectHdrInfo info,vec2 blueNoise,out vec3 direction){float v=textureLod(info.marginalWeights,vec2(blueNoise.x,0.0),0.).x;float u=textureLod(info.conditionalWeights,vec2(blueNoise.y,v),0.).x;vec2 uv=vec2(u,v);vec3 derivedDirection=equirectUvToDirection(uv);direction=derivedDirection;vec3 color=texture(info.map,uv).rgb;float totalSum=info.totalSumWhole+info.totalSumDecimal;float lum=luminance(color);float pdf=lum/totalSum;return info.size.x*info.size.y*pdf;}float misHeuristic(float a,float b){float aa=a*a;float bb=b*b;return aa/(aa+bb);}vec3 alignToNormal(const vec3 normal,const vec3 direction){vec3 tangent;vec3 bitangent;Onb(normal,tangent,bitangent);vec3 localDir=ToLocal(tangent,bitangent,normal,direction);vec3 localDirAligned=vec3(localDir.x,localDir.y,abs(localDir.z));vec3 alignedDir=ToWorld(tangent,bitangent,normal,localDirAligned);return alignedDir;}float getFlatness(vec3 g,vec3 rp){vec3 gw=fwidth(g);vec3 pw=fwidth(rp);float wfcurvature=length(gw)/length(pw);wfcurvature=smoothstep(0.0,30.,wfcurvature);return clamp(wfcurvature,0.,1.);}`;const gE=({data:{width:e,height:t,isFloatType:n,flipY:o,data:i}})=>{const r=s();function s(){const p=new ArrayBuffer(4),g=new Float32Array(p),m=new Uint32Array(p),v=new Uint32Array(512),y=new Uint32Array(512);for(let x=0;x<256;++x){const E=x-127;E<-27?(v[x]=0,v[x|256]=32768,y[x]=24,y[x|256]=24):E<-14?(v[x]=1024>>-E-14,v[x|256]=1024>>-E-14|32768,y[x]=-E-1,y[x|256]=-E-1):E<=15?(v[x]=E+15<<10,v[x|256]=E+15<<10|32768,y[x]=13,y[x|256]=13):E<128?(v[x]=31744,v[x|256]=64512,y[x]=24,y[x|256]=24):(v[x]=31744,v[x|256]=64512,y[x]=13,y[x|256]=13)}const w=new Uint32Array(2048),S=new Uint32Array(64),T=new Uint32Array(64);for(let x=1;x<1024;++x){let E=x<<13,C=0;for(;!(E&8388608);)E<<=1,C-=8388608;E&=-8388609,C+=947912704,w[x]=E|C}for(let x=1024;x<2048;++x)w[x]=939524096+(x-1024<<13);for(let x=1;x<31;++x)S[x]=x<<23;S[31]=1199570944,S[32]=2147483648;for(let x=33;x<63;++x)S[x]=2147483648+(x-32<<23);S[63]=3347054592;for(let x=1;x<64;++x)x!==32&&(T[x]=1024);return{floatView:g,uint32View:m,baseTable:v,shiftTable:y,mantissaTable:w,exponentTable:S,offsetTable:T}}function a(p){const g=p>>10;return r.uint32View[0]=r.mantissaTable[r.offsetTable[g]+(p&1023)]+r.exponentTable[g],r.floatView[0]}function c(p,g,m){return .2126*p+.7152*g+.0722*m}const l=(p,g,m=0,v=p.length)=>{let y=m,w=m+v-1;for(;y<w;){const S=y+w>>1;p[S]<g?y=S+1:w=S}return y-m},u=(p,g,m,v,y,w)=>{if(v)for(let D=0,R=m-1;D<=R;D++)for(let I=0,k=g*4;I<k;I+=4){const V=R-D,X=D*k+I,$=V*k+I;p[$]=p[X],p[$+1]=p[X+1],p[$+2]=p[X+2],p[$+3]=p[X+3]}const S=new Float32Array(g*m),T=new Float32Array(g*m),x=new Float32Array(m),E=new Float32Array(m);let C=0,L=0;for(let D=0;D<m;D++){let R=0;for(let I=0;I<g;I++){const k=D*g+I,V=p[4*k+0],X=p[4*k+1],$=p[4*k+2],_e=c(V,X,$);R+=_e,C+=_e,S[k]=_e,T[k]=R}if(R!==0)for(let I=D*g,k=D*g+g;I<k;I++)S[I]/=R,T[I]/=R;L+=R,x[D]=R,E[D]=L}if(L!==0)for(let D=0,R=x.length;D<R;D++)x[D]/=L,E[D]/=L;for(let D=0;D<m;D++){const R=(D+1)/m,I=l(E,R);y[D]=(I+.5)/m}for(let D=0;D<m;D++)for(let R=0;R<g;R++){const I=D*g+R,k=(R+1)/g,V=l(T,k,D*g,g);w[I]=(V+.5)/g}return C};if(!n){const p=new Float32Array(i.length);for(let g=0;g<i.length;g++)p[g]=a(i[g]);i=p}const d=new Float32Array(t),f=new Float32Array(e*t),h=u(i,e,t,o,d,f);postMessage({totalSumValue:h,marginalDataArray:d,conditionalDataArray:f})},vE=new Blob(["onmessage = "+gE],{type:"application/javascript"}),yE=URL.createObjectURL(vE);class bE{constructor(){const t=new vs(new Float32Array([1,1,1,1]),1,1);t.type=bt,t.format=Jc,t.minFilter=Oe,t.magFilter=Oe,t.wrapS=hr,t.wrapT=hr,t.generateMipmaps=!1,t.needsUpdate=!0;const n=new vs(new Float32Array([0,1]),1,2);n.type=bt,n.format=sp,n.minFilter=Oe,n.magFilter=Oe,n.generateMipmaps=!1,n.needsUpdate=!0;const o=new vs(new Float32Array([0,0,1,1]),2,2);o.type=bt,o.format=sp,o.minFilter=Oe,o.magFilter=Oe,o.generateMipmaps=!1,o.needsUpdate=!0,this.map=t,this.marginalWeights=n,this.conditionalWeights=o,this.totalSumWhole=1,this.totalSumDecimal=0,this.size=new Me}dispose(){this.marginalWeights.dispose(),this.conditionalWeights.dispose(),this.map.dispose()}updateFrom(t){t=t.clone();const{width:n,height:o,data:i}=t.image,{type:r}=t;return this.size.set(n,o),new Promise(s=>{var a;(a=this.worker)==null||a.terminate(),this.worker=new Worker(yE),this.worker.postMessage({width:n,height:o,isFloatType:r===bt,flipY:t.flipY,data:i}),this.worker.onmessage=({data:{totalSumValue:c,marginalDataArray:l,conditionalDataArray:u}})=>{this.dispose();const{marginalWeights:d,conditionalWeights:f}=this;d.image={width:o,height:1,data:l},d.needsUpdate=!0,f.image={width:n,height:o,data:u},f.needsUpdate=!0;const h=~~c,p=c-h;this.totalSumWhole=h,this.totalSumDecimal=p,this.map=t,this.worker=null,s(t)}})}}class xE extends Vi{constructor(){super({type:"SSGIMaterial",uniforms:{accumulatedTexture:new j(null),gBufferTexture:new j(null),depthTexture:new j(null),velocityTexture:new j(null),directLightTexture:new j(null),blueNoiseTexture:new j(null),projectionMatrix:new j(new ne),projectionMatrixInverse:new j(new ne),cameraMatrixWorld:new j(new ne),viewMatrix:new j(new ne),cameraNear:new j(0),cameraFar:new j(0),nearMulFar:new j(0),nearMinusFar:new j(0),farMinusNear:new j(0),rayDistance:new j(0),thickness:new j(0),frame:new j(0),envBlur:new j(0),maxEnvMapMipLevel:new j(0),envMapInfo:{value:new bE},envMapPosition:new j(new P),envMapSize:new j(new P),backgroundColor:new j(new vt),resolution:new j(new Me),blueNoiseRepeat:new j(new Me)},defines:{steps:20,refineSteps:5,CUBEUV_TEXEL_WIDTH:0,CUBEUV_TEXEL_HEIGHT:0,CUBEUV_MAX_MIP:0,vWorldPosition:"worldPos"},fragmentShader:pE.replace("#include <ssgi_utils>",mE).replace("#include <gbuffer_packing>",zr),vertexShader:Ur,blending:Xs,depthWrite:!1,depthTest:!1,toneMapped:!1}),cy(this)}}const wE=new vt(0);class SE extends di{constructor(t,n){super("SSGIPass"),this.defaultFragmentShader="",this.frame=21483,this.ssgiEffect=t,this._scene=t._scene,this._camera=t._camera,this.fullscreenMaterial=new xE,this.defaultFragmentShader=this.fullscreenMaterial.fragmentShader,this.renderTarget=new ki(1,1,{type:bt,minFilter:Oe,magFilter:Oe,depthBuffer:!1}),this.renderTarget.texture.name="SSGIPass.Texture",this.fullscreenMaterial.uniforms.cameraMatrixWorld.value=this._camera.matrixWorld,this.fullscreenMaterial.uniforms.viewMatrix.value=this._camera.matrixWorldInverse,this.fullscreenMaterial.uniforms.projectionMatrix.value=this._camera.projectionMatrix,this.fullscreenMaterial.uniforms.projectionMatrixInverse.value=this._camera.projectionMatrixInverse,t._camera.isPerspectiveCamera&&(this.fullscreenMaterial.defines.PERSPECTIVE_CAMERA=""),this.fullscreenMaterial.defines.mode=["ssgi","ssr"].indexOf(n.mode),this.gBufferPass=new ly(this._scene,this._camera),this.fullscreenMaterial.uniforms.gBufferTexture.value=this.gBufferPass.texture,this.fullscreenMaterial.uniforms.depthTexture.value=this.gBufferPass.depthTexture}get texture(){return this.renderTarget.texture}setSize(t,n){this.renderTarget.setSize(t*this.ssgiEffect.resolutionScale,n*this.ssgiEffect.resolutionScale),this.gBufferPass.setSize(t,n),this.fullscreenMaterial.uniforms.resolution.value.set(this.renderTarget.width,this.renderTarget.height)}dispose(){super.dispose(),this.renderTarget.dispose(),this.renderTarget.dispose(),this.fullscreenMaterial.dispose()}render(t){this.frame=(this.frame+1)%4096;const{mask:n}=this._camera.layers,o=this.ssgiEffect.selection.size>0;this._camera.layers.set(o?this.ssgiEffect.selection.layer:0),this.gBufferPass.render(t),this._camera.layers.mask=n,this.fullscreenMaterial.uniforms.frame.value=this.frame,this.fullscreenMaterial.uniforms.cameraNear.value=this._camera.near,this.fullscreenMaterial.uniforms.cameraFar.value=this._camera.far,this.fullscreenMaterial.uniforms.nearMinusFar.value=this._camera.near-this._camera.far,this.fullscreenMaterial.uniforms.farMinusNear.value=this._camera.far-this._camera.near,this.fullscreenMaterial.uniforms.nearMulFar.value=this._camera.near*this._camera.far,this.fullscreenMaterial.uniforms.accumulatedTexture.value=this.ssgiEffect.denoiser.texture,this.fullscreenMaterial.uniforms.velocityTexture.value=this.ssgiEffect.velocityTexture;const i=this._scene.background instanceof vt?this._scene.background:wE;this.fullscreenMaterial.uniforms.backgroundColor.value.copy(i),t.setRenderTarget(this.renderTarget),t.render(this.scene,this.camera)}}const TE=`
		#ifdef USE_SKINNING
		#ifdef BONE_TEXTURE
			uniform sampler2D prevBoneTexture;
			mat4 getPrevBoneMatrix( const in float i ) {
				float j = i * 4.0;
				float x = mod( j, float( boneTextureSize ) );
				float y = floor( j / float( boneTextureSize ) );
				float dx = 1.0 / float( boneTextureSize );
				float dy = 1.0 / float( boneTextureSize );
				y = dy * ( y + 0.5 );
				vec4 v1 = textureLod( prevBoneTexture, vec2( dx * ( x + 0.5 ), y ), 0. );
				vec4 v2 = textureLod( prevBoneTexture, vec2( dx * ( x + 1.5 ), y ), 0. );
				vec4 v3 = textureLod( prevBoneTexture, vec2( dx * ( x + 2.5 ), y ), 0. );
				vec4 v4 = textureLod( prevBoneTexture, vec2( dx * ( x + 3.5 ), y ), 0. );
				mat4 bone = mat4( v1, v2, v3, v4 );
				return bone;
			}
		#else
			uniform mat4 prevBoneMatrices[ MAX_BONES ];
			mat4 getPrevBoneMatrix( const in float i ) {
				mat4 bone = prevBoneMatrices[ int(i) ];
				return bone;
			}
		#endif
		#endif
`,EE=`
#define MAX_BONES 64

${me.skinning_pars_vertex}
${TE}

uniform mat4 velocityMatrix;
uniform mat4 prevVelocityMatrix;
varying vec4 prevPosition;
varying vec4 newPosition;

varying vec2 vHighPrecisionZW;
`,ME=`
// Get the current vertex position
transformed = vec3( position );
${me.skinning_vertex}
newPosition = velocityMatrix * vec4( transformed, 1.0 );

// Get the previous vertex position
transformed = vec3( position );
${me.skinbase_vertex.replace(/mat4 /g,"").replace(/getBoneMatrix/g,"getPrevBoneMatrix")}
${me.skinning_vertex.replace(/vec4 /g,"")}
prevPosition = prevVelocityMatrix * vec4( transformed, 1.0 );

gl_Position = newPosition;

vHighPrecisionZW = gl_Position.zw;
`,PE=`
varying vec4 prevPosition;
varying vec4 newPosition;

varying vec2 vHighPrecisionZW;
`,NE=`
vec2 pos0 = (prevPosition.xy / prevPosition.w) * 0.5 + 0.5;
vec2 pos1 = (newPosition.xy / newPosition.w) * 0.5 + 0.5;

vec2 vel = pos1 - pos0;

float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;

gl_FragColor = vec4(vel.x, vel.y, 0., 0.);
`,AE={prevVelocityMatrix:{value:new ne},velocityMatrix:{value:new ne},prevBoneTexture:{value:null},boneTexture:{value:null},normalMap:{value:null},normalScale:{value:new Me(1,1)},uvTransform:{value:new nd}};class CE extends Vi{constructor(t){super({uniforms:{...Gu.clone(AE),cameraMatrixWorld:{value:t.matrixWorld}},vertexShader:`
					#include <common>
					#include <uv_pars_vertex>
					#include <displacementmap_pars_vertex>
					#include <normal_pars_vertex>
					#include <morphtarget_pars_vertex>
					#include <logdepthbuf_pars_vertex>
					#include <clipping_planes_pars_vertex>

					varying vec2 vUv;

					varying vec3 vViewPosition;

                    ${EE}

                    void main() {
						vec3 transformed;

						#include <uv_vertex>

						#include <skinbase_vertex>
						#include <beginnormal_vertex>
						#include <skinnormal_vertex>
						#include <defaultnormal_vertex>

						#include <morphnormal_vertex>
						#include <normal_vertex>
						#include <morphtarget_vertex>
						#include <displacementmap_vertex>
						#include <project_vertex>
						#include <logdepthbuf_vertex>
						#include <clipping_planes_vertex>

						${ME}

						vViewPosition = - mvPosition.xyz;

						vUv = uv;

                    }`,fragmentShader:`
					precision highp float;
					uniform mat4 cameraMatrixWorld;

					varying vec3 vViewPosition;

					${PE}
					#include <packing>

					#include <uv_pars_fragment>
					#include <normal_pars_fragment>
					#include <normalmap_pars_fragment>

					varying vec2 vUv;

					// source: https://knarkowicz.wordpress.com/2014/04/16/octahedron-normal-vector-encoding/
					vec2 OctWrap( vec2 v ) {
						vec2 w = 1.0 - abs( v.yx );
						if (v.x < 0.0) w.x = -w.x;
						if (v.y < 0.0) w.y = -w.y;
						return w;
					}

					vec2 encodeOctWrap(vec3 n) {
						n /= (abs(n.x) + abs(n.y) + abs(n.z));
						n.xy = n.z > 0.0 ? n.xy : OctWrap(n.xy);
						n.xy = n.xy * 0.5 + 0.5;
						return n.xy;
					}

					float packNormal(vec3 normal) {
						return uintBitsToFloat(packHalf2x16(encodeOctWrap(normal)));
					}

                    void main() {
						#define vNormalMapUv vUv

						#include <normal_fragment_begin>
                    	#include <normal_fragment_maps>

						${NE}
						vec3 worldNormal = normalize((cameraMatrixWorld * vec4(normal, 0.)).xyz);
						gl_FragColor.b = packNormal(worldNormal);
						gl_FragColor.a = fragCoordZ;
                    }`})}}const LE=["vertexTangent","vertexColors","vertexAlphas","vertexUvs","uvsVertexOnly","supportsVertexTextures","instancing","instancingColor","side","flatShading","skinning","doubleSided","flipSided"],DE=(e,t)=>{for(const n of LE)t[n]=e[n]},IE=(e,t,n,o,i)=>{t[n]!==e[n]&&(e[n]=t[n],e.uniforms[n].value=t[n],t[n]?e.defines[o]="":delete e.defines[o],e.needsUpdate=!0)},FE=e=>{const t=[e],n=[];for(;t.length!==0;){const o=t.shift();o.material&&n.push(o);for(const i of o.children)i.visible&&t.push(i)}return n},RE=new vt(0),OE=new Me,Zm=new ne,Km=new ne,uy=e=>{let t=e.material.uniforms.prevBoneTexture.value;if(t&&t.image.width===e.skeleton.boneTexture.width)t=e.material.uniforms.prevBoneTexture.value,t.image.data.set(e.skeleton.boneTexture.image.data);else{var n;(n=t)==null||n.dispose();const o=e.skeleton.boneTexture.image.data.slice(),i=e.skeleton.boneTexture.image.width;t=new vs(o,i,i,Jc,bt),e.material.uniforms.prevBoneTexture.value=t,t.needsUpdate=!0}},kE=(e,t)=>{var n;(n=e.skeleton)!=null&&n.boneTexture&&(e.material.uniforms.boneTexture.value=e.skeleton.boneTexture,"USE_SKINNING"in e.material.defines||(e.material.defines.USE_SKINNING="",e.material.defines.BONE_TEXTURE="",e.material.needsUpdate=!0)),e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld),e.material.uniforms.velocityMatrix.value.multiplyMatrices(t.projectionMatrix,e.modelViewMatrix)},VE=(e,t)=>{var n;e.material.uniforms.prevVelocityMatrix.value.multiplyMatrices(t.projectionMatrix,e.modelViewMatrix),(n=e.skeleton)!=null&&n.boneTexture&&uy(e)};class Sl extends di{constructor(t,n){super("VelocityDepthNormalPass"),this.cachedMaterials=new WeakMap,this.visibleMeshes=[],this.needsSwap=!1,this._scene=t,this._camera=n,this.renderTarget=new ki(1,1,{type:bt,minFilter:Oe,magFilter:Oe}),this.renderTarget.texture.name="VelocityDepthNormalPass.Texture",this.renderTarget.depthTexture=new z1(1,1),this.renderTarget.depthTexture.type=bt}get texture(){return this.renderTarget.texture}setVelocityDepthNormalMaterialInScene(){this.visibleMeshes=ry(this._scene);for(const n of this.visibleMeshes){const o=n.material;let[i,r]=this.cachedMaterials.get(n)||[];if(o!==i){var t;r=new CE(this._camera),DE(o,r),n.material=r,(t=n.skeleton)!=null&&t.boneTexture&&uy(n),this.cachedMaterials.set(n,[o,r])}n.material=r,n.visible=ah(n,o),IE(r,o,"normalMap","USE_NORMALMAP_TANGENTSPACE"),r.uniforms.normalMap.value=o.normalMap;const s=o.map||o.normalMap||o.roughnessMap||o.metalnessMap;s&&(r.uniforms.uvTransform.value=s.matrix),kE(n,this._camera)}}unsetVelocityDepthNormalMaterialInScene(){for(const t of this.visibleMeshes)t.visible=!0,VE(t,this._camera),t.material=this.cachedMaterials.get(t)[0]}setSize(t,n){var o;this.renderTarget.setSize(t,n),(o=this.lastVelocityTexture)==null||o.dispose(),this.lastVelocityTexture=new B1(t,n,Jc),this.lastVelocityTexture.type=bt,this.lastVelocityTexture.minFilter=Oe,this.lastVelocityTexture.magFilter=Oe}dispose(){super.dispose(),this.renderTarget.dispose()}render(t){Zm.copy(this._camera.projectionMatrix),Km.copy(this._camera.projectionMatrixInverse),this._camera.view&&(this._camera.view.enabled=!1),this._camera.updateProjectionMatrix(),this._camera.updateMatrixWorld(),this.setVelocityDepthNormalMaterialInScene();const{background:n}=this._scene;this._scene.background=RE,t.setRenderTarget(this.renderTarget),t.copyFramebufferToTexture(OE,this.lastVelocityTexture),t.render(this._scene,this._camera),this._scene.background=n,this.unsetVelocityDepthNormalMaterialInScene(),this._camera.view&&(this._camera.view.enabled=!0),this._camera.projectionMatrix.copy(Zm),this._camera.projectionMatrixInverse.copy(Km)}}var UE=`#define GLSLIFY 1
float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 getViewPosition(float viewZ){float clipW=projectionMatrix[2][3]*viewZ+projectionMatrix[3][3];vec4 clipPosition=vec4((vec3(vUv,viewZ)-0.5)*2.0,1.0);clipPosition*=clipW;vec3 p=(projectionMatrixInverse*clipPosition).xyz;p.z=viewZ;return p;}vec3 F_Schlick(const vec3 f0,const float theta){return f0+(1.-f0)*pow(1.0-theta,5.);}vec3 SampleGGXVNDF(const vec3 V,const float ax,const float ay,const float r1,const float r2){vec3 Vh=normalize(vec3(ax*V.x,ay*V.y,V.z));float lensq=Vh.x*Vh.x+Vh.y*Vh.y;vec3 T1=lensq>0. ? vec3(-Vh.y,Vh.x,0.)*inversesqrt(lensq): vec3(1.,0.,0.);vec3 T2=cross(Vh,T1);float r=sqrt(r1);float phi=2.0*PI*r2;float t1=r*cos(phi);float t2=r*sin(phi);float s=0.5*(1.0+Vh.z);t2=(1.0-s)*sqrt(1.0-t1*t1)+s*t2;vec3 Nh=t1*T1+t2*T2+sqrt(max(0.0,1.0-t1*t1-t2*t2))*Vh;return normalize(vec3(ax*Nh.x,ay*Nh.y,max(0.0,Nh.z)));}void Onb(const vec3 N,inout vec3 T,inout vec3 B){vec3 up=abs(N.z)<0.9999999 ? vec3(0,0,1): vec3(1,0,0);T=normalize(cross(up,N));B=cross(N,T);}vec3 ToLocal(const vec3 X,const vec3 Y,const vec3 Z,const vec3 V){return vec3(dot(V,X),dot(V,Y),dot(V,Z));}vec3 ToWorld(const vec3 X,const vec3 Y,const vec3 Z,const vec3 V){return V.x*X+V.y*Y+V.z*Z;}vec3 constructGlobalIllumination(vec3 diffuseGi,vec3 specularGi,vec3 cameraRay,vec3 viewNormal,vec3 diffuse,vec3 emissive,float roughness,float metalness){roughness*=roughness;vec3 normal=(vec4(viewNormal,0.)*viewMatrix).xyz;vec3 T,B;vec3 v=-cameraRay;vec3 V=(vec4(v,0.)*viewMatrix).xyz;vec3 N=normal;Onb(N,T,B);V=ToLocal(T,B,N,V);vec3 H=SampleGGXVNDF(V,roughness,roughness,0.25,0.25);if(H.z<0.0)H=-H;vec3 l=normalize(reflect(-V,H));l=ToWorld(T,B,N,l);l=(vec4(l,1.)*cameraMatrixWorld).xyz;l=normalize(l);if(dot(viewNormal,l)<0.)l=-l;vec3 h=normalize(v+l);float VoH=max(EPSILON,dot(v,h));vec3 f0=mix(vec3(0.04),diffuse,metalness);vec3 F=F_Schlick(f0,VoH);
#if inputType != TYPE_SPECULAR
vec3 diffuseComponent=diffuse*(1.-metalness)*(1.-F)*diffuseGi;
#else
vec3 diffuseComponent=textureLod(sceneTexture,vUv,0.).rgb;
#endif
vec3 specularComponent=specularGi*F;vec3 globalIllumination=diffuseComponent+specularComponent+emissive;return globalIllumination;}`;class zE extends di{constructor(t,n,o,i,r={}){var s;super("DenoiserComposePass"),this._camera=t,this.renderTarget=new ki(1,1,{depthBuffer:!1,type:bt,minFilter:Oe,magFilter:Oe}),this.renderTarget.texture.name="DenoiserComposePass.Texture";let a,c;r.inputType==="diffuseSpecular"?(a=n[0],c=n[1]):r.inputType==="diffuse"?a=n[0]:r.inputType==="specular"&&(c=n[0]),this.fullscreenMaterial=new Vi({fragmentShader:`
            varying vec2 vUv;
            uniform sampler2D sceneTexture;
            uniform highp sampler2D depthTexture;
            uniform sampler2D diffuseGiTexture;
            uniform sampler2D specularGiTexture;
            uniform mat4 cameraMatrixWorld;
            uniform mat4 projectionMatrix;
            uniform mat4 projectionMatrixInverse;
			uniform float cameraNear;
			uniform float cameraFar;

            #include <common>
            #include <packing>

			#define TYPE_DIFFUSE_SPECULAR 0
			#define TYPE_DIFFUSE 1
			#define TYPE_SPECULAR 2

            ${zr}
            ${UE}

            void main() {
                float depth = textureLod(depthTexture, vUv, 0.).r;

				if(depth == 1.){
					discard;
					return;
				}

				// on Android there's a bug where using "vec3 normal = unpackNormal(textureLod(velocityTexture, vUv, 0.).b);" instead of
				// "vec3 normal = unpackNormal(velocity.b);" causes the normal to be distorted (possibly due to packHalf2x16 function)

                Material mat = getMaterial(gBufferTexture, vUv);

                vec3 viewNormal = (vec4(mat.normal, 0.) * cameraMatrixWorld).xyz;

				float viewZ = getViewZ(depth);

                // view-space position of the current texel
				vec3 viewPos = getViewPosition(viewZ);
                vec3 viewDir = normalize(viewPos);

                vec4 diffuseGi = textureLod(diffuseGiTexture, vUv, 0.);
                vec4 specularGi = textureLod(specularGiTexture, vUv, 0.);

                vec3 gi = constructGlobalIllumination(diffuseGi.rgb, specularGi.rgb, viewDir, viewNormal, mat.diffuse.rgb, mat.emissive, mat.roughness, mat.metalness);

				gl_FragColor = vec4(gi, 1.);
            }
            `,vertexShader:Ur,uniforms:{sceneTexture:{value:null},viewMatrix:{value:t.matrixWorldInverse},cameraMatrixWorld:{value:t.matrixWorld},projectionMatrix:{value:t.projectionMatrix},projectionMatrixInverse:{value:t.projectionMatrixInverse},cameraNear:{value:t.near},cameraFar:{value:t.far},gBufferTexture:{value:o},depthTexture:{value:i},diffuseGiTexture:{value:a},specularGiTexture:{value:c}},defines:{inputType:(s=["diffuseSpecular","diffuse","specular"].indexOf(r.inputType))!==null&&s!==void 0?s:0},blending:Xs,depthWrite:!1,depthTest:!1,toneMapped:!1}),t.isPerspectiveCamera&&(this.fullscreenMaterial.defines.PERSPECTIVE_CAMERA="")}get texture(){return this.renderTarget.texture}dispose(){this.renderTarget.dispose()}setSize(t,n){this.renderTarget.setSize(t,n)}setSceneTexture(t){this.fullscreenMaterial.uniforms.sceneTexture.value=t}render(t){this.fullscreenMaterial.uniforms.cameraNear.value=this._camera.near,this.fullscreenMaterial.uniforms.cameraFar.value=this._camera.far,t.setRenderTarget(this.renderTarget),t.render(this.scene,this.camera)}}var BE=`#define GLSLIFY 1
varying vec2 vUv;uniform sampler2D inputTexture;uniform highp sampler2D depthTexture;uniform sampler2D normalTexture;uniform mat4 projectionMatrix;uniform mat4 projectionMatrixInverse;uniform mat4 cameraMatrixWorld;uniform float radius;uniform float phi;uniform float lumaPhi;uniform float depthPhi;uniform float normalPhi;uniform float roughnessPhi;uniform float specularPhi;uniform vec2 resolution;layout(location=0)out vec4 gOutput0;
#if textureCount == 2
uniform sampler2D inputTexture2;layout(location=1)out vec4 gOutput1;
#endif
#include <common>
#include <gbuffer_packing>
#define luminance(a) pow(dot(vec3(0.2125, 0.7154, 0.0721), a), 0.125)
#if textureCount == 1
#define inputTexture2 inputTexture
#endif
Material mat;vec3 normal;float depth;float glossiness;float specularFactor;struct InputTexel{vec3 rgb;float a;float luminance;float w;float totalWeight;bool isSpecular;};void toDenoiseSpace(inout vec3 color){color=log(color+1.);}void toLinearSpace(inout vec3 color){color=exp(color)-1.;}float getBasicNeighborWeight(inout vec2 neighborUv,inout float wBasic,inout float wDisoccl){
#ifdef GBUFFER_TEXTURE
Material neighborMat=getMaterial(gBufferTexture,neighborUv);vec3 neighborNormal=neighborMat.normal;float neighborDepth=textureLod(depthTexture,neighborUv,0.0).r;
#else
vec3 neighborDepthVelocityTexel=textureLod(normalTexture,neighborUv,0.).xyz;vec3 neighborNormal=unpackNormal(neighborDepthVelocityTexel.b);float neighborDepth=neighborDepthVelocityTexel.a;
#endif
if(neighborDepth==1.0)return 0.;float normalDiff=1.-max(dot(normal,neighborNormal),0.);float depthDiff=10000.*abs(depth-neighborDepth);
#ifdef GBUFFER_TEXTURE
float roughnessDiff=abs(mat.roughness-neighborMat.roughness);wBasic=exp(-normalDiff*normalPhi-depthDiff*depthPhi-roughnessDiff*roughnessPhi);
#else
wBasic=exp(-normalDiff*normalPhi-depthDiff*depthPhi);
#endif
wDisoccl=pow(wBasic,0.1)*exp(-normalDiff*5.);}vec3 getNormal(Material mat){
#ifdef GBUFFER_TEXTURE
return mat.normal;
#else
vec3 depthVelocityTexel=textureLod(normalTexture,vUv,0.).xyz;return unpackNormal(depthVelocityTexel.b);
#endif
}void outputTexel(inout vec4 outputFrag,InputTexel inp){inp.rgb/=inp.totalWeight;outputFrag.rgb=inp.rgb;toLinearSpace(outputFrag.rgb);outputFrag.a=inp.a;}void applyWeight(inout InputTexel inp,vec2 neighborUv,float wBasic,float wDisoccl){float w=wBasic;vec4 t;if(inp.isSpecular){t=textureLod(inputTexture2,neighborUv,0.);w*=specularFactor;wDisoccl*=specularFactor;}else{t=textureLod(inputTexture,neighborUv,0.);}float lumaDiff=abs(inp.luminance-luminance(t.rgb));float lumaFactor=exp(-lumaDiff*lumaPhi);w=mix(w*lumaFactor,wDisoccl*exp(-lumaDiff),pow(inp.w,3.))*inp.w;w*=step(0.01,w);toDenoiseSpace(t.rgb);inp.rgb+=w*t.rgb;inp.totalWeight+=w;}void main(){depth=textureLod(depthTexture,vUv,0.).r;if(depth==1.0&&fwidth(depth)==0.){discard;return;}InputTexel[textureCount]inputs;float maxAlpha=0.;
#pragma unroll_loop_start
for(int i=0;i<textureCount;i++){{vec4 t;if(isTextureSpecular[i]){t=textureLod(inputTexture2,vUv,0.);}else{t=textureLod(inputTexture,vUv,0.);}float age=1./log(exp(t.a*phi)+1.718281828459045);InputTexel inp=InputTexel(t.rgb,t.a,luminance(t.rgb),age,1.,isTextureSpecular[i]);maxAlpha=max(maxAlpha,inp.a);toDenoiseSpace(inp.rgb);inputs[i]=inp;}}
#pragma unroll_loop_end
mat=getMaterial(gBufferTexture,vUv);normal=getNormal(mat);float flatness=1.-min(length(fwidth(normal)),1.);flatness*=flatness;flatness*=flatness;flatness=flatness*0.9+0.1;glossiness=1.-mat.roughness;glossiness*=glossiness;specularFactor=exp(-glossiness*specularPhi);float roughnessRadius=mix(mat.roughness*mat.roughness,1.,specularPhi);float r=flatness*radius;for(int i=0;i<8;i++){{vec4 rand=blueNoise(vUv,blueNoiseIndex*8+i);vec2 u=r*(rand.xy*2.-1.)/resolution;float rRoughness=rand.b<mat.metalness ? roughnessRadius : 1.;vec2 neighborUv=vUv+rRoughness*u;float wBasic,wDisoccl;getBasicNeighborWeight(neighborUv,wBasic,wDisoccl);applyWeight(inputs[0],neighborUv,wBasic,wDisoccl);
#if textureCount == 2
applyWeight(inputs[1],neighborUv,wBasic,wDisoccl);
#endif
}}outputTexel(gOutput0,inputs[0]);
#if textureCount == 2
outputTexel(gOutput1,inputs[1]);
#endif
}`;const jE=BE.replace("#include <gbuffer_packing>",zr),An={iterations:1,radius:3,phi:.5,lumaPhi:5,depthPhi:2,normalPhi:3.25,inputType:"diffuseSpecular"};class Tl extends di{constructor(t,n,o=An){super("PoissonBlurPass"),this.iterations=An.iterations,this.index=0,o={...An,...o},this.textures=n;let i=[!1,!0];o.inputType==="diffuse"&&(i=[!1,!1]),o.inputType==="specular"&&(i=[!0,!0]);const r=o.inputType==="diffuseSpecular"?2:1,s=oy(jE.replaceAll("textureCount",r));this.fullscreenMaterial=new Vi({fragmentShader:s,vertexShader:Ur,uniforms:{depthTexture:{value:null},inputTexture:{value:n[0]},inputTexture2:{value:n[1]},gBufferTexture:{value:null},normalTexture:{value:null},projectionMatrix:{value:t.projectionMatrix},projectionMatrixInverse:{value:t.projectionMatrixInverse},cameraMatrixWorld:{value:t.matrixWorld},viewMatrix:{value:t.matrixWorldInverse},radius:{value:An.radius},phi:{value:An.phi},lumaPhi:{value:An.lumaPhi},depthPhi:{value:An.depthPhi},normalPhi:{value:An.normalPhi},roughnessPhi:{value:An.roughnessPhi},specularPhi:{value:An.specularPhi},resolution:{value:new Me}},defines:{isTextureSpecular:"bool[2]("+i.join(",")+")"},glslVersion:j1}),cy(this.fullscreenMaterial);const a={type:C4,depthBuffer:!1};this.renderTargetA=new Xu(1,1,r,a),this.renderTargetB=new Xu(1,1,r,a),this.renderTargetB.texture[0].name="PoissonDenoisePass."+(i[0]?"specular":"diffuse"),r>1&&(this.renderTargetB.texture[1].name="PoissonDenoisePass."+(i[1]?"specular":"diffuse"));const{uniforms:c}=this.fullscreenMaterial;c.depthPhi.value=o.depthPhi,c.normalPhi.value=o.normalPhi}setSize(t,n){this.renderTargetA.setSize(t,n),this.renderTargetB.setSize(t,n),this.fullscreenMaterial.uniforms.resolution.value.set(t,n)}get texture(){return this.renderTargetB.texture}setGBufferPass(t){t instanceof ly?(this.fullscreenMaterial.uniforms.gBufferTexture.value=t.texture,this.fullscreenMaterial.defines.GBUFFER_TEXTURE=""):this.fullscreenMaterial.uniforms.normalTexture.value=t.texture,this.fullscreenMaterial.uniforms.depthTexture.value=t.renderTarget.depthTexture}setnNormalTexture(t){this.fullscreenMaterial.uniforms.normalTexture.value=t}setDepthTexture(t){this.fullscreenMaterial.uniforms.depthTexture.value=t}dispose(){super.dispose(),this.renderTargetA.dispose(),this.renderTargetB.dispose(),this.fullscreenMaterial.dispose()}render(t){for(let n=0;n<2*this.iterations;n++){const o=n%2===0,i=o?this.renderTargetB:this.renderTargetA;this.fullscreenMaterial.uniforms.inputTexture.value=n===0?this.textures[0]:i.texture[0],this.fullscreenMaterial.uniforms.inputTexture2.value=n===0?this.textures[1]:i.texture[1];const r=o?this.renderTargetA:this.renderTargetB;t.setRenderTarget(r),t.render(this.scene,this.camera)}}}Tl.DefaultOptions=An;const Ym={denoiseMode:"full",inputType:"diffuseSpecular",gBufferPass:null,velocityDepthNormalPass:null};class _E{constructor(t,n,o,i=Ym){var r,s,a;i={...Ym,...i},this.options=i,this.velocityDepthNormalPass=(r=i.velocityDepthNormalPass)!==null&&r!==void 0?r:new Sl(t,n),this.isOwnVelocityDepthNormalPass=!i.velocityDepthNormalPass;const c=i.inputType==="diffuseSpecular"?2:1;this.temporalReprojectPass=new sy(t,n,this.velocityDepthNormalPass,o,c,{fullAccumulate:!0,logTransform:!0,copyTextures:!i.denoise,reprojectSpecular:[!1,!0],neighborhoodClamp:[!0,!0],neighborhoodClampRadius:2,neighborhoodClampIntensity:.5,...i});const l=this.temporalReprojectPass.renderTarget.texture.slice(0,c);if(this.options.denoiseMode==="full"||this.options.denoiseMode==="denoised"){var u;this.denoisePass=new Tl(n,l,i),this.denoisePass.setGBufferPass((u=i.gBufferPass)!==null&&u!==void 0?u:this.velocityDepthNormalPass),this.temporalReprojectPass.overrideAccumulatedTextures=this.denoisePass.renderTargetB.texture}const d=(s=(a=this.denoisePass)==null?void 0:a.texture)!==null&&s!==void 0?s:l;i.denoiseMode.startsWith("full")&&(this.denoiserComposePass=new zE(n,d,i.gBufferPass.texture,i.gBufferPass.renderTarget.depthTexture,i))}get texture(){switch(this.options.denoiseMode){case"full":case"full_temporal":return this.denoiserComposePass.texture;case"denoised":return this.denoisePass.texture;case"temporal":return this.temporalReprojectPass.texture}}reset(){this.temporalReprojectPass.reset()}setSize(t,n){var o,i;this.velocityDepthNormalPass.setSize(t,n),this.temporalReprojectPass.setSize(t,n),(o=this.denoisePass)==null||o.setSize(t,n),(i=this.denoiserComposePass)==null||i.setSize(t,n)}dispose(){var t,n;this.velocityDepthNormalPass.dispose(),this.temporalReprojectPass.dispose(),(t=this.denoisePass)==null||t.dispose(),(n=this.denoiserComposePass)==null||n.dispose()}render(t,n=null){var o,i;if(this.isOwnVelocityDepthNormalPass&&this.velocityDepthNormalPass.render(t),this.temporalReprojectPass.render(t),this.options.inputType!=="diffuseSpecular"){var r;(r=this.denoiserComposePass)==null||r.setSceneTexture(n.texture)}(o=this.denoisePass)==null||o.render(t),(i=this.denoiserComposePass)==null||i.render(t)}}class HE extends di{constructor(t){super("GBufferDebugPass"),this.renderTarget=new ki(1,1,{depthBuffer:!1,type:bt,minFilter:Oe,magFilter:Oe}),this.renderTarget.texture.name="GBufferDebugPass.Texture",this.fullscreenMaterial=new Vi({fragmentShader:`
            varying vec2 vUv;
            uniform highp sampler2D depthTexture;
			uniform int mode;

            #include <common>
            #include <packing>

            ${zr}

            void main() {
                highp float depth = textureLod(depthTexture, vUv, 0.).r;

				if(depth == 0.){
					gl_FragColor = vec4(0.);
					return;
				}

                Material mat = getMaterial(gBufferTexture, vUv);

                if (mode == 0) {
                    gl_FragColor = vec4(mat.diffuse.rgb, 1.);
                } else if (mode == 1) {
                    gl_FragColor = vec4(mat.diffuse.aaa, 1.);
                } else if (mode == 2) {
                    gl_FragColor = vec4(mat.normal, 1.);
                } else if (mode == 3) {
                    gl_FragColor = vec4(vec3(mat.roughness), 1.);
                } else if (mode == 4) {
                    gl_FragColor = vec4(vec3(mat.metalness), 1.);
                } else {
                    gl_FragColor = vec4(mat.emissive, 1.);
                }
            }
            `,vertexShader:Ur,uniforms:{gBufferTexture:{value:t},mode:{value:0}},blending:Xs,depthWrite:!1,depthTest:!1,toneMapped:!1})}get texture(){return this.renderTarget.texture}dispose(){this.renderTarget.dispose()}setSize(t,n){this.renderTarget.setSize(t,n)}render(t){t.setRenderTarget(this.renderTarget),t.render(this.scene,this.camera)}}const fy={mode:"ssgi",distance:10,thickness:10,denoiseIterations:1,denoiseKernel:2,denoiseDiffuse:10,denoiseSpecular:10,radius:3,phi:.5,lumaPhi:5,depthPhi:2,normalPhi:50,roughnessPhi:50,specularPhi:50,envBlur:.5,importanceSampling:!0,steps:20,refineSteps:5,resolutionScale:1,missedRays:!1,outputTexture:null};var qE=`#define GLSLIFY 1
uniform sampler2D inputTexture;uniform sampler2D sceneTexture;uniform highp sampler2D depthTexture;uniform bool isDebug;uniform float cameraNear;uniform float cameraFar;
#include <fog_pars_fragment>
float getViewZ(const in float depth){
#if PERSPECTIVE_CAMERA == 1
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){if(isDebug){outputColor=textureLod(inputTexture,uv,0.);return;}float depth=textureLod(depthTexture,uv,0.).r;vec3 ssgiClr;if(depth==1.0){ssgiClr=textureLod(sceneTexture,uv,0.).rgb;}else{ssgiClr=inputColor.rgb+textureLod(inputTexture,uv,0.).rgb;
#ifdef USE_FOG
float viewZ=getViewZ(depth)*0.4;vFogDepth=-viewZ;
#include <fog_fragment>
ssgiClr=mix(ssgiClr,fogColor,fogFactor);
#endif
}outputColor=vec4(ssgiClr,1.0);}`;const{render:Qm}=Xa.prototype,Jm=JT();class uh extends Ws{constructor(t,n,o,i){var r;i={...fy,...i};let s=qE.replace("#include <fog_pars_fragment>",me.fog_pars_fragment.replace("varying",""));s=s.replace("#include <fog_fragment>",me.fog_fragment.replace(/.*gl_FragColor.*/g,""));const a=new Map;if(n.fog&&a.set("USE_FOG",""),(r=n.fog)!=null&&r.isFogExp2&&a.set("FOG_EXP2",""),super("SSGIEffect",s,{type:"FinalSSGIMaterial",uniforms:new Map([["inputTexture",new j(null)],["sceneTexture",new j(null)],["depthTexture",new j(null)],["isDebug",new j(!1)],["fogColor",new j(new vt)],["fogNear",new j(0)],["fogFar",new j(0)],["fogDensity",new j(0)],["cameraNear",new j(0)],["cameraFar",new j(0)]]),defines:new Map([["PERSPECTIVE_CAMERA",o.isPerspectiveCamera?"1":"0"],...a])}),this.selection=new b3,this.isUsingRenderPass=!0,this._scene=n,this._camera=o,this.composer=t,i.mode==="ssr"?(i.reprojectSpecular=!0,i.neighborhoodClamp=!0,i.inputType="specular"):i.mode==="ssgi"&&(i.reprojectSpecular=[!1,!0],i.neighborhoodClamp=[!1,!0]),typeof i.preset=="string")switch(i.preset){case"low":i.steps=10,i.refineSteps=2,i.denoiseMode="full_temporal";break;case"medium":i.steps=20,i.refineSteps=4,i.denoiseMode="full";break;case"medium":i.steps=40,i.refineSteps=4,i.denoiseMode="full";break}this.ssgiPass=new SE(this,i),this.denoiser=new _E(n,o,this.ssgiPass.texture,{gBufferPass:this.ssgiPass.gBufferPass,velocityDepthNormalPass:i.velocityDepthNormalPass,...i}),this.lastSize={width:i.width,height:i.height,resolutionScale:i.resolutionScale},this.sceneRenderTarget=new ki(1,1,{colorSpace:Hu}),this.renderPass=new Xa(this._scene,this._camera),this.renderPass.renderToScreen=!1,this.setSize(i.width,i.height);const c=this,l=this.renderPass;Xa.prototype.render=function(...u){if(this!==l){const d=c.isUsingRenderPass;c.isUsingRenderPass=!0,d!=c.isUsingRenderPass&&c.updateUsingRenderPass()}Qm.call(this,...u)},this.makeOptionsReactive(i),this.outputTexture=this.denoiser.texture}updateUsingRenderPass(){this.isUsingRenderPass?this.ssgiPass.fullscreenMaterial.defines.useDirectLight="":delete this.ssgiPass.fullscreenMaterial.defines.useDirectLight,this.ssgiPass.fullscreenMaterial.needsUpdate=!0}reset(){this.denoiser.reset()}makeOptionsReactive(t){let n=!1;const o=this.ssgiPass.fullscreenMaterial.uniforms,i=Object.keys(o);for(const r of Object.keys(t))Object.defineProperty(this,r,{get(){return t[r]},set(s){var a;if(!(t[r]===s&&n))switch(t[r]=s,r){case"denoiseIterations":this.denoiser.denoisePass&&(this.denoiser.denoisePass.iterations=s);break;case"radius":case"phi":case"lumaPhi":case"depthPhi":case"normalPhi":case"roughnessPhi":case"specularPhi":(a=this.denoiser.denoisePass)!=null&&a.fullscreenMaterial.uniforms[r]&&(this.denoiser.denoisePass.fullscreenMaterial.uniforms[r].value=s,this.reset());break;case"denoiseIterations":case"radius":this.denoiser.denoisePass&&(this.denoiser.denoisePass[r]=s);break;case"resolutionScale":this.setSize(this.lastSize.width,this.lastSize.height),this.reset();break;case"steps":case"refineSteps":this.ssgiPass.fullscreenMaterial.defines[r]=parseInt(s),this.ssgiPass.fullscreenMaterial.needsUpdate=n,this.reset();break;case"importanceSampling":case"missedRays":s?this.ssgiPass.fullscreenMaterial.defines[r]="":delete this.ssgiPass.fullscreenMaterial.defines[r],this.ssgiPass.fullscreenMaterial.needsUpdate=n,this.reset();break;case"distance":o.rayDistance.value=s,this.reset();break;case"outputTexture":if(!this.outputTexture)return;if(typeof s=="string"){this.gBufferDebugPass===void 0&&(this.gBufferDebugPass=new HE(this.ssgiPass.gBufferPass.texture),this.gBufferDebugPass.setSize(this.lastSize.width,this.lastSize.height));const l=["diffuse","alpha","normal","roughness","metalness","emissive"].indexOf(s);this.gBufferDebugPass.fullscreenMaterial.uniforms.mode.value=l,this.outputTexture=this.gBufferDebugPass.texture}else this.gBufferDebugPass!==void 0&&this.outputTexture!==this.gBufferDebugPass.texture&&(this.gBufferDebugPass.dispose(),delete this.gBufferDebugPass);this.uniforms.get("isDebug").value=this.outputTexture!==this.denoiser.texture;break;default:i.includes(r)&&(o[r].value=s,this.reset())}}}),this[r]=t[r];n=!0}initialize(t,...n){super.initialize(t,...n),this.ssgiPass.initialize(t,...n)}setSize(t,n,o=!1){var i,r;t===void 0&&n===void 0||!o&&t===this.lastSize.width&&n===this.lastSize.height&&this.resolutionScale===this.lastSize.resolutionScale||(this.ssgiPass.setSize(t,n),this.denoiser.setSize(t,n),(i=this.gBufferDebugPass)==null||i.setSize(t,n),this.sceneRenderTarget.setSize(t,n),(r=this.cubeToEquirectEnvPass)==null||r.setSize(t,n),this.lastSize={width:t,height:n,resolutionScale:this.resolutionScale})}dispose(){var t;super.dispose(),this.ssgiPass.dispose(),this.denoiser.dispose(),(t=this.cubeToEquirectEnvPass)==null||t.dispose(),Xa.prototype.render=Qm}keepEnvMapUpdated(t){const n=this.ssgiPass.fullscreenMaterial;let o=this._scene.environment;if(o){if(n.uniforms.envMapInfo.value.mapUuid!==o.uuid){o.isCubeTexture&&(this.cubeToEquirectEnvPass||(this.cubeToEquirectEnvPass=new rE),o=this.cubeToEquirectEnvPass.generateEquirectEnvMap(t,o),o.uuid=this._scene.environment.uuid),o.generateMipmaps||(o.generateMipmaps=!0,o.minFilter=qu,o.magFilter=Wu,o.needsUpdate=!0),o.type===bt&&console.warn("SSGI: Environment map is FloatType, this causes the environment map to be black in the SSGI pass for many modern Apple devices. Please use HalfFloatType instead."),n.uniforms.envMapInfo.value.mapUuid=o.uuid;const i=QT(o);n.uniforms.maxEnvMapMipLevel.value=i,n.uniforms.envMapInfo.value.map=o,n.defines.USE_ENVMAP="",delete n.defines.importanceSampling,this.importanceSampling?n.uniforms.envMapInfo.value.updateFrom(o,t).then(()=>{n.defines.importanceSampling="",n.needsUpdate=!0}):n.uniforms.envMapInfo.value.map=o,this.reset(),n.needsUpdate=!0}}else"USE_ENVMAP"in n.defines&&(delete n.defines.USE_ENVMAP,delete n.defines.importanceSampling,n.needsUpdate=!0)}get depthTexture(){return this.ssgiPass.gBufferPass.depthTexture}update(t,n){var o,i;this.keepEnvMapUpdated(t);const r=this.isUsingRenderPass?n:this.sceneRenderTarget,s=[];if(!this.isUsingRenderPass){const a=[];for(const c of FE(this._scene)){if(c.isScene)return;c.visible=!ah(c),c.visible?s.push(c):a.push(c)}this.renderPass.render(t,this.sceneRenderTarget);for(const c of a)c.visible=!0;for(const c of s)c.visible=!1}this.ssgiPass.fullscreenMaterial.uniforms.directLightTexture.value=r.texture,this.ssgiPass.render(t),(o=this.gBufferDebugPass)==null||o.render(t),this.denoiser.render(t,n),this.uniforms.get("inputTexture").value=(i=this.outputTexture[0])!==null&&i!==void 0?i:this.outputTexture,this.uniforms.get("sceneTexture").value=r.texture,this.uniforms.get("depthTexture").value=this.ssgiPass.gBufferPass.depthTexture,this._scene.fog&&(this.uniforms.get("fogColor").value=this._scene.fog.color,this.uniforms.get("fogNear").value=this._scene.fog.near,this.uniforms.get("fogFar").value=this._scene.fog.far,this.uniforms.get("fogDensity").value=this._scene.fog.density,this.uniforms.get("cameraNear").value=this._camera.near,this.uniforms.get("cameraFar").value=this._camera.far);for(const a of s)a.visible=!0;Jm.value=!0,cancelAnimationFrame(this.rAF2),cancelAnimationFrame(this.rAF),cancelAnimationFrame(this.usingRenderPassRAF),this.rAF=requestAnimationFrame(()=>{this.rAF2=requestAnimationFrame(()=>{Jm.value=!1})}),this.usingRenderPassRAF=requestAnimationFrame(()=>{const a=this.isUsingRenderPass;this.isUsingRenderPass=!1,a!=this.isUsingRenderPass&&this.updateUsingRenderPass()})}}uh.DefaultOptions=fy;class WE extends uh{constructor(t,n,o,i={}){i.mode="ssr",super(t,n,o,i)}}var GE=`#define GLSLIFY 1
uniform sampler2D inputTexture;uniform highp sampler2D velocityTexture;uniform vec2 resolution;uniform float intensity;uniform float jitter;uniform float deltaTime;uniform int frame;uniform vec2 texSize;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 velocity=textureLod(velocityTexture,vUv,0.0).xy;bool didMove=dot(velocity,velocity)>0.000000001;if(!didMove){outputColor=inputColor;return;}velocity*=intensity;vec4 blueNoise=blueNoise(vUv,frame);vec2 jitterOffset=jitter*velocity*blueNoise.xy;float frameSpeed=(1./100.)/deltaTime;vec2 startUv=vUv+(jitterOffset-velocity*0.5)*frameSpeed;vec2 endUv=vUv+(jitterOffset+velocity*0.5)*frameSpeed;startUv=max(vec2(0.),startUv);endUv=min(vec2(1.),endUv);vec3 motionBlurredColor=inputColor.rgb;for(float i=0.0;i<=samplesFloat;i++){vec2 reprojectedUv=mix(startUv,endUv,i/samplesFloat);vec3 neighborColor=textureLod(inputTexture,reprojectedUv,0.0).rgb;motionBlurredColor+=neighborColor;}motionBlurredColor/=samplesFloat+2.;outputColor=vec4(motionBlurredColor,inputColor.a);}`;const $m={intensity:1,jitter:1,samples:16};class XE extends Ws{constructor(t,n=$m){n={...$m,...n};const{fragmentShader:o,uniforms:i}=lh(GE),r=[];for(const s of Object.keys(i))r.push([s,i[s]]);super("MotionBlurEffect",o,{type:"MotionBlurMaterial",uniforms:new Map([...r,["inputTexture",new j(null)],["velocityTexture",new j(t.texture)],["resolution",new j(new Me)],["intensity",new j(1)],["jitter",new j(1)],["frame",new j(0)],["deltaTime",new j(0)]]),defines:new Map([["samples",n.samples.toFixed(0)],["samplesFloat",n.samples.toFixed(0)+".0"]])}),this.pointsIndex=0,this.makeOptionsReactive(n)}makeOptionsReactive(t){for(const n of Object.keys(t))Object.defineProperty(this,n,{get(){return t[n]},set(o){switch(t[n]=o,n){case"intensity":case"jitter":this.uniforms.get(n).value=o;break}}}),this[n]=t[n]}initialize(t,...n){super.initialize(t,...n),new V1().load(ay,o=>{o.minFilter=Oe,o.magFilter=Oe,o.wrapS=hr,o.wrapT=hr,o.colorSpace=U1,this.uniforms.get("blueNoiseTexture").value=o})}update(t,n,o){this.uniforms.get("inputTexture").value=n.texture,this.uniforms.get("deltaTime").value=Math.max(1/1e3,o);const i=t.info.render.frame%4096;this.uniforms.get("frame").value=i,this.uniforms.get("resolution").value.set(window.innerWidth,window.innerHeight);const r=this.uniforms.get("blueNoiseTexture").value;if(r){const{width:s,height:a}=r.source.data;this.uniforms.get("blueNoiseSize").value.set(s,a)}}}var ZE=`#define GLSLIFY 1
uniform sampler2D inputTexture;uniform highp sampler2D depthTexture;uniform float power;uniform vec3 color;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float unpackedDepth=textureLod(depthTexture,uv,0.).r;float ao=unpackedDepth>0.9999 ? 1.0 : textureLod(inputTexture,uv,0.0).a;ao=pow(ao,power);vec3 aoColor=mix(color,vec3(1.),ao);aoColor*=inputColor.rgb;outputColor=vec4(aoColor,inputColor.a);}`;const Tf={resolutionScale:1,spp:8,distance:2,distancePower:1,power:2,bias:40,thickness:.075,color:new vt("black"),useNormalPass:!1,velocityDepthNormalPass:null,normalTexture:null,...Tl.DefaultOptions};class KE extends Ws{constructor(t,n,o,i,r=Tf){if(super("AOEffect",ZE,{type:"FinalAOMaterial",uniforms:new Map([["inputTexture",new j(null)],["depthTexture",new j(null)],["power",new j(0)],["color",new j(new vt("black"))]])}),this.lastSize={width:0,height:0,resolutionScale:0},this.composer=t,this.aoPass=i,r={...Tf,...r},t.depthTexture||t.createDepthTexture(),this.aoPass.fullscreenMaterial.uniforms.depthTexture.value=t.depthTexture,this.uniforms.get("depthTexture").value=t.depthTexture,r.useNormalPass||r.normalTexture){var s;r.useNormalPass&&(this.normalPass=new x3(o,n));const a=(s=r.normalTexture)!==null&&s!==void 0?s:this.normalPass.texture;this.aoPass.fullscreenMaterial.uniforms.normalTexture.value=a,this.aoPass.fullscreenMaterial.defines.useNormalTexture=""}this.PoissonDenoisePass=new Tl(n,this.aoPass.texture,t.depthTexture,{normalInRgb:!0}),this.makeOptionsReactive(r)}makeOptionsReactive(t){for(const n of Object.keys(t))Object.defineProperty(this,n,{get(){return t[n]},set(o){if(o!=null)switch(t[n]=o,n){case"spp":this.aoPass.fullscreenMaterial.defines.spp=o.toFixed(0),this.aoPass.fullscreenMaterial.needsUpdate=!0;break;case"distance":this.aoPass.fullscreenMaterial.uniforms.aoDistance.value=o;break;case"resolutionScale":this.setSize(this.lastSize.width,this.lastSize.height);break;case"power":this.uniforms.get("power").value=o;break;case"color":this.uniforms.get("color").value.copy(new vt(o));break;case"iterations":case"radius":case"rings":case"samples":this.PoissonDenoisePass[n]=o;break;case"lumaPhi":case"depthPhi":case"normalPhi":this.PoissonDenoisePass.fullscreenMaterial.uniforms[n].value=Math.max(o,1e-4);break;default:n in this.aoPass.fullscreenMaterial.uniforms&&(this.aoPass.fullscreenMaterial.uniforms[n].value=o)}},configurable:!0}),this[n]=t[n]}setSize(t,n){var o;t===void 0||n===void 0||t===this.lastSize.width&&n===this.lastSize.height&&this.resolutionScale===this.lastSize.resolutionScale||((o=this.normalPass)==null||o.setSize(t,n),this.aoPass.setSize(t*this.resolutionScale,n*this.resolutionScale),this.PoissonDenoisePass.setSize(t,n),this.lastSize={width:t,height:n,resolutionScale:this.resolutionScale})}get texture(){return this.iterations>0?this.PoissonDenoisePass.texture:this.aoPass.texture}update(t){var n;const o=this.composer.passes.some(i=>{var r;return i.enabled&&!i.skipRendering&&((r=i.effects)==null?void 0:r.some(s=>s instanceof ch))});o&&!("animatedNoise"in this.aoPass.fullscreenMaterial.defines)?(this.aoPass.fullscreenMaterial.defines.animatedNoise="",this.aoPass.fullscreenMaterial.needsUpdate=!0):!o&&"animatedNoise"in this.aoPass.fullscreenMaterial.defines&&(delete this.aoPass.fullscreenMaterial.defines.animatedNoise,this.aoPass.fullscreenMaterial.needsUpdate=!0),this.uniforms.get("inputTexture").value=this.texture,(n=this.normalPass)==null||n.render(t),this.aoPass.render(t),this.PoissonDenoisePass.render(t)}}KE.DefaultOptions=Tf;const Eo="MotionBlurEffect",YE=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K),s=se(n,qt),a=We(()=>new L4),c=We(new Sl(a,s));return We(!1),A.useEffect(()=>{o[Eo].value||o[Eo].set(r[Eo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Eo].value&&i[Eo].set(W);return}const l=new XE(c,o[Eo].value);return i[Eo].set(l),()=>{i[Eo].set(W)}},[t]),null},QE=()=>{Q(K).merge({[Eo]:{reactor:YE,defaultValues:{isActive:!1,intensity:1,jitter:1,samples:16},schema:{intensity:{propertyType:N.Number,name:"Intensity",min:0,max:10,step:.01},jitter:{propertyType:N.Number,name:"Jitter",min:0,max:10,step:.01},samples:{propertyType:N.Number,name:"Samples",min:1,max:64,step:1}}}})},Mo="NoiseEffect",JE=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Mo].value||o[Mo].set(r[Mo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Mo].value&&i[Mo].set(W);return}const s=new w3(o[Mo].value);return i[Mo].set(s),()=>{i[Mo].set(W)}},[t]),null},$E=()=>{Q(K).merge({[Mo]:{reactor:JE,defaultValues:{isActive:!1,blendFunction:ot.SCREEN,premultiply:!1},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},premultiply:{propertyType:N.Boolean,name:"Premultiply"}}}})},Po="PixelationEffect",e5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Po].value||o[Po].set(r[Po].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Po].value&&i[Po].set(W);return}const s=new S3(o[Po].granularity.value);return i[Po].set(s),()=>{i[Po].set(W)}},[t]),null},t5=()=>{Q(K).merge({[Po]:{reactor:e5,defaultValues:{isActive:!1,granularity:30},schema:{granularity:{propertyType:N.Number,name:"Granularity",min:0,max:1e3,step:1}}}})},No="SMAAEffect",n5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[No].value||o[No].set(r[No].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[No].value&&i[No].set(W);return}const s=new P3(o[No].granularity.value);return i[No].set(s),()=>{i[No].set(W)}},[t]),null},o5=()=>{Q(K).merge({[No]:{reactor:n5,defaultValues:{isActive:!1,preset:T3.MEDIUM,edgeDetectionMode:E3.COLOR,predicationMode:M3.DISABLED},schema:{preset:{propertyType:N.SMAAPreset,name:"Preset"}}}})},Ao="SSAOEffect",i5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Ao].value||o[Ao].set(r[Ao].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Ao].value&&i[Ao].set(W);return}const s=se(n,qt),a=new N3(s.value,o[Ao].value);return i[Ao].set(a),()=>{i[Ao].set(W)}},[t]),null},r5=()=>{Q(K).merge({[Ao]:{reactor:i5,defaultValues:{isActive:!1,blendFunction:ot.MULTIPLY,distanceScaling:!0,depthAwareUpsampling:!0,normalDepthBuffer:void 0,samples:9,rings:7,distanceThreshold:.97,distanceFalloff:.03,rangeThreshold:5e-4,rangeFalloff:.001,minRadiusScale:.1,luminanceInfluence:.7,bias:.025,radius:.1825,intensity:1,fade:.01,color:void 0,resolutionScale:1,resolutionX:$o.AUTO_SIZE,resolutionY:$o.AUTO_SIZE,width:$o.AUTO_SIZE,height:$o.AUTO_SIZE},schema:{preset:{propertyType:N.SMAAPreset,name:"Preset"}}}})},Co="SSGIEffect",s5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Co].value||o[Co].set(r[Co].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Co].value&&i[Co].set(W);return}const s=new uh(o[Co].value);return i[Co].set(s),()=>{i[Co].set(W)}},[t]),null},a5=()=>{Q(K).merge({[Co]:{reactor:s5,defaultValues:{isActive:!1,distance:10,thickness:10,denoiseIterations:1,denoiseKernel:2,denoiseDiffuse:10,denoiseSpecular:10,radius:3,phi:.5,lumaPhi:5,depthPhi:2,normalPhi:50,roughnessPhi:50,specularPhi:50,envBlur:.5,importanceSampling:!0,steps:20,refineSteps:5,resolutionScale:1,missedRays:!1},schema:{distance:{propertyType:N.Number,name:"Distance",min:.001,max:10,step:.01},thickness:{propertyType:N.Number,name:"Thickness",min:0,max:5,step:.01},denoiseIterations:{propertyType:N.Number,name:"Denoise Iterations",min:0,max:5,step:1},denoiseKernel:{propertyType:N.Number,name:"Denoise Kernel",min:1,max:5,step:1},denoiseDiffuse:{propertyType:N.Number,name:"Denoise Diffuse",min:0,max:50,step:.01},denoiseSpecular:{propertyType:N.Number,name:"Denoise Specular",min:0,max:50,step:.01},radius:{propertyType:N.Number,name:"Radius",min:0,max:50,step:.01},phi:{propertyType:N.Number,name:"Phi",min:0,max:50,step:.01},lumaPhi:{propertyType:N.Number,name:"Denoise Specular",min:0,max:50,step:.01},depthPhi:{propertyType:N.Number,name:"luminosity Phi",min:0,max:15,step:.001},normalPhi:{propertyType:N.Number,name:"Normal Phi",min:0,max:50,step:.001},roughnessPhi:{propertyType:N.Number,name:"Roughness Phi",min:0,max:100,step:.001},specularPhi:{propertyType:N.Number,name:"Specular Phi",min:0,max:50,step:.01},envBlur:{propertyType:N.Number,name:"Environment Blur",min:0,max:1,step:.01},importanceSampling:{propertyType:N.Boolean,name:"Importance Sampling"},steps:{propertyType:N.Number,name:"Steps",min:0,max:256,step:1},refineSteps:{propertyType:N.Number,name:"Refine Steps",min:0,max:16,step:1},resolutionScale:{propertyType:N.Number,name:"Resolution Scale",min:.25,max:1,step:.25},missedRays:{propertyType:N.Boolean,name:"Missed Rays"}}}})},Lo="SSREffect",c5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i,composer:r,scene:s}=e,a=B(K),c=se(n,qt),l=We(new Sl(s,c));return A.useEffect(()=>{o[Lo].value||o[Lo].set(a[Lo].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Lo].value&&i[Lo].set(W);return}const u=new WE(r,s,c.value,{...o[Lo].value,velocityDepthNormalPass:l});return i[Lo].set(u),()=>{i[Lo].set(W)}},[t]),null},l5=()=>{Q(K).merge({[Lo]:{reactor:c5,defaultValues:{isActive:!1,distance:10,thickness:10,denoiseIterations:1,denoiseKernel:2,denoiseDiffuse:10,denoiseSpecular:10,radius:3,phi:.5,lumaPhi:5,depthPhi:2,normalPhi:50,roughnessPhi:50,specularPhi:50,envBlur:.5,importanceSampling:!0,steps:20,refineSteps:5,resolutionScale:1,missedRays:!1},schema:{distance:{propertyType:N.Number,name:"Distance",min:.001,max:10,step:.01},thickness:{propertyType:N.Number,name:"Thickness",min:0,max:5,step:.01},denoiseIterations:{propertyType:N.Number,name:"Denoise Iterations",min:0,max:5,step:1},denoiseKernel:{propertyType:N.Number,name:"Denoise Kernel",min:1,max:5,step:1},denoiseDiffuse:{propertyType:N.Number,name:"Denoise Diffuse",min:0,max:50,step:.01},denoiseSpecular:{propertyType:N.Number,name:"Denoise Specular",min:0,max:50,step:.01},radius:{propertyType:N.Number,name:"Radius",min:0,max:50,step:.01},phi:{propertyType:N.Number,name:"Phi",min:0,max:50,step:.01},lumaPhi:{propertyType:N.Number,name:"Denoise Specular",min:0,max:50,step:.01},depthPhi:{propertyType:N.Number,name:"luminosity Phi",min:0,max:15,step:.001},normalPhi:{propertyType:N.Number,name:"Normal Phi",min:0,max:50,step:.001},roughnessPhi:{propertyType:N.Number,name:"Roughness Phi",min:0,max:100,step:.001},specularPhi:{propertyType:N.Number,name:"Specular Phi",min:0,max:50,step:.01},envBlur:{propertyType:N.Number,name:"Environment Blur",min:0,max:1,step:.01},importanceSampling:{propertyType:N.Boolean,name:"Importance Sampling"},steps:{propertyType:N.Number,name:"Steps",min:0,max:256,step:1},refineSteps:{propertyType:N.Number,name:"Refine Steps",min:0,max:16,step:1},resolutionScale:{propertyType:N.Number,name:"Resolution Scale",min:.25,max:1,step:.25},missedRays:{propertyType:N.Boolean,name:"Missed Rays"}}}})},Do="ScanlineEffect",u5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Do].value||o[Do].set(r[Do].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Do].value&&i[Do].set(W);return}const s=new A3(o[Do].value);return i[Do].set(s),()=>{i[Do].set(W)}},[t]),null},f5=()=>{Q(K).merge({[Do]:{reactor:u5,defaultValues:{isActive:!1,blendFunction:ot.OVERLAY,density:1.25,scrollSpeed:0},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},density:{propertyType:N.Number,name:"Density",min:0,max:10,step:.05},scrollSpeed:{propertyType:N.Number,name:"Scroll Speed",min:0,max:10,step:.05}}}})},Io="ShockWaveEffect",d5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Io].value||o[Io].set(r[Io].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Io].value&&i[Io].set(W);return}const s=new C3(o[Io].value);return i[Io].set(s),()=>{i[Io].set(W)}},[t]),null},h5=()=>{Q(K).merge({[Io]:{reactor:d5,defaultValues:{isActive:!1,position:new P(0,0,0),speed:2,maxRadius:1,waveSize:.2,amplitude:.05},schema:{position:{propertyType:N.Vector3,name:"Position"},speed:{propertyType:N.Number,name:"Speed",min:0,max:10,step:.05},maxRadius:{propertyType:N.Number,name:"Max Radius",min:0,max:10,step:.05},waveSize:{propertyType:N.Number,name:"Wave Size",min:0,max:10,step:.05},amplitude:{propertyType:N.Number,name:"Amplitude",min:0,max:10,step:.05}}}})},_n="TRAAEffect",p5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i,scene:r}=e,s=B(K),a=se(n,qt),c=We(new Sl(r,a));return A.useEffect(()=>{o[_n].value||o[_n].set(s[_n].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[_n].value&&i[_n].set(W);return}const l=1,u=new ch(r,a.value,c,l,o[_n].value);return i[_n].set(u),()=>{i[_n].set(W)}},[t,o[_n],r,c]),null},m5=()=>{Q(K).merge({[_n]:{reactor:p5,defaultValues:{isActive:!1,blend:.8,constantBlend:!0,dilation:!0,blockySampling:!1,logTransform:!1,depthDistance:10,worldDistance:5,neighborhoodClamping:!0},schema:{blend:{propertyType:N.Number,name:"Blend",min:0,max:1,step:.001},constantBlend:{propertyType:N.Boolean,name:"Constant Blend"},dilation:{propertyType:N.Boolean,name:"Dilation"},blockySampling:{propertyType:N.Boolean,name:"Blocky Sampling"},logTransform:{propertyType:N.Boolean,name:"Log Transform"},depthDistance:{propertyType:N.Number,name:"Depth Distance",min:.01,max:100,step:.01},worldDistance:{propertyType:N.Number,name:"World Distance",min:.01,max:100,step:.01},neighborhoodClamping:{propertyType:N.Boolean,name:"Neighborhood Clamping"}}}})},Cn="TextureEffect",g5=e=>{var c;const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K),[s,a]=Ii((c=o[Cn].value)==null?void 0:c.texturePath);return A.useEffect(()=>{o[Cn].value||o[Cn].set(r[Cn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Cn].value&&i[Cn].set(W);return}if(s){let l=o[Cn].get(dr);l.texture=s;const u=new L3(l);i[Cn].set(u)}return()=>{i[Cn].set(W)}},[t,o[Cn],s]),null},v5=()=>{Q(K).merge({[Cn]:{reactor:g5,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,texturePath:void 0,texture:void 0,aspectCorrection:!1},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},texturePath:{propertyType:N.Texture,name:"Texture"},aspectCorrection:{propertyType:N.Boolean,name:"Aspect Correction"}}}})},Hn="TiltShiftEffect",y5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Hn].value||o[Hn].set(r[Hn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Hn].value&&i[Hn].set(W);return}const s=new D3(o[Hn].value);return i[Hn].set(s),()=>{i[Hn].set(W)}},[t,o[Hn]]),null},b5=()=>{Q(K).merge({[Hn]:{reactor:y5,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,offset:0,rotation:0,focusArea:.4,feather:.3,kernelSize:y1.MEDIUM,resolutionScale:.5,resolutionX:$o.AUTO_SIZE,resolutionY:$o.AUTO_SIZE},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},offset:{propertyType:N.Number,name:"Offset",min:0,max:10,step:.1},rotation:{propertyType:N.Number,name:"Rotation",min:0,max:360,step:.1},focusArea:{propertyType:N.Number,name:"Focus Area",min:0,max:10,step:.1},feather:{propertyType:N.Number,name:"Feather",min:0,max:10,step:.1},kernelSize:{propertyType:N.KernelSize,name:"KernelSize"},resolutionScale:{propertyType:N.Number,name:"Resolution Scale",min:0,max:10,step:.1}}}})},qn="ToneMappingEffect",x5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[qn].value||o[qn].set(r[qn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[qn].value&&i[qn].set(W);return}const s=new F3(o[qn].value);return i[qn].set(s),()=>{i[qn].set(W)}},[t,o[qn]]),null},w5=()=>{Q(K).merge({[qn]:{reactor:x5,defaultValues:{isActive:!1,blendFunction:ot.SRC,adaptive:!1,mode:I3.AGX,resolution:256,maxLuminance:4,whitePoint:4,middleGrey:.6,minLuminance:.01,averageLuminance:1,adaptationRate:1},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},adaptive:{propertyType:N.Boolean,name:"Adaptive"},adaptationRate:{propertyType:N.Number,name:"Adaptation Rate",min:-1,max:1,step:.01},averageLuminance:{propertyType:N.Number,name:"Average Luminance",min:-1,max:1,step:.01},maxLuminance:{propertyType:N.Number,name:"Max Luminance",min:-1,max:1,step:.01},middleGrey:{propertyType:N.Number,name:"Middle Grey",min:-1,max:1,step:.01},resolution:{propertyType:N.Number,name:"Resolution"},whitePoint:{propertyType:N.Number,name:"Resolution"},minLuminance:{propertyType:N.Number,name:"Resolution"}}}})},Wn="VignetteEffect",S5=e=>{const{isActive:t,rendererEntity:n,effectData:o,effects:i}=e,r=B(K);return A.useEffect(()=>{o[Wn].value||o[Wn].set(r[Wn].defaultValues)},[]),A.useEffect(()=>{if(!(t!=null&&t.value)){i[Wn].value&&i[Wn].set(W);return}const s=new O3(o[Wn].value);return i[Wn].set(s),()=>{i[Wn].set(W)}},[t,o[Wn]]),null},T5=()=>{Q(K).merge({[Wn]:{reactor:S5,defaultValues:{isActive:!1,blendFunction:ot.NORMAL,technique:R3.DEFAULT,eskil:!1,offset:.5,darkness:.5},schema:{blendFunction:{propertyType:N.BlendFunction,name:"Blend Function"},technique:{propertyType:N.VignetteTechnique,name:"Technique"},eskil:{propertyType:N.Boolean,name:"Eskil"},offset:{propertyType:N.Number,name:"Offset",min:0,max:10,step:.1},darkness:{propertyType:N.Number,name:"Darkness",min:0,max:10,step:.1}}}})},E5=()=>{pT(),gT(),yT(),xT(),ST(),ET(),PT(),AT(),LT(),IT(),RT(),BT(),qT(),kT(),UT(),QE(),$E(),t5(),f5(),h5(),o5(),r5(),l5(),a5(),v5(),b5(),w5(),m5(),T5()};ee({uuid:"ee.engine.PostProcessingRegisterSystem",insert:{before:Yt},reactor:()=>(A.useEffect(()=>E5(),[]),null)});const M5=`
//
// Description : Array and textureless GLSL 2D/3D/4D simplex
//               noise functions.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : stegu
//     Lastmod : 20201014 (stegu)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//               https://github.com/stegu/webgl-noise
//
vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x) {
     return mod289(((x*34.0)+1.0)*x);
}
vec4 taylorInvSqrt(vec4 r)
{
  return 1.79284291400159 - 0.85373472095314 * r;
}
float snoise(vec3 v)
{
  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
// First corner
  vec3 i  = floor(v + dot(v, C.yyy) );
  vec3 x0 =   v - i + dot(i, C.xxx) ;
// Other corners
  vec3 g = step(x0.yzx, x0.xyz);
  vec3 l = 1.0 - g;
  vec3 i1 = min( g.xyz, l.zxy );
  vec3 i2 = max( g.xyz, l.zxy );
  //   x0 = x0 - 0.0 + 0.0 * C.xxx;
  //   x1 = x0 - i1  + 1.0 * C.xxx;
  //   x2 = x0 - i2  + 2.0 * C.xxx;
  //   x3 = x0 - 1.0 + 3.0 * C.xxx;
  vec3 x1 = x0 - i1 + C.xxx;
  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y
  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y
// Permutations
  i = mod289(i);
  vec4 p = permute( permute( permute(
             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
// Gradients: 7x7 points over a square, mapped onto an octahedron.
// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)
  float n_ = 0.142857142857; // 1.0/7.0
  vec3  ns = n_ * D.wyz - D.xzx;
  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)
  vec4 x_ = floor(j * ns.z);
  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
  vec4 x = x_ *ns.x + ns.yyyy;
  vec4 y = y_ *ns.x + ns.yyyy;
  vec4 h = 1.0 - abs(x) - abs(y);
  vec4 b0 = vec4( x.xy, y.xy );
  vec4 b1 = vec4( x.zw, y.zw );
  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;
  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;
  vec4 s0 = floor(b0)*2.0 + 1.0;
  vec4 s1 = floor(b1)*2.0 + 1.0;
  vec4 sh = -step(h, vec4(0.0));
  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
  vec3 p0 = vec3(a0.xy,h.x);
  vec3 p1 = vec3(a0.zw,h.y);
  vec3 p2 = vec3(a1.xy,h.z);
  vec3 p3 = vec3(a1.zw,h.w);
//Normalise gradients
  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
  p0 *= norm.x;
  p1 *= norm.y;
  p2 *= norm.z;
  p3 *= norm.w;
// Mix final noise value
  vec4 m = max(0.5 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
  m = m * m;
  return 105.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),
                                dot(p2,x2), dot(p3,x3) ) );
}
float FBM(vec3 p) {
  float value = 0.0;
  float amplitude = 0.5;
  float frequency = 0.0;
  for (int i = 0; i < 6; ++i) {
    value += amplitude * snoise(p);
    p *= 2.0;
    amplitude *= 0.5;
  }
  return value;
}
`,ln={fog_fragment:{default:me.fog_fragment,brownianMotionFog:`#ifdef USE_FOG
        vec3 fogOrigin = cameraPosition;
        vec3 fogDirection = normalize(fogWorldPosition - fogOrigin);
        float fogDepth = myDistance(fogWorldPosition, fogOrigin);
        // f(p) = fbm( p + fbm( p ) )
        vec3 noiseSampleCoord = fogWorldPosition * 0.00025 + vec3(
            0.0, 0.0, fogTime * fogTimeScale * 0.025);
        float noiseSample = FBM(noiseSampleCoord + FBM(noiseSampleCoord)) * 0.5 + 0.5;
        fogDepth *= mix(noiseSample, 1.0, saturate((fogDepth - 5000.0) / 5000.0));
        fogDepth *= fogDepth;
        float fogFactor = heightFactor * exp(-fogOrigin.y * fogDensity) * (
            1.0 - exp(-fogDepth * fogDirection.y * fogDensity)) / fogDirection.y;
        fogFactor = saturate(fogFactor);
        gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
      #endif`,heightFog:`
      #ifdef USE_FOG
        vec3 fogOrigin = cameraPosition;
        vec3 fogDirection = normalize(fogWorldPosition - fogOrigin);
        float fogDepth = myDistance(fogWorldPosition, fogOrigin);

        float fogFactor = heightFactor * exp(-fogOrigin.y * fogDensity) * (
            1.0 - exp(-fogDepth * fogDirection.y * fogDensity)) / fogDirection.y;
        fogFactor = saturate(fogFactor);
        gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
      #endif`},fog_pars_fragment:{default:me.fog_pars_fragment,brownianMotionFog:M5+`
      float myDistance(vec3 a, vec3 b) {
        return length(a - b);
      } 
      #ifdef USE_FOG
        uniform float fogTime;
        uniform float fogTimeScale;
        uniform vec3 fogColor;
        varying vec3 fogWorldPosition;
        #ifdef FOG_EXP2
          uniform float fogDensity;
          uniform float heightFactor;
        #else
          uniform float fogNear;
          uniform float fogFar;
        #endif
      #endif`,heightFog:`
      float myDistance(vec3 a, vec3 b) {
        return length(a - b);
      }
      #ifdef USE_FOG
        uniform vec3 fogColor;
        varying vec3 fogWorldPosition;
        #ifdef FOG_EXP2
          uniform float fogDensity;
          uniform float heightFactor;
        #else
          uniform float fogNear;
          uniform float fogFar;
        #endif
      #endif`},fog_vertex:{default:me.fog_vertex,brownianMotionFog:`
      #ifdef USE_FOG
        fogWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz; // From local position to global position
      #endif`,heightFog:`
      #ifdef USE_FOG
        fogWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz; // From local position to global position
      #endif`},fog_pars_vertex:{default:me.fog_pars_vertex,brownianMotionFog:`
      #ifdef USE_FOG
        varying vec3 fogWorldPosition;
      #endif`,heightFog:`
      #ifdef USE_FOG
        varying vec3 fogWorldPosition;
      #endif`}};function P5(){me.fog_pars_vertex=ln.fog_pars_vertex.brownianMotionFog,me.fog_vertex=ln.fog_vertex.brownianMotionFog,me.fog_pars_fragment=ln.fog_pars_fragment.brownianMotionFog,me.fog_fragment=ln.fog_fragment.brownianMotionFog}function N5(){me.fog_fragment=ln.fog_fragment.heightFog,me.fog_pars_fragment=ln.fog_pars_fragment.heightFog,me.fog_vertex=ln.fog_vertex.heightFog,me.fog_pars_vertex=ln.fog_pars_vertex.heightFog}function Ca(){me.fog_pars_fragment=ln.fog_pars_fragment.default,me.fog_pars_vertex=ln.fog_pars_vertex.default,me.fog_fragment=ln.fog_fragment.default,me.fog_vertex=ln.fog_vertex.default}var Dc=(e=>(e.Disabled="disabled",e.Linear="linear",e.Exponential="exponential",e.Brownian="brownian",e.Height="height",e))(Dc||{});const fh=yt({name:"FogSettingsComponent",jsonID:"EE_fog",schema:_.Object({type:_.Enum(Dc,"disabled"),color:_.String("#FFFFFF"),density:_.Number(.005),near:_.Number(1),far:_.Number(1e3),timeScale:_.Number(1),height:_.Number(.05)}),reactor:()=>{const e=je(),t=se(e,fh),n=Zn(e,yn);return A.useEffect(()=>{if(!n)return;const o=t.value;switch(o.type){case"linear":O(e,$t,new D4(o.color,o.near,o.far)),Ca();break;case"exponential":O(e,$t,new _l(o.color,o.density)),Ca();break;case"brownian":O(e,$t,new _l(o.color,o.density)),P5();break;case"height":O(e,$t,new _l(o.color,o.density)),N5();break;default:Ca(),Qe(e,$t);break}return()=>{Ca(),Qe(e,$t)}},[t.type,n]),A.useEffect(()=>{var o;(o=ue(e,$t))==null||o.color.set(t.color.value)},[t.color]),A.useEffect(()=>{const o=ue(e,$t);o&&t.type.value!=="linear"&&(o.density=t.density.value)},[t.density]),A.useEffect(()=>{const o=ue(e,$t);o&&(o.near=t.near.value)},[t.near]),A.useEffect(()=>{const o=ue(e,$t);o&&(o.far=t.far.value)},[t.far]),A.useEffect(()=>{if(ue(e,$t)&&(t.type.value==="brownian"||t.type.value==="height"))for(const i of Er)i.uniforms.heightFactor.value=t.height.value},[t.height]),A.useEffect(()=>{if(ue(e,$t)&&t.type.value==="brownian")for(const i of Er)i.uniforms.fogTimeScale.value=t.timeScale.value},[t.timeScale]),null}}),Er=[],A5=()=>({id:"ee.engine.FogPlugin",priority:0,compile:e=>{Er.push(e),e.uniforms.fogTime={value:0},e.uniforms.fogTimeScale={value:1},e.uniforms.heightFactor={value:.05}}});function C5(e){!e.material||!e.material.fog||e.material.userData.fogPlugin||(e.material.userData.fogPlugin=A5(),Jf(e.material,e.material.userData.fogPlugin),e.material.needsUpdate=!0)}function L5(e){var n,o;if(!((o=(n=e.material)==null?void 0:n.userData)!=null&&o.fogPlugin))return;b1(e.material,e.material.userData.fogPlugin),delete e.material.userData.fogPlugin,e.material.needsUpdate=!0;const t=e.material.shader;Er.splice(Er.indexOf(t),1)}function D5(e){const t=je(),n=se(e.fogEntity,fh),o=se(t,mt);return A.useEffect(()=>{if(n.type.value===Dc.Brownian||n.type.value===Dc.Height){const r=[...o.value];for(const s of r)C5(s);return()=>{for(const s of r)L5(s)}}},[n.type,o]),null}const I5=()=>{const e=je();return te.createElement(Xt,{ChildEntityReactor:D5,Components:[mt,yn],props:{fogEntity:e}})},F5=()=>te.createElement(Xt,{ChildEntityReactor:I5,Components:[fh]}),R5=()=>{for(const e of Er)e.uniforms.fogTime&&(e.uniforms.fogTime.value=B(ht).elapsedSeconds)};ee({uuid:"ee.engine.FogSystem",insert:{after:Yt},execute:R5,reactor:F5});const O5=ie([F1]),k5=()=>{var n,o;if(B(io).isEditing)return;const e=he.getSelfAvatarEntity(),t=ue(e,$a);t&&((n=t.sitting)!=null&&n.begun&&Bl.mountEntity(e,B(k3).available[0]),(o=t.standing)!=null&&o.begun&&Bl.unmountEntity(e));for(const i of O5()){if(M(i,Kn).gamepadLocalInput.lengthSq()>.01){Bl.unmountEntity(i);continue}const s=M(M(i,F1).mountPointEntity,q);s.matrixWorld.decompose(fu,V5,U5);const a=M(i,On);fu.y-=a.normalizedRig.hips.node.position.y-.25,O(i,q,{rotation:s.rotation,position:fu}),de(i,z)}},fu=new P,V5=new re,U5=new P;ee({uuid:"ee.engine.MountPointSystem",insert:{with:e1},execute:k5});const z5=()=>(A.useEffect(()=>{V3.map((t,n)=>U3(t));const e=new ri({name:"Fallback Material",color:16738740});e.uuid=Uu.fallbackMaterial,x1(Li,e)},[]),te.createElement(te.Fragment,null,te.createElement(Xt,{Components:[qs],ChildEntityReactor:_5}),te.createElement(Xt,{Components:[Uu],ChildEntityReactor:j5}),te.createElement(Xt,{Components:[Ye],ChildEntityReactor:B5}))),B5=()=>{const e=je(),t=Zn(e,qs),n=se(e,Ye),o=i=>{const r=x1(e,i),s=ue(e,Jo);s&&O(r,Jo,s)};return A.useEffect(()=>{if(t)return;const i=n.material.value;if(!oi.isArray(i))o(i);else for(const r of i)o(r)},[]),null},j5=()=>{const e=je(),t=se(e,Uu);return A.useEffect(()=>{var n;if(t.instances.value)for(const o of t.instances.value){const i=ue(o,Jo);if(!i||!Jo.entitiesBySource[i])return;for(const r of Jo.entitiesBySource[M(o,Jo)]){const s=(n=ue(r,qs))==null?void 0:n.uuid;s&&w1(r,s)}}},[t.material]),A.useEffect(()=>{t.prototypeEntity.value&&!z3(e)&&B3(e)},[t.prototypeEntity]),A.useEffect(()=>{var n;((n=t.instances.value)==null?void 0:n.length)===0&&Gt(e)},[t.instances]),null},_5=()=>{const e=je(),t=se(e,qs),n=t.uuid;return A.useEffect(()=>{n.value&&w1(e,n.value)},[t.uuid]),null};ee({uuid:"ee.engine.scene.MaterialLibrarySystem",insert:{after:Yt},reactor:z5});const H5=yt({name:"GroundPlaneComponent",jsonID:"EE_ground_plane",schema:_.Object({color:_.Color(16777215),visible:_.Bool(!0)}),onInit(e){return{color:16777215,visible:!0}},onSet(e,t,n){n&&(j3.test(n.color)&&t.color.set(n.color),dt.boolean.test(n.visible)&&t.visible.set(n.visible))},toJSON:e=>({color:e.color,visible:e.visible}),reactor:function(){const e=je(),t=se(e,H5),n=()=>t.visible.value?new _1:new I4({opacity:.5}),o=S1(e,()=>new As(1e4,1e4),n);return A.useLayoutEffect(()=>{const i=o.value;return i.geometry.rotateX(-Math.PI/2),i.name="GroundPlaneMesh",i.material.polygonOffset=!0,i.material.polygonOffsetFactor=-.01,i.material.polygonOffsetUnits=1,O(e,H3,_3.Scene),O(e,Tt,{type:Ro.Fixed}),O(e,gs,{shape:q3.Plane,collisionLayer:Ei.Ground,collisionMask:Ei.Default|Ei.Avatars}),()=>{Qe(e,Tt),Qe(e,gs)}},[]),A.useLayoutEffect(()=>{const i=t.color.value;o.material.color.value!=i&&o.material.color.value.set(t.color.value)},[t.color]),A.useLayoutEffect(()=>{const i=n();i.color.set(t.color.value),o.material.set(i)},[t.visible]),null}}),q5="Hyperspace";class W5 extends $c{constructor(n){super();F(this,"curve");F(this,"splineMesh");F(this,"tubeMaterial");F(this,"tubeGeometry");F(this,"tubeMesh");F(this,"numPoints",200);F(this,"portalEntity");this.name="PortalEffect",this.createMesh();const o=this.portalEntity=It();O(o,at,this.name),O(o,Lt,{parentEntity:n}),O(o,yn,!0),Rt(o,this.tubeMesh),this.tubeMesh.layers.set(Dn.Portal)}get texture(){return this.tubeMaterial.map}set texture(n){this.tubeMaterial.map=n,this.tubeMaterial.map&&(this.tubeMaterial.map.wrapS=ap,this.tubeMaterial.map.wrapT=ap,this.tubeMaterial.map.repeat&&this.tubeMaterial.map.repeat.set(1,10))}createMesh(){const n=[];for(let u=0;u<this.numPoints;u+=1)n.push(new P(0,0,u));this.curve=new R4(n);const o=new Cr,i=new Float32Array(this.curve.getPoints(this.numPoints).map(u=>u.toArray()).flat());o.setAttribute("position",new Jn(i,3)),this.splineMesh=new R1(o,new Gs),this.tubeMaterial=new ri({side:H1,transparent:!0,opacity:0});const r=24,s=this.numPoints/10;this.tubeGeometry=new O4(this.curve,s,2,r,!1);const a=this.tubeGeometry.getAttribute("position"),c=5,l=this.numPoints/s;for(let u=0;u<r*c;u++){const d=(l*c-a.getZ(u))*.1;a.setX(u,a.getX(u)*d),a.setY(u,a.getY(u)*d)}this.tubeMesh=new Qn(this.tubeGeometry,this.tubeMaterial),this.tubeMesh.position.set(-.5,0,-15)}updateMaterialOffset(n){this.tubeMaterial.map&&(this.tubeMaterial.map.offset.x+=n)}update(n){this.updateMaterialOffset(n)}}const or=yt({name:"HyperspaceTagComponent",schema:_.Object({sceneVisible:_.Bool(!0),transition:W3(d1(.5,"OUT"))}),reactor:()=>{const e=je(),[t]=Ii(`${B(Yf).cloudDomain}/projects/ir-engine/default-project/assets/galaxyTexture.jpg`,e),n=We(It),o=We(It);return A.useEffect(()=>{const i=n.value,r=o.value,s=new W5(i);Rt(i,s),Vu(s,Dn.Portal),M(i,q).scale.set(10,10,10),O(i,Lt,{parentEntity:e}),O(i,yn);const a=new F4("#aaa");a.layers.enable(Dn.Portal),Rt(r,a),O(r,Lt,{parentEntity:i}),O(r,yn),M(e,or).transition.setState("IN");const l=M(ye.instance.cameraEntity,q),u=M(ye.instance.cameraEntity,qt);return u.layers.enable(Dn.Portal),u.zoom=1.5,s.quaternion.setFromUnitVectors(Y1.Forward,new P(0,0,1).applyQuaternion(l.rotation).setY(0).normalize()),()=>{Gt(r),G3(i)}},[]),A.useEffect(()=>{if(!t)return;const i=n.value,r=M(i,mt)[0];r.texture=t},[t]),t1(()=>{if(!de(e,or))return;const i=n.value;if(!i)return;const{transition:r}=M(e,or),s=M(i,mt)[0],a=M(ye.instance.cameraEntity,q),c=M(ye.instance.cameraEntity,qt),l=B(ht);r.alpha>=1&&r.state==="IN"&&(r.setState("OUT"),c.layers.enable(Dn.Scene)),r.update(l.deltaSeconds,d=>{s.update(l.deltaSeconds),s.tubeMaterial.opacity=d});const u=gt(e,or).sceneVisible;if(r.state==="IN"&&r.alpha>=1&&u.value){Q(ir).portalReady.set(!0);const d=M(B(ir).activePortalEntity,Q1);ed(he.getSelfAvatarEntity(),d.remoteSpawnPosition,!0),c.layers.disable(Dn.Scene),u.set(!1)}if(r.state==="OUT"&&r.alpha<=0&&!u.value){u.set(!0),Qe(e,or),Q(ir).activePortalEntity.set(Li),Q(ir).portalReady.set(!1),c.layers.disable(Dn.Portal);return}M(i,q).position.copy(a.position),c.zoom>.75&&(c.zoom-=l.deltaSeconds,c.updateProjectionMatrix())},{after:Yt}),null}});ub.set(q5,or);const eg=yt({name:"OldColliderComponent",jsonID:"collider",onInit(e){return{bodyType:zn.Fixed,shapeType:Vl.Cuboid,isTrigger:!1,removeMesh:!1,collisionLayer:Ei.Default,collisionMask:X3,restitution:.5,triggers:[{onEnter:null,onExit:null,target:null}]}},onSet(e,t,n){if(!n)return;typeof n.bodyType=="number"&&t.bodyType.set(n.bodyType),typeof n.shapeType=="number"&&t.shapeType.set(n.shapeType),(typeof n.isTrigger=="boolean"||typeof n.isTrigger=="number")&&t.isTrigger.set(!!n.isTrigger),(typeof n.removeMesh=="boolean"||typeof n.removeMesh=="number")&&t.removeMesh.set(!!n.removeMesh),typeof n.collisionLayer=="number"&&t.collisionLayer.set(n.collisionLayer),typeof n.collisionMask=="number"&&t.collisionMask.set(n.collisionMask),typeof n.restitution=="number"&&t.restitution.set(n.restitution);const o=n.onEnter??null,i=n.onExit??null,r=n.target??null;o||i||r?t.triggers.set([{onEnter:o,onExit:i,target:r}]):typeof n.triggers=="object"&&dt.arrayOf(dt.shape({onEnter:dt.nill.orParser(dt.string),onExit:dt.nill.orParser(dt.string),target:dt.nill.orParser(dt.string)})).test(n.triggers)&&t.triggers.set(n.triggers)},toJSON:e=>({bodyType:e.bodyType,shapeType:e.shapeType,isTrigger:e.isTrigger,removeMesh:e.removeMesh,collisionLayer:e.collisionLayer,collisionMask:e.collisionMask,restitution:e.restitution,triggers:e.triggers}),reactor:function(){const e=je(),t=se(e,q),n=se(e,eg),o=Zn(e,Y3),i=Zn(e,mt),r=Z3(e);return A.useLayoutEffect(()=>{O(e,Mi);const s=[Vl.TriMesh,Vl.ConvexPolyhedron].includes(n.shapeType.value);if(o!=null&&o.value||s){const a=M(e,eg);zu(e,p1),de(e,mt)&&K3(e);const c={bodyType:a.bodyType,shapeType:a.shapeType,isTrigger:a.isTrigger,collisionLayer:a.collisionLayer,collisionMask:a.collisionMask,restitution:a.restitution},l=typeof a.bodyType=="string"?zn[a.bodyType]:a.bodyType;let u;switch(l){default:case zn.Fixed:u=Ro.Fixed;break;case zn.Dynamic:u=Ro.Dynamic;break;case zn.KinematicPositionBased:case zn.KinematicVelocityBased:u=Ro.Kinematic;break}O(e,Tt,{type:u}),zu(e,d=>{const f=ue(d,Ye);if(!f)return;f.userData.type&&f.userData.type!=="glb"&&(f.userData.shapeType=f.userData.type);const h={...c,...f.userData};h.shapeType&&(h.shape=Qh[h.shapeType]),h.isTrigger&&O(d,Ul),O(d,gs,h)})}else{let a;switch(n.bodyType.value){default:case zn.Fixed:a=Ro.Fixed;break;case zn.Dynamic:a=Ro.Dynamic;break;case zn.KinematicPositionBased:case zn.KinematicVelocityBased:a=Ro.Kinematic;break}O(e,Tt,{type:a}),Qe(e,gs),O(e,gs,{shape:Qh[n.shapeType.value],collisionLayer:n.collisionLayer.value,collisionMask:n.collisionMask.value,restitution:n.restitution.value}),n.isTrigger.value?O(e,Ul):Qe(e,Ul)}},[o,n,t,i==null?void 0:i.length,r]),null}});var Ef=(e=>(e[e.BoxGeometry=0]="BoxGeometry",e[e.SphereGeometry=1]="SphereGeometry",e[e.CylinderGeometry=2]="CylinderGeometry",e[e.CapsuleGeometry=3]="CapsuleGeometry",e[e.PlaneGeometry=4]="PlaneGeometry",e[e.CircleGeometry=5]="CircleGeometry",e[e.RingGeometry=6]="RingGeometry",e[e.TorusGeometry=7]="TorusGeometry",e[e.DodecahedronGeometry=8]="DodecahedronGeometry",e[e.IcosahedronGeometry=9]="IcosahedronGeometry",e[e.OctahedronGeometry=10]="OctahedronGeometry",e[e.TetrahedronGeometry=11]="TetrahedronGeometry",e[e.TorusKnotGeometry=12]="TorusKnotGeometry",e))(Ef||{});const G5={0:e=>new k4(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments),3:e=>new V4(e.radius,e.length,e.capSegments,e.radialSegments),5:e=>new U4(e.radius,e.segments,e.thetaStart,e.thetaLength),2:e=>new z4(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength),8:e=>new B4(e.radius,e.detail),9:e=>new j4(e.radius,e.detail),10:e=>new _4(e.radius,e.detail),4:e=>new As(e.width,e.height,e.widthSegments,e.heightSegments),6:e=>new O1(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength),1:e=>new k1(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength),11:e=>new H4(e.radius,e.detail),7:e=>new q4(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc),12:e=>new W4(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)},tg=(e,t)=>{const n=G5[e];return n(t)},X5=yt({name:"PrimitiveGeometryComponent",jsonID:"EE_primitive_geometry",schema:_.Object({geometryType:_.Enum(Ef,Ef.BoxGeometry),geometryParams:_.Record(_.String(),_.Any())}),reactor:()=>{const e=je(),t=se(e,X5),n=S1(e,()=>tg(t.geometryType.value,t.geometryParams.value),()=>new _1);return A.useLayoutEffect(()=>{n.geometry.set(tg(t.geometryType.value,t.geometryParams.value))},[t.geometryType,t.geometryParams]),null}}),Z5=-10,dy=yt({name:"SceneSettingsComponent",jsonID:"EE_scene_settings",schema:_.Object({thumbnailURL:_.String(""),loadingScreenURL:_.String(""),primaryColor:_.String("#000000"),backgroundColor:_.String("#FFFFFF"),alternativeColor:_.String("#000000"),sceneKillHeight:_.Number(Z5),spectateEntity:_.Nullable(_.EntityUUID())})});yt({name:"ScreenshareTargetComponent",jsonID:"EE_screenshare_target",toJSON:()=>!0});function hy(e,t,n){var o,i;if(t.heuristic.value===Bo.DEVICE){const r=_s||Lr?"MOBILE":"DESKTOP",s=t.levels.findIndex(u=>u.metadata.device===r);if(s<0)return;const a=t.levels[s],c=(o=pp.exec(n.src.value))==null?void 0:o[3],l=a?(i=pp.exec(a.src.value))==null?void 0:i[3]:"";a&&c!==l&&t.currentLevel.set(s)}else if(dh(t.value)){const r=ms.squaredDistance[e];for(let s=0;s<t.levels.length;s++){const a=t.levels[s].value;if([a.metadata.minDistance,a.metadata.maxDistance].includes(void 0))continue;const c=Math.pow(a.metadata.minDistance,2),l=Math.pow(a.metadata.maxDistance,2);if(c<=r&&r<=l&&a.src){t.heuristic.value===Bo.BUDGET?s>=t.budgetLevel.value?t.currentLevel.set(s):t.currentLevel.set(t.budgetLevel.value):t.currentLevel.set(s);break}}}else t.heuristic.value===Bo.BUDGET&&t.budgetLevel.value!=t.currentLevel.value&&t.currentLevel.set(t.budgetLevel.value)}function K5(e,t){if(t.heuristic===Bo.DEVICE){const n=Lr?"XR":_s?"MOBILE":"DESKTOP",o=t.levels.find(i=>i.metadata.device===n);if(o)return o.src}return null}function Y5(e,t){const n=gt(e,In);n.heuristic.value===Bo.BUDGET&&n.budgetLevel.set(Math.min(t,n.levels.length-1))}function Q5(e){const t=gt(e,In),n=gt(e,js);hy(e,t,n)}async function J5(e){const t=M(e,In),n=M(e,Ye),o=K5(e,t);if(!o)return;const[i]=await Bu(o,e);if(!i)return;const r=Ku(i.scene);r&&de(e,Ye)&&(n.geometry=r.geometry,n.material=r.material,gt(e,Ye).set(s=>s))}async function py(e){const t=M(e,In),n=M(e,Ye),o=M(e,Gc);if(M(e,q),t.heuristic===Bo.DEVICE){const i=Lr?"XR":_s?"MOBILE":"DESKTOP",r=t.levels.find(c=>c.metadata.device===i);if(!r)return;const[s]=await Bu(r.src,e);if(!s)return;const a=Ku(s.scene);if(!a||!de(e,Ye))return;n.geometry=a.geometry,n.material=a.material,gt(e,Ye).set(c=>c)}else if(t.heuristic===Bo.DISTANCE){const i=[],r=[];M(ye.instance.cameraEntity,q).position,new P;for(let c=0;c<t.levels.length;c++)i.push(t.levels[c]),r.push(c);const s=M(e,mt),a=[];for(let c=0;c<s.length;c++){const l=s[c];if(!l.userData.variant)continue;const u=l.userData.variant,d=i.find((f,h)=>f.src===u.src&&r[h]===u.index);if(d){a.push(d);continue}ju(e,l)}for(let c=0;c<i.length;c++){const l=i[c];if(a.includes(l))continue;const u=new $c;u.userData.variant={src:l.src,index:r[c]},Rt(e,u);const[d]=await Bu(l.src,e);if(!d)return;const f=l.metadata.minDistance,h=l.metadata.maxDistance,p=Ku(d.scene);if(!p)return;const g=p instanceof cp?p:new cp(p.geometry,p.material,o.instanceMatrix.count);g.instanceMatrix=o.instanceMatrix,g.frustumCulled=!1;const m=Array.isArray(g.material)?g.material:[g.material];for(const v of m)Jf(v,{id:"lod-culling",priority:1,compile:(y,w)=>{y.fragmentShader=y.fragmentShader.replace(`void main() {
`,`
      void main() {
        float maxDistance = ${h.toFixed(1)};
        float minDistance = ${f.toFixed(1)};
        // Calculate the camera distance from the geometry
        float cameraDistance = length(vViewPosition);
        // Discard fragments outside the minDistance and maxDistance range
        if (cameraDistance <= minDistance || cameraDistance >= maxDistance) {
          discard;
        }
    `)}});g.userData.variant={src:l.src,index:r[c]},ju(e,u),Rt(e,g)}}}var Bo=(e=>(e.DISTANCE="DISTANCE",e.SCENE_SCALE="SCENE_SCALE",e.MANUAL="MANUAL",e.DEVICE="DEVICE",e.BUDGET="BUDGET",e))(Bo||{});const dh=e=>e.heuristic==="DISTANCE"||e.heuristic==="BUDGET"&&e.useDistance,In=yt({name:"EE_variant",jsonID:"EE_variant",schema:_.Object({levels:_.Array(_.Object({src:_.String(),metadata:_.Record(_.String(),_.Any())})),heuristic:_.Enum(Bo,"MANUAL"),useDistance:_.Bool(!1),currentLevel:_.Number(0),budgetLevel:_.Number(0)}),reactor:$5});function $5(){const e=je(),t=se(e,In),n=Zn(e,js),o=ue(e,Ye);return n1(()=>{if(In.toJSON(M(e,In)),t.heuristic.value!=="BUDGET")return;const i=t.levels.get(dr).sort((r,s)=>{const a=r.metadata.vertexCount?r.metadata.vertexCount:0;return(s.metadata.vertexCount?s.metadata.vertexCount:0)-a});t.levels.set(i)},[t.heuristic]),A.useEffect(()=>{const i=t.currentLevel.value;let r;if(t.heuristic.value==="BUDGET"){const s=t.budgetLevel.value;i>=s?r=t.levels[i].src.value:r=t.levels[s].src.value}else r=t.levels[i].src&&t.levels[i].src.value;r&&n&&n.src.value!==r&&n.src.set(r)},[t.currentLevel]),A.useEffect(()=>{t.heuristic.value==="BUDGET"&&hy(e,t,n)},[t.budgetLevel]),A.useEffect(()=>{dh(t.value)&&o&&o.removeFromParent()},[o]),te.createElement(te.Fragment,null,t.levels.map((i,r)=>te.createElement(eM,{entity:e,level:r,key:`${e}-${r}`})))}const eM=te.memo(({entity:e,level:t})=>{const n=se(e,In),o=n.levels[t];A.useEffect(()=>{dh(n.value)?(O(e,ms),o.metadata.minDistance.value===void 0&&o.metadata.minDistance.set(0),o.metadata.maxDistance.value===void 0&&o.metadata.maxDistance.set(0)):de(e,ms)&&Qe(e,ms)},[n.heuristic]);const i=Zn(e,Ye),r=ue(e,Gc);return A.useEffect(()=>{i&&r&&py(e)},[o.src,o.metadata,i]),null}),tM=e=>{const t=je(),n=se(t,E1),o=se(e.backgroundEntity,T1),i=se(t,mt);return A.useEffect(()=>{if(Q3(t,e.backgroundEntity)&&n.type.value===J3.Skybox)for(const r of i.value)$3(r,o.value)},[n.type,o]),null},nM=()=>{const e=je();return te.createElement(Xt,{Components:[E1],ChildEntityReactor:tM,props:{backgroundEntity:e}})};ee({uuid:"ee.engine.EnvironmentSystem",insert:{after:Yt},reactor:()=>te.createElement(Xt,{Components:[T1],ChildEntityReactor:nM})});const my=0,oM=1,iM=2,ng=2,du=1.25,og=1,Es=6*4+4+4,El=65535,rM=Math.pow(2,-24),hu=Symbol("SKIP_GENERATION");function sM(e){return e.index?e.index.count:e.attributes.position.count}function Br(e){return sM(e)/3}function aM(e,t=ArrayBuffer){return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}function cM(e,t){if(!e.index){const n=e.attributes.position.count,o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=aM(n,o);e.setIndex(new Jn(i,1));for(let r=0;r<n;r++)i[r]=r}}function gy(e){const t=Br(e),n=e.drawRange,o=n.start/3,i=(n.start+n.count)/3,r=Math.max(0,o),s=Math.min(t,i)-r;return[{offset:Math.floor(r),count:Math.floor(s)}]}function vy(e){if(!e.groups||!e.groups.length)return gy(e);const t=[],n=new Set,o=e.drawRange,i=o.start/3,r=(o.start+o.count)/3;for(const a of e.groups){const c=a.start/3,l=(a.start+a.count)/3;n.add(Math.max(i,c)),n.add(Math.min(r,l))}const s=Array.from(n.values()).sort((a,c)=>a-c);for(let a=0;a<s.length-1;a++){const c=s[a],l=s[a+1];t.push({offset:Math.floor(c),count:Math.floor(l-c)})}return t}function lM(e){if(e.groups.length===0)return!1;const t=Br(e),n=vy(e).sort((r,s)=>r.offset-s.offset),o=n[n.length-1];o.count=Math.min(t-o.offset,o.count);let i=0;return n.forEach(({count:r})=>i+=r),t!==i}function pu(e,t,n,o,i){let r=1/0,s=1/0,a=1/0,c=-1/0,l=-1/0,u=-1/0,d=1/0,f=1/0,h=1/0,p=-1/0,g=-1/0,m=-1/0;for(let v=t*6,y=(t+n)*6;v<y;v+=6){const w=e[v+0],S=e[v+1],T=w-S,x=w+S;T<r&&(r=T),x>c&&(c=x),w<d&&(d=w),w>p&&(p=w);const E=e[v+2],C=e[v+3],L=E-C,D=E+C;L<s&&(s=L),D>l&&(l=D),E<f&&(f=E),E>g&&(g=E);const R=e[v+4],I=e[v+5],k=R-I,V=R+I;k<a&&(a=k),V>u&&(u=V),R<h&&(h=R),R>m&&(m=R)}o[0]=r,o[1]=s,o[2]=a,o[3]=c,o[4]=l,o[5]=u,i[0]=d,i[1]=f,i[2]=h,i[3]=p,i[4]=g,i[5]=m}function uM(e,t=null,n=null,o=null){const i=e.attributes.position,r=e.index?e.index.array:null,s=Br(e),a=i.normalized;let c;t===null?(c=new Float32Array(s*6*4),n=0,o=s):(c=t,n=n||0,o=o||s);const l=i.array,u=i.offset||0;let d=3;i.isInterleavedBufferAttribute&&(d=i.data.stride);const f=["getX","getY","getZ"];for(let h=n;h<n+o;h++){const p=h*3,g=h*6;let m=p+0,v=p+1,y=p+2;r&&(m=r[m],v=r[v],y=r[y]),a||(m=m*d+u,v=v*d+u,y=y*d+u);for(let w=0;w<3;w++){let S,T,x;a?(S=i[f[w]](m),T=i[f[w]](v),x=i[f[w]](y)):(S=l[m+w],T=l[v+w],x=l[y+w]);let E=S;T<E&&(E=T),x<E&&(E=x);let C=S;T>C&&(C=T),x>C&&(C=x);const L=(C-E)/2,D=w*2;c[g+D+0]=E+L,c[g+D+1]=L+(Math.abs(E)+L)*rM}}return c}function ze(e,t,n){return n.min.x=t[e],n.min.y=t[e+1],n.min.z=t[e+2],n.max.x=t[e+3],n.max.y=t[e+4],n.max.z=t[e+5],n}function ig(e){let t=-1,n=-1/0;for(let o=0;o<3;o++){const i=e[o+3]-e[o];i>n&&(n=i,t=o)}return t}function rg(e,t){t.set(e)}function sg(e,t,n){let o,i;for(let r=0;r<3;r++){const s=r+3;o=e[r],i=t[r],n[r]=o<i?o:i,o=e[s],i=t[s],n[s]=o>i?o:i}}function La(e,t,n){for(let o=0;o<3;o++){const i=t[e+2*o],r=t[e+2*o+1],s=i-r,a=i+r;s<n[o]&&(n[o]=s),a>n[o+3]&&(n[o+3]=a)}}function es(e){const t=e[3]-e[0],n=e[4]-e[1],o=e[5]-e[2];return 2*(t*n+n*o+o*t)}const Fo=32,fM=(e,t)=>e.candidate-t.candidate,Xo=new Array(Fo).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Da=new Float32Array(6);function dM(e,t,n,o,i,r){let s=-1,a=0;if(r===my)s=ig(t),s!==-1&&(a=(t[s]+t[s+3])/2);else if(r===oM)s=ig(e),s!==-1&&(a=hM(n,o,i,s));else if(r===iM){const c=es(e);let l=du*i;const u=o*6,d=(o+i)*6;for(let f=0;f<3;f++){const h=t[f],m=(t[f+3]-h)/Fo;if(i<Fo/4){const v=[...Xo];v.length=i;let y=0;for(let S=u;S<d;S+=6,y++){const T=v[y];T.candidate=n[S+2*f],T.count=0;const{bounds:x,leftCacheBounds:E,rightCacheBounds:C}=T;for(let L=0;L<3;L++)C[L]=1/0,C[L+3]=-1/0,E[L]=1/0,E[L+3]=-1/0,x[L]=1/0,x[L+3]=-1/0;La(S,n,x)}v.sort(fM);let w=i;for(let S=0;S<w;S++){const T=v[S];for(;S+1<w&&v[S+1].candidate===T.candidate;)v.splice(S+1,1),w--}for(let S=u;S<d;S+=6){const T=n[S+2*f];for(let x=0;x<w;x++){const E=v[x];T>=E.candidate?La(S,n,E.rightCacheBounds):(La(S,n,E.leftCacheBounds),E.count++)}}for(let S=0;S<w;S++){const T=v[S],x=T.count,E=i-T.count,C=T.leftCacheBounds,L=T.rightCacheBounds;let D=0;x!==0&&(D=es(C)/c);let R=0;E!==0&&(R=es(L)/c);const I=og+du*(D*x+R*E);I<l&&(s=f,l=I,a=T.candidate)}}else{for(let w=0;w<Fo;w++){const S=Xo[w];S.count=0,S.candidate=h+m+w*m;const T=S.bounds;for(let x=0;x<3;x++)T[x]=1/0,T[x+3]=-1/0}for(let w=u;w<d;w+=6){let x=~~((n[w+2*f]-h)/m);x>=Fo&&(x=Fo-1);const E=Xo[x];E.count++,La(w,n,E.bounds)}const v=Xo[Fo-1];rg(v.bounds,v.rightCacheBounds);for(let w=Fo-2;w>=0;w--){const S=Xo[w],T=Xo[w+1];sg(S.bounds,T.rightCacheBounds,S.rightCacheBounds)}let y=0;for(let w=0;w<Fo-1;w++){const S=Xo[w],T=S.count,x=S.bounds,C=Xo[w+1].rightCacheBounds;T!==0&&(y===0?rg(x,Da):sg(x,Da,Da)),y+=T;let L=0,D=0;y!==0&&(L=es(Da)/c);const R=i-y;R!==0&&(D=es(C)/c);const I=og+du*(L*y+D*R);I<l&&(s=f,l=I,a=S.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${r} used.`);return{axis:s,pos:a}}function hM(e,t,n,o){let i=0;for(let r=t,s=t+n;r<s;r++)i+=e[r*6+o*2];return i/n}class mu{constructor(){this.boundingData=new Float32Array(6)}}function pM(e,t,n,o,i,r){let s=o,a=o+i-1;const c=r.pos,l=r.axis*2;for(;;){for(;s<=a&&n[s*6+l]<c;)s++;for(;s<=a&&n[a*6+l]>=c;)a--;if(s<a){for(let u=0;u<3;u++){let d=t[s*3+u];t[s*3+u]=t[a*3+u],t[a*3+u]=d}for(let u=0;u<6;u++){let d=n[s*6+u];n[s*6+u]=n[a*6+u],n[a*6+u]=d}s++,a--}else return s}}function mM(e,t,n,o,i,r){let s=o,a=o+i-1;const c=r.pos,l=r.axis*2;for(;;){for(;s<=a&&n[s*6+l]<c;)s++;for(;s<=a&&n[a*6+l]>=c;)a--;if(s<a){let u=e[s];e[s]=e[a],e[a]=u;for(let d=0;d<6;d++){let f=n[s*6+d];n[s*6+d]=n[a*6+d],n[a*6+d]=f}s++,a--}else return s}}function Ct(e,t){return t[e+15]===65535}function Wt(e,t){return t[e+6]}function un(e,t){return t[e+14]}function fn(e){return e+8}function dn(e,t){return t[e+6]}function yy(e,t){return t[e+7]}let by,ds,ac,xy;const gM=Math.pow(2,32);function Mf(e){return"count"in e?1:1+Mf(e.left)+Mf(e.right)}function vM(e,t,n){return by=new Float32Array(n),ds=new Uint32Array(n),ac=new Uint16Array(n),xy=new Uint8Array(n),Pf(e,t)}function Pf(e,t){const n=e/4,o=e/2,i="count"in t,r=t.boundingData;for(let s=0;s<6;s++)by[n+s]=r[s];if(i)if(t.buffer){const s=t.buffer;xy.set(new Uint8Array(s),e);for(let a=e,c=e+s.byteLength;a<c;a+=Es){const l=a/2;Ct(l,ac)||(ds[a/4+6]+=n)}return e+s.byteLength}else{const s=t.offset,a=t.count;return ds[n+6]=s,ac[o+14]=a,ac[o+15]=El,e+Es}else{const s=t.left,a=t.right,c=t.splitAxis;let l;if(l=Pf(e+Es,s),l/4>gM)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return ds[n+6]=l/4,l=Pf(l,a),ds[n+7]=c,l}}function yM(e,t){const n=(e.index?e.index.count:e.attributes.position.count)/3,o=n>2**16,i=o?4:2,r=t?new SharedArrayBuffer(n*i):new ArrayBuffer(n*i),s=o?new Uint32Array(r):new Uint16Array(r);for(let a=0,c=s.length;a<c;a++)s[a]=a;return s}function bM(e,t,n,o,i){const{maxDepth:r,verbose:s,maxLeafTris:a,strategy:c,onProgress:l,indirect:u}=i,d=e._indirectBuffer,f=e.geometry,h=f.index?f.index.array:null,p=u?mM:pM,g=Br(f),m=new Float32Array(6);let v=!1;const y=new mu;return pu(t,n,o,y.boundingData,m),S(y,n,o,m),y;function w(T){l&&l(T/g)}function S(T,x,E,C=null,L=0){if(!v&&L>=r&&(v=!0,s&&(console.warn(`MeshBVH: Max depth of ${r} reached when generating BVH. Consider increasing maxDepth.`),console.warn(f))),E<=a||L>=r)return w(x+E),T.offset=x,T.count=E,T;const D=dM(T.boundingData,C,t,x,E,c);if(D.axis===-1)return w(x+E),T.offset=x,T.count=E,T;const R=p(d,h,t,x,E,D);if(R===x||R===x+E)w(x+E),T.offset=x,T.count=E;else{T.splitAxis=D.axis;const I=new mu,k=x,V=R-x;T.left=I,pu(t,k,V,I.boundingData,m),S(I,k,V,m,L+1);const X=new mu,$=R,_e=E-V;T.right=X,pu(t,$,_e,X.boundingData,m),S(X,$,_e,m,L+1)}return T}}function xM(e,t){const n=e.geometry;t.indirect&&(e._indirectBuffer=yM(n,t.useSharedArrayBuffer),lM(n)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||cM(n,t);const o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,i=uM(n),r=t.indirect?gy(n):vy(n);e._roots=r.map(s=>{const a=bM(e,i,s.offset,s.count,t),c=Mf(a),l=new o(Es*c);return vM(0,a,l),l})}class Ho{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,n){let o=1/0,i=-1/0;for(let r=0,s=t.length;r<s;r++){const c=t[r][n];o=c<o?c:o,i=c>i?c:i}this.min=o,this.max=i}setFromPoints(t,n){let o=1/0,i=-1/0;for(let r=0,s=n.length;r<s;r++){const a=n[r],c=t.dot(a);o=c<o?c:o,i=c>i?c:i}this.min=o,this.max=i}isSeparated(t){return this.min>t.max||t.min>this.max}}Ho.prototype.setFromBox=function(){const e=new P;return function(n,o){const i=o.min,r=o.max;let s=1/0,a=-1/0;for(let c=0;c<=1;c++)for(let l=0;l<=1;l++)for(let u=0;u<=1;u++){e.x=i.x*c+r.x*(1-c),e.y=i.y*l+r.y*(1-l),e.z=i.z*u+r.z*(1-u);const d=n.dot(e);s=Math.min(d,s),a=Math.max(d,a)}this.min=s,this.max=a}}();const wM=function(){const e=new P,t=new P,n=new P;return function(i,r,s){const a=i.start,c=e,l=r.start,u=t;n.subVectors(a,l),e.subVectors(i.end,i.start),t.subVectors(r.end,r.start);const d=n.dot(u),f=u.dot(c),h=u.dot(u),p=n.dot(c),m=c.dot(c)*h-f*f;let v,y;m!==0?v=(d*f-p*h)/m:v=0,y=(d+v*f)/h,s.x=v,s.y=y}}(),hh=function(){const e=new Me,t=new P,n=new P;return function(i,r,s,a){wM(i,r,e);let c=e.x,l=e.y;if(c>=0&&c<=1&&l>=0&&l<=1){i.at(c,s),r.at(l,a);return}else if(c>=0&&c<=1){l<0?r.at(0,a):r.at(1,a),i.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){c<0?i.at(0,s):i.at(1,s),r.closestPointToPoint(s,!0,a);return}else{let u;c<0?u=i.start:u=i.end;let d;l<0?d=r.start:d=r.end;const f=t,h=n;if(i.closestPointToPoint(d,!0,t),r.closestPointToPoint(u,!0,n),f.distanceToSquared(d)<=h.distanceToSquared(u)){s.copy(f),a.copy(d);return}else{s.copy(u),a.copy(h);return}}}}(),SM=function(){const e=new P,t=new P,n=new td,o=new ko;return function(r,s){const{radius:a,center:c}=r,{a:l,b:u,c:d}=s;if(o.start=l,o.end=u,o.closestPointToPoint(c,!0,e).distanceTo(c)<=a||(o.start=l,o.end=d,o.closestPointToPoint(c,!0,e).distanceTo(c)<=a)||(o.start=u,o.end=d,o.closestPointToPoint(c,!0,e).distanceTo(c)<=a))return!0;const g=s.getPlane(n);if(Math.abs(g.distanceToPoint(c))<=a){const v=g.projectPoint(c,t);if(s.containsPoint(v))return!0}return!1}}(),TM=1e-15;function gu(e){return Math.abs(e)<TM}class Fn extends cs{constructor(...t){super(...t),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new P),this.satBounds=new Array(4).fill().map(()=>new Ho),this.points=[this.a,this.b,this.c],this.sphere=new q1,this.plane=new td,this.needsUpdate=!0}intersectsSphere(t){return SM(t,this)}update(){const t=this.a,n=this.b,o=this.c,i=this.points,r=this.satAxes,s=this.satBounds,a=r[0],c=s[0];this.getNormal(a),c.setFromPoints(a,i);const l=r[1],u=s[1];l.subVectors(t,n),u.setFromPoints(l,i);const d=r[2],f=s[2];d.subVectors(n,o),f.setFromPoints(d,i);const h=r[3],p=s[3];h.subVectors(o,t),p.setFromPoints(h,i),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,t),this.needsUpdate=!1}}Fn.prototype.closestPointToSegment=function(){const e=new P,t=new P,n=new ko;return function(i,r=null,s=null){const{start:a,end:c}=i,l=this.points;let u,d=1/0;for(let f=0;f<3;f++){const h=(f+1)%3;n.start.copy(l[f]),n.end.copy(l[h]),hh(n,i,e,t),u=e.distanceToSquared(t),u<d&&(d=u,r&&r.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),u=a.distanceToSquared(e),u<d&&(d=u,r&&r.copy(e),s&&s.copy(a)),this.closestPointToPoint(c,e),u=c.distanceToSquared(e),u<d&&(d=u,r&&r.copy(e),s&&s.copy(c)),Math.sqrt(d)}}();Fn.prototype.intersectsTriangle=function(){const e=new Fn,t=new Array(3),n=new Array(3),o=new Ho,i=new Ho,r=new P,s=new P,a=new P,c=new P,l=new P,u=new ko,d=new ko,f=new ko,h=new P;function p(g,m,v){const y=g.points;let w=0,S=-1;for(let T=0;T<3;T++){const{start:x,end:E}=u;x.copy(y[T]),E.copy(y[(T+1)%3]),u.delta(s);const C=gu(m.distanceToPoint(x));if(gu(m.normal.dot(s))&&C){v.copy(u),w=2;break}const L=m.intersectLine(u,h);if(!L&&C&&h.copy(x),(L||C)&&!gu(h.distanceTo(E))){if(w<=1)(w===1?v.start:v.end).copy(h),C&&(S=w);else if(w>=2){(S===1?v.start:v.end).copy(h),w=2;break}if(w++,w===2&&S===-1)break}}return w}return function(m,v=null,y=!1){this.needsUpdate&&this.update(),m.isExtendedTriangle?m.needsUpdate&&m.update():(e.copy(m),e.update(),m=e);const w=this.plane,S=m.plane;if(Math.abs(w.normal.dot(S.normal))>1-1e-10){const T=this.satBounds,x=this.satAxes;n[0]=m.a,n[1]=m.b,n[2]=m.c;for(let L=0;L<4;L++){const D=T[L],R=x[L];if(o.setFromPoints(R,n),D.isSeparated(o))return!1}const E=m.satBounds,C=m.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let L=0;L<4;L++){const D=E[L],R=C[L];if(o.setFromPoints(R,t),D.isSeparated(o))return!1}for(let L=0;L<4;L++){const D=x[L];for(let R=0;R<4;R++){const I=C[R];if(r.crossVectors(D,I),o.setFromPoints(r,t),i.setFromPoints(r,n),o.isSeparated(i))return!1}}return v&&(y||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),v.start.set(0,0,0),v.end.set(0,0,0)),!0}else{const T=p(this,S,d);if(T===1&&m.containsPoint(d.end))return v&&(v.start.copy(d.end),v.end.copy(d.end)),!0;if(T!==2)return!1;const x=p(m,w,f);if(x===1&&this.containsPoint(f.end))return v&&(v.start.copy(f.end),v.end.copy(f.end)),!0;if(x!==2)return!1;if(d.delta(a),f.delta(c),a.dot(c)<0){let k=f.start;f.start=f.end,f.end=k}const E=d.start.dot(a),C=d.end.dot(a),L=f.start.dot(a),D=f.end.dot(a),R=C<L,I=E<D;return E!==D&&L!==C&&R===I?!1:(v&&(l.subVectors(d.start,f.start),l.dot(a)>0?v.start.copy(d.start):v.start.copy(f.start),l.subVectors(d.end,f.end),l.dot(a)<0?v.end.copy(d.end):v.end.copy(f.end)),!0)}}}();Fn.prototype.distanceToPoint=function(){const e=new P;return function(n){return this.closestPointToPoint(n,e),n.distanceTo(e)}}();Fn.prototype.distanceToTriangle=function(){const e=new P,t=new P,n=["a","b","c"],o=new ko,i=new ko;return function(s,a=null,c=null){const l=a||c?o:null;if(this.intersectsTriangle(s,l))return(a||c)&&(a&&l.getCenter(a),c&&l.getCenter(c)),0;let u=1/0;for(let d=0;d<3;d++){let f;const h=n[d],p=s[h];this.closestPointToPoint(p,e),f=p.distanceToSquared(e),f<u&&(u=f,a&&a.copy(e),c&&c.copy(p));const g=this[h];s.closestPointToPoint(g,e),f=g.distanceToSquared(e),f<u&&(u=f,a&&a.copy(g),c&&c.copy(e))}for(let d=0;d<3;d++){const f=n[d],h=n[(d+1)%3];o.set(this[f],this[h]);for(let p=0;p<3;p++){const g=n[p],m=n[(p+1)%3];i.set(s[g],s[m]),hh(o,i,e,t);const v=e.distanceToSquared(t);v<u&&(u=v,a&&a.copy(e),c&&c.copy(t))}}return Math.sqrt(u)}}();class Nt{constructor(t,n,o){this.isOrientedBox=!0,this.min=new P,this.max=new P,this.matrix=new ne,this.invMatrix=new ne,this.points=new Array(8).fill().map(()=>new P),this.satAxes=new Array(3).fill().map(()=>new P),this.satBounds=new Array(3).fill().map(()=>new Ho),this.alignedSatBounds=new Array(3).fill().map(()=>new Ho),this.needsUpdate=!1,t&&this.min.copy(t),n&&this.max.copy(n),o&&this.matrix.copy(o)}set(t,n,o){this.min.copy(t),this.max.copy(n),this.matrix.copy(o),this.needsUpdate=!0}copy(t){this.min.copy(t.min),this.max.copy(t.max),this.matrix.copy(t.matrix),this.needsUpdate=!0}}Nt.prototype.update=function(){return function(){const t=this.matrix,n=this.min,o=this.max,i=this.points;for(let l=0;l<=1;l++)for(let u=0;u<=1;u++)for(let d=0;d<=1;d++){const f=1*l|2*u|4*d,h=i[f];h.x=l?o.x:n.x,h.y=u?o.y:n.y,h.z=d?o.z:n.z,h.applyMatrix4(t)}const r=this.satBounds,s=this.satAxes,a=i[0];for(let l=0;l<3;l++){const u=s[l],d=r[l],f=1<<l,h=i[f];u.subVectors(a,h),d.setFromPoints(u,i)}const c=this.alignedSatBounds;c[0].setFromPointsField(i,"x"),c[1].setFromPointsField(i,"y"),c[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();Nt.prototype.intersectsBox=function(){const e=new Ho;return function(n){this.needsUpdate&&this.update();const o=n.min,i=n.max,r=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=o.x,e.max=i.x,a[0].isSeparated(e)||(e.min=o.y,e.max=i.y,a[1].isSeparated(e))||(e.min=o.z,e.max=i.z,a[2].isSeparated(e)))return!1;for(let c=0;c<3;c++){const l=s[c],u=r[c];if(e.setFromBox(l,n),u.isSeparated(e))return!1}return!0}}();Nt.prototype.intersectsTriangle=function(){const e=new Fn,t=new Array(3),n=new Ho,o=new Ho,i=new P;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);const a=this.satBounds,c=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let f=0;f<3;f++){const h=a[f],p=c[f];if(n.setFromPoints(p,t),h.isSeparated(n))return!1}const l=s.satBounds,u=s.satAxes,d=this.points;for(let f=0;f<3;f++){const h=l[f],p=u[f];if(n.setFromPoints(p,d),h.isSeparated(n))return!1}for(let f=0;f<3;f++){const h=c[f];for(let p=0;p<4;p++){const g=u[p];if(i.crossVectors(h,g),n.setFromPoints(i,t),o.setFromPoints(i,d),n.isSeparated(o))return!1}}return!0}}();Nt.prototype.closestPointToPoint=function(){return function(t,n){return this.needsUpdate&&this.update(),n.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),n}}();Nt.prototype.distanceToPoint=function(){const e=new P;return function(n){return this.closestPointToPoint(n,e),n.distanceTo(e)}}();Nt.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map(()=>new ko),n=new Array(12).fill().map(()=>new ko),o=new P,i=new P;return function(s,a=0,c=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(c||l)&&(s.getCenter(i),this.closestPointToPoint(i,o),s.closestPointToPoint(o,i),c&&c.copy(o),l&&l.copy(i)),0;const u=a*a,d=s.min,f=s.max,h=this.points;let p=1/0;for(let m=0;m<8;m++){const v=h[m];i.copy(v).clamp(d,f);const y=v.distanceToSquared(i);if(y<p&&(p=y,c&&c.copy(v),l&&l.copy(i),y<u))return Math.sqrt(y)}let g=0;for(let m=0;m<3;m++)for(let v=0;v<=1;v++)for(let y=0;y<=1;y++){const w=(m+1)%3,S=(m+2)%3,T=v<<w|y<<S,x=1<<m|v<<w|y<<S,E=h[T],C=h[x];t[g].set(E,C);const D=e[m],R=e[w],I=e[S],k=n[g],V=k.start,X=k.end;V[D]=d[D],V[R]=v?d[R]:f[R],V[I]=y?d[I]:f[R],X[D]=f[D],X[R]=v?d[R]:f[R],X[I]=y?d[I]:f[R],g++}for(let m=0;m<=1;m++)for(let v=0;v<=1;v++)for(let y=0;y<=1;y++){i.x=m?f.x:d.x,i.y=v?f.y:d.y,i.z=y?f.z:d.z,this.closestPointToPoint(i,o);const w=i.distanceToSquared(o);if(w<p&&(p=w,c&&c.copy(o),l&&l.copy(i),w<u))return Math.sqrt(w)}for(let m=0;m<12;m++){const v=t[m];for(let y=0;y<12;y++){const w=n[y];hh(v,w,o,i);const S=o.distanceToSquared(i);if(S<p&&(p=S,c&&c.copy(o),l&&l.copy(i),S<u))return Math.sqrt(S)}}return Math.sqrt(p)}}();class ph{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){const t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}}class EM extends ph{constructor(){super(()=>new Fn)}}const hn=new EM;class MM{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const t=[];let n=null;this.setBuffer=o=>{n&&t.push(n),n=o,this.float32Array=new Float32Array(o),this.uint16Array=new Uint16Array(o),this.uint32Array=new Uint32Array(o)},this.clearBuffer=()=>{n=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,t.length!==0&&this.setBuffer(t.pop())}}}const De=new MM;let ni,lr;const Wi=[],Ia=new ph(()=>new kt);function PM(e,t,n,o,i,r){ni=Ia.getPrimitive(),lr=Ia.getPrimitive(),Wi.push(ni,lr),De.setBuffer(e._roots[t]);const s=Nf(0,e.geometry,n,o,i,r);De.clearBuffer(),Ia.releasePrimitive(ni),Ia.releasePrimitive(lr),Wi.pop(),Wi.pop();const a=Wi.length;return a>0&&(lr=Wi[a-1],ni=Wi[a-2]),s}function Nf(e,t,n,o,i=null,r=0,s=0){const{float32Array:a,uint16Array:c,uint32Array:l}=De;let u=e*2;if(Ct(u,c)){const f=Wt(e,l),h=un(u,c);return ze(e,a,ni),o(f,h,!1,s,r+e,ni)}else{let D=function(I){const{uint16Array:k,uint32Array:V}=De;let X=I*2;for(;!Ct(X,k);)I=fn(I),X=I*2;return Wt(I,V)},R=function(I){const{uint16Array:k,uint32Array:V}=De;let X=I*2;for(;!Ct(X,k);)I=dn(I,V),X=I*2;return Wt(I,V)+un(X,k)};const f=fn(e),h=dn(e,l);let p=f,g=h,m,v,y,w;if(i&&(y=ni,w=lr,ze(p,a,y),ze(g,a,w),m=i(y),v=i(w),v<m)){p=h,g=f;const I=m;m=v,v=I,y=w}y||(y=ni,ze(p,a,y));const S=Ct(p*2,c),T=n(y,S,m,s+1,r+p);let x;if(T===ng){const I=D(p),V=R(p)-I;x=o(I,V,!0,s+1,r+p,y)}else x=T&&Nf(p,t,n,o,i,r,s+1);if(x)return!0;w=lr,ze(g,a,w);const E=Ct(g*2,c),C=n(w,E,v,s+1,r+g);let L;if(C===ng){const I=D(g),V=R(g)-I;L=o(I,V,!0,s+1,r+g,w)}else L=C&&Nf(g,t,n,o,i,r,s+1);return!!L}}const ts=new P,vu=new P;function NM(e,t,n={},o=0,i=1/0){const r=o*o,s=i*i;let a=1/0,c=null;if(e.shapecast({boundsTraverseOrder:u=>(ts.copy(t).clamp(u.min,u.max),ts.distanceToSquared(t)),intersectsBounds:(u,d,f)=>f<a&&f<s,intersectsTriangle:(u,d)=>{u.closestPointToPoint(t,ts);const f=t.distanceToSquared(ts);return f<a&&(vu.copy(ts),a=f,c=d),f<r}}),a===1/0)return null;const l=Math.sqrt(a);return n.point?n.point.copy(vu):n.point=vu.clone(),n.distance=l,n.faceIndex=c,n}const Gi=new P,Xi=new P,Zi=new P,Fa=new Me,Ra=new Me,Oa=new Me,ag=new P,cg=new P,lg=new P,ka=new P;function AM(e,t,n,o,i,r,s,a){let c;if(r===H1?c=e.intersectTriangle(o,n,t,!0,i):c=e.intersectTriangle(t,n,o,r!==Qc,i),c===null)return null;const l=e.origin.distanceTo(i);return l<s||l>a?null:{distance:l,point:i.clone()}}function CM(e,t,n,o,i,r,s,a,c,l,u){Gi.fromBufferAttribute(t,r),Xi.fromBufferAttribute(t,s),Zi.fromBufferAttribute(t,a);const d=AM(e,Gi,Xi,Zi,ka,c,l,u);if(d){o&&(Fa.fromBufferAttribute(o,r),Ra.fromBufferAttribute(o,s),Oa.fromBufferAttribute(o,a),d.uv=cs.getInterpolation(ka,Gi,Xi,Zi,Fa,Ra,Oa,new Me)),i&&(Fa.fromBufferAttribute(i,r),Ra.fromBufferAttribute(i,s),Oa.fromBufferAttribute(i,a),d.uv1=cs.getInterpolation(ka,Gi,Xi,Zi,Fa,Ra,Oa,new Me)),n&&(ag.fromBufferAttribute(n,r),cg.fromBufferAttribute(n,s),lg.fromBufferAttribute(n,a),d.normal=cs.getInterpolation(ka,Gi,Xi,Zi,ag,cg,lg,new P),d.normal.dot(e.direction)>0&&d.normal.multiplyScalar(-1));const f={a:r,b:s,c:a,normal:new P,materialIndex:0};cs.getNormal(Gi,Xi,Zi,f.normal),d.face=f,d.faceIndex=r}return d}function Ml(e,t,n,o,i,r,s){const a=o*3;let c=a+0,l=a+1,u=a+2;const d=e.index;e.index&&(c=d.getX(c),l=d.getX(l),u=d.getX(u));const{position:f,normal:h,uv:p,uv1:g}=e.attributes,m=CM(n,f,h,p,g,c,l,u,t,r,s);return m?(m.faceIndex=o,i&&i.push(m),m):null}function tt(e,t,n,o){const i=e.a,r=e.b,s=e.c;let a=t,c=t+1,l=t+2;n&&(a=n.getX(a),c=n.getX(c),l=n.getX(l)),i.x=o.getX(a),i.y=o.getY(a),i.z=o.getZ(a),r.x=o.getX(c),r.y=o.getY(c),r.z=o.getZ(c),s.x=o.getX(l),s.y=o.getY(l),s.z=o.getZ(l)}function LM(e,t,n,o,i,r,s,a){const{geometry:c,_indirectBuffer:l}=e;for(let u=o,d=o+i;u<d;u++)Ml(c,t,n,u,r,s,a)}function DM(e,t,n,o,i,r,s){const{geometry:a,_indirectBuffer:c}=e;let l=1/0,u=null;for(let d=o,f=o+i;d<f;d++){let h;h=Ml(a,t,n,d,null,r,s),h&&h.distance<l&&(u=h,l=h.distance)}return u}function IM(e,t,n,o,i,r,s){const{geometry:a}=n,{index:c}=a,l=a.attributes.position;for(let u=e,d=t+e;u<d;u++){let f;if(f=u,tt(s,f*3,c,l),s.needsUpdate=!0,o(s,f,i,r))return!0}return!1}function FM(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,o=n.index?n.index.array:null,i=n.attributes.position;let r,s,a,c,l=0;const u=e._roots;for(let f=0,h=u.length;f<h;f++)r=u[f],s=new Uint32Array(r),a=new Uint16Array(r),c=new Float32Array(r),d(0,l),l+=r.byteLength;function d(f,h,p=!1){const g=f*2;if(a[g+15]===El){const v=s[f+6],y=a[g+14];let w=1/0,S=1/0,T=1/0,x=-1/0,E=-1/0,C=-1/0;for(let L=3*v,D=3*(v+y);L<D;L++){let R=o[L];const I=i.getX(R),k=i.getY(R),V=i.getZ(R);I<w&&(w=I),I>x&&(x=I),k<S&&(S=k),k>E&&(E=k),V<T&&(T=V),V>C&&(C=V)}return c[f+0]!==w||c[f+1]!==S||c[f+2]!==T||c[f+3]!==x||c[f+4]!==E||c[f+5]!==C?(c[f+0]=w,c[f+1]=S,c[f+2]=T,c[f+3]=x,c[f+4]=E,c[f+5]=C,!0):!1}else{const v=f+8,y=s[f+6],w=v+h,S=y+h;let T=p,x=!1,E=!1;t?T||(x=t.has(w),E=t.has(S),T=!x&&!E):(x=!0,E=!0);const C=T||x,L=T||E;let D=!1;C&&(D=d(v,h,T));let R=!1;L&&(R=d(y,h,T));const I=D||R;if(I)for(let k=0;k<3;k++){const V=v+k,X=y+k,$=c[V],_e=c[V+3],it=c[X],rt=c[X+3];c[f+k]=$<it?$:it,c[f+k+3]=_e>rt?_e:rt}return I}}}function ui(e,t,n,o,i){let r,s,a,c,l,u;const d=1/n.direction.x,f=1/n.direction.y,h=1/n.direction.z,p=n.origin.x,g=n.origin.y,m=n.origin.z;let v=t[e],y=t[e+3],w=t[e+1],S=t[e+3+1],T=t[e+2],x=t[e+3+2];return d>=0?(r=(v-p)*d,s=(y-p)*d):(r=(y-p)*d,s=(v-p)*d),f>=0?(a=(w-g)*f,c=(S-g)*f):(a=(S-g)*f,c=(w-g)*f),r>c||a>s||((a>r||isNaN(r))&&(r=a),(c<s||isNaN(s))&&(s=c),h>=0?(l=(T-m)*h,u=(x-m)*h):(l=(x-m)*h,u=(T-m)*h),r>u||l>s)?!1:((l>r||r!==r)&&(r=l),(u<s||s!==s)&&(s=u),r<=i&&s>=o)}function RM(e,t,n,o,i,r,s,a){const{geometry:c,_indirectBuffer:l}=e;for(let u=o,d=o+i;u<d;u++){let f=l?l[u]:u;Ml(c,t,n,f,r,s,a)}}function OM(e,t,n,o,i,r,s){const{geometry:a,_indirectBuffer:c}=e;let l=1/0,u=null;for(let d=o,f=o+i;d<f;d++){let h;h=Ml(a,t,n,c?c[d]:d,null,r,s),h&&h.distance<l&&(u=h,l=h.distance)}return u}function kM(e,t,n,o,i,r,s){const{geometry:a}=n,{index:c}=a,l=a.attributes.position;for(let u=e,d=t+e;u<d;u++){let f;if(f=n.resolveTriangleIndex(u),tt(s,f*3,c,l),s.needsUpdate=!0,o(s,f,i,r))return!0}return!1}function VM(e,t,n,o,i,r,s){De.setBuffer(e._roots[t]),Af(0,e,n,o,i,r,s),De.clearBuffer()}function Af(e,t,n,o,i,r,s){const{float32Array:a,uint16Array:c,uint32Array:l}=De,u=e*2;if(Ct(u,c)){const f=Wt(e,l),h=un(u,c);LM(t,n,o,f,h,i,r,s)}else{const f=fn(e);ui(f,a,o,r,s)&&Af(f,t,n,o,i,r,s);const h=dn(e,l);ui(h,a,o,r,s)&&Af(h,t,n,o,i,r,s)}}const UM=["x","y","z"];function zM(e,t,n,o,i,r){De.setBuffer(e._roots[t]);const s=Cf(0,e,n,o,i,r);return De.clearBuffer(),s}function Cf(e,t,n,o,i,r){const{float32Array:s,uint16Array:a,uint32Array:c}=De;let l=e*2;if(Ct(l,a)){const d=Wt(e,c),f=un(l,a);return DM(t,n,o,d,f,i,r)}else{const d=yy(e,c),f=UM[d],p=o.direction[f]>=0;let g,m;p?(g=fn(e),m=dn(e,c)):(g=dn(e,c),m=fn(e));const y=ui(g,s,o,i,r)?Cf(g,t,n,o,i,r):null;if(y){const T=y.point[f];if(p?T<=s[m+d]:T>=s[m+d+3])return y}const S=ui(m,s,o,i,r)?Cf(m,t,n,o,i,r):null;return y&&S?y.distance<=S.distance?y:S:y||S||null}}const Va=new kt,Ki=new Fn,Yi=new Fn,ns=new ne,ug=new Nt,Ua=new Nt;function BM(e,t,n,o){De.setBuffer(e._roots[t]);const i=Lf(0,e,n,o);return De.clearBuffer(),i}function Lf(e,t,n,o,i=null){const{float32Array:r,uint16Array:s,uint32Array:a}=De;let c=e*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),ug.set(n.boundingBox.min,n.boundingBox.max,o),i=ug),Ct(c,s)){const u=t.geometry,d=u.index,f=u.attributes.position,h=n.index,p=n.attributes.position,g=Wt(e,a),m=un(c,s);if(ns.copy(o).invert(),n.boundsTree)return ze(e,r,Ua),Ua.matrix.copy(ns),Ua.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:y=>Ua.intersectsBox(y),intersectsTriangle:y=>{y.a.applyMatrix4(o),y.b.applyMatrix4(o),y.c.applyMatrix4(o),y.needsUpdate=!0;for(let w=g*3,S=(m+g)*3;w<S;w+=3)if(tt(Yi,w,d,f),Yi.needsUpdate=!0,y.intersectsTriangle(Yi))return!0;return!1}});for(let v=g*3,y=(m+g)*3;v<y;v+=3){tt(Ki,v,d,f),Ki.a.applyMatrix4(ns),Ki.b.applyMatrix4(ns),Ki.c.applyMatrix4(ns),Ki.needsUpdate=!0;for(let w=0,S=h.count;w<S;w+=3)if(tt(Yi,w,h,p),Yi.needsUpdate=!0,Ki.intersectsTriangle(Yi))return!0}}else{const u=e+8,d=a[e+6];return ze(u,r,Va),!!(i.intersectsBox(Va)&&Lf(u,t,n,o,i)||(ze(d,r,Va),i.intersectsBox(Va)&&Lf(d,t,n,o,i)))}}const za=new ne,yu=new Nt,os=new Nt,jM=new P,_M=new P,HM=new P,qM=new P;function WM(e,t,n,o={},i={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),yu.set(t.boundingBox.min,t.boundingBox.max,n),yu.needsUpdate=!0;const a=e.geometry,c=a.attributes.position,l=a.index,u=t.attributes.position,d=t.index,f=hn.getPrimitive(),h=hn.getPrimitive();let p=jM,g=_M,m=null,v=null;i&&(m=HM,v=qM);let y=1/0,w=null,S=null;return za.copy(n).invert(),os.matrix.copy(za),e.shapecast({boundsTraverseOrder:T=>yu.distanceToBox(T),intersectsBounds:(T,x,E)=>E<y&&E<s?(x&&(os.min.copy(T.min),os.max.copy(T.max),os.needsUpdate=!0),!0):!1,intersectsRange:(T,x)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:C=>os.distanceToBox(C),intersectsBounds:(C,L,D)=>D<y&&D<s,intersectsRange:(C,L)=>{for(let D=C,R=C+L;D<R;D++){tt(h,3*D,d,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let I=T,k=T+x;I<k;I++){tt(f,3*I,l,c),f.needsUpdate=!0;const V=f.distanceToTriangle(h,p,m);if(V<y&&(g.copy(p),v&&v.copy(m),y=V,w=I,S=D),V<r)return!0}}}});{const E=Br(t);for(let C=0,L=E;C<L;C++){tt(h,3*C,d,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let D=T,R=T+x;D<R;D++){tt(f,3*D,l,c),f.needsUpdate=!0;const I=f.distanceToTriangle(h,p,m);if(I<y&&(g.copy(p),v&&v.copy(m),y=I,w=D,S=C),I<r)return!0}}}}}),hn.releasePrimitive(f),hn.releasePrimitive(h),y===1/0?null:(o.point?o.point.copy(g):o.point=g.clone(),o.distance=y,o.faceIndex=w,i&&(i.point?i.point.copy(v):i.point=v.clone(),i.point.applyMatrix4(za),g.applyMatrix4(za),i.distance=g.sub(i.point).length(),i.faceIndex=S),o)}function GM(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const n=e.geometry,o=n.index?n.index.array:null,i=n.attributes.position;let r,s,a,c,l=0;const u=e._roots;for(let f=0,h=u.length;f<h;f++)r=u[f],s=new Uint32Array(r),a=new Uint16Array(r),c=new Float32Array(r),d(0,l),l+=r.byteLength;function d(f,h,p=!1){const g=f*2;if(a[g+15]===El){const v=s[f+6],y=a[g+14];let w=1/0,S=1/0,T=1/0,x=-1/0,E=-1/0,C=-1/0;for(let L=v,D=v+y;L<D;L++){const R=3*e.resolveTriangleIndex(L);for(let I=0;I<3;I++){let k=R+I;k=o?o[k]:k;const V=i.getX(k),X=i.getY(k),$=i.getZ(k);V<w&&(w=V),V>x&&(x=V),X<S&&(S=X),X>E&&(E=X),$<T&&(T=$),$>C&&(C=$)}}return c[f+0]!==w||c[f+1]!==S||c[f+2]!==T||c[f+3]!==x||c[f+4]!==E||c[f+5]!==C?(c[f+0]=w,c[f+1]=S,c[f+2]=T,c[f+3]=x,c[f+4]=E,c[f+5]=C,!0):!1}else{const v=f+8,y=s[f+6],w=v+h,S=y+h;let T=p,x=!1,E=!1;t?T||(x=t.has(w),E=t.has(S),T=!x&&!E):(x=!0,E=!0);const C=T||x,L=T||E;let D=!1;C&&(D=d(v,h,T));let R=!1;L&&(R=d(y,h,T));const I=D||R;if(I)for(let k=0;k<3;k++){const V=v+k,X=y+k,$=c[V],_e=c[V+3],it=c[X],rt=c[X+3];c[f+k]=$<it?$:it,c[f+k+3]=_e>rt?_e:rt}return I}}}function XM(e,t,n,o,i,r,s){De.setBuffer(e._roots[t]),Df(0,e,n,o,i,r,s),De.clearBuffer()}function Df(e,t,n,o,i,r,s){const{float32Array:a,uint16Array:c,uint32Array:l}=De,u=e*2;if(Ct(u,c)){const f=Wt(e,l),h=un(u,c);RM(t,n,o,f,h,i,r,s)}else{const f=fn(e);ui(f,a,o,r,s)&&Df(f,t,n,o,i,r,s);const h=dn(e,l);ui(h,a,o,r,s)&&Df(h,t,n,o,i,r,s)}}const ZM=["x","y","z"];function KM(e,t,n,o,i,r){De.setBuffer(e._roots[t]);const s=If(0,e,n,o,i,r);return De.clearBuffer(),s}function If(e,t,n,o,i,r){const{float32Array:s,uint16Array:a,uint32Array:c}=De;let l=e*2;if(Ct(l,a)){const d=Wt(e,c),f=un(l,a);return OM(t,n,o,d,f,i,r)}else{const d=yy(e,c),f=ZM[d],p=o.direction[f]>=0;let g,m;p?(g=fn(e),m=dn(e,c)):(g=dn(e,c),m=fn(e));const y=ui(g,s,o,i,r)?If(g,t,n,o,i,r):null;if(y){const T=y.point[f];if(p?T<=s[m+d]:T>=s[m+d+3])return y}const S=ui(m,s,o,i,r)?If(m,t,n,o,i,r):null;return y&&S?y.distance<=S.distance?y:S:y||S||null}}const Ba=new kt,Qi=new Fn,Ji=new Fn,is=new ne,fg=new Nt,ja=new Nt;function YM(e,t,n,o){De.setBuffer(e._roots[t]);const i=Ff(0,e,n,o);return De.clearBuffer(),i}function Ff(e,t,n,o,i=null){const{float32Array:r,uint16Array:s,uint32Array:a}=De;let c=e*2;if(i===null&&(n.boundingBox||n.computeBoundingBox(),fg.set(n.boundingBox.min,n.boundingBox.max,o),i=fg),Ct(c,s)){const u=t.geometry,d=u.index,f=u.attributes.position,h=n.index,p=n.attributes.position,g=Wt(e,a),m=un(c,s);if(is.copy(o).invert(),n.boundsTree)return ze(e,r,ja),ja.matrix.copy(is),ja.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:y=>ja.intersectsBox(y),intersectsTriangle:y=>{y.a.applyMatrix4(o),y.b.applyMatrix4(o),y.c.applyMatrix4(o),y.needsUpdate=!0;for(let w=g,S=m+g;w<S;w++)if(tt(Ji,3*t.resolveTriangleIndex(w),d,f),Ji.needsUpdate=!0,y.intersectsTriangle(Ji))return!0;return!1}});for(let v=g,y=m+g;v<y;v++){const w=t.resolveTriangleIndex(v);tt(Qi,3*w,d,f),Qi.a.applyMatrix4(is),Qi.b.applyMatrix4(is),Qi.c.applyMatrix4(is),Qi.needsUpdate=!0;for(let S=0,T=h.count;S<T;S+=3)if(tt(Ji,S,h,p),Ji.needsUpdate=!0,Qi.intersectsTriangle(Ji))return!0}}else{const u=e+8,d=a[e+6];return ze(u,r,Ba),!!(i.intersectsBox(Ba)&&Ff(u,t,n,o,i)||(ze(d,r,Ba),i.intersectsBox(Ba)&&Ff(d,t,n,o,i)))}}const _a=new ne,bu=new Nt,rs=new Nt,QM=new P,JM=new P,$M=new P,e6=new P;function t6(e,t,n,o={},i={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),bu.set(t.boundingBox.min,t.boundingBox.max,n),bu.needsUpdate=!0;const a=e.geometry,c=a.attributes.position,l=a.index,u=t.attributes.position,d=t.index,f=hn.getPrimitive(),h=hn.getPrimitive();let p=QM,g=JM,m=null,v=null;i&&(m=$M,v=e6);let y=1/0,w=null,S=null;return _a.copy(n).invert(),rs.matrix.copy(_a),e.shapecast({boundsTraverseOrder:T=>bu.distanceToBox(T),intersectsBounds:(T,x,E)=>E<y&&E<s?(x&&(rs.min.copy(T.min),rs.max.copy(T.max),rs.needsUpdate=!0),!0):!1,intersectsRange:(T,x)=>{if(t.boundsTree){const E=t.boundsTree;return E.shapecast({boundsTraverseOrder:C=>rs.distanceToBox(C),intersectsBounds:(C,L,D)=>D<y&&D<s,intersectsRange:(C,L)=>{for(let D=C,R=C+L;D<R;D++){const I=E.resolveTriangleIndex(D);tt(h,3*I,d,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let k=T,V=T+x;k<V;k++){const X=e.resolveTriangleIndex(k);tt(f,3*X,l,c),f.needsUpdate=!0;const $=f.distanceToTriangle(h,p,m);if($<y&&(g.copy(p),v&&v.copy(m),y=$,w=k,S=D),$<r)return!0}}}})}else{const E=Br(t);for(let C=0,L=E;C<L;C++){tt(h,3*C,d,u),h.a.applyMatrix4(n),h.b.applyMatrix4(n),h.c.applyMatrix4(n),h.needsUpdate=!0;for(let D=T,R=T+x;D<R;D++){const I=e.resolveTriangleIndex(D);tt(f,3*I,l,c),f.needsUpdate=!0;const k=f.distanceToTriangle(h,p,m);if(k<y&&(g.copy(p),v&&v.copy(m),y=k,w=D,S=C),k<r)return!0}}}}}),hn.releasePrimitive(f),hn.releasePrimitive(h),y===1/0?null:(o.point?o.point.copy(g):o.point=g.clone(),o.distance=y,o.faceIndex=w,i&&(i.point?i.point.copy(v):i.point=v.clone(),i.point.applyMatrix4(_a),g.applyMatrix4(_a),i.distance=g.sub(i.point).length(),i.faceIndex=S),o)}function n6(){return typeof SharedArrayBuffer<"u"}const Ms=new De.constructor,Ic=new De.constructor,Zo=new ph(()=>new kt),$i=new kt,er=new kt,xu=new kt,wu=new kt;let Su=!1;function o6(e,t,n,o){if(Su)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Su=!0;const i=e._roots,r=t._roots;let s,a=0,c=0;const l=new ne().copy(n).invert();for(let u=0,d=i.length;u<d;u++){Ms.setBuffer(i[u]),c=0;const f=Zo.getPrimitive();ze(0,Ms.float32Array,f),f.applyMatrix4(l);for(let h=0,p=r.length;h<p&&(Ic.setBuffer(r[u]),s=Ln(0,0,n,l,o,a,c,0,0,f),Ic.clearBuffer(),c+=r[h].length,!s);h++);if(Zo.releasePrimitive(f),Ms.clearBuffer(),a+=i[u].length,s)break}return Su=!1,s}function Ln(e,t,n,o,i,r=0,s=0,a=0,c=0,l=null,u=!1){let d,f;u?(d=Ic,f=Ms):(d=Ms,f=Ic);const h=d.float32Array,p=d.uint32Array,g=d.uint16Array,m=f.float32Array,v=f.uint32Array,y=f.uint16Array,w=e*2,S=t*2,T=Ct(w,g),x=Ct(S,y);let E=!1;if(x&&T)u?E=i(Wt(t,v),un(t*2,y),Wt(e,p),un(e*2,g),c,s+t,a,r+e):E=i(Wt(e,p),un(e*2,g),Wt(t,v),un(t*2,y),a,r+e,c,s+t);else if(x){const C=Zo.getPrimitive();ze(t,m,C),C.applyMatrix4(n);const L=fn(e),D=dn(e,p);ze(L,h,$i),ze(D,h,er);const R=C.intersectsBox($i),I=C.intersectsBox(er);E=R&&Ln(t,L,o,n,i,s,r,c,a+1,C,!u)||I&&Ln(t,D,o,n,i,s,r,c,a+1,C,!u),Zo.releasePrimitive(C)}else{const C=fn(t),L=dn(t,v);ze(C,m,xu),ze(L,m,wu);const D=l.intersectsBox(xu),R=l.intersectsBox(wu);if(D&&R)E=Ln(e,C,n,o,i,r,s,a,c+1,l,u)||Ln(e,L,n,o,i,r,s,a,c+1,l,u);else if(D)if(T)E=Ln(e,C,n,o,i,r,s,a,c+1,l,u);else{const I=Zo.getPrimitive();I.copy(xu).applyMatrix4(n);const k=fn(e),V=dn(e,p);ze(k,h,$i),ze(V,h,er);const X=I.intersectsBox($i),$=I.intersectsBox(er);E=X&&Ln(C,k,o,n,i,s,r,c,a+1,I,!u)||$&&Ln(C,V,o,n,i,s,r,c,a+1,I,!u),Zo.releasePrimitive(I)}else if(R)if(T)E=Ln(e,L,n,o,i,r,s,a,c+1,l,u);else{const I=Zo.getPrimitive();I.copy(wu).applyMatrix4(n);const k=fn(e),V=dn(e,p);ze(k,h,$i),ze(V,h,er);const X=I.intersectsBox($i),$=I.intersectsBox(er);E=X&&Ln(L,k,o,n,i,s,r,c,a+1,I,!u)||$&&Ln(L,V,o,n,i,s,r,c,a+1,I,!u),Zo.releasePrimitive(I)}}return E}const Ha=new Nt,dg=new kt,i6={strategy:my,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0};class na{static serialize(t,n={}){n={cloneBuffers:!0,...n};const o=t.geometry,i=t._roots,r=t._indirectBuffer,s=o.getIndex();let a;return n.cloneBuffers?a={roots:i.map(c=>c.slice()),index:s?s.array.slice():null,indirectBuffer:r?r.slice():null}:a={roots:i,index:s?s.array:null,indirectBuffer:r},a}static deserialize(t,n,o={}){o={setIndex:!0,indirect:!!t.indirectBuffer,...o};const{index:i,roots:r,indirectBuffer:s}=t,a=new na(n,{...o,[hu]:!0});if(a._roots=r,a._indirectBuffer=s||null,o.setIndex){const c=n.getIndex();if(c===null){const l=new Jn(t.index,1,!1);n.setIndex(l)}else c.array!==i&&(c.array.set(i),c.needsUpdate=!0)}return a}get indirect(){return!!this._indirectBuffer}constructor(t,n={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(n=Object.assign({...i6,[hu]:!1},n),n.useSharedArrayBuffer&&!n6())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=t,this._roots=null,this._indirectBuffer=null,n[hu]||(xM(this,n),!t.boundingBox&&n.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new kt))),this.resolveTriangleIndex=n.indirect?o=>this._indirectBuffer[o]:o=>o}refit(t=null){return(this.indirect?GM:FM)(this,t)}traverse(t,n=0){const o=this._roots[n],i=new Uint32Array(o),r=new Uint16Array(o);s(0);function s(a,c=0){const l=a*2,u=r[l+15]===El;if(u){const d=i[a+6],f=r[l+14];t(c,u,new Float32Array(o,a*4,6),d,f)}else{const d=a+Es/4,f=i[a+6],h=i[a+7];t(c,u,new Float32Array(o,a*4,6),h)||(s(d,c+1),s(f,c+1))}}}raycast(t,n=lp,o=0,i=1/0){const r=this._roots,s=this.geometry,a=[],c=n.isMaterial,l=Array.isArray(n),u=s.groups,d=c?n.side:n,f=this.indirect?XM:VM;for(let h=0,p=r.length;h<p;h++){const g=l?n[u[h].materialIndex].side:d,m=a.length;if(f(this,h,g,t,a,o,i),l){const v=u[h].materialIndex;for(let y=m,w=a.length;y<w;y++)a[y].face.materialIndex=v}}return a}raycastFirst(t,n=lp,o=0,i=1/0){const r=this._roots,s=this.geometry,a=n.isMaterial,c=Array.isArray(n);let l=null;const u=s.groups,d=a?n.side:n,f=this.indirect?KM:zM;for(let h=0,p=r.length;h<p;h++){const g=c?n[u[h].materialIndex].side:d,m=f(this,h,g,t,o,i);m!=null&&(l==null||m.distance<l.distance)&&(l=m,c&&(m.face.materialIndex=u[h].materialIndex))}return l}intersectsGeometry(t,n){let o=!1;const i=this._roots,r=this.indirect?YM:BM;for(let s=0,a=i.length;s<a&&(o=r(this,s,t,n),!o);s++);return o}shapecast(t){const n=hn.getPrimitive(),o=this.indirect?kM:IM;let{boundsTraverseOrder:i,intersectsBounds:r,intersectsRange:s,intersectsTriangle:a}=t;if(s&&a){const d=s;s=(f,h,p,g,m)=>d(f,h,p,g,m)?!0:o(f,h,this,a,p,g,n)}else s||(a?s=(d,f,h,p)=>o(d,f,this,a,h,p,n):s=(d,f,h)=>h);let c=!1,l=0;const u=this._roots;for(let d=0,f=u.length;d<f;d++){const h=u[d];if(c=PM(this,d,r,s,i,l),c)break;l+=h.byteLength}return hn.releasePrimitive(n),c}bvhcast(t,n,o){let{intersectsRanges:i,intersectsTriangles:r}=o;const s=hn.getPrimitive(),a=this.geometry.index,c=this.geometry.attributes.position,l=this.indirect?p=>{const g=this.resolveTriangleIndex(p);tt(s,g*3,a,c)}:p=>{tt(s,p*3,a,c)},u=hn.getPrimitive(),d=t.geometry.index,f=t.geometry.attributes.position,h=t.indirect?p=>{const g=t.resolveTriangleIndex(p);tt(u,g*3,d,f)}:p=>{tt(u,p*3,d,f)};if(r){const p=(g,m,v,y,w,S,T,x)=>{for(let E=v,C=v+y;E<C;E++){h(E),u.a.applyMatrix4(n),u.b.applyMatrix4(n),u.c.applyMatrix4(n),u.needsUpdate=!0;for(let L=g,D=g+m;L<D;L++)if(l(L),s.needsUpdate=!0,r(s,u,L,E,w,S,T,x))return!0}return!1};if(i){const g=i;i=function(m,v,y,w,S,T,x,E){return g(m,v,y,w,S,T,x,E)?!0:p(m,v,y,w,S,T,x,E)}}else i=p}return o6(this,t,n,i)}intersectsBox(t,n){return Ha.set(t.min,t.max,n),Ha.needsUpdate=!0,this.shapecast({intersectsBounds:o=>Ha.intersectsBox(o),intersectsTriangle:o=>Ha.intersectsTriangle(o)})}intersectsSphere(t){return this.shapecast({intersectsBounds:n=>t.intersectsBox(n),intersectsTriangle:n=>n.intersectsSphere(t)})}closestPointToGeometry(t,n,o={},i={},r=0,s=1/0){return(this.indirect?t6:WM)(this,t,n,o,i,r,s)}closestPointToPoint(t,n={},o=0,i=1/0){return NM(this,t,n,o,i)}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(o=>{ze(0,new Float32Array(o),dg),t.union(dg)}),t}}const hg=new kt;class r6 extends $c{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}constructor(t,n,o=10,i=0){super(),this.material=n,this.geometry=new Cr,this.name="MeshBVHRootHelper",this.depth=o,this.displayParents=!1,this.bvh=t,this.displayEdges=!0,this._group=i}raycast(){}update(){const t=this.geometry,n=this.bvh,o=this._group;if(t.dispose(),this.visible=!1,n){const i=this.depth-1,r=this.displayParents;let s=0;n.traverse((f,h)=>{if(f>=i||h)return s++,!0;r&&s++},o);let a=0;const c=new Float32Array(8*3*s);n.traverse((f,h,p)=>{const g=f>=i||h;if(g||r){ze(0,p,hg);const{min:m,max:v}=hg;for(let y=-1;y<=1;y+=2){const w=y<0?m.x:v.x;for(let S=-1;S<=1;S+=2){const T=S<0?m.y:v.y;for(let x=-1;x<=1;x+=2){const E=x<0?m.z:v.z;c[a+0]=w,c[a+1]=T,c[a+2]=E,a+=3}}}return g}},o);let l,u;this.displayEdges?u=new Uint8Array([0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]):u=new Uint8Array([0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),c.length>65535?l=new Uint32Array(u.length*s):l=new Uint16Array(u.length*s);const d=u.length;for(let f=0;f<s;f++){const h=f*8,p=f*d;for(let g=0;g<d;g++)l[p+g]=h+u[g]}t.setIndex(new Jn(l,1,!1)),t.setAttribute("position",new Jn(c,3,!1)),this.visible=!0}}}class mh extends G4{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(t){this.edgeMaterial.opacity=t,this.meshMaterial.opacity=t}constructor(t=null,n=null,o=10){t instanceof na&&(o=n||10,n=t,t=null),typeof n=="number"&&(o=n,n=null),super(),this.name="MeshBVHHelper",this.depth=o,this.mesh=t,this.bvh=n,this.displayParents=!1,this.displayEdges=!0,this._roots=[];const i=new Gs({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),r=new ri({color:65416,transparent:!0,opacity:.3,depthWrite:!1});r.color=i.color,this.edgeMaterial=i,this.meshMaterial=r,this.update()}update(){const t=this.bvh||this.mesh.geometry.boundsTree,n=t?t._roots.length:0;for(;this._roots.length>n;){const o=this._roots.pop();o.geometry.dispose(),this.remove(o)}for(let o=0;o<n;o++){const{depth:i,edgeMaterial:r,meshMaterial:s,displayParents:a,displayEdges:c}=this;if(o>=this._roots.length){const u=new r6(t,r,i,o);this.add(u),this._roots.push(u)}const l=this._roots[o];l.bvh=t,l.depth=i,l.displayParents=a,l.displayEdges=c,l.material=c?r:s,l.update()}}updateMatrixWorld(...t){const n=this.mesh,o=this.parent;n!==null&&(n.updateWorldMatrix(!0,!1),o?this.matrix.copy(o.matrixWorld).invert().multiply(n.matrixWorld):this.matrix.copy(n.matrixWorld),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...t)}copy(t){this.depth=t.depth,this.mesh=t.mesh,this.bvh=t.bvh,this.opacity=t.opacity,this.color.copy(t.color)}clone(){return new mh(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();const t=this.children;for(let n=0,o=t.length;n<o;n++)t[n].geometry.dispose()}}Qn.prototype.raycast;function s6(e){return this.boundsTree=new na(this,e),this.boundsTree}function a6(){this.boundsTree=null}const c6=()=>{if(Ar)return new Jh("/workers/generateBVHAsync.worker.js");{const t=require("path").resolve(__dirname,"./generateBVHAsync.register.js");return new Jh(t,{type:"module"})}},wy=new lb(1);wy.setWorkerCreator(c6);async function l6(e,t,n={}){if(!e.isMesh||e.isInstancedMesh||!e.geometry||!e.geometry.attributes.position||e.geometry.boundsTree)return Promise.resolve();const o=e.geometry,i=o.index?Uint32Array.from(o.index.array):null,r=Float32Array.from(o.attributes.position.array),s=[r];i&&s.push(i);const a=await wy.postMessage({index:i,position:r,options:n},s.map(u=>u.buffer)),{serialized:c,error:l}=a.data;if(l)return console.error(l);{o.setIndex(new Jn(c.index,1));const u=na.deserialize(c,o);return Object.assign({setBoundingBox:!0},n).setBoundingBox&&(o.boundingBox=u.getBoundingBox(new kt)),o.boundsTree=u,u}}const Tu=new X4,pg=new ne,u6=Qn.prototype.raycast;function Sy(e){return e!==void 0&&e.isMesh&&!e.isInstancedMesh&&!e.isSkinnedMesh}function mg(e,t,n){return e===null||(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(n.ray.origin),e.object=t,e.distance<n.near||e.distance>n.far)?null:e}function f6(e,t){const n=this,o=n.geometry;if(o.boundsTree){if(n.material===void 0)return;pg.copy(n.matrixWorld).invert(),Tu.copy(e.ray).applyMatrix4(pg);const i=o.boundsTree;if(e.firstHitOnly===!0){const r=mg(i.raycastFirst(Tu,n.material),n,e);r&&t.push(r)}else{const r=i.raycast(Tu,n.material);for(let s=0,a=r.length;s<a;s++){const c=mg(r[s],n,e);c&&t.push(c)}}}else(!Sy(n)||!de(n.entity,Ye))&&u6.call(n,e,t)}Qn.prototype.raycast=f6;Z4.prototype.raycast=()=>{};Cr.prototype.disposeBoundsTree=a6;Cr.prototype.computeBoundsTree=s6;const d6=new Gs({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),h6=()=>{const e=je(),t=We(Q(Pr).bvhDebug),n=se(e,Ye);return A.useEffect(()=>{const o=ue(e,Ye);if(!o)return;const i=new AbortController;return Sy(o)&&l6(o,i.signal).then(()=>{i.signal.aborted}),()=>{i.abort()}},[n]),A.useEffect(()=>{if(!t.value)return;const o=M(e,Ye),i=new mh(o);return i.edgeMaterial=d6,i.depth=20,i.displayParents=!1,i.update(),Rt(e,i),()=>{ju(e,i)}},[t.value]),null};ee({uuid:"ee.engine.MeshBVHSystem",insert:{after:Yt},reactor:()=>te.createElement(Xt,{Components:[Ye],ChildEntityReactor:h6})});const p6=()=>{const e=B(fb).renderers;for(const t of Object.values(e)){const n=t.renderer,o=B(ht).deltaSeconds;n.update(o)}};ee({uuid:"ee.engine.ParticleSystem",insert:{with:M1},execute:p6});const m6=()=>{const e=We(Q(ir).activePortalEntity);return A.useEffect(()=>{const t=e.value;if(!t)return;const n=M(t,Q1);gt(ye.instance.cameraEntity,Hs).mode.set(Fu.ShoulderCam);const o=he.getSelfAvatarEntity();return Kn.captureMovement(o,t),()=>{const i=he.getSelfAvatarEntity();B(P1)[M(i,Se)].spawnPosition.copy(n.remoteSpawnPosition),Kn.releaseMovement(i,t),Q(ir).lastPortalTimeout.set(Date.now())}},[e]),null};ee({uuid:"ee.engine.PortalSystem",insert:{after:Yt},reactor:m6});const g6=ie([Tt,Di,Zf(u1)]),v6=ie([dy]),y6=new P,b6=()=>{var i;const t=v6().map(r=>[$h(r,[ep]),M(r,dy).sceneKillHeight]),n=g6(),o=xt.isCameraAttachedToAvatar;for(const r of n){const s=$h(r,[ep]),a=(i=t.find(([l])=>l===s))==null?void 0:i[1];if(typeof a!="number")continue;const c=M(r,Tt).position;if(c.y<a){const l=M(r,Se),u=B(P1)[l];if(O(r,q,{position:u==null?void 0:u.spawnPosition,rotation:u==null?void 0:u.spawnRotation}),q.dirtyTransforms[r]=!0,!o)continue;E4(r,y6.subVectors(u==null?void 0:u.spawnPosition,c))}}};ee({uuid:"ee.engine.SceneKillHeightSystem",insert:{before:o1},execute:b6});let Eu=0;const x6=_s?.5:1,w6=ie([Zu]),S6=()=>{var o;if(B(io).isEditor||(Eu+=B(ht).deltaSeconds,Eu<1))return;Eu=0;const t=he.getSelfAvatarEntity(),n=(o=ue(t,q))==null?void 0:o.position;if(n)for(const i of w6()){const r=M(i,Zu);if(r.mode!=="distance")continue;const s=M(i,q),a=n.distanceToSquared(s.position),c=r.distance*r.distance*x6;gt(i,Zu).loaded.set(a<c)}};ee({uuid:"ee.engine.scene.SceneObjectDynamicLoadSystem",insert:{after:Yt},execute:S6});const Mu=new ne;class Pl{constructor(t={}){F(this,"vertices",{near:[new P,new P,new P,new P],far:[new P,new P,new P,new P]});t.projectionMatrix!==void 0&&this.setFromProjectionMatrix(t.projectionMatrix,t.maxFar||1e4)}setFromProjectionMatrix(t,n){const o=t.elements[11]===0;return Mu.copy(t).invert(),this.vertices.near[0].set(1,1,-1),this.vertices.near[1].set(1,-1,-1),this.vertices.near[2].set(-1,-1,-1),this.vertices.near[3].set(-1,1,-1),this.vertices.near.forEach(function(i){i.applyMatrix4(Mu)}),this.vertices.far[0].set(1,1,1),this.vertices.far[1].set(1,-1,1),this.vertices.far[2].set(-1,-1,1),this.vertices.far[3].set(-1,1,1),this.vertices.far.forEach(function(i){i.applyMatrix4(Mu);const r=Math.abs(i.z);o?i.z*=Math.min(n/r,1):i.multiplyScalar(Math.min(n/r,1))}),this.vertices}split(t,n){for(;t.length>n.length;)n.push(new Pl);n.length=t.length;for(let o=0;o<t.length;o++){const i=n[o];if(o===0)for(let r=0;r<4;r++)i.vertices.near[r].copy(this.vertices.near[r]);else for(let r=0;r<4;r++)i.vertices.near[r].lerpVectors(this.vertices.near[r],this.vertices.far[r],t[o-1]);if(o===t.length-1)for(let r=0;r<4;r++)i.vertices.far[r].copy(this.vertices.far[r]);else for(let r=0;r<4;r++)i.vertices.far[r].lerpVectors(this.vertices.near[r],this.vertices.far[r],t[o])}}toSpace(t,n){for(let o=0;o<4;o++)n.vertices.near[o].copy(this.vertices.near[o]).applyMatrix4(t),n.vertices.far[o].copy(this.vertices.far[o]).applyMatrix4(t)}}const T6=me.lights_pars_begin,gg={lights_fragment_begin:e=>`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal;

#ifdef CLEARCOAT

  geometryClearcoatNormal = clearcoatNormal;

#endif

IncidentLight directLight;

#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )

	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {

		pointLight = pointLights[ i ];

		getPointLightInfo( pointLight, geometryPosition, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )

	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {

		spotLight = spotLights[ i ];

		getSpotLightInfo( spotLight, geometryPosition, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_DIR_LIGHTS > 0) && defined( RE_Direct ) && defined( USE_CSM ) && defined( CSM_CASCADES )

	DirectionalLight directionalLight;
	float linearDepth = (vViewPosition.z) / (shadowFar - cameraNear);
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#if defined( USE_SHADOWMAP ) && defined( CSM_FADE )
	vec2 cascade;
	float cascadeCenter;
	float closestEdge;
	float margin;
	float csmx;
	float csmy;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );

	  	#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
			// NOTE: Depth gets larger away from the camera.
			// cascade.x is closer, cascade.y is further

				#if ( UNROLLED_LOOP_INDEX < ${e} )

					// NOTE: Apply CSM shadows

					cascade = CSM_cascades[ i ];
					cascadeCenter = ( cascade.x + cascade.y ) / 2.0;
					closestEdge = linearDepth < cascadeCenter ? cascade.x : cascade.y;
					margin = 0.25 * pow( closestEdge, 2.0 );
					csmx = cascade.x - margin / 2.0;
					csmy = cascade.y + margin / 2.0;
					if( linearDepth >= csmx && ( linearDepth < csmy || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 ) ) {

						float dist = min( linearDepth - csmx, csmy - linearDepth );
						float ratio = clamp( dist / margin, 0.0, 1.0 );

						vec3 prevColor = directLight.color;
						directionalLightShadow = directionalLightShadows[ i ];
						directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

						bool shouldFadeLastCascade = UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth > cascadeCenter;
						directLight.color = mix( prevColor, directLight.color, shouldFadeLastCascade ? ratio : 1.0 );

						ReflectedLight prevLight = reflectedLight;
						RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

						bool shouldBlend = UNROLLED_LOOP_INDEX != CSM_CASCADES - 1 || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1 && linearDepth < cascadeCenter;
						float blendRatio = shouldBlend ? ratio : 1.0;

						reflectedLight.directDiffuse = mix( prevLight.directDiffuse, reflectedLight.directDiffuse, blendRatio );
						reflectedLight.directSpecular = mix( prevLight.directSpecular, reflectedLight.directSpecular, blendRatio );
						reflectedLight.indirectDiffuse = mix( prevLight.indirectDiffuse, reflectedLight.indirectDiffuse, blendRatio );
						reflectedLight.indirectSpecular = mix( prevLight.indirectSpecular, reflectedLight.indirectSpecular, blendRatio );

					}

				#else

					// NOTE: Apply the reminder of directional lights

					directionalLightShadow = directionalLightShadows[ i ];
					directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

					RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

				#endif

	  	#endif

	}
	#pragma unroll_loop_end
	#else

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

			directionalLight = directionalLights[ i ];
			getDirectionalLightInfo( directionalLight, directLight );

			#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS ) 

				#if ( UNROLLED_LOOP_INDEX < ${e} )

					// NOTE: Apply CSM shadows

					directionalLightShadow = directionalLightShadows[ i ];
					if(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y) directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;

					if(linearDepth >= CSM_cascades[UNROLLED_LOOP_INDEX].x && (linearDepth < CSM_cascades[UNROLLED_LOOP_INDEX].y || UNROLLED_LOOP_INDEX == CSM_CASCADES - 1)) RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

				#else

					// NOTE: Apply the reminder of directional lights

					directionalLightShadow = directionalLightShadows[ i ];
					directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	
					RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

				#endif

			#endif

		}
		#pragma unroll_loop_end

	#endif

	#if ( NUM_DIR_LIGHTS > NUM_DIR_LIGHT_SHADOWS)
		// compute the lights not casting shadows (if any)

		#pragma unroll_loop_start
		for ( int i = NUM_DIR_LIGHT_SHADOWS; i < NUM_DIR_LIGHTS; i ++ ) {

			directionalLight = directionalLights[ i ];

			getDirectionalLightInfo( directionalLight, directLight );

			RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

		}
		#pragma unroll_loop_end

	#endif

#endif


#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct ) && !defined( USE_CSM ) && !defined( CSM_CASCADES )

	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {

		directionalLight = directionalLights[ i ];

		getDirectionalLightInfo( directionalLight, directLight );

		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif

		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )

	RectAreaLight rectAreaLight;

	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {

		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );

	}
	#pragma unroll_loop_end

#endif

#if defined( RE_IndirectDiffuse )

	vec3 iblIrradiance = vec3( 0.0 );

	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );

	#if defined( USE_LIGHT_PROBES )

		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );

	#endif

	#if ( NUM_HEMI_LIGHTS > 0 )

		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {

			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );

		}
		#pragma unroll_loop_end

	#endif

#endif

#if defined( RE_IndirectSpecular )

	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );

#endif
`,lights_pars_begin:()=>`
#if defined( USE_CSM ) && defined( CSM_CASCADES )
uniform vec2 CSM_cascades[CSM_CASCADES];
uniform float cameraNear;
uniform float shadowFar;
#endif
	`+T6},E6=me.lights_fragment_begin,M6=me.lights_pars_begin,Pu=new ne,vg=new ne,yg=new ne,Nu=new Pl,lo=new P,ss=new kt,Au=[],Cu=[],as={UNIFORM:"UNIFORM",LOGARITHMIC:"LOGARITHMIC",PRACTICAL:"PRACTICAL",CUSTOM:"CUSTOM"};class P6{constructor(t){F(this,"cascades");F(this,"maxFar");F(this,"mode");F(this,"shadowBias");F(this,"shadowNormalBias");F(this,"shadowMapSize");F(this,"lightDirection");F(this,"lightDirectionUp");F(this,"lightColor");F(this,"lightIntensity");F(this,"lightMargin");F(this,"customSplitsCallback");F(this,"fade");F(this,"mainFrustum");F(this,"frustums");F(this,"breaks");F(this,"sourceLight");F(this,"lights");F(this,"lightEntities");F(this,"lightSourcesCount");F(this,"shaders",new Map);F(this,"materials",new Set);F(this,"needsUpdate",!1);this.cascades=t.cascades??5,this.maxFar=t.maxFar??100,this.mode=t.mode??as.PRACTICAL,this.shadowMapSize=t.shadowMapSize??1024,this.shadowBias=t.shadowBias??0,this.shadowNormalBias=0,this.lightDirection=t.lightDirection??new P(1,-1,1).normalize(),this.lightDirectionUp=t.lightDirectionUp??$c.DEFAULT_UP,this.lightColor=t.lightColor??16777215,this.lightIntensity=t.lightIntensity??1,this.lightMargin=t.lightMargin??200,this.customSplitsCallback=t.customSplitsCallback,this.fade=t.fade??!0,this.mainFrustum=new Pl,this.frustums=[],this.breaks=[],this.lights=[],this.lightEntities=[],this.createLights(t.light),this.updateFrustums(),this.injectInclude()}changeLights(t){t!==this.sourceLight&&(this.remove(),this.createLights(t),this.updateShadowBounds())}updateProperty(t,n){const o=t.split("."),i=o[o.length-1];this.lights.forEach(r=>{let s=r;for(let a=0;a<o.length-1;a++)s=s[o[a]];s[i]&&typeof s[i].copy=="function"?s[i].copy(n):s[i]=n})}createLight(t,n){t.castShadow=!0,t.frustumCulled=!1,t.shadow.mapSize.width=this.shadowMapSize,t.shadow.mapSize.height=this.shadowMapSize,t.shadow.camera.near=0,t.shadow.camera.far=1,t.intensity=this.lightIntensity;const o=It();Rt(o,t),O(o,at,"CSM light "+n),O(o,yn),O(o,Lt,{parentEntity:ye.instance.originEntity}),this.lightEntities.push(o),this.lights.push(t),t.name="CSM_"+t.name,t.target.name="CSM_"+t.target.name}createLights(t){if(t){this.sourceLight=t,this.shadowBias=t.shadow.bias,this.lightIntensity=t.intensity;for(let n=0;n<this.cascades;n++){const o=t.clone();this.createLight(o,n)}return}for(let n=0;n<this.cascades;n++){const o=new K4(this.lightColor,this.lightIntensity);this.createLight(o,n)}}initCascades(){const t=M(ye.instance.cameraEntity,qt);t.updateProjectionMatrix(),this.mainFrustum.setFromProjectionMatrix(t.projectionMatrix,this.maxFar),this.mainFrustum.split(this.breaks,this.frustums)}updateShadowBounds(){const t=this.frustums;for(let n=0;n<t.length;n++){const o=this.lights[n],i=o.shadow.camera,r=this.frustums[n],s=r.vertices.near,a=r.vertices.far,c=a[0];let l;c.distanceTo(a[2])>c.distanceTo(s[2])?l=a[2]:l=s[2];let u=c.distanceTo(l);if(this.fade){const d=M(ye.instance.cameraEntity,qt),f=Math.max(d.far,this.maxFar),h=r.vertices.far[0].z/(f-d.near),p=.25*Math.pow(h,2)*(f-d.near);u+=p}i.left=-u/2,i.right=u/2,i.top=u/2,i.bottom=-u/2,i.near=0,i.far=u+this.lightMargin,i.updateProjectionMatrix(),o.shadow.bias=this.shadowBias*u,o.shadow.normalBias=this.shadowNormalBias*u}}getBreaks(){const t=M(ye.instance.cameraEntity,qt),n=Math.min(t.far,this.maxFar);switch(this.breaks.length=0,this.mode){case as.UNIFORM:o(this.cascades,t.near,n,this.breaks);break;case as.LOGARITHMIC:i(this.cascades,t.near,n,this.breaks);break;case as.PRACTICAL:r(this.cascades,t.near,n,.5,this.breaks);break;case as.CUSTOM:this.customSplitsCallback===void 0&&console.error("CSM: Custom split scheme callback not defined."),this.customSplitsCallback(this.cascades,t.near,n,this.breaks);break}function o(s,a,c,l){for(let u=1;u<s;u++)l.push((a+(c-a)*u/s)/c);l.push(1)}function i(s,a,c,l){for(let u=1;u<s;u++)l.push(a*(c/a)**(u/s)/c);l.push(1)}function r(s,a,c,l,u){Au.length=0,Cu.length=0,i(s,a,c,Cu),o(s,a,c,Au);for(let d=1;d<s;d++)u.push(Ht.lerp(Au[d-1],Cu[d-1],l));u.push(1)}}update(){var o;if(this.sourceLight&&this.lightDirection.subVectors(this.sourceLight.target.position,this.sourceLight.position),this.needsUpdate){this.injectInclude(),this.updateFrustums();for(const i of this.lights)(o=i.shadow.map)==null||o.dispose(),i.shadow.map=null,i.shadow.camera.updateProjectionMatrix(),i.shadow.needsUpdate=!0;this.needsUpdate=!1}const t=M(ye.instance.cameraEntity,q),n=this.frustums;for(let i=0;i<n.length;i++){const r=this.lights[i],s=n[i],a=r.shadow.camera,c=(a.right-a.left)/this.shadowMapSize,l=(a.top-a.bottom)/this.shadowMapSize;Pu.lookAt(pc,this.lightDirection,this.lightDirectionUp),vg.copy(Pu).invert(),yg.multiplyMatrices(vg,t.matrixWorld),s.toSpace(yg,Nu);const u=Nu.vertices.near,d=Nu.vertices.far;ss.makeEmpty();for(let f=0;f<4;f++)ss.expandByPoint(u[f]),ss.expandByPoint(d[f]);ss.getCenter(lo),lo.z=ss.max.z+this.lightMargin,lo.x=Math.floor(lo.x/c)*c,lo.y=Math.floor(lo.y/l)*l,lo.applyMatrix4(Pu),M(this.lightEntities[i],q).position.copy(lo),r.target.position.copy(lo).add(this.lightDirection),r.target.matrix.compose(r.target.position,r.target.quaternion,r.target.scale),r.target.matrixWorld.copy(r.target.matrix)}}injectInclude(){me.lights_fragment_begin=gg.lights_fragment_begin(this.cascades),me.lights_pars_begin=gg.lights_pars_begin()}removeInclude(){me.lights_fragment_begin=E6,me.lights_pars_begin=M6}setupMaterial(t){const n=t.material;n.userData||(n.userData={});const o=this.materials;if(n.userData.IGNORE_CSM||o.has(n))return;o.add(n),n.defines=n.defines||{},n.defines.USE_CSM=1,n.defines.CSM_CASCADES=this.cascades,this.fade&&(n.defines.CSM_FADE="");const i=this.shaders;i.delete(n),n.userData.CSMPlugin={id:"CSM"+Math.random(),compile:r=>{const s=M(ye.instance.cameraEntity,qt),a=Math.min(s.far,this.maxFar),c=Math.min(this.maxFar,s.near);r.uniforms.CSM_cascades||(r.uniforms.CSM_cascades={value:[]}),this.getExtendedBreaks(r.uniforms.CSM_cascades.value),r.uniforms.cameraNear={value:c},r.uniforms.shadowFar={value:a},i.set(n,r),this.needsUpdate=!0}},Jf(n,n.userData.CSMPlugin)}teardownMaterial(t){t!=null&&t.isMaterial&&(t.userData||(t.userData={}),t.userData.CSMPlugin&&(b1(t,t.userData.CSMPlugin),delete t.userData.CSMPlugin),t.defines&&(delete t.defines.USE_CSM,delete t.defines.CSM_CASCADES,delete t.defines.CSM_FADE),t.needsUpdate=!0,this.shaders.delete(t),this.materials.delete(t))}updateUniforms(){const t=M(ye.instance.cameraEntity,qt),n=Math.min(t.far,this.maxFar);for(const[o,i]of this.shaders.entries()){const r=M(ye.instance.cameraEntity,qt);if(i!==null){const s=i.uniforms;s.cameraNear.value=Math.min(this.maxFar,r.near),s.shadowFar.value=n}!this.fade&&"CSM_FADE"in o.defines?(delete o.defines.CSM_FADE,o.needsUpdate=!0):this.fade&&!("CSM_FADE"in o.defines)&&(o.defines.CSM_FADE="",o.needsUpdate=!0)}}getExtendedBreaks(t){for(;t.length<this.breaks.length;)t.push(new Me);t.length=this.breaks.length;for(let n=0;n<this.cascades;n++){const o=this.breaks[n]||0,i=this.breaks[n-1]||0;t[n].x=i,t[n].y=o}return t}updateFrustums(){this.getBreaks(),this.initCascades(),this.updateShadowBounds(),this.updateUniforms()}remove(){this.lightEntities.forEach(t=>{Gt(t)}),this.lights.forEach(t=>{t.dispose()}),this.lightEntities=[],this.lights=[]}dispose(){this.materials.forEach(t=>{this.teardownMaterial(t)}),this.materials.clear(),this.shaders.clear(),this.remove(),this.removeInclude()}}const Ty=()=>{const e=B(Pr);return!Lr&&!N1&&e.useShadows},Ey=()=>{const e=Q(Pr),t=We(e.useShadows).value;return!Lr&&!N1&&t},Ps=yt({name:"DropShadowComponent",schema:_.Object({radius:_.Number(0),center:_.Vec3(),entity:_.Entity()})}),N6=Oi({name:"ee.engine.scene.ShadowSystemState",initial:()=>({priorityQueue:G1({accumulationBudget:Lr?4:20})})}),A6=new P(0,-1,0),bg=new re,Rf=new Y4;Rf.firstHitOnly=!0;const xg=new P,C6=e=>{const{entity:t,rendererEntity:n,renderSettingsEntity:o}=e,i=se(n,Yn),r=se(o,$f),s=se(t,C1),a=We(Q(Pr).shadowMapResolution),c=s.light.get(dr),l=i.csm.get(dr);return A.useEffect(()=>{if(!c||!s.castShadow.value)return;const u=new P6({light:c,shadowMapSize:a.value,shadowBias:s.shadowBias.value,maxFar:s.cameraFar.value,lightIntensity:s.intensity.value,lightColor:s.color.value,cascades:r.cascades.value});return i.csm.set(u),()=>{u.dispose(),de(n,Yn)&&i.csm.set(null)}},[c,s==null?void 0:s.castShadow.value]),t1(()=>{!c||!s.castShadow.value||(c.visible=!1)},{after:M1}),A.useEffect(()=>{if(l&&c&&s.castShadow.value){l.shadowBias=c.shadow.bias,l.maxFar=s.cameraFar.value,l.shadowMapSize=a.value;for(const u of l.lights)u.color.set(new vt(s.color.value)),u.intensity=s.intensity.value,u.shadow.mapSize.setScalar(a.value),u.shadow.radius=s.shadowRadius.value;l.needsUpdate=!0}},[i.csm,a,c,s.shadowBias,s.intensity,s.color,s.castShadow,s.shadowRadius,s.cameraFar]),A.useEffect(()=>{l&&(l.cascades=r.cascades.value,l.needsUpdate=!0)},[l,r.cascades]),te.createElement(Xt,{Components:[Xc,mt],ChildEntityReactor:L6,props:{rendererEntity:n}})},L6=e=>{const t=je(),{rendererEntity:n}=e,o=se(t,Xc),i=se(t,mt),r=se(n,Yn).csm.value;return A.useEffect(()=>{if(!r||!o.receive.value||!i)return;const s=[...i.value];for(const a of s)a.material&&r.setupMaterial(a);return()=>{for(const a of s)a.material&&r.teardownMaterial(a.material)}},[o.receive,r]),null};function D6(){const e=je(),t=se(e,Yn).value,n=e4(t.scenes[0],[$f]),o=We(Q(io).isEditor).value,i=We(Q(Pr).renderMode).value;return!e||!n||o&&i===tp.UNLIT||i===tp.LIT?null:te.createElement(I6,{rendererEntity:e,renderSettingsEntity:n})}function I6(e){const{rendererEntity:t,renderSettingsEntity:n}=e,o=se(n,$f),i=We(Q(t4).directionalLightEntity),r=We(Se.getEntityByUUID(o.primaryLight.value)),s=Zn(r.value,C1);return A.useEffect(()=>{if(t===ye.instance.viewerEntity&&i.value){r.set(i.value);return}if(o.primaryLight.value){r.set(Se.getEntityByUUID(o.primaryLight.value));return}r.set(Li)},[i.value,o.primaryLight]),!o.csm.value||!r.value||!s?null:te.createElement(C6,{key:r.value,entity:r.value,rendererEntity:t,renderSettingsEntity:n})}const F6=new As(1,1,1,1).rotateX(-Math.PI),Of=new ri({side:Qc,transparent:!0,opacity:1,polygonOffset:!0,polygonOffsetFactor:-2,polygonOffsetUnits:.01}),R6=ie([Ps]),O6=.15,k6=5,qa=new q1,Lu=new kt,V6=new P,U6=()=>{const e=je(),t=n4(e),n=se(e,Xc);return A.useEffect(()=>{if(!n.cast.value||!t||de(e,Ps))return;Lu.makeEmpty();let o=!1;if(zu(e,l=>{const u=ue(l,Ye);u&&(Lu.expandByObject(u),o=!0)}),!o||(Lu.getBoundingSphere(qa),qa.radius>k6))return;const i=Math.max(qa.radius*2,O6),r=qa.center.sub(q.getWorldPosition(e,V6)),s=It(),[a,c]=o4(Qn,s,F6.clone(),Of.clone());return Rt(s,a),O(s,Lt,{parentEntity:ye.instance.originEntity}),O(s,at,"Shadow for "+M(e,at)+"_"+M(e,Se)),O(s,yn),O(s,A1[Dn.Scene]),O(e,Ps,{radius:i,center:r,entity:s}),()=>{Qe(e,Ps),Gt(s),c()}},[t,n]),null},z6=new P(0,.01,0),B6=X1(R6,s1),j6=[],_6=ie([A1[Dn.Scene],Ye]),H6=()=>{const{deltaSeconds:e}=B(ht),{priorityQueue:t}=B(N6);B6(t,j6,e);const n=_6().flatMap(o=>M(o,Ye));for(const o of t.priorityEntities){const i=M(o,Ps),r=M(i.entity,q);q.getWorldPosition(o,xg).add(i.center),Rf.set(xg,A6);const s=Rf.intersectObjects(n,!1)[0];if(!s||!s.face){r.scale.setScalar(0);continue}const a=Math.max(s.distance-i.center.y,1e-4),l=.3*i.radius+i.radius*a*.5,u=M(i.entity,mt)[0].material;u.opacity=Math.min(1/(1+a),1)*1.2,bg.setFromUnitVectors(s.face.normal,ib),r.rotation.copy(bg),r.scale.setScalar(l*2),r.position.copy(s.point).add(z6)}},q6=ie([Yn]),W6=()=>{if(!(!Ar||!Ty()))for(const t of q6()){const{csm:n,csmHelper:o}=M(t,Yn);n&&n.update()}},G6=()=>{const e=je(),t=Ey(),n=se(e,Yn);return A.useEffect(()=>{const o=M(e,Yn).renderer;o&&(o.shadowMap.enabled=o.shadowMap.autoUpdate=t)},[t,n.renderer]),null},X6=()=>{if(!Ar)return null;const e=Ey(),[t]=Ii(`${B(Yf).cloudDomain}/projects/ir-engine/default-project/assets/drop-shadow.png`);return A.useEffect(()=>{t&&(Of.map=t,Of.needsUpdate=!0)},[t]),te.createElement(te.Fragment,null,e?te.createElement(Xt,{Components:[Yn],ChildEntityReactor:D6}):t?te.createElement(Xt,{Components:[yn,Xc],ChildEntityReactor:U6}):null,te.createElement(Xt,{Components:[Yn],ChildEntityReactor:G6}))};ee({uuid:"ee.engine.ShadowSystem",insert:{with:e1},execute:W6,reactor:X6});ee({uuid:"ee.engine.DropShadowSystem",insert:{after:Wc},execute:()=>{if(!Ar)return;Ty()||H6()}});const Z6=.1;let wg=0;const My=ie([In,js,q]),K6=ie([In,Ye,q,Zf(Gc)]),Y6=ie([In,Ye,q,Gc]);function Q6(){if(B(io).isEditing)return;const t=B(ht);if(!(t.elapsedSeconds-wg<Z6)){wg=t.elapsedSeconds;for(const n of My())Q5(n);for(const n of K6())J5(n);for(const n of Y6())py(n)}}function J6(){const e=Nr(i4).gpuPerformanceOffset;return A.useEffect(()=>{if(B(io).isEditing)return;const t=e.value;for(const n of My())Y5(n,t)},[e]),null}ee({uuid:"ee.engine.scene.VariantSystem",insert:{after:Yt},execute:Q6,reactor:J6});class Te{static mustEqual(t,n,o=""){if(t!==n)throw new Error(`failed assertion: ${t} must equal ${n}.  ${o}`)}static mustBeTrue(t,n=""){if(!t)throw new Error(`failed assertion: ${n}`)}static mustBeDefined(t,n=""){if(t===void 0)throw new Error(`failed assertion: variable must be defined ${n}`)}}class jo{constructor(){F(this,"listeners",[])}addListener(t){this.listeners.push(t)}removeListener(t){this.listeners.splice(this.listeners.indexOf(t),1)}clear(){this.listeners.splice(0,this.listeners.length)}emit(t){this.listeners.length!==0&&this.listeners.slice(0).forEach(n=>{n(t)})}get listenerCount(){return this.listeners.length}}function Sg(e){switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3}}const Ko=class Ko{static log(t,n){this.onLog.emit({severity:t,text:n})}static verbose(t){this.onLog.emit({severity:"verbose",text:t})}static info(t){this.onLog.emit({severity:"info",text:t})}static warning(t){this.onLog.emit({severity:"warning",text:t})}static error(t){this.onLog.emit({severity:"error",text:t})}};F(Ko,"logLevel",1),F(Ko,"prefixStyle",1),F(Ko,"onLog",new jo),(()=>{const t=()=>{switch(Ko.prefixStyle){case 0:return"";case 1:return"[ee Visual Script]:";case 2:return new Date().toLocaleTimeString().padStart(11,"0")+" "}};Ko.onLog.addListener(n=>{if(!(Ko.logLevel>Sg(n.severity)))switch(Sg(n.severity)){case 1:console.info(t()+n.text);break;case 2:console.warn(t()+n.text);break;case 3:console.error(t()+n.text);break}})})();let ks=Ko;const Tg={linear:e=>e,quadratic:e=>e*e,cubic:e=>e*e*e,quartric:e=>e*e*e*e,quintic:e=>e*e*e*e*e,sine:e=>1-Math.cos(e*Math.PI/2),exponential:e=>Math.pow(2,10*(e-1)),circle:e=>1-Math.sqrt(1-e*e),back:e=>e*e*((1.70158+1)*e-1.70158),elastic:e=>1-Math.pow(Math.cos(e*Math.PI/2),3)*Math.cos(e*Math.PI),bounce:e=>{if(e<1/2.75)return 7.5625*e*e;if(e<2/2.75){const n=e-.5454545454545454;return 7.5625*n*n+.75}if(e<2.5/2.75){const n=e-.8181818181818182;return 7.5625*n*n+.9375}const t=e-2.625/2.75;return 7.5625*t*t+.984375}},Eg={in:e=>e,out:e=>t=>1-e(1-t),inOut:e=>t=>t<.5?e(t*2)/2:1-e((1-t)*2)/2};class gh{constructor(t,n,o=[]){F(this,"label","");F(this,"metadata",{});F(this,"eventEmitter",new jo);this.id=t,this.name=n,this.parameters=o}}const Py=(e,t,n)=>{const o=e.find(i=>i.name===t);if(o===void 0)throw new Error(`can not find input socket with name ${t} on node of type ${n}`);return o.value},Ny=(e,t,n,o)=>{const i=e.find(r=>r.name===t);if(i===void 0)throw new Error(`can not find output socket with name ${t} on node of type ${o}`);i.value=n};var En=(e=>(e.Event="Event",e.Flow="Flow",e.Async="Async",e.Function="Function",e))(En||{});const Mg=e=>e.nodeType==="Flow",Pg=e=>e.nodeType==="Event",Ay=e=>e.nodeType==="Async",Ng=e=>e.nodeType==="Function";function vh(e,t){if(t.links.length===0)return 0;const n=e.nodes,o=t.links[0];if((o._targetNode===void 0||o._targetSocket===void 0)&&(Te.mustBeTrue(t.links.length===1),o._targetNode=n[o.nodeId],o._targetSocket=o._targetNode.outputs.find(a=>a.name===o.socketName),o._targetSocket===void 0))throw new Error(`can not find socket with the name ${o.socketName}`);const i=o._targetNode,r=o._targetSocket;if(!Ng(i))return t.value=r.value,0;let s=0;if(Ng(i)){for(const a of i.inputs)s+=vh(e,a);return e.onNodeExecutionStart.emit(i),i.exec(i),s++,e.onNodeExecutionEnd.emit(i),t.value=r.value,s}return 0}class $6{constructor(t,n,o=void 0){F(this,"fiberCompletedListenerStack",[]);F(this,"nodes");F(this,"executionSteps",0);this.engine=t,this.nextEval=n,this.nodes=t.nodes,o!==void 0&&this.fiberCompletedListenerStack.push(o)}commit(t,n,o=void 0){Te.mustBeTrue(Mg(t)),Te.mustBeTrue(this.nextEval===null);const i=t.outputs.find(r=>r.name===n);if(i===void 0)throw new Error(`can not find socket with the name ${n}`);if(i.links.length>1)throw new Error(`invalid for an output flow socket to have multiple downstream links:${t.description.typeName}.${i.name} has ${i.links.length} downlinks`);if(i.links.length===1){const r=i.links[0];if(r===void 0)throw new Error("link must be defined");this.nextEval=r}o!==void 0&&this.fiberCompletedListenerStack.push(o)}executeStep(){const t=this.nextEval;if(this.nextEval=null,t===null){if(this.fiberCompletedListenerStack.length===0)return;const o=this.fiberCompletedListenerStack.pop();if(o===void 0)throw new Error("awaitingCallback is empty");o();return}const n=this.nodes[t.nodeId];if(n.inputs.forEach(o=>{o.valueTypeName!=="flow"&&(this.executionSteps+=vh(this.engine,o))}),this.engine.onNodeExecutionStart.emit(n),Ay(n)){this.engine.asyncNodes.push(n),n.triggered(this.engine,t.socketName,()=>{const o=this.engine.asyncNodes.indexOf(n);this.engine.asyncNodes.splice(o,1),this.engine.onNodeExecutionEnd.emit(n),this.executionSteps++});return}if(Mg(n)){n.triggered(this,t.socketName),this.engine.onNodeExecutionEnd.emit(n),this.executionSteps++;return}throw new TypeError(`should not get here, unhandled node ${n.description.typeName}`)}isCompleted(){return this.fiberCompletedListenerStack.length===0&&this.nextEval===null}}function eP(e){return new Promise(t=>setTimeout(t,Math.round(e*1e3)))}class tP{constructor(t){F(this,"fiberQueue",[]);F(this,"asyncNodes",[]);F(this,"eventNodes",[]);F(this,"onNodeExecutionStart",new jo);F(this,"onNodeExecutionEnd",new jo);F(this,"executionSteps",0);this.nodes=t,Object.values(t).forEach(n=>{Pg(n)&&this.eventNodes.push(n)}),this.eventNodes.forEach(n=>{n.inputs.forEach(o=>{Te.mustBeTrue(o.valueTypeName!=="flow"),this.executionSteps+=vh(this,o)}),this.onNodeExecutionStart.emit(n),n.init(this),this.executionSteps++,this.onNodeExecutionEnd.emit(n)})}dispose(){this.asyncNodes.forEach(t=>t.dispose()),this.eventNodes.forEach(t=>t.dispose(this))}commitToNewFiber(t,n,o=void 0){Te.mustBeTrue(Pg(t)||Ay(t));const i=t.outputs.find(r=>r.name===n);if(i===void 0)throw new Error(`no socket with the name ${n}`);if(i.links.length>1)throw new Error(`invalid for an output flow socket to have multiple downstream links:${t.description.typeName}.${i.name} has ${i.links.length} downlinks`);if(i.links.length===1){const r=new $6(this,i.links[0],o);this.fiberQueue.push(r)}}executeAllSync(t=100,n=1e8){const o=Date.now();let i=0,r=0;for(;r<n&&i<t&&this.fiberQueue.length>0;){const s=this.fiberQueue[0],a=s.executionSteps;s.executeStep(),r+=s.executionSteps-a,s.isCompleted()&&this.fiberQueue.shift(),i=(Date.now()-o)*.001}return this.executionSteps+=r,r}async executeAllAsync(t=100,n=1e8){const o=Date.now();let i=0,r=0,s=0;do s>0&&await eP(0),i+=this.executeAllSync(t-r,n-i),r=(Date.now()-o)*.001,s+=1;while((this.asyncNodes.length>0||this.fiberQueue.length>0)&&r<t&&i<n);return i}}const nP=({graph:e,registry:t,nodeTypeName:n,nodeConfiguration:o={}})=>{const i=t.nodes[n]?t.nodes[n]:void 0;if(i===void 0)throw ks.verbose("known nodes: "+Object.keys(t.nodes).join(", ")),new Error(`no registered node descriptions with the typeName ${n}`);const r=i.nodeFactory(e,o);return r.inputs.forEach(s=>{var a;s.valueTypeName!=="flow"&&s.value===void 0&&(s.value=(a=t.values[s.valueTypeName])==null?void 0:a.creator())}),r},oP=({variables:e={},customEvents:t={},values:n,dependencies:o={}})=>({variables:e,customEvents:t,values:n,getDependency:i=>{const r=o[i];return r||console.error(`Dependency not found ${i}.  Did you register it? Existing dependencies: ${Object.keys(o)}`),r}});class Fc{constructor(t="",n=""){F(this,"_targetNode");F(this,"_targetSocket");this.nodeId=t,this.socketName=n}}class ke{constructor(t,n,o=void 0,i=void 0,r){F(this,"links",[]);this.valueTypeName=t,this.name=n,this.value=o,this.label=i,this.valueChoices=r}}class Nl{constructor(t,n,o,i){F(this,"value");F(this,"label","");F(this,"metadata",{});F(this,"version",0);F(this,"onChanged",new jo);this.id=t,this.name=n,this.valueTypeName=o,this.initialValue=i,this.value=this.initialValue}get(){return this.value}set(t){t!==this.value&&(this.value=t,this.version++,this.onChanged.emit(this))}}function iP({graphJson:e,registry:t}){const n=(e==null?void 0:e.name)||"",o=(e==null?void 0:e.metadata)||{};let i={},r={};"variables"in e&&(i=cP(t.values,e.variables??[])),"customEvents"in e&&(r=lP(t.values,e.customEvents??[]));const s=(e==null?void 0:e.nodes)??[];s.length===0&&ks.warning("readGraphFromJSON: no nodes specified");const a=oP({...t,variables:i,customEvents:r}),c={};for(let l=0;l<s.length;l+=1){const u=s[l],d=rP({graph:a,registry:t,nodeJson:u}),f=u.id;if(f in c)throw new Error(`can not create new node with id ${f} as one with that id already exists.`);c[f]=d}return Object.entries(c).forEach(([l,u])=>{u.inputs.forEach(d=>{d.links.forEach(f=>{if(!(f.nodeId in c))throw new Error(`node '${u.description.typeName}' specifies an input '${d.name}' whose link goes to a nonexistent upstream node id: ${f.nodeId}`);const h=c[f.nodeId],p=h.outputs.find(m=>m.name===f.socketName);if(p===void 0)throw new Error(`node '${u.description.typeName}' specifies an input '${d.name}' whose link goes to a nonexistent output '${f.socketName}' on upstream node '${h.description.typeName}'`);const g=new Fc(l,d.name);p.links.findIndex(m=>m.nodeId==g.nodeId&&m.socketName==g.socketName)<0&&p.links.push(g)})}),u.outputs.forEach(d=>{d.links.forEach(f=>{if(!(f.nodeId in c))throw new Error(`node '${u.description.typeName}' specifies an output '${d.name}' whose link goes to a nonexistent downstream node id ${f.nodeId}`);const h=c[f.nodeId],p=h.inputs.find(m=>m.name===f.socketName);if(p===void 0)throw new Error(`node '${u.description.typeName}' specifies an output '${d.name}' whose link goes to a nonexistent input '${f.socketName}' on downstream node '${h.description.typeName}'`);const g=new Fc(l,d.name);p.links.findIndex(m=>m.nodeId==g.nodeId&&m.socketName==g.socketName)<0&&p.links.push(g)})})}),{name:n,metadata:o,nodes:c,customEvents:r,variables:i}}function rP({graph:e,registry:t,nodeJson:n}){if(n.type===void 0)throw new Error("readGraphFromJSON: no type for node");const o=n.type,i=n.configuration,r={};i!==void 0&&Object.keys(i).forEach(a=>{r[a]=i[a]});const s=nP({graph:e,registry:t,nodeTypeName:o,nodeConfiguration:r});return s.label=(n==null?void 0:n.label)??s.label,s.metadata=(n==null?void 0:n.metadata)??s.metadata,n.parameters!==void 0&&sP(t.values,s,n.parameters),n.flows!==void 0&&aP(s,n.flows),s}function sP(e,t,n){t.inputs.forEach(o=>{var r;if(!(o.name in n))return;const i=n[o.name];if("value"in i&&(o.value=(r=e[o.valueTypeName])==null?void 0:r.deserialize(i.value)),"link"in i){const s=i.link;o.links.push(new Fc(s.nodeId,s.socket))}});for(const o in n)if(t.inputs.find(r=>r.name===o)===void 0)throw new Error(`node '${t.description.typeName}' specifies an input '${o}' that doesn't exist on its node type, available inputs are: ${t.inputs.map(r=>r.name).join(", ")}`)}function aP(e,t){e.outputs.forEach(n=>{if(n.name in t){const o=t[n.name];n.links.push(new Fc(o.nodeId,o.socket))}});for(const n in t)if(e.outputs.find(i=>i.name===n)===void 0)throw new Error(`node '${e.description.typeName}' specifies an output '${n}' that doesn't exist on its node type, available outputs are: ${e.outputs.map(i=>i.name).join(", ")}`)}function cP(e,t){var o;const n={};for(let i=0;i<t.length;i+=1){const r=t[i],s=new Nl(r.id,r.name,r.valueTypeName,(o=e[r.valueTypeName])==null?void 0:o.deserialize(r.initialValue));if(s.label=(r==null?void 0:r.label)??s.label,s.metadata=(r==null?void 0:r.metadata)??s.metadata,r.id in n)throw new Error(`duplicate variable id ${s.id}`);n[r.id]=s}return n}function lP(e,t){const n={};for(let o=0;o<t.length;o+=1){const i=t[o],r=[];(i.parameters??[]).forEach(a=>{var c;r.push(new ke(a.valueTypeName,a.name,(c=e[a.valueTypeName])==null?void 0:c.deserialize(a.defaultValue)))});const s=new gh(i.id,i.name,r);if(s.label=(i==null?void 0:i.label)??s.label,s.metadata=(i==null?void 0:i.metadata)??s.metadata,s.id in n)throw new Error(`duplicate variable id ${s.id}`);n[s.id]=s}return n}class Ui{constructor(t){F(this,"inputs");F(this,"outputs");F(this,"description");F(this,"nodeType");F(this,"otherTypeNames");F(this,"graph");F(this,"label");F(this,"metadata");F(this,"configuration");F(this,"readInput",t=>Py(this.inputs,t,this.description.typeName));F(this,"writeOutput",(t,n)=>{Ny(this.outputs,t,n,this.description.typeName)});this.inputs=t.inputs,this.outputs=t.outputs,this.description=t.description,this.nodeType=t.nodeType,this.graph=t.graph,this.configuration=t.configuration,this.metadata=t.metadata||{}}}class yh extends Ui{constructor(t,n,o=[],i=[],r={}){super({description:{...t,category:t.category},inputs:o,outputs:i,graph:n,nodeType:En.Async,configuration:r}),Te.mustBeTrue(this.inputs.some(s=>s.valueTypeName==="flow")),Te.mustBeTrue(this.outputs.some(s=>s.valueTypeName==="flow"))}triggered(t,n,o){throw new Error("not implemented")}dispose(){throw new Error("not implemented")}}class uP extends Ui{constructor(n){super({...n,nodeType:En.Async});F(this,"triggeredInner");F(this,"disposeInner");F(this,"state");F(this,"triggered",(n,o,i)=>{this.triggeredInner({read:this.readInput,write:this.writeOutput,commit:(r,s)=>n.commitToNewFiber(this,r,s),configuration:this.configuration,graph:this.graph,finished:i,triggeringSocketName:o})});F(this,"dispose",()=>{this.state=this.disposeInner({state:this.state,graph:this.graph})});this.triggeredInner=n.triggered,this.disposeInner=n.dispose,this.state=n.initialState}}class fP extends Ui{constructor(t,n,o=[],i=[],r={}){super({...t,description:{...t,category:t.category},inputs:o,outputs:i,graph:n,configuration:r,nodeType:En.Event}),Te.mustBeTrue(!this.inputs.some(s=>s.valueTypeName==="flow")),Te.mustBeTrue(this.outputs.some(s=>s.valueTypeName==="flow"))}init(t){throw new Error("not implemented")}dispose(t){throw new Error("not implemented")}}class dP extends fP{constructor(t){super(t.description,t.graph,t.inputs,t.outputs,t.configuration)}}class hP extends Ui{constructor(n){super({...n,nodeType:En.Event});F(this,"initInner");F(this,"disposeInner");F(this,"state");F(this,"outputSocketKeys");F(this,"init",n=>{this.state=this.initInner({read:this.readInput,write:this.writeOutput,state:this.state,outputSocketKeys:this.outputSocketKeys,commit:(o,i)=>{n.commitToNewFiber(this,o,i),n.executeAllSync(1)},configuration:this.configuration,graph:this.graph})});this.initInner=n.init,this.disposeInner=n.dispose,this.state=n.initialState,this.outputSocketKeys=n.outputs.map(o=>o.name)}dispose(){this.disposeInner({state:this.state,graph:this.graph})}}class Cy extends Ui{constructor(t,n,o=[],i=[],r={}){super({description:{...t,category:t.category},inputs:o,outputs:i,graph:n,configuration:r,nodeType:En.Flow}),Te.mustBeTrue(this.inputs.some(s=>s.valueTypeName==="flow"))}triggered(t,n){throw new Error("not implemented")}}class pP extends Cy{constructor(t){super(t.description,t.graph,t.inputs,t.outputs,t.configuration)}}class mP extends Ui{constructor(n){super({...n,nodeType:En.Flow});F(this,"triggeredInner");F(this,"state");F(this,"outputSocketKeys");F(this,"triggered",(n,o)=>{this.state=this.triggeredInner({commit:(i,r)=>n.commit(this,i,r),read:this.readInput,write:this.writeOutput,graph:this.graph,state:this.state,configuration:this.configuration,outputSocketKeys:this.outputSocketKeys,triggeringSocketName:o})});this.triggeredInner=n.triggered,this.state=n.initialState,this.outputSocketKeys=n.outputs.map(o=>o.name)}}const Ag=(e,{valueType:t,defaultValue:n,choices:o})=>new ke(t,e,n,void 0,o),gP=(e,t,n,o)=>t.map(i=>{const r=e[i];if(typeof r=="string")return new ke(r,i);if(typeof r=="function"){const s=r(n,o);return Ag(i,s)}return Ag(i,r)}),vP=e=>e.map(t=>new ke(t.valueType,t.key,t.defaultValue,void 0,t.choices));function Cg(e,t,n){if(typeof e=="function"){const o=e(t,n);return vP(o)}return gP(e,Object.keys(e),t,n)}const Al=(e,{typeName:t,in:n,out:o,otherTypeNames:i=[],category:r=U.None,configuration:s,helpDescription:a="",label:c=""},l,u)=>({description:{typeName:t,configuration:s||{},category:r,otherTypeNames:i,helpDescription:a,label:c},nodeType:e,inputs:Cg(n,l,u),outputs:Cg(o,l,u),configuration:l,graph:u});var U=(e=>(e.Action="Action",e.Logic="Logic",e.Engine="Engine",e.Variable="Variable",e.Flow="Flow",e.None="None",e.Math="Math",e.Debug="Debug",e))(U||{});function oe(e){return{...e,nodeFactory:(t,n)=>new mP({...Al(En.Flow,e,n,t),initialState:e.initialState,triggered:e.triggered})}}function yP(e){return{...e,nodeFactory:(t,n)=>new uP({...Al(En.Async,e,n,t),initialState:e.initialState,triggered:e.triggered,dispose:e.dispose})}}function St(e){return{...e,nodeFactory:(t,n)=>new bP({...Al(En.Function,e,n,t),exec:e.exec})}}function zt(e){return{...e,nodeFactory:(t,n)=>new hP({...Al(En.Event,e,n,t),initialState:e.initialState,init:e.init,dispose:e.dispose})}}class bP extends Ui{constructor(n){super({...n,nodeType:En.Function});F(this,"execInner");F(this,"exec",n=>{this.execInner({read:o=>Py(n.inputs,o,n.description.typeName),write:(o,i)=>Ny(n.outputs,o,i,n.description.typeName),configuration:this.configuration,graph:this.graph})});this.execInner=n.exec}}const xP="abcdefghijklmnop",Lg=e=>xP[e];function Dg(e,t){return!e||e.length===0?[]:e.map((n,o)=>typeof n=="string"?{key:t(o),valueType:n}:{key:Object.keys(n)[0],valueType:n[Object.keys(n)[0]]})}function b({in:e,out:t,exec:n,category:o,...i}){const r=Dg(e,Lg),s=typeof t=="string"||t.length>1?()=>"result":Lg,c=Dg(typeof t=="string"?[t]:t,s);return St({typeName:i.name,label:i.label,in:()=>r,out:()=>c,category:o,exec:({read:u,write:d})=>{const f=r.map(({key:p})=>u(p)),h=n(...f);c.length===1&&c[0].key==="result"?d("result",h):c.forEach(({key:p})=>{d(p,h[p])})}})}function Be(e){return Object.values(e).filter(t=>typeof t=="object")}class bh{constructor(t,n,o="",i,r=[],s="",a={}){F(this,"nodeFactory");this.typeName=t,this.category=n,this.label=o,this.otherTypeNames=r,this.helpDescription=s,this.configuration=a,this.nodeFactory=(c,l)=>i(this,c,l)}}class Cl extends bh{constructor(t){super(t.typeName,t.category,t.label,t.factory,t.otherTypeNames,t.helpDescription,t.configuration),this.properties=t}}const jr=1e-6;function pn(e,t,n=jr){return Math.abs(e-t)<n}function wP(e){return e*(Math.PI/180)}function SP(e){return e*(180/Math.PI)}function mi(e){let t;return()=>(t===void 0&&(t=e()),t)}const TP=/[^\d+.-]+/;function Ly(e,t=0){try{return Number.parseFloat(e)}catch{return t}}function oa(e,t=0){return e.split(TP).filter(Boolean).map(n=>Ly(n,t))}function*gn(e,t,n=1){let o=e;for(;o<t;)yield o,o+=n}function EP(e){return e.length>0?e.slice(0,1).toLocaleUpperCase()+e.slice(1):e}class MP{log(t,n){ks.log(t,n)}}class PP{constructor(){F(this,"startEvent",new jo);F(this,"endEvent",new jo);F(this,"tickEvent",new jo)}}const kc=class kc extends dP{constructor(n,o,i){const r=o.customEvents[i.customEventId]||new gh("-1","undefined");super({description:n,graph:o,outputs:[new ke("flow","flow"),...r.parameters.map(s=>new ke(s.valueTypeName,s.name,s.value,s.label))],configuration:i});F(this,"customEvent");F(this,"onCustomEvent");this.customEvent=r,o.customEvents[i.customEventId]=r}init(n){Te.mustBeTrue(this.onCustomEvent===void 0),this.onCustomEvent=o=>{this.customEvent.parameters.forEach(i=>{if(!(i.name in o))throw new Error(`parameters of custom event do not align with parameters of custom event node, missing ${i.name}`);this.writeOutput(i.name,o[i.name])}),n.commitToNewFiber(this,"flow")},this.customEvent.eventEmitter.addListener(this.onCustomEvent)}dispose(n){Te.mustBeTrue(this.onCustomEvent!==void 0),this.onCustomEvent!==void 0&&this.customEvent.eventEmitter.removeListener(this.onCustomEvent)}};F(kc,"Description",new Cl({typeName:"customEvent/onTriggered",category:"Event",label:"On Triggered",configuration:{customEventId:{valueType:"string",defaultValue:"-1"}},factory:(n,o,i)=>new kc(n,o,i)}));let Ig=kc;const Vc=class Vc extends pP{constructor(n,o,i){const r=o.customEvents[i.customEventId]||new gh("-1","undefined");super({description:n,graph:o,inputs:[new ke("flow","flow"),...r.parameters.map(s=>new ke(s.valueTypeName,s.name,s.value,s.label))],outputs:[new ke("flow","flow")],configuration:i});F(this,"customEvent");this.customEvent=r,o.customEvents[i.customEventId]=r}triggered(n,o){const i={};this.customEvent.parameters.forEach(r=>{i[r.name]=this.readInput(r.name)}),this.customEvent.eventEmitter.emit(i),n.commit(this,"flow")}};F(Vc,"Description",new Cl({typeName:"customEvent/trigger",category:"Action",label:"Trigger",configuration:{customEventId:{valueType:"string",defaultValue:"-1"}},factory:(n,o,i)=>new Vc(n,o,i)}));let Fg=Vc;const NP=oe({typeName:"debug/expectTrue",category:U.Action,label:"Assert Expect True",in:()=>[{key:"flow",valueType:"flow"},{key:"condition",valueType:"boolean"},{key:"description",valueType:"string"}],initialState:void 0,out:{flow:"flow"},triggered:({read:e,commit:t})=>{Te.mustBeTrue(e("condition"),e("description")),t("flow")}}),AP=oe({typeName:"debug/log",category:U.Debug,label:"Debug Log",in:{flow:"flow",text:"string",severity:{valueType:"string",defaultValue:"info",choices:["verbose","info","warning","error"],label:"severity"}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t,graph:{getDependency:n}})=>{const o=n("ILogger");o==null||o.log(e("severity"),e("text")),t("flow")}}),CP=oe({typeName:"flow/decision/branch",category:U.Flow,label:"Branch",helpDescription:"Checks the value of the 'condition' input and if true, executes the 'true' branch, otherwise it executes the 'false' branch.",in:{flow:"flow",condition:"boolean"},out:{true:"flow",false:"flow"},triggered:({read:e,commit:t})=>{t(e("condition")===!0?"true":"false")},initialState:void 0}),LP=oe({typeName:"flow/counter",label:"Counter",in:{flow:"flow",reset:"flow"},out:{flow:"flow",count:"integer"},initialState:{count:0},category:U.Flow,triggered:({commit:e,write:t,triggeringSocketName:n,state:o})=>{let i=o.count;switch(n){case"flow":{i++,t("count",i),e("flow");break}case"reset":{i=0;break}default:throw new Error("should not get here")}return{count:i}}}),Uc=class Uc extends yh{constructor(n,o){super(n,o,[new ke("flow","flow"),new ke("float","waitDuration"),new ke("flow","cancel")],[new ke("flow","flow")]);F(this,"triggerVersion",0)}triggered(n,o,i){if(this.triggerVersion++,o==="cancel")return;const r=this.triggerVersion;setTimeout(()=>{this.triggerVersion>r||(n.commitToNewFiber(this,"flow"),i())},this.readInput("waitDuration")*1e3)}dispose(){this.triggerVersion++}};F(Uc,"Description",new bh("flow/rate/debounce","Flow","Debounce",(n,o)=>new Uc(n,o)));let kf=Uc;const DP=oe({typeName:"flow/repeat/n",label:"Repeat N Times",category:U.Flow,in:{flow:"flow",n:{valueType:"integer",defaultValue:1},reset:"flow"},out:{flow:"flow",count:"integer"},initialState:{count:0},triggered:({commit:e,read:t,write:n,triggeringSocketName:o,state:i})=>o==="reset"?{count:0}:i.count<Number(t("n"))?(n("count",i.count),e("flow"),{count:i.count+1}):i}),IP=oe({typeName:"flow/repeat/None",label:"No Repeat",category:U.Flow,in:{flow:"flow",reset:"flow"},out:{flow:"flow"},initialState:{firedOnce:!1},triggered:({commit:e,triggeringSocketName:t,state:n})=>t==="reset"?{firedOnce:!1}:n.firedOnce?n:(e("flow"),{firedOnce:!0})}),FP=oe({typeName:"flow/decision/flipFlop",category:U.Flow,label:"Flip Flop",in:{flow:"flow"},out:{on:"flow",off:"flow",isOn:"boolean"},initialState:{isOn:!0},triggered:({commit:e,write:t,state:n})=>(t("isOn",n.isOn),e(n.isOn?"on":"off"),{isOn:!n.isOn})}),RP=oe({typeName:"flow/forLoop",category:U.Flow,label:"For Loop",in:{flow:"flow",startIndex:"integer",endIndex:"integer"},out:{loopBody:"flow",index:"integer",completed:"flow"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("startIndex"),i=e("endIndex"),r=s=>{s<i?(t("index",s),n("loopBody",()=>{r(s+BigInt(1))})):n("completed")};r(o)}}),OP=oe({typeName:"flow/gate",label:"Gate",category:U.Flow,in:{flow:"flow",open:"flow",close:"flow",toggle:"flow",startClosed:"boolean"},out:{flow:"flow"},initialState:{isInitialized:!1,isClosed:!0},triggered:({commit:e,read:t,triggeringSocketName:n,state:o})=>{let i=o.isClosed,r=o.isInitialized;switch(o.isInitialized||(i=!!t("startClosed"),r=!0),n){case"flow":i||e("flow");break;case"open":i=!1;break;case"close":i=!0;break;case"toggle":i=!i;break;default:throw new Error(`Unexpected triggering socket: ${n}`)}return{isClosed:i,isInitialized:r}}}),kP=oe({typeName:"flow/multiGate",category:U.Flow,label:"MultiGate",in:{flow:"flow",reset:"flow",loop:"boolean",startIndex:"integer"},out:{1:"flow",2:"flow",3:"flow"},initialState:{isInitialized:!1,nextIndex:0},triggered:({state:e,commit:t,read:n,outputSocketKeys:o,triggeringSocketName:i})=>{let r=e.nextIndex,s=e.isInitialized;switch(s||(r=Number(n("startIndex")),s=!0),n("loop")&&(r=r%o.length),i){case"reset":return r=0,{isInitialized:s,nextIndex:r};case"flow":{if(0<=r&&r<o.length){const c=o[r];t(c)}return r++,{isInitialized:s,nextIndex:r}}}const a=c=>{if(c<o.length){const l=o[c];t(l,()=>{a(c+1)})}};return a(0),{isInitialized:s,nextIndex:r}}}),VP=oe({typeName:"flow/decision/sequence",label:"Sequence",configuration:{numOutputs:{valueType:"number",defaultValue:4}},in:{flow:"flow"},out:e=>{const t=e.numOutputs??4,n=[];for(let o=1;o<=t;o++){const i=`${o}`;n.push({key:i,valueType:"flow"})}return n},initialState:void 0,triggered:({commit:e,outputSocketKeys:t})=>{const n=o=>{if(o<t.length){const i=t[o];e(i,()=>{n(o+1)})}};n(0)}}),zc=class zc extends yh{constructor(n,o){super(n,o,[new ke("flow","flow"),new ke("float","duration",1),new ke("flow","cancel")],[new ke("flow","flow")]);F(this,"triggerVersion",0);F(this,"timeoutPending",!1)}triggered(n,o,i){if(o==="cancel"){this.timeoutPending&&(this.triggerVersion++,this.timeoutPending=!1);return}if(this.timeoutPending)return;this.triggerVersion++;const r=this.triggerVersion;this.timeoutPending=!0,setTimeout(()=>{this.triggerVersion===r&&(Te.mustBeTrue(this.timeoutPending),this.timeoutPending=!1,n.commitToNewFiber(this,"flow"),i())},this.readInput("duration")*1e3)}dispose(){this.triggerVersion++,this.timeoutPending=!1}};F(zc,"Description",new bh("flow/rate/throttle",U.Flow,"Throttle",(n,o)=>new zc(n,o)));let Vf=zc;const Bc=class Bc extends Cy{constructor(n,o,i){const r=[];for(let s=1;s<=i;s++)r.push(new ke("flow",`${s}`));super(n,o,[...r,new ke("flow","reset"),new ke("boolean","autoReset")],[new ke("flow","flow")]);F(this,"isOn",!0);F(this,"triggeredMap",{});F(this,"triggeredCount",0);F(this,"outputTriggered",!1);this.numInputs=i,this.reset()}reset(){for(let n=1;n<=this.numInputs;n++)this.triggeredMap[`${n}`]=!1;this.triggeredCount=0,this.outputTriggered=!1}triggered(n,o){if(o==="reset"){this.reset();return}this.triggeredMap[o]||(this.triggeredMap[o]=!0,this.triggeredCount++,this.triggeredCount===this.numInputs&&!this.outputTriggered&&(n.commit(this,"flow"),this.outputTriggered=!0,this.readInput("autoReset")===!0&&this.reset()))}};F(Bc,"Description",new Cl({typeName:"flow/waitAll",category:"Flow",label:"WaitAll",configuration:{numInputs:{valueType:"number",defaultValue:3}},factory:(n,o,i)=>new Bc(n,o,i.numInputs)}));let Uf=Bc;const UP=()=>({onEndEvent:void 0});zt({typeName:"flow/lifecycle/onEnd",label:"On End",category:U.Flow,in:{},out:{flow:"flow"},initialState:UP(),init:({state:e,commit:t,graph:{getDependency:n}})=>{Te.mustBeTrue(e.onEndEvent===void 0);const o=()=>{t("flow")},i=n("ILifecycleEventEmitter");return i==null||i.endEvent.addListener(o),{onEndEvent:o}},dispose:({state:{onEndEvent:e},graph:{getDependency:t}})=>{Te.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.endEvent.removeListener(e)),{}}});const zP=()=>({onStartEvent:void 0}),BP=zt({typeName:"flow/lifecycle/onStart",label:"On Start",category:U.Flow,in:{},out:{flow:"flow"},initialState:zP(),init:({state:e,commit:t,graph:{getDependency:n}})=>{Te.mustBeTrue(e.onStartEvent===void 0);const o=()=>{t("flow")},i=n("ILifecycleEventEmitter");return i==null||i.startEvent.addListener(o),{onStartEvent:o}},dispose:({state:{onStartEvent:e},graph:{getDependency:t}})=>{Te.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.startEvent.removeListener(e)),{}}}),jP=()=>({onTickEvent:void 0});zt({typeName:"flow/lifecycle/onTick",label:"On Tick",category:U.Flow,in:{},out:{flow:"flow",deltaSeconds:"float"},initialState:jP(),init:({state:e,commit:t,write:n,graph:{getDependency:o}})=>{Te.mustBeTrue(e.onTickEvent===void 0);let i=Date.now();const r=()=>{const a=Date.now(),c=(a-i)*.001;n("deltaSeconds",c),t("flow"),i=a},s=o("ILifecycleEventEmitter");return s==null||s.tickEvent.addListener(r),{onTickEvent:r}},dispose:({state:{onTickEvent:e},graph:{getDependency:t}})=>{Te.mustBeTrue(e!==void 0);const n=t("ILifecycleEventEmitter");return e&&(n==null||n.tickEvent.removeListener(e)),{}}});function Ll({values:e,valueTypeName:t}){const n=EP(t);return[b({name:`logic/string/convert/to${n}`,label:`To ${n}`,in:["string"],out:t,exec:o=>{var i;return(i=e[t])==null?void 0:i.deserialize(o)}}),b({name:`math/${t}/convert/toString`,label:"To String",in:[t],out:"string",exec:o=>{var i;return`${(i=e[t])==null?void 0:i.serialize(o)}`}})]}const _P=oe({typeName:"flow/decision/switch/integer",label:"Switch on Int",configuration:{numCases:{valueType:"number"}},in:e=>{const t=[];t.push({key:"flow",valueType:"flow"},{key:"selection",valueType:"integer"});for(const n of gn(1,e.numCases+1))t.push({key:`${n}`,valueType:"integer"});return t},out:e=>{const t=[];t.push({key:"default",valueType:"flow"});for(const n of gn(1,e.numCases+1))t.push({key:`${n}`,valueType:"flow"});return t},initialState:void 0,triggered:({read:e,commit:t,configuration:n})=>{const o=e("selection");for(const i of gn(1,n.numCases+1))if(o===e(`${i}`)){t(`${i}`);return}t("default")}}),HP=oe({typeName:"flow/decision/switch/string",label:"Switch on String",configuration:{numCases:{valueType:"number"}},in:e=>{const t=[];t.push({key:"flow",valueType:"flow"},{key:"selection",valueType:"string"});for(const n of gn(1,e.numCases+1))t.push({key:`${n}`,valueType:"string"});return t},out:e=>{const t=[];t.push({key:"default",valueType:"flow"});for(const n of gn(1,e.numCases+1))t.push({key:`${n}`,valueType:"flow"});return t},initialState:void 0,triggered:({read:e,commit:t,configuration:n})=>{const o=e("selection");for(const i of gn(1,n.numCases+1))if(o===e(`${i}`)){t(`${i}`);return}t("default")}}),qP=St({typeName:"math/easing",category:U.Math,label:"Easing",in:{easingFunction:{valueType:"string",name:"easingFunction",defaultValue:"linear",options:Object.keys(Tg)},easingMode:{valueType:"string",name:"easingMode",defaultValue:"inOut",options:Object.keys(Eg)},t:"float"},out:{t:"float"},exec:({read:e,write:t})=>{const n=Tg[e("easingFunction")],o=Eg[e("easingMode")],i=o(n),r=e("t");t("t",i(r))}}),jc=class jc extends yh{constructor(n,o){super(n,o,[new ke("flow","flow"),new ke("float","duration",1)],[new ke("flow","flow")]);F(this,"timeoutPending",!1)}triggered(n,o,i){this.timeoutPending||(this.timeoutPending=!0,setTimeout(()=>{this.timeoutPending&&(this.timeoutPending=!1,n.commitToNewFiber(this,"flow"),i())},this.readInput("duration")*1e3))}dispose(){this.timeoutPending=!1}};F(jc,"Description",new Cl({typeName:"flow/time/delay",category:"Time",label:"Delay",factory:(n,o)=>new jc(n,o)}));let zf=jc;const WP=b({name:"flow/time/now",label:"Now",out:"float",exec:()=>Date.now()/1e3}),GP=Object.freeze(Object.defineProperty({__proto__:null,Now:WP},Symbol.toStringTag,{value:"Module"})),XP=b({name:"math/boolean/constant",label:"Boolean",in:["boolean"],out:"boolean",exec:e=>e}),ZP=b({name:"math/boolean/and",label:"",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e&&t}),KP=b({name:"math/boolean/or",label:"",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e||t}),YP=b({name:"math/boolean/xor",label:"",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>(e||t)&&!(e&&t)}),QP=b({name:"math/boolean/negate",label:"",in:["boolean"],out:"boolean",exec:e=>!e}),JP=b({name:"math/boolean/convert/toFloat",label:"To Float",in:["boolean"],out:"float",exec:e=>e?1:0}),$P=b({name:"math/boolean/compare/equal",label:"=",in:["boolean","boolean"],out:"boolean",exec:(e,t)=>e===t}),e7=b({name:"math/boolean/convert/toInteger",label:"To Integer",in:["boolean"],out:"integer",exec:e=>e?1n:0n}),t7=Object.freeze(Object.defineProperty({__proto__:null,And:ZP,Constant:XP,Equal:$P,Not:QP,Or:KP,ToFloat:JP,Xor:YP,toInteger:e7},Symbol.toStringTag,{value:"Module"})),Dy={name:"boolean",creator:()=>!1,deserialize:e=>typeof e=="string"?e.toLowerCase()==="true":e,serialize:e=>e,lerp:(e,t,n)=>n<.5?e:t,equals:(e,t)=>e===t,clone:e=>e},n7=b({name:"math/float/constant",label:"Float",in:["float"],out:"float",exec:e=>e}),o7=b({name:"math/float/basic/add",label:"+",in:["float","float"],out:"float",exec:(e,t)=>e+t}),i7=b({name:"math/float/basic/subtract",label:"-",in:["float","float"],out:"float",exec:(e,t)=>e-t}),r7=b({name:"math/float/negate",label:"-",in:["float"],out:"float",exec:e=>-e}),s7=b({name:"math/float/basic/multiply",label:"",in:["float","float"],out:"float",exec:(e,t)=>e*t}),a7=b({name:"math/float/basic/divide",label:"",in:["float","float"],out:"float",exec:(e,t)=>e/t}),c7=b({name:"math/float/basic/modulus",label:"MOD",in:["float","float"],out:"float",exec:(e,t)=>e%t}),l7=b({name:"math/float/transcendental/pow",label:"POW",in:["float","float"],out:"float",exec:Math.pow}),u7=b({name:"math/float/transcendental/sqrt",label:"",in:["float"],out:"float",exec:Math.sqrt}),f7=b({name:"math/float/constant/e",label:"",out:"float",exec:()=>Math.E}),d7=b({name:"math/float/constant/phi",label:"",out:"float",exec:()=>1.6180339887}),h7=b({name:"math/float/transcendental/exp",label:"EXP",in:["float"],out:"float",exec:Math.exp}),p7=b({name:"math/float/transcendental/ln",label:"LN",in:["float"],out:"float",exec:Math.log}),m7=b({name:"math/float/transcendental/log2",label:"LOG2",in:["float"],out:"float",exec:Math.log2}),g7=b({name:"math/float/transcendental/log10",label:"LOG10",in:["float"],out:"float",exec:Math.log10}),v7=b({name:"math/float/constant/pi",label:"",out:"float",exec:()=>Math.PI}),y7=b({name:"math/float/trig/sin",label:"SIN",in:["float"],out:"float",exec:Math.sin}),b7=b({name:"math/float/trig/asin",label:"ASIN",in:["float"],out:"float",exec:Math.asin}),x7=b({name:"math/float/trig/cos",label:"COS",in:["float"],out:"float",exec:Math.cos}),w7=b({name:"math/float/trig/acos",label:"ACOS",in:["float"],out:"float",exec:Math.acos}),S7=b({name:"math/float/trig/tan",label:"TAN",in:["float"],out:"float",exec:Math.tan}),T7=b({name:"math/float/trig/radiansToDegrees",label:"To Degrees",in:["float"],out:"float",exec:SP}),E7=b({name:"math/float/trig/degreesToRadians",label:"To Radians",in:["float"],out:"float",exec:wP}),M7=b({name:"math/float/trig/atan",label:"ATAN",in:["float"],out:"float",exec:Math.atan}),P7=b({name:"math/float/basic/mix",label:"MIX",in:["float","float","float"],out:"float",exec:(e,t,n)=>{const o=1-n;return e*o+t*n}}),N7=b({name:"math/float/convert/toFloat",label:"To Float",in:["float"],out:"float",exec:e=>Number(e)}),A7=b({name:"math/float/basic/min",label:"MIN",in:["float","float"],out:"float",exec:(e,t)=>Math.min(e,t)}),C7=b({name:"math/float/basic/max",label:"MAX",in:["float","float"],out:"float",exec:(e,t)=>Math.max(e,t)}),L7=b({name:"math/float/precision/clamp",label:"CLAMP",in:[{value:"float"},{min:"float"},{max:"float"}],out:"float",exec:(e,t,n)=>e<t?t:e>n?n:e}),D7=b({name:"math/float/abs",label:"ABS",in:["float"],out:"float",exec:Math.abs}),I7=b({name:"math/float/sign",label:"SIGN",in:["float"],out:"float",exec:Math.sign}),F7=b({name:"math/float/precision/floor",label:"FLOOR",in:["float"],out:"float",exec:Math.floor}),R7=b({name:"math/float/precision/ceil",label:"CEIL",in:["float"],out:"float",exec:Math.ceil}),O7=b({name:"math/float/precision/round",label:"ROUND",in:["float"],out:"float",exec:Math.round}),k7=b({name:"math/float/precision/trunc",label:"TRUNC",in:["float"],out:"float",exec:Math.trunc}),V7=b({name:"math/float/random",label:"RANDOM",out:"float",exec:Math.random}),U7=b({name:"math/float/compare/equal",label:"=",in:["float","float"],out:"boolean",exec:(e,t)=>e===t}),z7=b({name:"math/float/compare/equalTolerance",label:"=",in:["float","float","float"],out:"boolean",exec:(e,t,n)=>pn(e,t,n)}),B7=b({name:"math/float/compare/greaterThan",label:">",in:["float","float"],out:"boolean",exec:(e,t)=>e>t}),j7=b({name:"math/float/compare/greaterThanOrEqual",label:"",in:["float","float"],out:"boolean",exec:(e,t)=>e>=t}),_7=b({name:"math/float/compare/lessThan",label:"<",in:["float","float"],out:"boolean",exec:(e,t)=>e<t}),H7=b({name:"math/float/compare/lessThanOrEqual",label:"",in:["float","float"],out:"boolean",exec:(e,t)=>e<=t}),q7=b({name:"math/float/compare/isNaN",label:"isNaN",in:["float"],out:"boolean",exec:Number.isNaN}),W7=b({name:"math/float/compare/isInf",label:"isInf",in:["float"],out:"boolean",exec:e=>!Number.isFinite(e)&&!Number.isNaN(e)}),G7=Object.freeze(Object.defineProperty({__proto__:null,Abs:D7,Acos:w7,Add:o7,Asin:b7,Atan:M7,Ceil:R7,Clamp:L7,Constant:n7,Cos:x7,DegreesToRadians:E7,Divide:a7,E:f7,Equal:U7,EqualTolerance:z7,Exp:h7,Floor:F7,GreaterThan:B7,GreaterThanOrEqual:j7,IsInf:W7,IsNaN:q7,LessThan:_7,LessThanOrEqual:H7,Ln:p7,Log10:g7,Log2:m7,Max:C7,Min:A7,Mix:P7,Modulus:c7,Multiply:s7,Negate:r7,PI:v7,Phi:d7,Power:l7,RadiansToDegrees:T7,Random:V7,Round:O7,Sign:I7,Sin:y7,SquareRoot:u7,Subtract:i7,Tan:S7,ToFloat:N7,Trunc:k7},Symbol.toStringTag,{value:"Module"})),Iy={name:"float",creator:()=>0,deserialize:e=>typeof e=="string"?Ly(e,0):e,serialize:e=>e,lerp:(e,t,n)=>e*(1-n)+t*n,equals:(e,t)=>e===t,clone:e=>e},X7=b({name:"math/integer/constant",label:"Integer",in:["integer"],out:"integer",exec:e=>e}),Z7=b({name:"math/integer/basic/add",label:"+",in:["integer","integer"],out:"integer",exec:(e,t)=>e+t}),K7=b({name:"math/integer/basic/subtract",label:"-",in:["integer","integer"],out:"integer",exec:(e,t)=>e-t}),Y7=b({name:"math/integer/negate",label:"-",in:["integer"],out:"integer",exec:e=>-e}),Q7=b({name:"math/integer/basic/multiply",label:"",in:["integer","integer"],out:"integer",exec:(e,t)=>e*t}),J7=b({name:"math/integer/basic/divide",label:"",in:["integer","integer"],out:"integer",exec:(e,t)=>e/t}),$7=b({name:"math/integer/basic/modulus",label:"MOD",in:["integer","integer"],out:"integer",exec:(e,t)=>e%t}),e9=b({name:"math/integer/convert/toFloat",label:"To Float",in:["integer"],out:"float",exec:e=>Number(e)}),t9=b({name:"math/integer/basic/min",label:"MIN",in:["integer","integer"],out:"integer",exec:(e,t)=>e>t?t:e}),n9=b({name:"math/integer/basic/max",label:"MAX",in:["integer","integer"],out:"integer",exec:(e,t)=>e>t?e:t}),o9=b({name:"math/integer/precision/clamp",label:"CLAMP",in:[{value:"integer"},{min:"integer"},{max:"integer"}],out:"integer",exec:(e,t,n)=>e<t?t:e>n?n:e}),i9=b({name:"math/integer/abs",label:"ABS",in:["integer"],out:"integer",exec:e=>e<BigInt(0)?-e:e}),r9=b({name:"math/integer/sign",label:"SIGN",in:["integer"],out:"integer",exec:e=>BigInt(e<0?-1:e>0?1:0)}),s9=b({name:"math/integer/compare/equal",label:"=",in:["integer","integer"],out:"boolean",exec:(e,t)=>e===t}),a9=b({name:"math/integer/compare/greaterThan",label:">",in:["integer","integer"],out:"boolean",exec:(e,t)=>e>t}),c9=b({name:"math/integer/compare/greaterThanOrEqual",label:"",in:["integer","integer"],out:"boolean",exec:(e,t)=>e>=t}),l9=b({name:"math/integer/compare/lessThan",label:"<",in:["integer","integer"],out:"boolean",exec:(e,t)=>e<t}),u9=b({name:"math/integer/compare/lessThanOrEqual",label:"",in:["integer","integer"],out:"boolean",exec:(e,t)=>e<=t}),f9=b({name:"math/integer/convert/toBoolean",label:"To Boolean",in:["integer"],out:"boolean",exec:e=>e!==0n}),d9=Object.freeze(Object.defineProperty({__proto__:null,Abs:i9,Add:Z7,Clamp:o9,Constant:X7,Divide:J7,Equal:s9,GreaterThan:a9,GreaterThanOrEqual:c9,LessThan:l9,LessThanOrEqual:u9,Max:n9,Min:t9,Modulus:$7,Multiply:Q7,Negate:Y7,Sign:r9,Subtract:K7,ToFloat:e9,toBoolean:f9},Symbol.toStringTag,{value:"Module"})),Fy={name:"integer",creator:()=>BigInt(0),deserialize:e=>BigInt(e),serialize:e=>Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?Number(e):e.toString(),lerp:(e,t,n)=>BigInt(Number(e)*(1-n)+Number(t)*n),equals:(e,t)=>e===t,clone:e=>e},h9=b({name:"logic/string/constant",label:"String",in:["string"],out:"string",exec:e=>e}),p9=b({name:"logic/string/concat",label:"Concat",in:["string","string"],out:"string",exec:(e,t)=>e.concat(t)}),m9=b({name:"logic/string/includes",label:"Includes",in:["string","string"],out:"boolean",exec:(e,t)=>e.includes(t)}),g9=b({name:"logic/string/length",label:"Length",in:["string"],out:"integer",exec:e=>BigInt(e.length)}),v9=b({name:"math/string/compare/equal",label:"=",in:["string","string"],out:"boolean",exec:(e,t)=>e===t}),y9=Object.freeze(Object.defineProperty({__proto__:null,Concat:p9,Constant:h9,Equal:v9,Includes:m9,Length:g9},Symbol.toStringTag,{value:"Module"})),Ry={name:"string",creator:()=>"",deserialize:e=>e,serialize:e=>e,lerp:(e,t,n)=>n<.5?e:t,equals:(e,t)=>e===t,clone:e=>e},ia=mi(()=>Object.fromEntries([Dy,Ry,Fy,Iy].map(t=>[t.name,t])));function b9(e){return Object.keys(ia()).filter(t=>t!=="string").flatMap(t=>Ll({values:e,valueTypeName:t}))}const x9=mi(()=>{const e=[...Be(y9),...Be(t7),...Be(d9),...Be(G7),qP,AP,NP,BP,zf.Description,...Be(GP),CP,FP,RP,VP,_P,HP,kf.Description,Vf.Description,DP,IP,OP,kP,Uf.Description,LP,...b9(ia())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),w9=e=>({values:{...e.values,...ia()},nodes:{...e.nodes,...x9()},dependencies:{...e.dependencies}});class Mt{constructor(t=0,n=0){this.x=t,this.y=n}clone(t=new Mt){return t.set(this.x,this.y)}set(t,n){return this.x=t,this.y=n,this}}function S9(e,t,n=jr){return pn(e.x,t.x,n)&&pn(e.y,t.y,n)}function T9(e,t,n=new Mt){return n.set(e.x+t.x,e.y+t.y)}function E9(e,t,n=new Mt){return n.set(e.x-t.x,e.y-t.y)}function Oy(e,t,n=new Mt){return n.set(e.x*t,e.y*t)}function M9(e,t=new Mt){return t.set(-e.x,-e.y)}function ky(e){return Math.sqrt(Vy(e,e))}function P9(e,t=new Mt){const n=1/ky(e);return Oy(e,n,t)}function Vy(e,t){return e.x*t.x+e.y*t.y}function Uy(e,t,n,o=new Mt){const i=1-n;return o.set(e.x*i+t.x*n,e.y*i+t.y*n)}function N9(e,t=0,n=new Mt){return n.set(e[t+0],e[t+1])}function A9(e,t,n=0){t[n+0]=e.x,t[n+1]=e.y}function C9(e,t=new Mt){return N9(oa(e),0,t)}const xh=3,cc=3,sn=xh*cc;class Xe{constructor(t=[1,0,0,0,1,0,0,0,1]){if(this.elements=t,t.length!==sn)throw new Error(`elements must have length ${sn}, got ${t.length}`)}clone(t=new Xe){return t.set(this.elements)}set(t){if(t.length!==sn)throw new Error(`elements must have length ${sn}, got ${t.length}`);for(let n=0;n<sn;n++)this.elements[n]=t[n];return this}}function L9(e,t,n,o=new Xe){const i=o.set(e.elements).elements,r=t*xh;return i[r+0]=n.x,i[r+1]=n.y,i[r+2]=n.z,o}function D9(e,t,n,o=new Xe){const i=o.set(e.elements).elements;return i[t+cc*0]=n.x,i[t+cc*1]=n.y,i[t+cc*2]=n.z,o}function I9(e,t,n,o=new Xe){const i=o.elements,r=[e,t,n];for(let s=0;s<r.length;s++){const a=s*xh,c=r[s];i[a+0]=c.x,i[a+1]=c.y,i[a+2]=c.z}return o}function zy(e,t,n=jr){for(let o=0;o<sn;o++)if(!pn(e.elements[o],t.elements[o],n))return!1;return!0}function F9(e,t,n=new Xe){for(let o=0;o<sn;o++)n.elements[o]=e.elements[o]+t.elements[o];return n}function R9(e,t,n=new Xe){for(let o=0;o<sn;o++)n.elements[o]=e.elements[o]-t.elements[o];return n}function O9(e,t,n=new Xe){for(let o=0;o<sn;o++)n.elements[o]=e.elements[o]*t;return n}function k9(e,t=new Xe){for(let n=0;n<sn;n++)t.elements[n]=-e.elements[n];return t}function V9(e,t,n=new Xe){const o=e.elements,i=t.elements,r=n.elements,s=o[0],a=o[3],c=o[6],l=o[1],u=o[4],d=o[7],f=o[2],h=o[5],p=o[8],g=i[0],m=i[3],v=i[6],y=i[1],w=i[4],S=i[7],T=i[2],x=i[5],E=i[8];return r[0]=s*g+a*y+c*T,r[3]=s*m+a*w+c*x,r[6]=s*v+a*S+c*E,r[1]=l*g+u*y+d*T,r[4]=l*m+u*w+d*x,r[7]=l*v+u*S+d*E,r[2]=f*g+h*y+p*T,r[5]=f*m+h*w+p*x,r[8]=f*v+h*S+p*E,n}function U9(e){const t=e.elements,n=t[0],o=t[1],i=t[2],r=t[3],s=t[4],a=t[5],c=t[6],l=t[7],u=t[8];return n*s*u-n*a*l-o*r*u+o*a*c+i*r*l-i*s*c}function z9(e,t=new Xe){const n=e.elements,o=t.elements;return o[0]=n[0],o[4]=n[4],o[8]=n[8],o[1]=n[3],o[3]=n[1],o[2]=n[6],o[6]=n[2],o[5]=n[7],o[7]=n[5],t}function B9(e,t=new Xe){const n=e.elements,o=n[0],i=n[1],r=n[2],s=n[3],a=n[4],c=n[5],l=n[6],u=n[7],d=n[8],f=d*a-c*u,h=c*l-d*s,p=u*s-a*l,g=o*f+i*h+r*p;if(g===0)throw new Error("can not invert degenerate matrix");const m=1/g,v=t.elements;return v[0]=f*m,v[1]=(r*u-d*i)*m,v[2]=(c*i-r*a)*m,v[3]=h*m,v[4]=(d*o-r*l)*m,v[5]=(r*s-c*o)*m,v[6]=p*m,v[7]=(i*l-u*o)*m,v[8]=(a*o-i*s)*m,t}function By(e,t,n,o=new Xe){const i=1-n;for(let r=0;r<sn;r++)o.elements[r]=e.elements[r]*i+t.elements[r]*n;return o}function j9(e,t=0,n=new Xe){for(let o=0;o<sn;o++)n.elements[o]=e[t+o];return n}function _9(e,t=new Xe){return j9(oa(e),0,t)}function wh(e,t=new Xe){const n=t.elements,o=e.x,i=e.y,r=e.z,s=Math.cos(o),a=Math.sin(o),c=Math.cos(i),l=Math.sin(i),u=Math.cos(r),d=Math.sin(r),f=s*u,h=s*d,p=a*u,g=a*d;return n[0]=c*u,n[3]=-c*d,n[6]=l,n[1]=h+p*l,n[4]=f-g*l,n[7]=-a*c,n[2]=g-f*l,n[5]=p+h*l,n[8]=s*c,t}function jy(e,t=new Xe){const n=e.x,o=e.y,i=e.z,r=e.w,s=n+n,a=o+o,c=i+i,l=n*s,u=n*a,d=n*c,f=o*a,h=o*c,p=i*c,g=r*s,m=r*a,v=r*c;return t.set([1-(f+p),u-v,d+m,u+v,1-(l+p),h-g,d-m,h+g,1-(l+f)])}function H9(e,t=new Xe){return t.set([e.x,0,0,0,e.y,0,0,0,1])}function q9(e,t=new Mt){const n=e.elements,o=n[0],i=n[1],r=n[3],s=n[4];return t.set(Math.sqrt(o*o+i*i),Math.sqrt(r*r+s*s))}function W9(e,t=new Xe){return t.set([1,0,e.x,0,1,e.y,0,0,1])}function G9(e,t=new Mt){return t.set(e.elements[2],e.elements[5])}function Sh(e,t=new Xe){const n=e.elements;return t.set([n[0],n[1],n[2],n[4],n[5],n[6],n[8],n[9],n[10]])}class xe{constructor(t=0,n=0,o=0){this.x=t,this.y=n,this.z=o}clone(t=new xe){return t.set(this.x,this.y,this.z)}set(t,n,o){return this.x=t,this.y=n,this.z=o,this}}function _r(e,t,n=jr){return pn(e.x,t.x,n)&&pn(e.y,t.y,n)&&pn(e.z,t.z,n)}function Th(e,t,n=new xe){return n.set(e.x+t.x,e.y+t.y,e.z+t.z)}function Dl(e,t,n=new xe){return n.set(e.x-t.x,e.y-t.y,e.z-t.z)}function Mr(e,t,n=new xe){return n.set(e.x*t,e.y*t,e.z*t)}function Eh(e,t=new xe){return t.set(-e.x,-e.y,-e.z)}function Rc(e){return Math.sqrt(_y(e,e))}function Mh(e,t=new xe){const n=1/Rc(e);return Mr(e,n,t)}function _y(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function lc(e,t,n=new xe){const o=e.x,i=e.y,r=e.z,s=t.x,a=t.y,c=t.z;return n.set(i*c-r*a,r*s-o*c,o*a-i*s)}function Hr(e,t,n,o=new xe){const i=1-n;return o.set(e.x*i+t.x*n,e.y*i+t.y*n,e.z*i+t.z*n)}function X9(e,t=0,n=new xe){return n.set(e[t+0],e[t+1],e[t+2])}function Ph(e,t=new xe){return X9(oa(e),0,t)}function Z9(e,t=new xe){function n(c,l,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?c+(l-c)*6*u:u<1/2?l:u<2/3?c+(l-c)*6*(2/3-u):c}const o=(e.x%1+1)%1,i=Math.min(Math.max(e.y,0),1),r=Math.min(Math.max(e.z,0),1);if(i===0)return t.set(1,1,1);const s=r<=.5?r*(1+i):r+i-r*i,a=2*r-s;return t.set(n(a,s,o+1/3),n(a,s,o),n(a,s,o-1/3))}function K9(e,t=new xe){const n=e.x,o=e.y,i=e.z,r=Math.max(n,o,i),s=Math.min(n,o,i);let a=0,c=0;const l=(s+r)/2;if(s===r)a=0,c=0;else{const u=r-s;switch(c=l<=.5?u/(r+s):u/(2-r-s),r){case n:a=(o-i)/u+(o<i?6:0);break;case o:a=(i-n)/u+2;break;case i:a=(n-o)/u+4;break}a/=6}return t.set(a,c,l)}function Y9(e,t=new xe){return e=Math.floor(e),t.set((e>>16&255)/255,(e>>8&255)/255,(e&255)/255)}function Q9(e){return e.x*255<<16^e.y*255<<8^e.z*255<<0}function Nh(e,t=new xe){const n=e.elements,o=n[0],i=n[3],r=n[6];n[1];const s=n[4],a=n[7];n[2];const c=n[5],l=n[8];return t.y=Math.asin(oi.clamp(r,-1,1)),Math.abs(r)<.9999999?(t.x=Math.atan2(-a,l),t.z=Math.atan2(-i,o)):(t.x=Math.atan2(c,s),t.z=0),t}function J9(e,t=new xe){return Nh(Sh(e),t)}function $9(e,t=new xe){return Nh(jy(e),t)}const Hy={name:"color",creator:()=>new xe,deserialize:e=>typeof e=="string"?Ph(e):new xe(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>Hr(e,t,n),equals:(e,t)=>_r(e,t),clone:e=>e.clone()},qy={name:"euler",creator:()=>new xe,deserialize:e=>typeof e=="string"?Ph(e):new xe(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>Hr(e,t,n),equals:(e,t)=>_r(e,t),clone:e=>e.clone()};class Ne{constructor(t=0,n=0,o=0,i=0){this.x=t,this.y=n,this.z=o,this.w=i}clone(t=new Ne){return t.set(this.x,this.y,this.z,this.w)}set(t,n,o,i){return this.x=t,this.y=n,this.z=o,this.w=i,this}}function Il(e,t,n=jr){return pn(e.x,t.x,n)&&pn(e.y,t.y,n)&&pn(e.z,t.z,n)&&pn(e.w,t.w,n)}function eN(e,t,n=new Ne){return n.set(e.x+t.x,e.y+t.y,e.z+t.z,e.w+t.w)}function tN(e,t,n=new Ne){return n.set(e.x-t.x,e.y-t.y,e.z-t.z,e.w-t.w)}function Fl(e,t,n=new Ne){return n.set(e.x*t,e.y*t,e.z*t,e.w*t)}function Wy(e,t=new Ne){return t.set(-e.x,-e.y,-e.z,-e.w)}function Ah(e){return Math.sqrt(Rl(e,e))}function Ch(e,t=new Ne){const n=1/Ah(e);return Fl(e,n,t)}function Rl(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}function Lh(e,t,n,o=new Ne){const i=1-n;return o.set(e.x*i+t.x*n,e.y*i+t.y*n,e.z*i+t.z*n,e.w*i+t.w*n)}function nN(e,t=0,n=new Ne){return n.set(e[t+0],e[t+1],e[t+2],e[t+3])}function oN(e,t,n=0){t[n+0]=e.x,t[n+1]=e.y,t[n+2]=e.z,t[n+3]=e.w}function Gy(e,t=new Ne){return nN(oa(e),0,t)}function iN(e,t=new Ne){return t.set(-e.x,-e.y,-e.z,e.w)}function rN(e,t,n=new Ne){const o=e.x,i=e.y,r=e.z,s=e.w,a=t.x,c=t.y,l=t.z,u=t.w;return n.set(o*u+s*a+i*l-r*c,i*u+s*c+r*a-o*l,r*u+s*l+o*c-i*a,s*u-o*a-i*c-r*l)}function Xy(e,t,n,o=new Ne){if(n<=0)return e.clone(o);if(n>=1)return t.clone(o);let i=Rl(e,t);if(i<0?(Wy(t,o),i=-i):t.clone(o),i>=1)return o;const r=1-i*i;if(r<=Number.EPSILON)return Lh(e,o,n),Ch(o,o),o;const s=Math.sqrt(r),a=Math.atan2(s,i),c=Math.sin((1-n)*a)/s,l=Math.sin(n*a)/s;return o.w=e.w*c+o.w*l,o.x=e.x*c+o.x*l,o.y=e.y*c+o.y*l,o.z=e.z*c+o.z*l,o}function Zy(e,t=new Ne){const n=e.x,o=e.y,i=e.z,r=e.w,s=Math.sqrt(n*n+o*o+i*i),a=Math.exp(r),c=s>0?a*Math.sin(s)/s:0;return t.set(n*c,o*c,i*c,a*Math.cos(s))}function Ky(e,t=new Ne){const n=e.x,o=e.y,i=e.z,r=e.w,s=Math.sqrt(n*n+o*o+i*i),a=s>0?Math.atan2(s,r)/s:0;return t.set(n*a,o*a,i*a,.5*Math.log(n*n+o*o+i*i+r*r))}function sN(e,t,n=new Ne){const o=Ky(e),i=Fl(o,t);return Zy(i,n),n}function aN(e,t=new Ne){const n=Math.cos(e.x/2),o=Math.cos(e.y/2),i=Math.cos(e.z/2),r=Math.sin(e.x/2),s=Math.sin(e.y/2),a=Math.sin(e.z/2);return t.set(r*o*i+n*s*a,n*s*i-r*o*a,n*o*a+r*s*i,n*o*i-r*s*a)}function cN(e,t,n=new Ne){const o=e/2,i=Math.sin(o);return n.set(t.x*i,t.y*i,t.z*i,Math.cos(o))}function lN(e,t=new Ne){return Yy(Sh(e),t)}function Yy(e,t=new Ne){const n=e.elements,o=n[0],i=n[3],r=n[6],s=n[1],a=n[4],c=n[7],l=n[2],u=n[5],d=n[8],f=o+a+d;if(f>0){const p=.5/Math.sqrt(f+1);return t.set((u-c)*p,(r-l)*p,(s-i)*p,.25/p)}if(o>a&&o>d){const p=2*Math.sqrt(1+o-a-d);return t.set(.25*p,(i+s)/p,(r+l)/p,(u-c)/p)}if(a>d){const p=2*Math.sqrt(1+a-o-d);return t.set((i+s)/p,.25*p,(c+u)/p,(r-l)/p)}const h=2*Math.sqrt(1+d-o-a);return t.set((r+l)/h,(c+u)/h,.25*h,(s-i)/h)}const Qy={name:"quat",creator:()=>new Ne,deserialize:e=>typeof e=="string"?Gy(e):new Ne(e[0],e[1],e[2],e[3]),serialize:e=>[e.x,e.y,e.z,e.w],lerp:(e,t,n)=>Xy(e,t,n),equals:(e,t)=>Il(e,t),clone:e=>e.clone()},Jy={name:"vec2",creator:()=>new Mt,deserialize:e=>typeof e=="string"?C9(e):new Mt(e[0],e[1]),serialize:e=>[e.x,e.y],lerp:(e,t,n)=>Uy(e,t,n),equals:(e,t)=>e.x===t.x&&e.y===t.y,clone:e=>e.clone()},$y={name:"vec3",creator:()=>new xe,deserialize:e=>typeof e=="string"?Ph(e):new xe(e[0],e[1],e[2]),serialize:e=>[e.x,e.y,e.z],lerp:(e,t,n)=>Hr(e,t,n),equals:(e,t)=>_r(e,t),clone:e=>e.clone()},e2={name:"vec4",creator:()=>new Ne,deserialize:e=>typeof e=="string"?Gy(e):new Ne(e[0],e[1],e[2],e[3]),serialize:e=>[e.x,e.y,e.z,e.w],lerp:(e,t,n)=>Lh(e,t,n),equals:(e,t)=>Il(e,t),clone:e=>e.clone()},uN=()=>({});zt({typeName:"scene/nodeClick",category:U.None,label:"On Scene Node Click",in:{jsonPath:(e,t)=>{const n=t.getDependency("IScene");return{valueType:"string",choices:n==null?void 0:n.getRaycastableProperties()}}},out:{flow:"flow"},initialState:uN(),init:({read:e,commit:t,graph:n})=>{const o=()=>{t("flow")},i=e("jsonPath"),r=n.getDependency("IScene");return r==null||r.addOnClickedListener(i,o),{handleNodeClick:o,jsonPath:i}},dispose:({state:{handleNodeClick:e,jsonPath:t},graph:{getDependency:n}})=>{if(Te.mustBeTrue(e!==void 0),Te.mustBeTrue(t!==void 0),!t||!e)return{};const o=n("scene");return o==null||o.removeOnClickedListener(t,e),{}}});const fN=b({name:"math/color/constant",label:"Color",in:["color"],out:"color",exec:e=>e}),dN=b({name:"math/color/convert/toColor/rgb",label:"RGB To Color",in:[{r:"float"},{g:"float"},{b:"float"}],out:"color",exec:(e,t,n)=>new xe(e,t,n)}),hN=b({name:"math/color/toRgb",label:"Color to RGB",in:["color"],out:[{r:"float"},{g:"float"},{b:"float"}],exec:e=>({r:e.x,g:e.y,b:e.z})}),pN=b({name:"math/color/basic/add",label:"+",in:["color","color"],out:"color",exec:Th}),mN=b({name:"math/color/basic/subtract",label:"-",in:["color","color"],out:"color",exec:Dl}),gN=b({name:"math/color/negate",label:"-",in:["color"],out:"color",exec:Eh}),vN=b({name:"math/color/basic/scale",label:"",in:["color","float"],out:"color",exec:Mr}),yN=b({name:"math/color/basic/mix",label:"",in:[{a:"color"},{b:"color"},{t:"float"}],out:"color",exec:Hr}),bN=b({name:"math/color/convert/toColor/hsl",label:"HSL to Color",in:["vec3"],out:"color",exec:Z9}),xN=b({name:"math/color/toHsl",label:"Color to HSL",in:["color"],out:"vec3",exec:K9}),wN=b({name:"math/color/convert/toColor/hex",label:"HEX to Color",in:["float"],out:"color",exec:Y9}),SN=b({name:"math/color/toHex",label:"Color to HEX",in:["color"],out:"float",exec:Q9}),TN=b({name:"math/color/compare/equal",label:"=",in:[{a:"color"},{b:"color"},{tolerance:"float"}],out:"boolean",exec:_r}),EN=Object.freeze(Object.defineProperty({__proto__:null,Add:pN,ColorToHex:SN,ColorToHsl:xN,Constant:fN,Create:dN,Elements:hN,Equal:TN,HexToColor:wN,HslToColor:bN,Mix:yN,Negate:gN,Scale:vN,Subtract:mN},Symbol.toStringTag,{value:"Module"})),MN=b({name:"math/euler/constant",label:"Euler",in:["euler"],out:"euler",exec:e=>e}),PN=b({name:"math/float/convert/toEuler",label:"Float to Euler",in:[{x:"float"},{y:"float"},{z:"float"}],out:"euler",exec:(e,t,n)=>new xe(e,t,n)}),NN=b({name:"math/euler/convert/toFloat",label:"Euler to Float",in:["euler"],out:[{x:"float"},{y:"float"},{z:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z})}),AN=b({name:"math/euler/basic/add",label:"+",in:["euler","euler"],out:"euler",exec:Th}),CN=b({name:"math/euler/basic/subtract",label:"-",in:["euler","euler"],out:"euler",exec:Dl}),LN=b({name:"math/euler/negate",label:"-",in:["euler"],out:"euler",exec:Eh}),DN=b({name:"math/euler/basic/scale",label:"",in:["euler","float"],out:"euler",exec:Mr}),IN=b({name:"math/euler/basic/mix",label:"",in:[{a:"euler"},{b:"euler"},{t:"float"}],out:"euler",exec:(e,t,n)=>(console.warn("TODO: this is not shortest path"),Hr(e,t,n))}),FN=b({name:"math/mat3/convert/toEuler",label:"To Euler",in:["mat3"],out:"euler",exec:Nh}),RN=b({name:"math/mat4/convert/toEuler",label:"To Euler",in:["mat4"],out:"euler",exec:J9}),ON=b({name:"math/quat/convert/toEuler",label:"To Euler",in:["quat"],out:"euler",exec:$9}),kN=b({name:"math/euler/compare/equal",label:"=",in:[{a:"euler"},{b:"euler"},{tolerance:"float"}],out:"boolean",exec:_r}),VN=Object.freeze(Object.defineProperty({__proto__:null,Add:AN,Constant:MN,Create:PN,Elements:NN,Equal:kN,Mat3ToEuler:FN,Mat4ToEuler:RN,Mix:IN,Negate:LN,QuatToEuler:ON,Scale:DN,Subtract:CN},Symbol.toStringTag,{value:"Module"})),UN=b({name:"math/mat3/constant",label:"Mat3",in:["mat3"],out:"mat3",exec:e=>e}),zN=b({name:"math/mat3/convert/toMat3/column3",label:"Columns to Mat3",in:["vec3","vec3","vec3"],out:"mat3",exec:I9}),BN=b({name:"math/mat3/setColumn",label:"Set Column",in:["mat3","integer","vec3"],out:"mat3",exec:L9}),jN=b({name:"math/mat3/setRow",label:"Set Row",in:["mat3","integer","vec3"],out:"mat3",exec:D9}),_N=b({name:"math/mat3/convert/toVec3",label:"Mat3 To Vec3",in:["mat3"],out:[{x:"vec3"},{y:"vec3"},{z:"vec3"}],exec:e=>{throw new Error("not implemented")}}),HN=b({name:"math/mat3/basic/add",label:"+",in:["mat3","mat3"],out:"mat3",exec:F9}),qN=b({name:"math/mat3/basic/subtract",label:"-",in:["mat3","mat3"],out:"mat3",exec:R9}),WN=b({name:"math/mat3/negate",label:"-",in:["mat3"],out:"mat3",exec:k9}),GN=b({name:"math/mat3/basic/scale",label:"",in:["mat3","float"],out:"mat3",exec:O9}),XN=b({name:"math/mat3/determinant",label:"Determinant",in:["mat3"],out:"float",exec:U9}),ZN=b({name:"math/mat3/basic/inverse",label:"Inverse",in:["mat3"],out:"mat3",exec:B9}),KN=b({name:"math/mat4/convert/toMat3",label:"Mat4 To Mat3",in:["mat4"],out:"mat3",exec:Sh}),YN=b({name:"math/mat3/transpose",label:"Transpose",in:["mat3"],out:"mat3",exec:z9}),QN=b({name:"math/mat3/basic/multiply",label:"Cross",in:["mat3","mat3"],out:"mat3",exec:V9}),JN=b({name:"math/mat3/basic/mix",label:"",in:[{a:"mat3"},{b:"mat3"},{t:"float"}],out:"mat3",exec:By}),$N=b({name:"math/mat3/compare/equal",label:"=",in:[{a:"mat3"},{b:"mat3"},{tolerance:"float"}],out:"boolean",exec:zy}),eA=b({name:"math/euler/convert/toMat3",label:"To Mat3",in:["euler"],out:"mat3",exec:wh}),tA=b({name:"math/quat/convert/toMat3",label:"To Mat3",in:["quat"],out:"mat3",exec:wh}),nA=b({name:"math/mat3/convert/toMat3/scale2",label:"Scale2 To Mat3",in:["vec2"],out:"mat3",exec:H9}),oA=b({name:"math/mat3/toScale2",label:"Mat3 to Scale2",in:["mat3"],out:"vec2",exec:q9}),iA=b({name:"math/mat3/convert/toMat3/translation2",label:"Translation2 To Mat3",in:["vec2"],out:"mat3",exec:W9}),rA=b({name:"math/mat3/toTranslation2",label:"Mat3 to Translation2",in:["mat3"],out:"vec2",exec:G9}),sA=Object.freeze(Object.defineProperty({__proto__:null,Add:HN,Column3ToMat3:zN,Constant:UN,Determinant:XN,Elements:_N,Equal:$N,EulerToMat3:eA,Inverse:ZN,Mat3ToScale2:oA,Mat3ToTranslation3:rA,Mat4ToMat3:KN,Mix:JN,Multiply:QN,Negate:WN,QuatToMat3:tA,Scale:GN,Scale2ToMat3:nA,SetColumn:BN,SetRow:jN,Subtract:qN,Translation2ToMat3:iA,Transpose:YN},Symbol.toStringTag,{value:"Module"})),Dh=4,hs=4,an=Dh*hs;class we{constructor(t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]){if(this.elements=t,t.length!==an)throw new Error(`elements must have length ${an}, got ${t.length}`)}clone(t=new we){return t.set(this.elements)}set(t){if(t.length!==an)throw new Error(`elements must have length ${an}, got ${t.length}`);for(let n=0;n<an;n++)this.elements[n]=t[n];return this}}function aA(e,t,n,o=new we){const i=o.set(e.elements).elements,r=Number(t)*Dh;return i[r+0]=n.x,i[r+1]=n.y,i[r+2]=n.z,i[r+3]=n.w,o}function cA(e,t,n,o=new we){const i=o.set(e.elements).elements,r=Number(t);return i[r+hs*0]=n.x,i[r+hs*1]=n.y,i[r+hs*2]=n.z,i[r+hs*3]=n.w,o}function lA(e,t,n,o,i=new we){const r=i.elements,s=[e,t,n,o];for(let a=0;a<s.length;a++){const c=a*Dh,l=s[a];r[c+0]=l.x,r[c+1]=l.y,r[c+2]=l.z,r[c+3]=l.w}return i}function t2(e,t,n=jr){for(let o=0;o<an;o++)if(!pn(e.elements[o],t.elements[o],n))return!1;return!0}function uA(e,t,n=new we){for(let o=0;o<an;o++)n.elements[o]=e.elements[o]+t.elements[o];return n}function fA(e,t,n=new we){for(let o=0;o<an;o++)n.elements[o]=e.elements[o]-t.elements[o];return n}function dA(e,t,n=new we){for(let o=0;o<an;o++)n.elements[o]=e.elements[o]*t;return n}function hA(e,t=new we){for(let n=0;n<an;n++)t.elements[n]=-e.elements[n];return t}function ra(e,t,n=new we){const o=e.elements,i=t.elements,r=n.elements,s=o[0],a=o[4],c=o[8],l=o[12],u=o[1],d=o[5],f=o[9],h=o[13],p=o[2],g=o[6],m=o[10],v=o[14],y=o[3],w=o[7],S=o[11],T=o[15],x=i[0],E=i[4],C=i[8],L=i[12],D=i[1],R=i[5],I=i[9],k=i[13],V=i[2],X=i[6],$=i[10],_e=i[14],it=i[3],rt=i[7],qo=i[11],sa=i[15];return r[0]=s*x+a*D+c*V+l*it,r[4]=s*E+a*R+c*X+l*rt,r[8]=s*C+a*I+c*$+l*qo,r[12]=s*L+a*k+c*_e+l*sa,r[1]=u*x+d*D+f*V+h*it,r[5]=u*E+d*R+f*X+h*rt,r[9]=u*C+d*I+f*$+h*qo,r[13]=u*L+d*k+f*_e+h*sa,r[2]=p*x+g*D+m*V+v*it,r[6]=p*E+g*R+m*X+v*rt,r[10]=p*C+g*I+m*$+v*qo,r[14]=p*L+g*k+m*_e+v*sa,r[3]=y*x+w*D+S*V+T*it,r[7]=y*E+w*R+S*X+T*rt,r[11]=y*C+w*I+S*$+T*qo,r[15]=y*L+w*k+S*_e+T*sa,n}function pA(e){const t=e.elements,n=t[0],o=t[1],i=t[2],r=t[3],s=t[4],a=t[5],c=t[6],l=t[7],u=t[8],d=t[9],f=t[10],h=t[11],p=t[12],g=t[13],m=t[14],v=t[15],y=d*m*l-g*f*l+g*c*h-a*m*h-d*c*v+a*f*v,w=p*f*l-u*m*l-p*c*h+s*m*h+u*c*v-s*f*v,S=u*g*l-p*d*l+p*a*h-s*g*h-u*a*v+s*d*v,T=p*d*c-u*g*c-p*a*f+s*g*f+u*a*m-s*d*m;return n*y+o*w+i*S+r*T}function mA(e,t=new we){const n=e.elements,o=t.elements,i=n[0],r=n[1],s=n[2],a=n[3],c=n[4],l=n[5],u=n[6],d=n[7],f=n[8],h=n[9],p=n[10],g=n[11],m=n[12],v=n[13],y=n[14],w=n[15],S=i*l-r*c,T=i*u-s*c,x=i*d-a*c,E=r*u-s*l,C=r*d-a*l,L=s*d-a*u,D=f*v-h*m,R=f*y-p*m,I=f*w-g*m,k=h*y-p*v,V=h*w-g*v,X=p*w-g*y;return o[0]=l*X-u*V+d*k,o[1]=s*V-r*X-a*k,o[2]=v*L-y*C+w*E,o[3]=p*C-h*L-g*E,o[4]=u*I-c*X-d*R,o[5]=i*X-s*I+a*R,o[6]=y*x-m*L-w*T,o[7]=f*L-p*x+g*T,o[8]=c*V-l*I+d*D,o[9]=r*I-i*V-a*D,o[10]=m*C-v*x+w*S,o[11]=h*x-f*C-g*S,o[12]=l*R-c*k-u*D,o[13]=i*k-r*R+s*D,o[14]=v*T-m*E-y*S,o[15]=f*E-h*T+p*S,t}function gA(e,t=new we){const n=e.clone(t).elements;let o;return o=n[1],n[1]=n[4],n[4]=o,o=n[2],n[2]=n[8],n[8]=o,o=n[6],n[6]=n[9],n[9]=o,o=n[3],n[3]=n[12],n[12]=o,o=n[7],n[7]=n[13],n[13]=o,o=n[11],n[11]=n[14],n[14]=o,t}function vA(e,t=new we){const n=e.elements,o=n[0],i=n[1],r=n[2],s=n[3],a=n[4],c=n[5],l=n[6],u=n[7],d=n[8],f=n[9],h=n[10],p=n[11],g=n[12],m=n[13],v=n[14],y=n[15],w=f*v*u-m*h*u+m*l*p-c*v*p-f*l*y+c*h*y,S=g*h*u-d*v*u-g*l*p+a*v*p+d*l*y-a*h*y,T=d*m*u-g*f*u+g*c*p-a*m*p-d*c*y+a*f*y,x=g*f*l-d*m*l-g*c*h+a*m*h+d*c*v-a*f*v,E=o*w+i*S+r*T+s*x;if(E===0)throw new Error("can not invert degenerate matrix");const C=1/E,L=t.elements;return L[0]=w*C,L[1]=(m*h*s-f*v*s-m*r*p+i*v*p+f*r*y-i*h*y)*C,L[2]=(c*v*s-m*l*s+m*r*u-i*v*u-c*r*y+i*l*y)*C,L[3]=(f*l*s-c*h*s-f*r*u+i*h*u+c*r*p-i*l*p)*C,L[4]=S*C,L[5]=(d*v*s-g*h*s+g*r*p-o*v*p-d*r*y+o*h*y)*C,L[6]=(g*l*s-a*v*s-g*r*u+o*v*u+a*r*y-o*l*y)*C,L[7]=(a*h*s-d*l*s+d*r*u-o*h*u-a*r*p+o*l*p)*C,L[8]=T*C,L[9]=(g*f*s-d*m*s-g*i*p+o*m*p+d*i*y-o*f*y)*C,L[10]=(a*m*s-g*c*s+g*i*u-o*m*u-a*i*y+o*c*y)*C,L[11]=(d*c*s-a*f*s-d*i*u+o*f*u+a*i*p-o*c*p)*C,L[12]=x*C,L[13]=(d*m*r-g*f*r+g*i*h-o*m*h-d*i*v+o*f*v)*C,L[14]=(g*c*r-a*m*r-g*i*l+o*m*l+a*i*v-o*c*v)*C,L[15]=(a*f*r-d*c*r+d*i*l-o*f*l-a*i*h+o*c*h)*C,t}function n2(e,t,n,o=new we){const i=1-n;for(let r=0;r<an;r++)o.elements[r]=e.elements[r]*i+t.elements[r]*n;return o}function yA(e,t=0,n=new we){for(let o=0;o<an;o++)n.elements[o]=e[t+o];return n}function bA(e,t=new we){return yA(oa(e),0,t)}function Ih(e,t=new we){const n=e.elements;return t.set([n[0],n[1],n[2],0,n[3],n[4],n[5],0,n[6],n[7],n[8],0,0,0,0,1])}function o2(e,t=new we){return Ih(wh(e),t)}function i2(e,t=new we){return Ih(jy(e),t)}function r2(e,t=new we){return t.set([e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1])}function s2(e,t=new we){return t.set([1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1])}function xA(e,t,n=new we){return ra(e,s2(t),n)}function wA(e,t,n=new we){return ra(e,r2(t),n)}function SA(e,t,n=new we){return ra(e,i2(t),n)}function TA(e,t,n=new we){return ra(e,o2(t),n)}function EA(e,t,n=new xe){const o=t.x,i=t.y,r=t.z,s=e.elements,a=1/(s[3]*o+s[7]*i+s[11]*r+s[15]);return n.x=(s[0]*o+s[4]*i+s[8]*r+s[12])*a,n.y=(s[1]*o+s[5]*i+s[9]*r+s[13])*a,n.z=(s[2]*o+s[6]*i+s[10]*r+s[14])*a,n}function MA(e,t,n=new xe){const o=e.x,i=e.y,r=e.z,s=t.elements;return n.x=s[0]*o+s[4]*i+s[8]*r,n.y=s[1]*o+s[5]*i+s[9]*r,n.z=s[2]*o+s[6]*i+s[10]*r,Mh(n,n)}function PA(e,t,n,o=new we){const i=o.elements,r=Dl(e,t),s=Rc(r);s===0?r.z=1:Mr(r,1/s,r);const a=lc(n,r),c=Rc(a);c===0?(Math.abs(n.z)===1?n.x+=1e-4:n.z+=1e-4,Mh(n,n),lc(a,n,a)):Mr(a,1/c,a);const l=lc(r,a);return i[0]=a.x,i[4]=l.x,i[8]=r.x,i[1]=a.y,i[5]=l.y,i[9]=r.y,i[2]=a.z,i[6]=l.z,i[10]=r.z,o}const NA=b({name:"math/mat4/constant",label:"Mat4",in:["mat4"],out:"mat4",exec:e=>e}),AA=b({name:"math/mat4/convert/toMat4/column4",label:"Columns to Mat4",in:[{x:"vec4"},{y:"vec4"},{z:"vec4"},{w:"vec4"}],out:"mat4",exec:lA}),CA=b({name:"math/mat4/setColumn",label:"Set Column",in:["mat4","integer","vec4"],out:"mat4",exec:aA}),LA=b({name:"math/mat4/setRow",label:"Set Row",in:["mat4","integer","vec4"],out:"mat4",exec:cA}),DA=b({name:"math/mat4/convert/toVec4",label:"Mat4 To Vec4",in:["mat4"],out:[{x:"vec4"},{y:"vec4"},{z:"vec4"},{w:"vec4"}],exec:()=>{throw new Error("not implemented")}}),IA=b({name:"math/mat4/basic/add",label:"+",in:["mat4","mat4"],out:"mat4",exec:uA}),FA=b({name:"math/mat4/basic/subtract",label:"-",in:["mat4","mat4"],out:"mat4",exec:fA}),RA=b({name:"math/mat4/negate",label:"-",in:["mat4"],out:"mat4",exec:hA}),OA=b({name:"math/mat4/basic/multiplyByScalar",label:"",in:["mat4","float"],out:"mat4",exec:dA}),kA=b({name:"math/mat4/determinant",label:"Determinant",in:["mat4"],out:"float",exec:pA}),VA=b({name:"math/mat4/basic/adjoint",label:"Adjoint",in:["mat4"],out:"mat4",exec:mA}),UA=b({name:"math/mat4/basic/inverse",label:"Inverse",in:["mat4"],out:"mat4",exec:vA}),zA=b({name:"math/mat4/transpose",label:"Transpose",in:["mat4"],out:"mat4",exec:gA}),BA=b({name:"math/mat3/convert/toMat4",label:"Mat3 To Mat4",in:["mat3"],out:"mat4",exec:Ih}),jA=b({name:"math/mat4/convert/toMat4/scale3",label:"Scale3 To Mat4",in:["vec3"],out:"mat4",exec:r2}),_A=b({name:"math/mat4/convert/toMat4/translate3",label:"Translate3 To Mat4",in:["vec3"],out:"mat4",exec:s2}),HA=b({name:"math/quat/convert/toMat4",label:"Quat To Mat4",in:["quat"],out:"mat4",exec:i2}),qA=b({name:"math/euler/convert/toMat4",label:"Euler To Mat4",in:["euler"],out:"mat4",exec:o2}),WA=b({name:"math/mat4/translate",label:"Translate",in:["mat4","vec3"],out:"mat4",exec:xA}),GA=b({name:"math/mat4/basic/scale",label:"Scale",in:["mat4","vec3"],out:"mat4",exec:wA}),XA=b({name:"math/mat4/rotateByQuat",label:"Rotate",in:["mat4","quat"],out:"mat4",exec:SA}),ZA=b({name:"math/mat4/rotateByEuler",label:"Rotate",in:["mat4","euler"],out:"mat4",exec:TA}),KA=b({name:"math/mat4/basic/multiply",label:"Matrix4 Multiply",in:["mat4","mat4"],out:"mat4",exec:ra}),YA=b({name:"math/mat4/basic/mix",label:"Matrix4 Mix",in:[{a:"mat4"},{b:"mat4"},{t:"float"}],out:"mat4",exec:n2}),QA=b({name:"math/mat4/convert/equal",label:"=",in:[{a:"mat4"},{b:"mat4"},{tolerance:"float"}],out:"boolean",exec:t2}),JA=b({name:"math/mat4/transformPoint3",label:"Transform Point3",in:["mat4","vec3"],out:"vec3",exec:EA}),$A=b({name:"math/mat4/transformNormal3",label:"Transform Normal",in:["mat4","vec3"],out:"vec3",exec:MA}),e8=b({name:"math/mat4/lookAt",label:"Look At",in:[{eye:"vec3"},{target:"vec3"},{up:"vec3"}],out:"mat4",exec:PA}),t8=Object.freeze(Object.defineProperty({__proto__:null,Add:IA,Adjoint:VA,Column4ToMat4:AA,Constant:NA,Determinant:kA,Elements:DA,Equal:QA,EulerToMat4:qA,Inverse:UA,LookAt:e8,Mat3ToMat4:BA,Mix:YA,Multiply:KA,MultiplyByScalar:OA,Negate:RA,QuatToMat4:HA,RotateByEuler:ZA,RotateByQuat:XA,Scale:GA,Scale3ToMat4:jA,SetColumn:CA,SetRow:LA,Subtract:FA,TransformNormal3:$A,TransformPoint3:JA,Translate:WA,Translate3ToMat4:_A,Transpose:zA},Symbol.toStringTag,{value:"Module"})),n8=b({name:"math/quat/constants",label:"Quaternion",in:["quat"],out:"quat",exec:e=>e}),o8=b({name:"math/float/convert/toQuat",label:"Float to Quat",in:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],out:"quat",exec:(e,t,n,o)=>new Ne(e,t,n,o)}),i8=b({name:"math/quat/convert/toFloat",label:"Quat to Float",in:["quat"],out:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],exec:oN}),r8=b({name:"math/quat/conjugate",label:"Conjugate",in:["quat"],out:"quat",exec:iN}),s8=b({name:"math/quat/basic/multiply",label:"",in:["quat","quat"],out:"quat",exec:rN}),a8=b({name:"math/quat/basic/scale",label:"",in:["quat","float"],out:"quat",exec:Fl}),c8=b({name:"math/quat/length",label:"Length",in:["quat"],out:"float",exec:Ah}),l8=b({name:"math/quat/normalize",label:"Normalize",in:["quat"],out:"quat",exec:Ch}),u8=b({name:"math/quat/basic/dot",label:"Dot Product",in:["quat","quat"],out:"float",exec:Rl}),f8=b({name:"math/quat/transcendental/ln",label:"Ln",in:["quat"],out:"quat",exec:Ky}),d8=b({name:"math/quat/transcendental/exp",label:"Exp",in:["quat"],out:"quat",exec:Zy}),h8=b({name:"math/quat/transcendental/pow",label:"Pow",in:["quat","float"],out:"quat",exec:sN}),p8=b({name:"math/mat3/convert/toQuat",label:"To Quat",in:["mat3"],out:"quat",exec:Yy}),m8=b({name:"math/mat4/convert/toQuat",label:"To Quat",in:["mat4"],out:"quat",exec:lN}),g8=b({name:"math/euler/convert/toQuat",label:"",in:["euler"],out:"quat",exec:aN}),v8=b({name:"math/quat/convert/toQuat/angleAxis",label:"Angle Axis to Quat",in:["float","vec3"],out:"quat",exec:cN}),y8=b({name:"math/quat/slerp",label:"Slerp",in:[{a:"quat"},{b:"quat"},{t:"float"}],out:"quat",exec:Xy}),b8=b({name:"math/quat/compare/equal",label:"=",in:[{a:"quat"},{b:"quat"},{tolerance:"float"}],out:"boolean",exec:Il}),x8=Object.freeze(Object.defineProperty({__proto__:null,AngleAxisToQuat:v8,Constant:n8,Create:o8,Dot:u8,Elements:i8,Equal:b8,EulerToQuat:g8,Exp:d8,Length:c8,Ln:f8,Mat3ToQuat:p8,Mat4ToQuat:m8,Multiply:s8,Negate:r8,Normalize:l8,Pow:h8,Scale:a8,Slerp:y8},Symbol.toStringTag,{value:"Module"})),w8=b({name:"math/vec2/constant",label:"Vec2",in:["vec2"],out:"vec2",exec:e=>e}),S8=b({name:"math/float/convert/toVec2",label:"Float to Vec2",in:[{x:"float"},{y:"float"}],out:"vec2",exec:(e,t)=>new Mt(e,t)}),T8=b({name:"math/vec2/convert/toFloat",label:"Vec2 To Float",in:["vec2"],out:[{x:"float"},{y:"float"}],exec:A9}),E8=b({name:"math/vec2/basic/add",label:"+",in:["vec2","vec2"],out:"vec2",exec:T9}),M8=b({name:"math/vec2/basic/subtract",label:"-",in:["vec2","vec2"],out:"vec2",exec:E9}),P8=b({name:"math/vec2/negate",label:"-",in:["vec2"],out:"vec2",exec:M9}),N8=b({name:"math/vec2/basic/scale",label:"",in:["vec2","float"],out:"vec2",exec:Oy}),A8=b({name:"math/vec2/length",label:"Length",in:["vec2"],out:"float",exec:ky}),C8=b({name:"math/vec2/normalize",label:"Normalize",in:["vec2"],out:"vec2",exec:P9}),L8=b({name:"math/vec2/basic/dot",label:"Dot Product",in:["vec2","vec2"],out:"float",exec:Vy}),D8=b({name:"math/vec2/basic/mix",label:"",in:[{a:"vec2"},{b:"vec2"},{t:"float"}],out:"vec2",exec:Uy}),I8=b({name:"math/vec2/compare/equal",label:"=",in:[{a:"vec2"},{b:"vec2"},{tolerance:"float"}],out:"boolean",exec:S9}),F8=Object.freeze(Object.defineProperty({__proto__:null,Add:E8,Constant:w8,Create:S8,Dot:L8,Elements:T8,Equal:I8,Length:A8,Mix:D8,Negate:P8,Normalize:C8,Scale:N8,Subtract:M8},Symbol.toStringTag,{value:"Module"})),R8=b({name:"math/vec3/constant",label:"Vec3",in:["vec3"],out:"vec3",exec:e=>e}),O8=b({name:"math/float/convert/toVec3",label:"Float to Vec3",in:[{x:"float"},{y:"float"},{z:"float"}],out:"vec3",exec:(e,t,n)=>new xe(e,t,n)}),k8=b({name:"math/vec3/convert/toFloat",label:"Vec3 To Float",in:["vec3"],out:[{x:"float"},{y:"float"},{z:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z})}),V8=b({name:"math/vec3/basic/add",label:"+",in:["vec3","vec3"],out:"vec3",exec:Th}),U8=b({name:"math/vec3/basic/subtract",label:"-",in:["vec3","vec3"],out:"vec3",exec:Dl}),z8=b({name:"math/vec3/negate",label:"-",in:["vec3"],out:"vec3",exec:Eh}),B8=b({name:"math/vec3/basic/scale",label:"",in:["vec3","float"],out:"vec3",exec:Mr}),j8=b({name:"math/vec3/length",label:"Length",in:["vec3"],out:"float",exec:Rc}),_8=b({name:"math/vec3/normalize",label:"Normalize",in:["vec3"],out:"vec3",exec:Mh}),H8=b({name:"math/vec3/basic/cross",label:"Cross",in:["vec3","vec3"],out:"vec3",exec:lc}),q8=b({name:"math/vec3/basic/dot",label:"Dot",in:["vec3","vec3"],out:"float",exec:_y}),W8=b({name:"math/vec3/basic/mix",label:"",in:[{a:"vec3"},{b:"vec3"},{t:"float"}],out:"vec3",exec:Hr}),G8=b({name:"math/vec3/compare/equal",label:"=",in:[{a:"vec3"},{b:"vec3"},{tolerance:"float"}],out:"boolean",exec:_r}),X8=Object.freeze(Object.defineProperty({__proto__:null,Add:V8,Constant:R8,Create:O8,Cross:H8,Dot:q8,Elements:k8,Equal:G8,Length:j8,Mix:W8,Negate:z8,Normalize:_8,Scale:B8,Subtract:U8},Symbol.toStringTag,{value:"Module"})),Z8=b({name:"math/vec4/constant",label:"Vec4",in:["vec4"],out:"vec4",exec:e=>e}),K8=b({name:"math/float/convert/toVec4",label:"Float to Vec4",in:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],out:"vec4",exec:(e,t,n,o)=>new Ne(e,t,n,o)}),Y8=b({name:"math/vec4/convert/toFloat",label:"Vec4 to Float",in:["vec4"],out:[{x:"float"},{y:"float"},{z:"float"},{w:"float"}],exec:e=>({x:e.x,y:e.y,z:e.z,w:e.z})}),Q8=b({name:"math/vec4/basic/add",label:"+",in:["vec4","vec4"],out:"vec4",exec:eN}),J8=b({name:"math/vec4/basic/subtract",label:"-",in:["vec4","vec4"],out:"vec4",exec:tN}),$8=b({name:"math/vec4/negate",label:"-",in:["vec4"],out:"vec4",exec:Wy}),eC=b({name:"math/vec4/basic/scale",label:"",in:["vec4","float"],out:"vec4",exec:Fl}),tC=b({name:"math/vec4/length",label:"Length",in:["vec4"],out:"float",exec:Ah}),nC=b({name:"math/vec4/normalize",label:"Normalize",in:["vec4"],out:"vec4",exec:Ch}),oC=b({name:"math/vec4/basic/dot",label:"Dot Product",in:["vec4","vec4"],out:"float",exec:Rl}),iC=b({name:"math/vec4/basic/mix",label:"",in:[{a:"vec4"},{b:"vec4"},{t:"float"}],out:"vec4",exec:Lh}),rC=b({name:"math/vec4/compare/equal",label:"=",in:[{a:"vec4"},{b:"vec4"},{tolerance:"float"}],out:"boolean",exec:Il}),sC=Object.freeze(Object.defineProperty({__proto__:null,Add:Q8,Constant:Z8,Create:K8,Dot:oC,Elements:Y8,Equal:rC,Length:tC,Mix:iC,Negate:$8,Normalize:nC,Scale:eC,Subtract:J8},Symbol.toStringTag,{value:"Module"})),Bf=mi(()=>Object.fromEntries([Jy,$y,e2,Hy,qy,Qy,fC,dC].map(n=>[n.name,n]))),aC=e=>Object.keys(e).flatMap(t=>Ll({values:e,valueTypeName:t})),cC=mi(()=>{Object.keys({...ia(),...Bf()});const e=[...Be(F8),...Be(X8),...Be(sC),...Be(EN),...Be(VN),...Be(x8),...Be(sA),...Be(t8),...aC(Bf())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),lC=e=>({values:{...e.values,...ia(),...Bf()},nodes:{...e.nodes,...cC()},dependencies:{...e.dependencies}});function jf(e){return e?new P(e.x,e.y,e.z):null}function uC(e){return e?new W1(e.x,e.y,e.z,e.w):null}function a2(e){return e?new re(e.x,e.y,e.z,e.w):null}const fC={name:"mat3",creator:()=>new Xe,deserialize:e=>typeof e=="string"?_9(e):new Xe(e),serialize:e=>e.elements,lerp:(e,t,n)=>By(e,t,n),equals:(e,t)=>zy(e,t),clone:e=>e.clone()},dC={name:"mat4",creator:()=>new we,deserialize:e=>typeof e=="string"?bA(e):new we(e),serialize:e=>e.elements,lerp:(e,t,n)=>n2(e,t,n),equals:(e,t)=>t2(e,t),clone:e=>e.clone()};function Vs(e){if(e===null)return"Null";if(e===void 0)return"Undefined";if(Number.isNaN(e))return"NaN";const t=Object.prototype.toString.call(e).slice(8,-1);return t==="AsyncFunction"?"Promise":t}const{isArray:Fh}=Array;function hC(e,t="."){return typeof e=="string"?e.split(t):e}const pC=e=>Array.prototype.slice.call(e);function mC(e){return e<<0===e}const Du=Number.isInteger||mC;function Rh(e,t=[]){return(...n)=>(o=>o.length>=e.length?e(...o):Rh(e,o))([...t,...n])}function gC(e,t,n){return Object.assign({},n,{[e]:t})}const vC=Rh(gC);function c2(e,t,n){const o=typeof e=="string"?e.split(".").map(r=>Du(Number(r))?Number(r):r):e;if(o.length===0)return t;const i=o[0];if(o.length>1){const s=typeof n!="object"||n===null||!n.hasOwnProperty(i)?Du(o[1])?[]:{}:n[i];t=c2(Array.prototype.slice.call(o,1),t,s)}if(Du(i)&&Fh(n)){const r=pC(n);return r[i]=t,r}return vC(i,t,n)}const yC=Rh(c2);function Ol(e,t){if(arguments.length===1)return r=>Ol(e,r);if(t==null)return;let n=t,o=0;const i=hC(e);for(;o<i.length;){if(n==null||n[i[o]]===null)return;n=n[i[o]],o++}return n}function bC(e,t){if(!Fh(t))throw new Error(`Cannot read property 'indexOf' of ${t}`);const n=Vs(e);if(!["Object","Array","NaN","RegExp"].includes(n))return t.indexOf(e);let o=-1,i=-1;const{length:r}=t;for(;++o<r&&i===-1;)Ci(t[o],e)&&(i=o);return i}function Rg(e){const t=[];let n;for(;!(n=e.next()).done;)t.push(n.value);return t}function xC(e,t){if(e.size!==t.size)return!1;const n=Rg(e.values()),o=Rg(t.values());return n.filter(r=>bC(r,o)===-1).length===0}function Og(e){const t=e.__proto__.toString();return["Error","TypeError"].includes(t)?[t,e.message]:[]}function kg(e){return e.toDateString?[!0,e.getTime()]:[!1]}function Vg(e){return e.constructor!==RegExp?[!1]:[!0,e.toString()]}function Ci(e,t){if(arguments.length===1)return l=>Ci(e,l);const n=Vs(e);if(n!==Vs(t))return!1;if(n==="Function")return e.name===void 0?!1:e.name===t.name;if(["NaN","Undefined","Null"].includes(n))return!0;if(n==="Number")return Object.is(-0,e)!==Object.is(-0,t)?!1:e.toString()===t.toString();if(["String","Boolean"].includes(n))return e.toString()===t.toString();if(n==="Array"){const l=Array.from(e),u=Array.from(t);if(l.toString()!==u.toString())return!1;let d=!0;return l.forEach((f,h)=>{d&&f!==u[h]&&!Ci(f,u[h])&&(d=!1)}),d}const o=Vg(e),i=Vg(t);if(o[0])return i[0]?o[1]===i[1]:!1;if(i[0])return!1;const r=kg(e),s=kg(t);if(r[0])return s[0]?r[1]===s[1]:!1;if(s[0])return!1;const a=Og(e),c=Og(t);if(a[0])return c[0]?a[0]===c[0]&&a[1]===c[1]:!1;if(n==="Set")return xC(e,t);if(n==="Object"){const l=Object.keys(e);if(l.length!==Object.keys(t).length)return!1;let u=!0;return l.forEach(d=>{if(u){const f=e[d],h=t[d];f!==h&&!Ci(f,h)&&(u=!1)}}),u}return!1}function l2(e){const t=Fh(e)?Array(e.length):{};if(e&&e.getTime)return new Date(e.getTime());for(const n in e){const o=e[n];t[n]=typeof o=="object"&&o!==null?o.getTime?new Date(o.getTime()):l2(o):o}return t}function _f(e,t){if(arguments.length===1)return o=>_f(e,o);const n=l2(e);return Object.keys(t).forEach(o=>{Vs(t[o])==="Object"&&Vs(e[o])==="Object"?n[o]=_f(e[o],t[o]):n[o]=t[o]}),n}function u2(e,t){return arguments.length===1?n=>u2(e,n):typeof e=="string"?`${e}${t}`:[...e,...t]}const wC={name:"list",creator:()=>[],deserialize:e=>typeof e=="string"?JSON.parse(e):e,serialize:e=>JSON.stringify(e),equals:(e,t)=>Ci(e,t),clone:e=>e,lerp:e=>{throw new Error("Not implemented")}},f2=mi(()=>Object.fromEntries([VC,wC].map(n=>[n.name,n]))),SC=e=>Object.keys(e).flatMap(t=>Ll({values:e,valueTypeName:t})),TC=mi(()=>{const e=[...Be(mb),...Be(pb),...SC(f2())];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),EC=e=>({values:{...e.values,...f2()},nodes:{...e.nodes,...TC()},dependencies:{...e.dependencies}}),MC=b({name:"logic/list/constant",category:U.Logic,label:"List",in:["list"],out:"list",exec:e=>e}),PC=b({name:"logic/list/compare/equal",category:U.Logic,label:"=",in:["list","list"],out:"boolean",exec:(e,t)=>Ci(e,t)}),Hf=St({typeName:"logic/list/concat",category:U.Logic,configuration:{numInputs:{valueType:"number",defaultValue:2}},label:"Concat",in:e=>{var o;const t=[],n=i=>({key:`list${i}`,valueType:"list"});for(const i of gn(1,(e.numInputs??((o=Hf.configuration)==null?void 0:o.numInputs.defaultValue))+1))t.push({...n(i)});return t},out:{result:"list"},exec:({read:e,write:t,configuration:n})=>{var i;let o=[];for(const r of gn(1,(n.numInputs??((i=Hf.configuration)==null?void 0:i.numInputs.defaultValue))+1)){const s=e(`componentName${r}`);o=u2(o,s)}t("result",o)}}),NC=oe({typeName:"logic/list/loop",category:U.Logic,label:"list Loop",in:{flow:"flow",list:"list",startIndex:"integer",endIndex:"integer"},out:{loopBody:"flow",index:"integer",value:"string",completed:"flow"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("list"),i=Math.max(0,Number(e("startIndex"))||0),r=Math.min(o.length,Number(e("endIndex"))||o.length),s=a=>{a<r?(t("value",JSON.stringify(o[a])),t("index",a),n("loopBody",()=>{s(a+1)})):n("completed")};s(i)}}),AC=St({typeName:"logic/list/getIndex",category:U.Logic,label:"get Index",in:{list:"list",index:"integer"},out:{index:"integer",value:"string"},exec:({read:e,write:t})=>{const n=e("list"),o=e("index");Te.mustBeTrue(o>=0&&o<n.length,"ERROR: index out of range"),t("index",o),t("value",JSON.stringify(n[o]))}}),CC=St({typeName:"logic/list/getLength",category:U.Logic,label:"get Length",in:{list:"list"},out:{length:"integer"},exec:({read:e,write:t})=>{const n=e("list");t("length",n.length)}}),LC=b({name:"logic/object/constant",category:U.Logic,label:"Object",in:["object"],out:"object",exec:e=>e}),DC=b({name:"logic/object/compare/equal",category:U.Logic,label:"=",in:["object","object"],out:"boolean",exec:(e,t)=>Ci(e,t)}),IC=b({name:"logic/assocPath/object",category:U.Logic,label:"Assoc Path",in:[{path:"string"},{newValue:"object"},{obj:"object"}],out:"object",exec:(e,t,n)=>{const o=e.split(".");return yC(o,t,n)}}),FC=b({name:"logic/object/mergeDeep",category:U.Logic,label:"Merge Deep",in:["object","object"],out:"object",exec:(e,t)=>_f(e,t)}),RC=b({name:"logic/object/path/object",category:U.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"object",exec:(e,t)=>Ol(e,t)}),OC=b({name:"logic/object/path/string",category:U.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"string",exec:(e,t)=>Ol(e,t)}),kC=b({name:"logic/object/path/integer",category:U.Logic,label:"Path",in:[{pathToSearch:"string"},{obj:"object"}],out:"integer",exec:(e,t)=>Ol(e,t)}),VC={name:"object",creator:()=>[],deserialize:e=>typeof e=="string"?JSON.parse(e):e,serialize:e=>JSON.stringify(e),equals:(e,t)=>e===t,clone:e=>e,lerp:e=>{throw new Error("Not implemented")}};class UC{constructor(){F(this,"onSceneChanged",new jo);F(this,"sceneVariables",{});F(this,"statePropertiesPaths",{});F(this,"valueRegistry");this.valueRegistry=Object.fromEntries([Dy,Ry,Fy,Iy,Jy,$y,e2,Hy,qy,Qy].map(t=>[t.name,t])),Object.entries(p4.store.stateMap).forEach(t=>{const n={};Object.keys(t[1]).forEach(o=>{n[o]=o}),this.statePropertiesPaths[t[0]]=n})}getProperty(t){const n=t.split(".");let o=this.sceneVariables;for(const i of n){if(!o[i])return;o=o[i]}return o}setProperty(t,n,o){var r;const i=t.split(".");o=o??((r=this.valueRegistry[n])==null?void 0:r.creator()),this.sceneVariables=i.reduceRight((s,a)=>({[a]:s}),o),this.onSceneChanged.emit()}addOnClickedListener(t,n){console.log("added on clicked listener")}removeOnClickedListener(t,n){console.log("removed on clicked listener")}getQueryableProperties(){return[]}getRaycastableProperties(){return[]}getStateProperties(t){const n=t?this.statePropertiesPaths[t]:this.statePropertiesPaths,o=[],i=[{node:n,path:""}];for(;i.length>0;){const{node:r,path:s}=i.pop();for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)){const c=s?`${s}.${a}`:a;typeof r[a]=="object"?i.push({node:r[a],path:c}):o.push(c)}}return o}getProperties(){const t=[],n=[{node:this.sceneVariables,path:""}];for(;n.length>0;){const{node:o,path:i}=n.pop();for(const r in o)if(Object.prototype.hasOwnProperty.call(o,r)){const s=i?`${i}.${r}`:r;typeof o[r]=="object"?n.push({node:o[r],path:s}):t.push(s)}}return t}addOnSceneChangedListener(){console.log("added on scene changed listener")}removeOnSceneChangedListener(){console.log("removed on scene changed listener")}}const zC=()=>{let e=w9({values:{},nodes:{},dependencies:{ILogger:new MP,ILifecycleEventEmitter:new PP,IScene:new UC}});return e=lC(e),e=EC(e),e},BC=[{id:"4bb99f89-11c4-471e-ba46-f507d86ffc93",type:"flow/lifecycle/onExecute",metadata:{positionX:"4.753700030301175",positionY:"-330.7364926607548"}},{id:"0",type:"flow/lifecycle/onStart",metadata:{positionX:"2.1104424778760915",positionY:"-501.2300884955752"},flows:{flow:{nodeId:"2",socket:"flow"}}},{id:"2",type:"debug/log",metadata:{positionX:"270.5933446233562",positionY:"-504.0538689099578"},parameters:{text:{value:"DEBUG hello"}}}],jC=[],_C=[],HC={nodes:BC,variables:jC,customEvents:_C},Oh=Oi({name:"VisualScriptState",initial:()=>{const e=zC();return{templates:[],registries:{ECS:e}}},registerProfile:(e,t)=>{Q(Oh).registries[t].set(n=>e(n))}});let d2=0,Wa;const qC=()=>"visual-script-asyncExecute"+d2,WC=({visualScriptJson:e,autoRun:t=!1,registry:n})=>{var u;const[o,i]=A.useState(),[r,s]=A.useState(t),a=A.useCallback(()=>{s(!0)},[]),c=A.useCallback(()=>{s(!1)},[]),l=A.useCallback(()=>{s(d=>!d)},[]);return A.useEffect(()=>{if(!e||!n.values||!r||!n.dependencies)return;let d;try{d=iP({graphJson:e,registry:n}).nodes}catch(h){console.error(h);return}const f=new tP(d);return i(f),()=>{f.dispose(),i(void 0)}},[e,n.values,r,n.nodes,n.dependencies]),A.useEffect(()=>{var f;if(!o||!r)return;const d=(f=n.dependencies)==null?void 0:f.ILifecycleEventEmitter;if(o.executeAllSync(),d.startEvent.listenerCount===0){console.warn("No onStart Node found in graph.  Graph will not run.");return}return d.startEvent.emit(),o.asyncNodes.length&&Wa===void 0&&(d2++,Wa=ee({uuid:qC(),execute:()=>{!o||!r||o.executeAllAsync(500)},insert:{after:Yt}})),()=>{Wa!==void 0&&(Wa=void 0)}},[o,(u=n.dependencies)==null?void 0:u.ILifecycleEventEmitter,r]),{engine:o,playing:r,play:a,togglePlay:l,pause:c}};var kh=(e=>(e.ECS="ECS",e))(kh||{});const mn=yt({name:"VisualScriptComponent",jsonID:"EE_visual_script",schema:_.Object({domain:_.Enum(kh,"ECS"),visualScript:_.Nullable(_.Type()),run:_.Bool(!1),disabled:_.Bool(!1)}),onSet:(e,t,n)=>{if(!n)return;typeof n.disabled=="boolean"&&t.disabled.set(n.disabled),typeof n.run=="boolean"&&t.run.set(n.run),dt.string.test(n.domain)&&t.domain.value!==n.domain&&t.domain.set(n.domain),dt.object.test(n.visualScript)&&t.visualScript.set(np(n.visualScript))},reactor:()=>{const e=je(),t=se(e,mn),n=Nr(Oh),o=t.run.value&&!t.disabled.value,i=n.registries[t.domain.value].get({noproxy:!0}),r=r4(e,[L1]);n1(()=>{t.visualScript.value===null&&t.visualScript.set(np(HC))},[]);const s=WC({visualScriptJson:t.visualScript.get({noproxy:!0}),autoRun:o,registry:i});return A.useEffect(()=>{t.disabled.value||(t.run.value?s.play():s.pause())},[t.run]),A.useEffect(()=>{t.disabled.value&&t.run.set(!1)},[t.disabled]),r?te.createElement(GC,{entity:e,gltfAncestor:r,key:r}):null}}),GC=e=>{const t=L1.useSceneLoaded(e.gltfAncestor);return A.useEffect(()=>(O(e.entity,mn,{run:!0}),()=>{de(e.entity,mn)&&O(e.entity,mn,{run:!1})}),[t]),null};let XC=0;const Ug=()=>({query:void 0,systemUUID:""}),ZC=zt({typeName:"engine/axis/use",category:U.Engine,label:"Use Axis",in:{axis:(e,t)=>{const n=[...Object.keys(D1).filter(o=>!(parseInt(o)>=0)).sort().map(o=>({text:`gamepad/${o}`,value:o})),...Object.keys(I1).filter(o=>!(parseInt(o)>=0)).sort().map(o=>({text:`xr-gamepad/${o}`,value:o}))];return{valueType:"integer",choices:n,defaultValue:n[0].value}},deadzone:"float"},out:{flow:"flow",entity:"entity",value:"float"},initialState:Ug(),init:({read:e,write:t,commit:n,graph:o})=>{const i=e("axis"),r=e("deadzone"),s=ie([Dt]),a=ee({uuid:"visual-script-onAxis-"+XC++,insert:{with:Rn},execute:()=>{var l;for(const u of s()){const d=M(u,Dt);if(!d.source.gamepad)continue;let f=(l=d.source.gamepad)==null?void 0:l.axes[i];Math.abs(f)<r&&(f=0),t("value",u),t("value",f),n("flow")}}});return{query:s,systemUUID:a}},dispose:({state:{query:e,systemUUID:t},graph:{getDependency:n}})=>(vn(t),Bs(e),Ug())});let KC=0;const zg=()=>({query:void 0,systemUUID:""}),Bg=["down","pressed","touched","up"],YC=zt({typeName:"engine/onButton",category:U.Engine,label:"On Button",in:{button:e=>({valueType:"string",choices:[...Object.keys(s4).filter(n=>!(parseInt(n)>=0)).sort().map(n=>({text:`keyboard/${n}`,value:n})),...Object.keys(op).filter(n=>!(parseInt(n)>=0)).sort().map(n=>({text:`mouse/${n}`,value:n})),...Object.keys(tr).filter(n=>!(parseInt(n)>=0)).sort().map(n=>({text:`gamepad/${n}`,value:n})),...Object.keys(a4).filter(n=>!(parseInt(n)>=0)).sort().map(n=>({text:`xr-gamepad/${n}`,value:n}))],defaultValue:op.PrimaryClick})},out:{...Bg.reduce((e,t)=>({...e,[`${t.charAt(0).toUpperCase()}${t.slice(1)}`]:"flow"}),{}),value:"float"},initialState:zg(),init:({read:e,write:t,commit:n})=>{const o=e("button"),i=ie([Dt]),r=ee({uuid:"visual-script-onButton-"+KC++,insert:{with:Rn},execute:()=>{for(const a of i()){const l=M(a,Dt).buttons[o];Bg.forEach(u=>{if((l==null?void 0:l[u])===!0){const d=`${u.charAt(0).toUpperCase()}${u.slice(1)}`;n(d)}}),t("value",(l==null?void 0:l.value)??0)}}});return{query:i,systemUUID:r}},dispose:({state:{query:e,systemUUID:t}})=>(vn(t),Bs(e),zg())});let QC=0;const jg=()=>({query:void 0,systemUUID:""}),JC=zt({typeName:"engine/onCollision",category:U.Engine,label:"Collision Events",configuration:{},in:{entity:"entity"},out:{flow:"flow",entity:"entity",target:"entity"},initialState:jg(),init:({read:e,write:t,commit:n})=>{const o=e("entity"),i=ie([zl]),r=ee({uuid:"visual-script-onCollision-"+QC++,insert:{after:c4},execute:()=>{const a=i();for(const c of a){if(o&&o!=c)continue;M(c,at);const l=M(c,zl);for(const[u,d]of l)t("entity",c),t("target",u),n("flow",()=>{});Qe(c,zl)}}});return{query:i,systemUUID:r}},dispose:({state:{query:e,systemUUID:t}})=>(vn(t),Bs(e),jg())});let h2=0;const $C="visual-script-onExecute-",eL=()=>$C+h2,_g=()=>({systemUUID:""}),tL=zt({typeName:"flow/lifecycle/onExecute",category:U.Flow,label:"On Execute",in:{system:(e,t)=>{const n=Array.from(Kf.keys()).map(s=>s),o=n.filter(s=>s.includes("group")).sort(),i=n.filter(s=>!s.includes("group")).sort();return{valueType:"string",choices:[...o,...i],defaultValue:Rn}}},out:{flow:"flow",delta:"float"},initialState:_g(),init:({read:e,write:t,commit:n,graph:o,configuration:i})=>{const r=e("system");return h2++,{systemUUID:ee({uuid:eL(),insert:{with:r},execute:()=>{n("flow"),t("delta",B(ht).deltaSeconds)}})}},dispose:({state:{systemUUID:e},graph:{getDependency:t}})=>(vn(e),_g())});let nL=0;const Hg=()=>({query:void 0,systemUUID:""}),qf=zt({typeName:"engine/query/use",category:U.Engine,label:"On Query",configuration:{numInputs:{valueType:"number",defaultValue:1}},in:e=>{var r;const t=[],n=s=>{const a=Array.from(Ft.keys()).sort();return{key:`componentName${s}`,valueType:"string",choices:a,defaultValue:q.name}},o=()=>{const s=["enter","exit"];return{key:"type",valueType:"string",choices:s,defaultValue:s[0]}},i=()=>{const s=Array.from(Kf.keys()).map(u=>u),a=s.filter(u=>u.includes("group")).sort(),c=s.filter(u=>!u.includes("group")).sort();return{key:"system",valueType:"string",choices:[...a,...c],defaultValue:Rn}};t.push({...o()},{...i()});for(const s of gn(1,(e.numInputs??((r=qf.configuration)==null?void 0:r.numInputs.defaultValue))+1))t.push({...n(s)});return t},out:{flow:"flow",entity:"entity"},initialState:Hg(),init:({read:e,write:t,commit:n,configuration:o})=>{var f;const i=e("type"),r=e("system"),s=[];for(const h of gn(1,(o.numInputs??((f=qf.configuration)==null?void 0:f.numInputs.defaultValue))+1)){const p=e(`componentName${h}`),g=Ft.get(p);s.push(g)}const a=ie(s)[i];let c=[],l=[];const u=ee({uuid:"visual-script-onQuery-"+nL++,insert:{with:r},execute:()=>{if(l=a(),l.length===0||c===l)return;const h=l;for(let p=0;p<h.length;p++)console.log("DEBUG in code",h[p]),t("entity",h[p]),n("flow");c=h}});return{query:a,systemUUID:u}},dispose:({state:{query:e,systemUUID:t}})=>(vn(t),Bs(e),Hg())}),Wf=(e,t)=>{switch(typeof t){case"number":return e.toLowerCase().includes("entity")?"entity":"float";case"boolean":return"boolean";case"string":case"undefined":return"string";case"object":if(t instanceof Me)return"vec2";if(t instanceof P)return"vec3";if(t instanceof W1)return"vec4";if(t instanceof re)return"quat";if(t instanceof ne)return"mat4";if(t instanceof nd)return"mat3";if(t instanceof vt)return"color";break;case"function":break;default:return null}};function Us(e,t){switch(t){case"float":case"integer":return Number(e);case"string":return String(e);case"euler":case"vec3":case"vec2":return jf(e);case"quat":return a2(e);case"vec4":return uC(e);case"mat4":return new ne().fromArray(e.elements);case"mat3":return new nd().fromArray(e.elements);case"color":return new vt().setFromVector3(e);case"boolean":return!!e}}function fi(e){if(typeof e=="object"&&e instanceof vt){const n=e.getStyle().match(/\d+/g).map(Number);return new P(n[0],n[1],n[2])}return e}const p2=[""],oL=e=>{switch(e){case dt.boolean:return"boolean";case dt.string:return"string";case dt.number:return"float";default:return null}};function m2(e){const t={},n=e;if(n===null||n===void 0)return t;for(const[o,i]of Object.entries(n)){const r=oL(i);r&&(t[o]=r)}return t}function iL(){const e=[];for(const[t,n]of Object.entries(hc)){const{type:o,...i}=n.actionShape,r={};if(p2.includes(t))continue;const s=m2(i);if(Object.keys(s).length===0)continue;const c=(Array.isArray(o)?o[0]:o).split("."),l=oi.startCase(c.pop().toLowerCase()),u=c.splice(1).join("/"),d=oe({typeName:`action/${u}/${l}/dispatch`,category:U.Action,label:`dispatch ${u} ${l}`,in:{flow:"flow",...s},out:{flow:"flow"},initialState:void 0,triggered:({read:f,write:h,commit:p})=>{const g=Object.entries(d.in).splice(1);for(const[m,v]of g)r[m]=Us(f(m),v);ei(hc[o](r)),p("flow")}});e.push(d)}return e}const qg=()=>({queue:void 0,systemUUID:""});let rL=0;function sL(){const e=[];for(const[t,n]of Object.entries(hc)){const{type:o,...i}=n.actionShape;if(p2.includes(t))continue;const r=m2(i);if(Object.keys(r).length===0)continue;const a=(Array.isArray(o)?o[0]:o).split("."),c=oi.startCase(a.pop().toLowerCase()),l=a.splice(1).join("/"),u=zt({typeName:`action/${l}/${c}/consume`,category:U.Action,label:`on ${l} ${c}`,in:{system:(d,f)=>{const h=Array.from(Kf.keys()).map(v=>v),p=h.filter(v=>v.includes("group")).sort(),g=h.filter(v=>!v.includes("group")).sort();return{key:"system",valueType:"string",choices:[...p,...g],defaultValue:Rn}}},out:{flow:"flow",...r},initialState:qg(),init:({read:d,write:f,commit:h,graph:p})=>{const g=d("system"),m=Zc(hc[o].matches);m();const v=ee({uuid:`visual-script-onAction-${c}`+rL++,insert:{with:g},execute:()=>{const w=m();if(w.length===0)return;const S=w;for(let T=0;T<S.length;T++){const x=S[T];for(const[E,C]of Object.entries(r))f(E,Us(x[E],C));h("flow")}m()}});return{queue:m,systemUUID:v}},dispose:({state:{queue:d,systemUUID:f},graph:{getDependency:h}})=>(vn(f),m4(d),qg())});e.push(u)}return e}const kl=[q.name,"PostProcessingComponent","AvatarAnimationComponent"],aL=[...kl,at.name];function Vh(e,t=!1){const n={};if(kl.includes(e.name))return n;const o=P2(Li,e);if(o===null||o===void 0)return n;if(typeof o!="object"){const i=e.name.replace("Component",""),r=Wf(i,o);return t&&(n[`${i}Change`]="flow"),r&&(n[i]=r),n}for(const[i,r]of Object.entries(o)){const s=Wf(i,r);t&&(n[`${i}Change`]="flow"),s&&(n[i]=s)}return n}function cL(){const e=[];for(const[t,n]of Ft){if(kl.includes(t))continue;const o=Vh(n);if(Object.keys(o).length===0)continue;const i=oe({typeName:`engine/component/${t}/set`,category:U.Engine,label:`set ${t}`,in:{flow:"flow",entity:"entity",...o},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:r,write:s,commit:a})=>{const c=Number.parseInt(r("entity")),l=Object.entries(i.in).splice(2);let u={};if(l.length===1)u=Us(r(l[0][0]),l[0][1]);else for(const[d,f]of l)u[d]=Us(r(d),f);O(c,n,u),s("entity",c),a("flow")}});e.push(i)}return e}function lL(){const e=[];for(const[t,n]of Ft){if(kl.includes(t))continue;const o=Vh(n);if(Object.keys(o).length===0)continue;const i=St({typeName:`engine/component/${t}/get`,category:U.Engine,label:`get ${t}`,in:{entity:"entity"},out:{entity:"entity",...o},exec:({read:r,write:s,graph:a})=>{const c=Number.parseInt(r("entity")),l=M(c,n),u=Object.entries(i.out).splice(1);if(typeof l!="object")s(u[u.length-1][0],fi(l));else for(const[d,f]of u)s(d,fi(l[d]));s("entity",c)}});e.push(i)}return e}const Wg=()=>({systemUUID:""});function uL(){const e=[];for(const[t,n]of Ft){if(aL.includes(t))continue;const o=Vh(n,!0);if(Object.keys(o).length===0)continue;const i=zt({typeName:`engine/component/${t}/use`,category:U.Engine,label:`use ${t}`,in:{entity:"entity"},out:{entity:"entity",...o},initialState:Wg(),init:({read:r,write:s,commit:a})=>{const c=Number.parseInt(r("entity")),l=Object.entries(i.out).splice(1).filter(([h,p])=>p!=="flow"),u=Object.entries(i.out).splice(1).filter(([h,p])=>p==="flow"),d=ee({uuid:`visual-script-use-${t}`+oi.uniqueId(),insert:{with:Rn},execute:()=>{},reactor:()=>{const h=se(c,n);return typeof h!="object"?A.useEffect(()=>{const p=fi(h.value);s(l[l.length-1][0],p),a(u[u.length-1][0])},[h]):l.forEach(([p,g],m)=>{A.useEffect(()=>{const v=fi(h[p].value),y=u.find(([w,S])=>w===`${p}Change`);s(p,v),a(y[0])},[h[p]])}),null}});return s("entity",c),{systemUUID:d}},dispose:({state:{systemUUID:r}})=>(vn(r),Wg())});e.push(i)}return e}const fL=(e,t=Li,n=Li)=>{const o=It();let i;if(n){const s=M(n,Lt);s!=null&&s.parentEntity&&de(s.parentEntity,Lt)&&(i=M(s.parentEntity,Lt).children.indexOf(n))}O(o,Lt,{parentEntity:t,childIndex:i}),O(o,q);const r=N2();O(o,Se,r),O(o,yn);for(const s of e)_h.has(s.name)&&O(o,_h.get(s.name),s.props);return o},Uh=[""];function zh(e,t=!1){const n={},o=e.get(dr);if(o===null||o===void 0)return n;for(const[i,r]of Object.entries(o)){const s=Wf(i,r);t&&(n[`${i}Change`]="flow"),s&&(n[i]=s)}return n}function dL(){const e=[];for(const[t,n]of Object.entries(ye.instance.store.stateMap)){if(Uh.includes(t))continue;const o=zh(n);if(Object.keys(o).length===0)continue;const i=oe({typeName:`engine/state/${t}/set`,category:U.Engine,label:`set ${t}`,in:{flow:"flow",...o},out:{flow:"flow"},initialState:void 0,triggered:({read:r,write:s,commit:a})=>{const c=Object.entries(i.in).splice(1);for(const[l,u]of c)n[l].set(Us(r(l),u));a("flow")}});e.push(i)}return e}function hL(){const e=[];for(const[t,n]of Object.entries(ye.instance.store.stateMap)){if(Uh.includes(t))continue;const o=zh(n);if(Object.keys(o).length===0)continue;const i=oe({typeName:`engine/state/${t}/get`,category:U.Engine,label:`get ${t}`,in:{flow:"flow"},out:{flow:"flow",...o},initialState:void 0,triggered:({read:r,write:s,commit:a})=>{const c=Object.entries(i.out).splice(1),l=n;if(typeof l!="object")s(c[c.length-1][0],fi(l));else for(const[u,d]of c)s(u,fi(l[u].value));a("flow")}});e.push(i)}return e}let g2=0;const Gg=()=>({systemUUID:""}),pL="visual-script-use-",Xg=e=>pL+`${e}`+g2;function mL(){const e=[];for(const[t,n]of Object.entries(ye.instance.store.stateMap)){if(Uh.includes(t))continue;const o=zh(n,!0);if(Object.keys(o).length===0)continue;const i=zt({typeName:`engine/state/${t}/use`,category:U.Engine,label:`Use ${t}`,in:{},out:{...o},initialState:Gg(),init:({read:r,write:s,commit:a})=>{const c=Object.entries(i.out).filter(([f,h])=>h!=="flow"),l=Object.entries(i.out).filter(([f,h])=>h==="flow");return g2++,console.log("stateName",Xg(t)),{systemUUID:ee({uuid:Xg(t),insert:{with:Rn},execute:()=>{},reactor:()=>{const f=We(n);return typeof f.value!="object"?A.useEffect(()=>{const h=fi(f.value);s(c[c.length-1][0],h),a(l[l.length-1][0])},[f]):c.forEach(([h,p],g)=>{A.useEffect(()=>{const m=fi(f[h].value),v=l.find(([y,w])=>y===`${h}Change`);s(h,m),a(v[0])},[f[h]])}),null}})}},dispose:({state:{systemUUID:r}})=>(vn(r),Gg())});e.push(i)}return e}const gL=oe({typeName:"engine/media/volumetric/playVolumetric",category:U.Engine,label:"Play Volumetric",in:{flow:"flow",entity:"entity",play:"boolean"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entity"),o=e("play");gt(n,id).paused.set(!o),t("flow")}}),vL=oe({typeName:"engine/media/volumetric/setVolumetricTime",category:U.Engine,label:"Set Volumetric Time",in:{flow:"flow",entity:"entity",time:"float"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entity"),o=e("time");gt(n,id).currentTrackInfo.currentTime.set(o),t("flow")}}),yL=oe({typeName:"engine/media/volumetric/fadeVolumetricVolume",category:U.Engine,label:"Fade Volumetric Volume",in:{flow:"flow",entity:"entity",targetVolume:"float",duration:"float"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entity"),o=e("targetVolume"),i=e("duration"),r=gt(n,id),s={};Object.defineProperty(s,"volume",{get:()=>r.volume.value,set:c=>{r.volume.set(c)}});const a=It();O(a,Xn,new Ls(s).to({volume:o},i*1e3).start().onComplete(()=>{Gt(a)})),t("flow")}}),bL=Object.freeze(Object.defineProperty({__proto__:null,fadeVolumetricAudioVolume:yL,playVolumetric:gL,setVolumetricTime:vL},Symbol.toStringTag,{value:"Module"})),xL=St({typeName:"engine/axis/get",category:U.Engine,label:"get Axis",in:{axis:(e,t)=>{const n=[...Object.keys(D1).filter(o=>!(parseInt(o)>=0)).sort().map(o=>({text:`gamepad/${o}`,value:o})),...Object.keys(I1).filter(o=>!(parseInt(o)>=0)).sort().map(o=>({text:`xr-gamepad/${o}`,value:o}))];return{valueType:"integer",choices:n,defaultValue:n[0].value}},deadzone:"float",entity:"entity"},out:{value:"float"},exec:({read:e,write:t,graph:n})=>{var c;const o=e("axis"),i=e("deadzone"),r=Number(e("entity"));Te.mustBeTrue(de(r,Dt),"ERROR: entity does not have Input Source component");const s=M(r,Dt);Te.mustBeDefined(s.source.gamepad,"ERROR: InputSourceComponent does not have gamepad");let a=(c=s.source.gamepad)==null?void 0:c.axes[o];Math.abs(a)<i&&(a=0),t("value",a)}}),wL=Object.freeze(Object.defineProperty({__proto__:null,getAxis:xL},Symbol.toStringTag,{value:"Module"})),SL=oe({typeName:"engine/component/addComponent",category:U.Engine,label:"Add Component",in:{flow:"flow",entity:"entity",componentName:e=>{const t=Array.from(Ft.keys()).sort();return t.unshift("none"),{valueType:"string",choices:t}}},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=Number.parseInt(e("entity")),i=e("componentName"),r=Ft.get(i);O(o,r),t("entity",o),n("flow")}}),TL=oe({typeName:"engine/component/deleteComponent",category:U.Engine,label:"Delete Component",in:{flow:"flow",entity:"entity",componentName:e=>{const t=Array.from(Ft.keys()).sort();return t.unshift("none"),{valueType:"string",choices:t}}},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=Number.parseInt(e("entity")),i=e("componentName"),r=Ft.get(i);Qe(o,r),t("entity",o),n("flow")}}),EL=oe({typeName:"engine/component/tag/set",category:U.Engine,label:"set Tag",in:{flow:"flow",entity:"entity",tagName:"string"},out:{flow:"flow",entity:"entity",tagName:"string"},initialState:void 0,triggered:({read:e,write:t,commit:n,graph:{getDependency:o}})=>{const i=Number.parseInt(e("entity")),r=e("tagName"),s=yt({name:`bg-tag.${r}`});O(i,s),t("entity",i),t("tagName",r),n("flow")}}),ML=oe({typeName:"engine/component/tag/remove",category:U.Engine,label:"remove Tag",in:{flow:"flow",entity:"entity",tagName:"string"},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:e,write:t,commit:n,graph:{getDependency:o}})=>{const i=Number.parseInt(e("entity")),r=`bg-tag.${e("tagName")}`,s=Ft.get(r);Te.mustBeDefined(s,`Component ${r} does not exist`),Qe(i,s),t("entity",i),n("flow")}}),PL=Object.freeze(Object.defineProperty({__proto__:null,addComponent:SL,deleteComponent:TL,removeTag:ML,setTag:EL},Symbol.toStringTag,{value:"Module"})),NL=oe({typeName:"engine/media/playVideo",category:U.Engine,label:"Play video",in:{flow:"flow",entity:"entity",mediaPath:"string",autoplay:"boolean",volume:"float",playMode:e=>{const t=Object.keys(gc).map(n=>({text:n,value:gc[n]}));return{valueType:"string",choices:t,defaultValue:t[0]}},videoFit:e=>{const t=["cover","contain","vertical","horizontal"];return{valueType:"string",choices:t,defaultValue:t[0]}}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=Number(e("entity"));let o,i;if(de(n,ti)){const l=M(n,ti);o=l.resources.length>0?l.resources:[],i=l.volume}O(n,mc);const r=e("mediaPath");o=r?[r,...o]:o;const s=e("autoplay");i=Ht.clamp(e("volume")??i,0,1);const a=e("videoFit"),c=e("playMode");O(n,nb,{fit:a}),O(n,ti,{autoplay:s,resources:o,volume:i,playMode:c}),t("flow")}}),AL=oe({typeName:"engine/media/playAudio",category:U.Engine,label:"Play audio",in:{flow:"flow",entity:"entity",mediaPath:"string",autoplay:"boolean",isMusic:"boolean",volume:"float",paused:"boolean",seekTime:"float",playMode:e=>{const t=Object.keys(gc).map(n=>({text:n,value:gc[n]}));return{valueType:"string",choices:t,defaultValue:t[0]}}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=Number(e("entity"));let o,i;if(de(n,ti)){const d=M(n,ti);o=d.resources.length>0?d.resources:[],i=d.volume}de(n,mc)||O(n,mc);const r=e("mediaPath");o=r?[r,...o]:o;const s=e("autoplay");i=Ht.clamp(e("volume")??i,0,1);const a=e("playMode"),c=e("paused"),l=e("seekTime");O(n,ti,{autoplay:s,resources:o,volume:i,playMode:a,seekTime:l}),gt(n,ti).paused.set(c),t("flow")}}),CL=St({typeName:"engine/media/getAnimationPack",category:U.Engine,label:"Get Avatar Animations",in:{animationName:e=>{const t=B(Qf).loadedAnimations,n=Object.keys(t).sort();return n.unshift("none"),{valueType:"string",choices:n}}},out:{animationPack:"string"},exec:({read:e,write:t})=>{const n=e("animationName");t("animationPack",n)}}),LL=oe({typeName:"engine/media/playAnimation",category:U.Engine,label:"Play animation",in:{flow:"flow",entity:"entity",paused:"boolean",timeScale:"float",animationPack:"string",activeClipIndex:"float",isAvatar:"boolean"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entity"),o=e("paused"),i=e("timeScale"),r=e("animationPack"),s=e("activeClipIndex");O(n,Kc,{paused:o,timeScale:i,animationPack:r,activeClipIndex:s}),t("flow")}}),DL=oe({typeName:"engine/media/setAnimationAction",category:U.Engine,label:"Set animation action",in:{flow:"flow",entity:"entity",timeScale:"float",blendMode:e=>{const t=[{text:"normal",value:Q4},{text:"additive",value:J4}];return{valueType:"number",choices:t,defaultValue:t[0]}},loopMode:e=>{const t=[{text:"once",value:$4},{text:"repeat",value:eb},{text:"pingpong",value:tb}];return{valueType:"number",choices:t,defaultValue:t[0]}},weight:"float",clampWhenFinished:"boolean",zeroSlopeAtStart:"boolean",zeroSlopeAtEnd:"boolean"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entity"),o=e("timeScale"),i=e("blendMode"),r=e("loopMode"),s=e("clampWhenFinished"),a=e("zeroSlopeAtStart"),c=e("zeroSlopeAtEnd"),l=e("weight");O(n,Kc,{timeScale:o,blendMode:i,loop:r,clampWhenFinished:s,zeroSlopeAtStart:a,zeroSlopeAtEnd:c,weight:l}),t("flow")}}),IL=oe({typeName:"engine/camera/cameraFade",category:U.Engine,label:"Camera fade",in:{flow:"flow",toBlack:"boolean"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{ei(Ou.fadeToBlack({in:e("toBlack")})),t("flow")}}),FL=oe({typeName:"engine/camera/setCameraZoom",category:U.Engine,label:"Set camera zoom",in:{flow:"flow",zoom:"float"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=ye.instance.cameraEntity,o=e("zoom");O(n,Hs,{targetDistance:o}),t("flow")}}),RL=oe({typeName:"engine/xr/startSession",category:U.Engine,label:"Start XR Session",in:{flow:"flow",XRmode:e=>{const t=["inline","immersive-ar","immersive-vr"];return{valueType:"string",choices:t,defaultValue:t[0]}}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("XRmode");l4({mode:n}),t("flow")}}),OL=oe({typeName:"engine/xr/endSession",category:U.Engine,label:"End XR Session",in:{flow:"flow"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{u4(),t("flow")}}),kL=oe({typeName:"engine/switchScene",category:U.Engine,label:"Switch Scene",in:{flow:"flow",projectName:"string",sceneName:"string"},out:{},initialState:void 0,triggered:({read:e,commit:t})=>{}}),VL=St({typeName:"group",in:{},out:{},exec:({read:e,write:t,graph:n})=>{}}),UL=oe({typeName:"engine/redirectToURL",category:U.Engine,label:"Redirect to URL",in:{flow:"flow",url:"string"},out:{},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("url");window.location.assign(n)}}),zL=oe({typeName:"engine/fadeMesh",category:U.Engine,label:"Fade Mesh",in:{flow:"flow",entity:"entity",fadeOut:"boolean",duration:"float"},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{var c;const n=e("entity"),o=e("fadeOut"),i=e("duration"),r=((c=ue(n,mt))==null?void 0:c[0])??null,s=r?f4(r,l=>{const u=l.material;return u.transparent=!0,u},l=>(l==null?void 0:l.isMesh)&&!!l.material&&!Array.isArray(l.material)&&typeof l.material.transparent=="boolean"):[],a={opacity:1,_opacity:1};Object.defineProperty(a,"opacity",{get:()=>a._opacity,set:l=>{a._opacity=l;for(const u of s)u.opacity=l}}),o?(a.opacity=1,O(n,Xn,new Ls(a).to({opacity:0},i*1e3).start().onComplete(()=>{Qe(n,Xn)}))):(a.opacity=0,O(n,Xn,new Ls(a).to({opacity:1},i*1e3).start().onComplete(()=>{Qe(n,Xn)}))),t("flow")}}),BL=Object.freeze(Object.defineProperty({__proto__:null,fadeCamera:IL,fadeMesh:zL,finishXRSession:OL,getAnimationPack:CL,group:VL,playAnimation:LL,playAudio:AL,playVideo:NL,redirectToURL:UL,setAnimationAction:DL,setCameraZoom:FL,startXRSession:RL,switchScene:kL},Symbol.toStringTag,{value:"Module"})),Zg=()=>({systemUUID:""}),Bh=ie([Jo]),jL=St({typeName:"logic/entity/get/entityInScene",category:U.Logic,label:"Get entity in scene",in:{entity:e=>({valueType:"string",choices:Bh().map(n=>({text:M(n,at),value:M(n,Se)})),defaultValue:""})},out:{entity:"entity"},exec:({read:e,write:t})=>{const n=e("entity"),o=Se.getEntityByUUID(n);t("entity",o)}}),_L=St({typeName:"logic/entity/get/localClientEntity",category:U.Logic,label:"Get local client entity",in:{},out:{entity:"entity"},exec:({write:e})=>{const t=he.getSelfAvatarEntity();e("entity",t)}}),HL=St({typeName:"logic/entity/get/cameraEntity",category:U.Logic,label:"Get camera entity",in:{},out:{entity:"entity"},exec:({write:e})=>{const t=ye.instance.cameraEntity;e("entity",t)}}),qL=oe({typeName:"logic/entity/exists",category:U.Logic,label:"Entity exists",in:{flow:"flow",entity:"entity"},out:{flow:"flow",exists:"boolean",entity:"entity",uuid:"string",position:"vec3",rotation:"quat",scale:"vec3",matrix:"mat4"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("entity");if(!o)t("exists",!1);else{t("exists",!0),t("entity",o);const i=M(o,q);t("position",i.position),t("rotation",i.rotation),t("scale",i.scale),t("matrix",i.matrix),t("uuid",M(o,Se))}n("flow")}}),WL=oe({typeName:"logic/entity/addEntity",category:U.Logic,label:"Add entity",in:{flow:"flow",parentEntity:e=>({valueType:"string",choices:Bh().map(n=>({text:M(n,at),value:M(n,Se)})),defaultValue:""}),componentName:e=>({valueType:"string",choices:Array.from(Ft.entries()).filter(([,n])=>!!n.jsonID).map(([n])=>n).sort(),defaultValue:q.name}),entityName:"string"},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=e("parentEntity"),i=o==""?Li:Se.getEntityByUUID(o),r=e("componentName"),s=fL([{name:Ft.get(r).jsonID}],i),a=e("entityName");a.length>0&&O(s,at,a),t("entity",s),n("flow")}}),GL=oe({typeName:"logic/entity/deleteEntity",category:U.Logic,label:"Delete entity",in:{flow:"flow",entityUUID:e=>{const t=Bh().map(n=>({text:M(n,at),value:M(n,Se)}));return t.unshift({text:"none",value:""}),{valueType:"string",choices:t}}},out:{flow:"flow"},initialState:void 0,triggered:({read:e,commit:t})=>{const n=e("entityUUID"),o=Se.getEntityByUUID(n);Gt(o),t("flow")}}),XL=St({typeName:"engine/entity/TransformComponent/get",category:U.Engine,label:"Get entity transform",in:{entity:"entity"},out:{entity:"entity",position:"vec3",rotation:"quat",scale:"vec3",matrix:"mat4"},exec:({read:e,write:t})=>{const n=Number(e("entity")),o=M(n,q);t("position",o.position),t("rotation",o.rotation),t("scale",o.scale),t("matrix",o.matrix),t("entity",n)}}),ZL=oe({typeName:"engine/entity/TransformComponent/set",category:U.Engine,label:"set transformComponent",in:{flow:"flow",entity:"entity",position:"vec3",rotation:"quat",scale:"vec3"},out:{flow:"flow",entity:"entity"},initialState:void 0,triggered:({read:e,write:t,commit:n})=>{const o=jf(e("position")),i=a2(e("rotation")),r=jf(e("scale")),s=Number(e("entity"));s===he.getSelfAvatarEntity()?ed(s,o,!0):(O(s,q,{position:o,rotation:i,scale:r}),de(s,Tt)&&d4(s)),t("entity",s),n("flow")}}),v2=zt({typeName:"engine/entity/TransformComponent/use",category:U.Engine,label:"Use entity transform",in:{entity:"entity"},out:{entity:"entity",positionChange:"flow",position:"vec3",rotationChange:"flow",rotation:"quat",scaleChange:"flow",scale:"vec3"},initialState:Zg(),init:({read:e,commit:t,write:n})=>{const o=Number(e("entity")),i={},s={systemUUID:ee({uuid:"visual-script-useTransform-"+oi.uniqueId(),insert:{with:Rn},execute:()=>{const a=M(o,q);Object.entries(a).forEach(([c,l])=>{Object.keys(v2.out).includes(c)&&(Object.hasOwn(i,c)&&oi.isEqual(i[c],a[c])||(n(c,l),t(`${c}Change`),i[c]=oi.cloneDeep(a[c])))})},reactor:()=>null})};return n("entity",o),s},dispose:({state:{systemUUID:e}})=>(vn(e),Zg())}),KL=b({name:"logic/entity/getUuid",label:"Entity uuid",in:["entity"],out:"string",exec:e=>M(e,Se)}),YL=b({name:"logic/entity/constant",label:"Entity",in:["entity"],out:"entity",exec:e=>e}),QL=b({name:"logic/entity/compare/equal",label:"Entity =",in:["entity","entity"],out:"boolean",exec:(e,t)=>e===t}),JL=Object.freeze(Object.defineProperty({__proto__:null,Constant:YL,Equal:QL,addEntity:WL,deleteEntity:GL,entityExists:qL,getCameraEntity:HL,getEntity:jL,getEntityTransform:XL,getLocalClientEntity:_L,getUUID:KL,setEntityTransform:ZL,useEntityTransform:v2},Symbol.toStringTag,{value:"Module"})),$L={name:"entity",creator:()=>0,deserialize:e=>e,serialize:e=>e,equals:(e,t)=>e===t,clone:e=>e,lerp:function(e,t,n){throw new Error("Function not implemented.")}},Gf=St({typeName:"engine/query/get",category:U.Engine,label:"get Query",configuration:{numInputs:{valueType:"number",defaultValue:1}},in:(e,t)=>{var r;const n=[],o=s=>{const a=Array.from(Ft.keys()).sort();return{key:`componentName${s}`,valueType:"string",choices:a,defaultValue:q.name}},i=()=>{const s=["enter","exit"];return{key:"type",valueType:"string",choices:s,defaultValue:s[0]}};n.push({...i()});for(const s of gn(1,(e.numInputs??((r=Gf.configuration)==null?void 0:r.numInputs.defaultValue))+1))n.push({...o(s)});return n},out:{entityList:"list"},exec:({read:e,write:t,graph:n,configuration:o})=>{var a;const i=e("type"),r=[];for(const c of gn(1,(o.numInputs??((a=Gf.configuration)==null?void 0:a.numInputs.defaultValue))+1)){const l=e(`componentName${c}`),u=Ft.get(l);r.push(u)}const s=ie(r)[i]();t("entityList",s),Bs(s)}}),eD=Object.freeze(Object.defineProperty({__proto__:null,getQuery:Gf},Symbol.toStringTag,{value:"Module"})),tD=ie([J1]),nD=St({typeName:"engine/spline/getSpline",category:U.Engine,label:"Get Spline Entity",in:{spline:e=>{const t=tD().map(n=>({text:M(n,at),value:M(n,Se)}));return t.unshift({text:"none",value:""}),{valueType:"string",choices:t}}},out:{entity:"entity"},exec:({read:e,write:t})=>{const n=e("spline");Te.mustBeTrue(n!=="","Please select spline entity");const o=Se.getEntityByUUID(n);t("entity",o)}});let oD=0;const Kg=()=>({systemUUID:""}),iD=yP({typeName:"engine/spline/addSplineTrack",category:U.Engine,label:"Add spline track",in:{flow:"flow",entity:"entity",velocity:"float",splineUUID:"string",isLoop:"boolean",lockToXZPlane:"boolean",enableRotation:"boolean",reset:"boolean"},out:{flow:"flow",trackEnd:"flow",entity:"entity"},initialState:Kg(),triggered:({read:e,write:t,commit:n,finished:o})=>{const i=Number(e("entity")),r=e("splineUUID"),s=e("velocity"),a=e("isLoop"),c=e("lockToXZPlane"),l=e("enableRotation"),u=e("reset")?0:void 0;O(i,fp,{alpha:u,splineEntityUUID:r,velocity:s,enableRotation:l,lockToXZPlane:c,loop:a}),t("entity",i);const d=ee({uuid:"visual-script-spline-tracker-"+oD++,insert:{with:Yt},execute:()=>{const h=M(i,fp);if(h.loop)return;const p=Se.getEntityByUUID(h.splineEntityUUID);if(!p)return;const g=ue(p,J1);if(g&&Math.floor(h.alpha)>g.elements.length-1){n("trackEnd"),o==null||o(),vn(d);return}}});return n("flow"),{systemUUID:d}},dispose:({state:{systemUUID:e}})=>(e&&vn(e),Kg())}),rD=Object.freeze(Object.defineProperty({__proto__:null,addSplineTrack:iD,getSpline:nD},Symbol.toStringTag,{value:"Module"})),zs=St({typeName:"variable/get",category:U.Variable,label:"Get",configuration:{variableName:{valueType:"string",defaultValue:"variable"}},in:(e,t)=>{var o;return[{key:Object.keys(zs.configuration).find(i=>i==="variableName"),valueType:(o=zs.configuration.variableName)==null?void 0:o.valueType,choices:Object.values(t.variables).map(i=>i.name)}]},out:(e,t)=>{var r;const n=(r=Object.values(t.variables).find(s=>s.name===e.variableName))==null?void 0:r.id,o=n!==void 0?t.variables[n]:new Nl("-1","value","string","");return[{key:"value",valueType:o.valueTypeName,label:o.name}]},exec:({read:e,write:t,graph:{variables:n},configuration:o})=>{var a;const i=(a=Object.values(n).find(c=>c.name===e("variableName")))==null?void 0:a.id,r=n[i];if(!r)return;const s=r.get();t("value",s)}}),Xf=oe({typeName:"variable/set",category:U.Variable,label:"Set",configuration:{variableName:{valueType:"string",defaultValue:"variable"}},in:(e,t)=>{var r,s;const n=(r=Object.values(t.variables).find(a=>a.name===e.variableName))==null?void 0:r.id,o=n!==void 0?t.variables[n]:new Nl("-1","value","string","");return[{key:"flow",valueType:"flow"},{key:Object.keys(Xf.configuration).find(a=>a==="variableName"),valueType:(s=Xf.configuration.variableName)==null?void 0:s.valueType,choices:Object.values(t.variables).map(a=>a.name)},{key:"value",valueType:o.valueTypeName,label:o.name}]},initialState:void 0,out:{flow:"flow"},triggered:({read:e,commit:t,graph:{variables:n},configuration:o})=>{var s;const i=(s=Object.values(n).find(a=>a.name===e(Object.keys(o).find(c=>c==="variableName"))))==null?void 0:s.id,r=n[i];r&&(r.set(e("value")),t("flow"))}}),Iu=()=>({systemUUID:""});let y2=0;const sD="visual-script-useVariable-",b2=e=>sD+`${e}-`+y2,aD=zt({typeName:"variable/use",category:U.Variable,label:"Use",configuration:{variableName:{valueType:"string",defaultValue:"variable"}},in:(e,t)=>{var o;return[{key:Object.keys(zs.configuration).find(i=>i==="variableName"),valueType:(o=zs.configuration.variableName)==null?void 0:o.valueType,choices:Object.values(t.variables).map(i=>i.name)}]},out:(e,t)=>{var r;const n=(r=Object.values(t.variables).find(s=>s.name===e.variableName))==null?void 0:r.id,o=n!==void 0?t.variables[n]:new Nl("-1","value","string","");return[{key:"valueChange",valueType:"flow"},{key:"value",valueType:o.valueTypeName,label:o.name}]},initialState:Iu(),init:({read:e,commit:t,write:n,graph:{variables:o}})=>{var l;const i=(l=Object.values(o).find(u=>u.name===e("variableName")))==null?void 0:l.id;if(i===void 0)return Iu();const r=[o[i].get()],s=u=>{r.unshift(u.get())};return y2++,{systemUUID:ee({uuid:b2(e("variableName")),insert:{with:Rn},execute:()=>{const u=r.pop();u!==void 0&&(n("value",u),t("valueChange"))},reactor:()=>(A.useEffect(()=>(o[i].onChanged.addListener(s),()=>{o[i].onChanged.removeListener(s)}),[]),null)})}},dispose:({state:{systemUUID:e}})=>(vn(e),Iu())}),cD=Object.freeze(Object.defineProperty({__proto__:null,EngineVariableGet:zs,EngineVariableSet:Xf,EngineVariableUse:aD,getUseVariableSystemUUID:b2},Symbol.toStringTag,{value:"Module"})),Oc=mi(()=>Object.fromEntries([$L].map(t=>[t.name,t])));function lD(e){return Object.keys(Oc()).filter(t=>t!=="string").flatMap(t=>Ll({values:e,valueTypeName:t}))}const uD=mi(()=>{Object.keys({...Oc()});const e=[...Be(JL),...Be(PL),...Be(BL),...Be(rD),...Be(eD),...Be(wL),...Be(bL),...Be(cD),YC,JC,qf,tL,ZC,...lD(Oc()),...cL(),...lL(),...uL(),...dL(),...hL(),...mL(),...sL(),...iL()];return Object.fromEntries(e.map(t=>[t.typeName,t]))}),fD=e=>({values:{...e.values,...Oc()},nodes:{...e.nodes,...uD()},dependencies:{...e.dependencies}}),x2={execute:la({type:"ee.engine.VisualScript.EXECUTE",entity:dt.number}),stop:la({type:"ee.engine.VisualScript.STOP",entity:dt.number}),executeAll:la({type:"ee.engine.VisualScript.EXECUTEALL",entity:dt.number}),stopAll:la({type:"ee.engine.VisualScript.STOPALL",entity:dt.number})};ie([mn]);const dD=Zc(x2.execute.matches),hD=Zc(x2.stop.matches),pD=()=>{if(!B(io).isEditor){for(const e of dD()){const t=e.entity;de(t,mn)&&O(t,mn,{run:!0})}for(const e of hD()){const t=e.entity;de(t,mn)&&O(t,mn,{run:!1})}}},mD=()=>(A.useEffect(()=>{Oh.registerProfile(fD,kh.ECS)},[]),null);ee({uuid:"ee.engine.VisualScriptSystem",insert:{with:Rn},execute:pD,reactor:mD});const jh=e=>{hb();const t=se(e.entity,mn);return te.createElement(db,{...e,name:"Visual Script Component",description:" Adds a visual script to the entity",icon:te.createElement(jh.iconComponent,null)},te.createElement(hp,{name:"Disable Visual Script",label:"Disable Visual Script"},te.createElement(dp,{value:t.disabled.value,onChange:Hh(mn,"disabled")})),te.createElement(hp,{name:"Play Visual Script",label:"Play Visual Script"},te.createElement(dp,{value:t.run.value,onChange:Hh(mn,"run")})))};jh.iconComponent=A2;const gD={},wI={title:"Editor/Properties/VisualScript",component:jh,parameters:{componentSubtitle:"VisualScriptNodeEditor",jest:"visualScriptNodeEditor.test.tsx",design:{type:"figma",url:""}},argTypes:gD},Ga={args:{}};var Yg,Qg,Jg;Ga.parameters={...Ga.parameters,docs:{...(Yg=Ga.parameters)==null?void 0:Yg.docs,source:{originalSource:`{
  args: {}
}`,...(Jg=(Qg=Ga.parameters)==null?void 0:Qg.docs)==null?void 0:Jg.source}}};const SI=["Default"];export{Ga as Default,SI as __namedExportsOrder,wI as default};
